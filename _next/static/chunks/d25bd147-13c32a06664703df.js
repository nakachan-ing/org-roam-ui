(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[446],{75569:function(t,n,r){var i;i=function(){var t;return(function t(n,r,i){function o(s,l){if(!r[s]){if(!n[s]){if(a)return a(s,!0);var c=Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};n[s][0].call(u.exports,function(t){return o(n[s][1][t]||t)},u,u.exports,t,n,r,i)}return r[s].exports}for(var a=void 0,s=0;s<i.length;s++)o(i[s]);return o})({1:[function(t,n,r){var i=Object.prototype.toString;n.exports=function(t){return t.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===i.call(t.buffer)||Array.isArray(t)}},{}],2:[function(t,n,r){n.exports=function(t,n){return"number"==typeof t?t:"number"==typeof n?n:0}},{}],3:[function(t,n,r){"use strict";r.byteLength=function(t){var n=u(t),r=n[0],i=n[1];return(r+i)*3/4-i},r.toByteArray=function(t){for(var n,r=u(t),i=r[0],s=r[1],l=new a((i+s)*3/4-s),c=0,h=s>0?i-4:i,d=0;d<h;d+=4)n=o[t.charCodeAt(d)]<<18|o[t.charCodeAt(d+1)]<<12|o[t.charCodeAt(d+2)]<<6|o[t.charCodeAt(d+3)],l[c++]=n>>16&255,l[c++]=n>>8&255,l[c++]=255&n;return 2===s&&(n=o[t.charCodeAt(d)]<<2|o[t.charCodeAt(d+1)]>>4,l[c++]=255&n),1===s&&(n=o[t.charCodeAt(d)]<<10|o[t.charCodeAt(d+1)]<<4|o[t.charCodeAt(d+2)]>>2,l[c++]=n>>8&255,l[c++]=255&n),l},r.fromByteArray=function(t){for(var n,r=t.length,o=r%3,a=[],s=0,l=r-o;s<l;s+=16383)a.push(function(t,n,r){for(var o,a=[],s=n;s<r;s+=3)a.push(i[(o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]))>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}(t,s,s+16383>l?l:s+16383));return 1===o?a.push(i[(n=t[r-1])>>2]+i[n<<4&63]+"=="):2===o&&a.push(i[(n=(t[r-2]<<8)+t[r-1])>>10]+i[n>>4&63]+i[n<<2&63]+"="),a.join("")};for(var i=[],o=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,c=s.length;l<c;++l)i[l]=s[l],o[s.charCodeAt(l)]=l;function u(t){var n=t.length;if(n%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=n);var i=r===n?0:4-r%4;return[r,i]}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],4:[function(t,n,r){"use strict";n.exports={createLink:function(t,n){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("link");for(var o in i.href=t,i.rel="stylesheet",n)if(n.hasOwnProperty(o)){var a=n[o];i.setAttribute("data-"+o,a)}r.appendChild(i)},createStyle:function(t,n){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");for(var o in i.type="text/css",n)if(n.hasOwnProperty(o)){var a=n[o];i.setAttribute("data-"+o,a)}i.sheet?(i.innerHTML=t,i.sheet.cssText=t,r.appendChild(i)):i.styleSheet?(r.appendChild(i),i.styleSheet.cssText=t):(i.appendChild(document.createTextNode(t)),r.appendChild(i))}}},{}],5:[function(t,n,r){var i=t("buffer").Buffer;n.exports=function(t,n){if(i.isBuffer(t)&&i.isBuffer(n)){if("function"==typeof t.equals)return t.equals(n);if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}}},{buffer:6}],6:[function(t,n,i){(function(n,r){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */"use strict";var o=t("base64-js"),a=t("ieee754"),s=t("isarray");function l(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,n){if(l()<n)throw RangeError("Invalid typed array length");return r.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=r.prototype:(null===t&&(t=new r(n)),t.length=n),t}function r(t,n,i){if(!r.TYPED_ARRAY_SUPPORT&&!(this instanceof r))return new r(t,n,i);if("number"==typeof t){if("string"==typeof n)throw Error("If encoding is specified then the first argument must be a string");return d(this,t)}return u(this,t,n,i)}function u(t,n,i,o){if("number"==typeof n)throw TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?function(t,n,i,o){if(n.byteLength,i<0||n.byteLength<i)throw RangeError("'offset' is out of bounds");if(n.byteLength<i+(o||0))throw RangeError("'length' is out of bounds");return n=void 0===i&&void 0===o?new Uint8Array(n):void 0===o?new Uint8Array(n,i):new Uint8Array(n,i,o),r.TYPED_ARRAY_SUPPORT?(t=n).__proto__=r.prototype:t=p(t,n),t}(t,n,i,o):"string"==typeof n?function(t,n,i){if(("string"!=typeof i||""===i)&&(i="utf8"),!r.isEncoding(i))throw TypeError('"encoding" must be a valid string encoding');var o=0|m(n,i),a=(t=c(t,o)).write(n,i);return a!==o&&(t=t.slice(0,a)),t}(t,n,i):function(t,n){if(r.isBuffer(n)){var i,o=0|f(n.length);return 0===(t=c(t,o)).length||n.copy(t,0,0,o),t}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(i=n.length)!=i?c(t,0):p(t,n);if("Buffer"===n.type&&s(n.data))return p(t,n.data)}throw TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,n)}function h(t){if("number"!=typeof t)throw TypeError('"size" argument must be a number');if(t<0)throw RangeError('"size" argument must not be negative')}function d(t,n){if(h(n),t=c(t,n<0?0:0|f(n)),!r.TYPED_ARRAY_SUPPORT)for(var i=0;i<n;++i)t[i]=0;return t}function p(t,n){var r=n.length<0?0:0|f(n.length);t=c(t,r);for(var i=0;i<r;i+=1)t[i]=255&n[i];return t}function f(t){if(t>=l())throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l().toString(16)+" bytes");return 0|t}function m(t,n){if(r.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var o=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return P(t).length;default:if(o)return L(t).length;n=(""+n).toLowerCase(),o=!0}}function v(t,n,r){var i,a,s=!1;if((void 0===n||n<0)&&(n=0),n>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(n>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,n,r){var i,o=t.length;(!n||n<0)&&(n=0),(!r||r<0||r>o)&&(r=o);for(var a="",s=n;s<r;++s)a+=(i=t[s])<16?"0"+i.toString(16):i.toString(16);return a}(this,n,r);case"utf8":case"utf-8":return A(this,n,r);case"ascii":return function(t,n,r){var i="";r=Math.min(t.length,r);for(var o=n;o<r;++o)i+=String.fromCharCode(127&t[o]);return i}(this,n,r);case"latin1":case"binary":return function(t,n,r){var i="";r=Math.min(t.length,r);for(var o=n;o<r;++o)i+=String.fromCharCode(t[o]);return i}(this,n,r);case"base64":return i=n,a=r,0===i&&a===this.length?o.fromByteArray(this):o.fromByteArray(this.slice(i,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,n,r){for(var i=t.slice(n,r),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}(this,n,r);default:if(s)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}function g(t,n,r){var i=t[n];t[n]=t[r],t[r]=i}function y(t,n,i,o,a){if(0===t.length)return -1;if("string"==typeof i?(o=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),isNaN(i=+i)&&(i=a?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(a)return -1;i=t.length-1}else if(i<0){if(!a)return -1;i=0}if("string"==typeof n&&(n=r.from(n,o)),r.isBuffer(n))return 0===n.length?-1:b(t,n,i,o,a);if("number"==typeof n)return(n&=255,r.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf)?a?Uint8Array.prototype.indexOf.call(t,n,i):Uint8Array.prototype.lastIndexOf.call(t,n,i):b(t,[n],i,o,a);throw TypeError("val must be string, number or Buffer")}function b(t,n,r,i,o){var a,s=1,l=t.length,c=n.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||n.length<2)return -1;s=2,l/=2,c/=2,r/=2}function u(t,n){return 1===s?t[n]:t.readUInt16BE(n*s)}if(o){var h=-1;for(a=r;a<l;a++)if(u(t,a)===u(n,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===c)return h*s}else -1!==h&&(a-=a-h),h=-1}else for(r+c>l&&(r=l-c),a=r;a>=0;a--){for(var d=!0,p=0;p<c;p++)if(u(t,a+p)!==u(n,p)){d=!1;break}if(d)return a}return -1}function A(t,n,r){r=Math.min(t.length,r);for(var i=[],o=n;o<r;){var a,s,l,c,u=t[o],h=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=r)switch(d){case 1:u<128&&(h=u);break;case 2:(192&(a=t[o+1]))==128&&(c=(31&u)<<6|63&a)>127&&(h=c);break;case 3:a=t[o+1],s=t[o+2],(192&a)==128&&(192&s)==128&&(c=(15&u)<<12|(63&a)<<6|63&s)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:a=t[o+1],s=t[o+2],l=t[o+3],(192&a)==128&&(192&s)==128&&(192&l)==128&&(c=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&l)>65535&&c<1114112&&(h=c)}null===h?(h=65533,d=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),o+=d}return function(t){var n=t.length;if(n<=4096)return String.fromCharCode.apply(String,t);for(var r="",i=0;i<n;)r+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return r}(i)}function x(t,n,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+n>r)throw RangeError("Trying to access beyond buffer length")}function w(t,n,i,o,a,s){if(!r.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(n>a||n<s)throw RangeError('"value" argument is out of bounds');if(i+o>t.length)throw RangeError("Index out of range")}function E(t,n,r,i){n<0&&(n=65535+n+1);for(var o=0,a=Math.min(t.length-r,2);o<a;++o)t[r+o]=(n&255<<8*(i?o:1-o))>>>(i?o:1-o)*8}function M(t,n,r,i){n<0&&(n=4294967295+n+1);for(var o=0,a=Math.min(t.length-r,4);o<a;++o)t[r+o]=n>>>(i?o:3-o)*8&255}function _(t,n,r,i,o,a){if(r+i>t.length||r<0)throw RangeError("Index out of range")}function T(t,n,r,i,o){return o||_(t,n,r,4,34028234663852886e22,-34028234663852886e22),a.write(t,n,r,i,23,4),r+4}function S(t,n,r,i,o){return o||_(t,n,r,8,17976931348623157e292,-17976931348623157e292),a.write(t,n,r,i,52,8),r+8}i.Buffer=r,i.SlowBuffer=function(t){return+t!=t&&(t=0),r.alloc(+t)},i.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),i.kMaxLength=l(),r.poolSize=8192,r._augment=function(t){return t.__proto__=r.prototype,t},r.from=function(t,n,r){return u(null,t,n,r)},r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=function(t,n,r){return(h(t),t<=0)?c(null,t):void 0!==n?"string"==typeof r?c(null,t).fill(n,r):c(null,t).fill(n):c(null,t)},r.allocUnsafe=function(t){return d(null,t)},r.allocUnsafeSlow=function(t){return d(null,t)},r.isBuffer=function(t){return!!(null!=t&&t._isBuffer)},r.compare=function(t,n){if(!r.isBuffer(t)||!r.isBuffer(n))throw TypeError("Arguments must be Buffers");if(t===n)return 0;for(var i=t.length,o=n.length,a=0,s=Math.min(i,o);a<s;++a)if(t[a]!==n[a]){i=t[a],o=n[a];break}return i<o?-1:o<i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,n){if(!s(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return r.alloc(0);if(void 0===n)for(i=0,n=0;i<t.length;++i)n+=t[i].length;var i,o=r.allocUnsafe(n),a=0;for(i=0;i<t.length;++i){var l=t[i];if(!r.isBuffer(l))throw TypeError('"list" argument must be an Array of Buffers');l.copy(o,a),a+=l.length}return o},r.byteLength=m,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)g(this,n,n+1);return this},r.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)g(this,n,n+3),g(this,n+1,n+2);return this},r.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)g(this,n,n+7),g(this,n+1,n+6),g(this,n+2,n+5),g(this,n+3,n+4);return this},r.prototype.toString=function(){var t=0|this.length;return 0===t?"":0==arguments.length?A(this,0,t):v.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",n=i.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t,n,i,o,a){if(!r.isBuffer(t))throw TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===i&&(i=t?t.length:0),void 0===o&&(o=0),void 0===a&&(a=this.length),n<0||i>t.length||o<0||a>this.length)throw RangeError("out of range index");if(o>=a&&n>=i)return 0;if(o>=a)return -1;if(n>=i)return 1;if(n>>>=0,i>>>=0,o>>>=0,a>>>=0,this===t)return 0;for(var s=a-o,l=i-n,c=Math.min(s,l),u=this.slice(o,a),h=t.slice(n,i),d=0;d<c;++d)if(u[d]!==h[d]){s=u[d],l=h[d];break}return s<l?-1:l<s?1:0},r.prototype.includes=function(t,n,r){return -1!==this.indexOf(t,n,r)},r.prototype.indexOf=function(t,n,r){return y(this,t,n,r,!0)},r.prototype.lastIndexOf=function(t,n,r){return y(this,t,n,r,!1)},r.prototype.write=function(t,n,r,i){if(void 0===n)i="utf8",r=this.length,n=0;else if(void 0===r&&"string"==typeof n)i=n,r=this.length,n=0;else if(isFinite(n))n|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,a,s,l,c,u,h,d,p,f,m,v,g=this.length-n;if((void 0===r||r>g)&&(r=g),t.length>0&&(r<0||n<0)||n>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var y=!1;;)switch(i){case"hex":return function(t,n,r,i){r=Number(r)||0;var o=t.length-r;i?(i=Number(i))>o&&(i=o):i=o;var a=n.length;if(a%2!=0)throw TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var s=0;s<i;++s){var l=parseInt(n.substr(2*s,2),16);if(isNaN(l))break;t[r+s]=l}return s}(this,t,n,r);case"utf8":case"utf-8":return c=n,u=r,D(L(t,this.length-c),this,c,u);case"ascii":return h=n,d=r,D(R(t),this,h,d);case"latin1":case"binary":return o=this,a=t,s=n,l=r,D(R(a),o,s,l);case"base64":return p=n,f=r,D(P(t),this,p,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m=n,v=r,D(function(t,n){for(var r,i,o=[],a=0;a<t.length&&!((n-=2)<0);++a)i=(r=t.charCodeAt(a))>>8,o.push(r%256),o.push(i);return o}(t,this.length-m),this,m,v);default:if(y)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),y=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.slice=function(t,n){var i,o=this.length;if(t=~~t,n=void 0===n?o:~~n,t<0?(t+=o)<0&&(t=0):t>o&&(t=o),n<0?(n+=o)<0&&(n=0):n>o&&(n=o),n<t&&(n=t),r.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,n)).__proto__=r.prototype;else{var a=n-t;i=new r(a,void 0);for(var s=0;s<a;++s)i[s]=this[s+t]}return i},r.prototype.readUIntLE=function(t,n,r){t|=0,n|=0,r||x(t,n,this.length);for(var i=this[t],o=1,a=0;++a<n&&(o*=256);)i+=this[t+a]*o;return i},r.prototype.readUIntBE=function(t,n,r){t|=0,n|=0,r||x(t,n,this.length);for(var i=this[t+--n],o=1;n>0&&(o*=256);)i+=this[t+--n]*o;return i},r.prototype.readUInt8=function(t,n){return n||x(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,n){return n||x(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,n){return n||x(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,n){return n||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,n){return n||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,n,r){t|=0,n|=0,r||x(t,n,this.length);for(var i=this[t],o=1,a=0;++a<n&&(o*=256);)i+=this[t+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*n)),i},r.prototype.readIntBE=function(t,n,r){t|=0,n|=0,r||x(t,n,this.length);for(var i=n,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*n)),a},r.prototype.readInt8=function(t,n){return(n||x(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},r.prototype.readInt16LE=function(t,n){n||x(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},r.prototype.readInt16BE=function(t,n){n||x(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},r.prototype.readInt32LE=function(t,n){return n||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,n){return n||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,n){return n||x(t,4,this.length),a.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,n){return n||x(t,4,this.length),a.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,n){return n||x(t,8,this.length),a.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,n){return n||x(t,8,this.length),a.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,n,r,i){if(t=+t,n|=0,r|=0,!i){var o=Math.pow(2,8*r)-1;w(this,t,n,r,o,0)}var a=1,s=0;for(this[n]=255&t;++s<r&&(a*=256);)this[n+s]=t/a&255;return n+r},r.prototype.writeUIntBE=function(t,n,r,i){if(t=+t,n|=0,r|=0,!i){var o=Math.pow(2,8*r)-1;w(this,t,n,r,o,0)}var a=r-1,s=1;for(this[n+a]=255&t;--a>=0&&(s*=256);)this[n+a]=t/s&255;return n+r},r.prototype.writeUInt8=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},r.prototype.writeUInt16LE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):E(this,t,n,!0),n+2},r.prototype.writeUInt16BE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):E(this,t,n,!1),n+2},r.prototype.writeUInt32LE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):M(this,t,n,!0),n+4},r.prototype.writeUInt32BE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):M(this,t,n,!1),n+4},r.prototype.writeIntLE=function(t,n,r,i){if(t=+t,n|=0,!i){var o=Math.pow(2,8*r-1);w(this,t,n,r,o-1,-o)}var a=0,s=1,l=0;for(this[n]=255&t;++a<r&&(s*=256);)t<0&&0===l&&0!==this[n+a-1]&&(l=1),this[n+a]=(t/s>>0)-l&255;return n+r},r.prototype.writeIntBE=function(t,n,r,i){if(t=+t,n|=0,!i){var o=Math.pow(2,8*r-1);w(this,t,n,r,o-1,-o)}var a=r-1,s=1,l=0;for(this[n+a]=255&t;--a>=0&&(s*=256);)t<0&&0===l&&0!==this[n+a+1]&&(l=1),this[n+a]=(t/s>>0)-l&255;return n+r},r.prototype.writeInt8=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},r.prototype.writeInt16LE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):E(this,t,n,!0),n+2},r.prototype.writeInt16BE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):E(this,t,n,!1),n+2},r.prototype.writeInt32LE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):M(this,t,n,!0),n+4},r.prototype.writeInt32BE=function(t,n,i){return t=+t,n|=0,i||w(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):M(this,t,n,!1),n+4},r.prototype.writeFloatLE=function(t,n,r){return T(this,t,n,!0,r)},r.prototype.writeFloatBE=function(t,n,r){return T(this,t,n,!1,r)},r.prototype.writeDoubleLE=function(t,n,r){return S(this,t,n,!0,r)},r.prototype.writeDoubleBE=function(t,n,r){return S(this,t,n,!1,r)},r.prototype.copy=function(t,n,i,o){if(i||(i=0),o||0===o||(o=this.length),n>=t.length&&(n=t.length),n||(n=0),o>0&&o<i&&(o=i),o===i||0===t.length||0===this.length)return 0;if(n<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("sourceStart out of bounds");if(o<0)throw RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-n<o-i&&(o=t.length-n+i);var a,s=o-i;if(this===t&&i<n&&n<o)for(a=s-1;a>=0;--a)t[a+n]=this[a+i];else if(s<1e3||!r.TYPED_ARRAY_SUPPORT)for(a=0;a<s;++a)t[a+n]=this[a+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+s),n);return s},r.prototype.fill=function(t,n,i,o){if("string"==typeof t){if("string"==typeof n?(o=n,n=0,i=this.length):"string"==typeof i&&(o=i,i=this.length),1===t.length){var a,s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==o&&"string"!=typeof o)throw TypeError("encoding must be a string");if("string"==typeof o&&!r.isEncoding(o))throw TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<i)throw RangeError("Out of range index");if(i<=n)return this;if(n>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(a=n;a<i;++a)this[a]=t;else{var l=r.isBuffer(t)?t:L(new r(t,o).toString()),c=l.length;for(a=0;a<i-n;++a)this[a+n]=l[a%c]}return this};var C=/[^+\/0-9A-Za-z-_]/g;function L(t,n){n=n||1/0;for(var r,i=t.length,o=null,a=[],s=0;s<i;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319||s+1===i){(n-=3)>-1&&a.push(239,191,189);continue}o=r;continue}if(r<56320){(n-=3)>-1&&a.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(n-=3)>-1&&a.push(239,191,189);if(o=null,r<128){if((n-=1)<0)break;a.push(r)}else if(r<2048){if((n-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((n-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((n-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return a}function R(t){for(var n=[],r=0;r<t.length;++r)n.push(255&t.charCodeAt(r));return n}function P(t){return o.toByteArray(function(t){var n;if((t=((n=t).trim?n.trim():n.replace(/^\s+|\s+$/g,"")).replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function D(t,n,r,i){for(var o=0;o<i&&!(o+r>=n.length)&&!(o>=t.length);++o)n[o+r]=t[o];return o}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(t,n,r){!function(){if("undefined"!=typeof window)try{var t=new window.CustomEvent("test",{cancelable:!0});if(t.preventDefault(),!0!==t.defaultPrevented)throw Error("Could not prevent default")}catch(t){var n=function(t,n){var r,i;return(n=n||{}).bubbles=!!n.bubbles,n.cancelable=!!n.cancelable,(r=document.createEvent("CustomEvent")).initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i=r.preventDefault,r.preventDefault=function(){i.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(t){this.defaultPrevented=!0}},r};n.prototype=window.Event.prototype,window.CustomEvent=n}}()},{}],8:[function(t,n,r){function i(){var t;try{t=r.storage.debug}catch(t){}return t}(r=n.exports=t("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},r.formatArgs=function(){var t=arguments,n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" "),!n)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var i=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r),t},r.save=function(t){try{null==t?r.storage.removeItem("debug"):r.storage.debug=t}catch(t){}},r.load=i,r.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},r.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],r.formatters.j=function(t){return JSON.stringify(t)},r.enable(i())},{"./debug":9}],9:[function(t,n,r){(r=n.exports=function(t){function n(){}function o(){null==o.useColors&&(o.useColors=r.useColors()),null==o.color&&o.useColors&&(o.color=r.colors[i++%r.colors.length]);var t=Array.prototype.slice.call(arguments);t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(i,a){if("%%"===i)return i;n++;var s=r.formatters[a];if("function"==typeof s){var l=t[n];i=s.call(o,l),t.splice(n,1),n--}return i}),"function"==typeof r.formatArgs&&(t=r.formatArgs.apply(o,t)),(o.log||r.log||console.log.bind(console)).apply(o,t)}n.enabled=!1,o.enabled=!0;var a=r.enabled(t)?o:n;return a.namespace=t,a}).coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){r.enable("")},r.enable=function(t){r.save(t);for(var n=(t||"").split(/[\s,]+/),i=n.length,o=0;o<i;o++)n[o]&&("-"===(t=n[o].replace(/\*/g,".*?"))[0]?r.skips.push(RegExp("^"+t.substr(1)+"$")):r.names.push(RegExp("^"+t+"$")))},r.enabled=function(t){var n,i;for(n=0,i=r.skips.length;n<i;n++)if(r.skips[n].test(t))return!1;for(n=0,i=r.names.length;n<i;n++)if(r.names[n].test(t))return!0;return!1},r.names=[],r.skips=[],r.formatters={};var i=0},{}],10:[function(t,n,r){"use strict";var i=t("is-obj"),o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(t,n,r){var a=n[r];if(null!=a){if(o.call(t,r)&&(void 0===t[r]||null===t[r]))throw TypeError("Cannot convert undefined or null to object ("+r+")");o.call(t,r)&&i(a)?t[r]=l(Object(t[r]),n[r]):t[r]=a}}function l(t,n){if(t===n)return t;for(var r in n=Object(n))o.call(n,r)&&s(t,n,r);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(n),l=0;l<i.length;l++)a.call(n,i[l])&&s(t,n,i[l]);return t}n.exports=function(t){t=function(t){if(null==t)throw TypeError("Sources cannot be null or undefined");return Object(t)}(t);for(var n=1;n<arguments.length;n++)l(t,arguments[n]);return t}},{"is-obj":34}],11:[function(t,n,r){"use strict";var i=t("object-keys"),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),a=Object.prototype.toString,s=Array.prototype.concat,l=Object.defineProperty,c=l&&function(){var t={};try{for(var n in l(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,n,r,i){(!(n in t)||"function"==typeof i&&"[object Function]"===a.call(i)&&i())&&(c?l(t,n,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[n]=r)},h=function(t,n){var r=arguments.length>2?arguments[2]:{},a=i(n);o&&(a=s.call(a,Object.getOwnPropertySymbols(n)));for(var l=0;l<a.length;l+=1)u(t,a[l],n[a[l]],r[a[l]])};h.supportsDescriptors=!!c,n.exports=h},{"object-keys":41}],12:[function(t,n,r){!/*! (C) WebReflection Mit Style License */function(t,n,r,i){"use strict";function o(t,n){for(var r=0,i=t.length;r<i;r++)m(t[r],n)}function a(t){return function(n){es(n)&&(m(n,t),o(n.querySelectorAll(V),t))}}function s(t){var n=eu.call(t,"is"),r=t.nodeName.toUpperCase(),i=q.call(z,n?U+n.toUpperCase():N+r);return n&&-1<i&&!l(r,n)?-1:i}function l(t,n){return -1<V.indexOf(t+'[is="'+n+'"]')}function c(t){var n=t.currentTarget,r=t.attrChange,i=t.attrName,o=t.target;eA&&(!o||o===n)&&n.attributeChangedCallback&&"style"!==i&&t.prevValue!==t.newValue&&n.attributeChangedCallback(i,r===t[D]?null:t.prevValue,r===t[I]?null:t.newValue)}function u(t){var n=a(t);return function(t){x.push(n,t.target)}}function h(t){eb&&(eb=!1,t.currentTarget.removeEventListener(F,h)),o((t.target||n).querySelectorAll(V),t.detail===R?R:L),ea&&function(){for(var t,n=0,r=el.length;n<r;n++)t=el[n],W.contains(t)||(r--,el.splice(n--,1),m(t,R))}()}function d(t,n){eh.call(this,t,n),w.call(this,{target:this})}function p(t,n){er(t,n),_?_.observe(t,ef):(ey&&(t.setAttribute=d,t[C]=M(t),t.addEventListener(k,w)),t.addEventListener(B,c)),t.createdCallback&&eA&&(t.created=!0,t.createdCallback(),t.created=!1)}function f(t){throw Error("A "+t+" type is already registered")}function m(t,n){var r,i=s(t);-1<i&&(T(t,j[i]),i=0,n!==L||t[L]?n!==R||t[R]||(t[L]=!1,t[R]=!0,i=1):(t[R]=!1,t[L]=!0,i=1,ea&&0>q.call(el,t)&&el.push(t)),i&&(r=t[n+"Callback"])&&r.call(t))}if(!(i in n)){var v,g,y,b,A,x,w,E,M,_,T,S,C="__"+i+(1e5*Math.random()>>0),L="attached",R="detached",P="extends",D="ADDITION",O="MODIFICATION",I="REMOVAL",B="DOMAttrModified",F="DOMContentLoaded",k="DOMSubtreeModified",N="<",U="=",H=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,G=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],z=[],j=[],V="",W=n.documentElement,q=z.indexOf||function(t){for(var n=this.length;n--&&this[n]!==t;);return n},X=r.prototype,Y=X.hasOwnProperty,Q=X.isPrototypeOf,Z=r.defineProperty,K=r.getOwnPropertyDescriptor,J=r.getOwnPropertyNames,$=r.getPrototypeOf,ee=r.setPrototypeOf,et=!!r.__proto__,en=r.create||function t(n){return n?(t.prototype=n,new t):this},er=ee||(et?function(t,n){return t.__proto__=n,t}:J&&K?function(t,n){do!function(t,n){for(var r,i=J(n),o=0,a=i.length;o<a;o++)r=i[o],Y.call(t,r)||Z(t,r,K(n,r))}(t,n);while((n=$(n))&&!Q.call(n,t));return t}:function(t,n){for(var r in n)t[r]=n[r];return t}),ei=t.MutationObserver||t.WebKitMutationObserver,eo=(t.HTMLElement||t.Element||t.Node).prototype,ea=!Q.call(eo,W),es=ea?function(t){return 1===t.nodeType}:function(t){return Q.call(eo,t)},el=ea&&[],ec=eo.cloneNode,eu=eo.getAttribute,eh=eo.setAttribute,ed=eo.removeAttribute,ep=n.createElement,ef=ei&&{attributes:!0,characterData:!0,attributeOldValue:!0},em=ei||function(t){ey=!1,W.removeEventListener(B,em)},ev=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,10)},eg=!1,ey=!0,eb=!0,eA=!0;ee||et?(T=function(t,n){Q.call(n,t)||p(t,n)},S=p):S=T=function(t,n){t[C]||(t[C]=r(!0),p(t,n))},ea?(ey=!1,g=(v=K(eo,"addEventListener")).value,y=function(t){var n=new CustomEvent(B,{bubbles:!0});n.attrName=t,n.prevValue=eu.call(this,t),n.newValue=null,n[I]=n.attrChange=2,ed.call(this,t),this.dispatchEvent(n)},b=function(t,n){var r=this.hasAttribute(t),i=r&&eu.call(this,t);e=new CustomEvent(B,{bubbles:!0}),eh.call(this,t,n),e.attrName=t,e.prevValue=r?i:null,e.newValue=n,r?e[O]=e.attrChange=1:e[D]=e.attrChange=0,this.dispatchEvent(e)},A=function(t){var n,r=t.currentTarget,i=r[C],o=t.propertyName;i.hasOwnProperty(o)&&(i=i[o],(n=new CustomEvent(B,{bubbles:!0})).attrName=i.name,n.prevValue=i.value||null,n.newValue=i.value=r[o]||null,null==n.prevValue?n[D]=n.attrChange=0:n[O]=n.attrChange=1,r.dispatchEvent(n))},v.value=function(t,n,r){t===B&&this.attributeChangedCallback&&this.setAttribute!==b&&(this[C]={className:{name:"class",value:this.className}},this.setAttribute=b,this.removeAttribute=y,g.call(this,"propertychange",A)),g.call(this,t,n,r)},Z(eo,"addEventListener",v)):ei||(W.addEventListener(B,em),W.setAttribute(C,1),W.removeAttribute(C),ey&&(w=function(t){var n,r,i;if(this===t.target){for(i in n=this[C],this[C]=r=M(this),r){if(!(i in n))return E(0,this,i,n[i],r[i],D);if(r[i]!==n[i])return E(1,this,i,n[i],r[i],O)}for(i in n)if(!(i in r))return E(2,this,i,n[i],r[i],I)}},E=function(t,n,r,i,o,a){var s={attrChange:t,currentTarget:n,attrName:r,prevValue:i,newValue:o};s[a]=t,c(s)},M=function(t){for(var n,r,i={},o=t.attributes,a=0,s=o.length;a<s;a++)"setAttribute"!==(r=(n=o[a]).name)&&(i[r]=n.value);return i})),n[i]=function(t,r){if(i=t.toUpperCase(),eg||(eg=!0,ei?(_=function(t,n){function r(t,n){for(var r=0,i=t.length;r<i;n(t[r++]));}return new ei(function(i){for(var o,a,s,l=0,c=i.length;l<c;l++)"childList"===(o=i[l]).type?(r(o.addedNodes,t),r(o.removedNodes,n)):(a=o.target,eA&&a.attributeChangedCallback&&"style"!==o.attributeName&&(s=eu.call(a,o.attributeName))!==o.oldValue&&a.attributeChangedCallback(o.attributeName,o.oldValue,s))})}(a(L),a(R))).observe(n,{childList:!0,subtree:!0}):(x=[],ev(function t(){for(;x.length;)x.shift().call(null,x.shift());ev(t)}),n.addEventListener("DOMNodeInserted",u(L)),n.addEventListener("DOMNodeRemoved",u(R))),n.addEventListener(F,h),n.addEventListener("readystatechange",h),n.createElement=function(t,r){var i=ep.apply(n,arguments),o=""+t,a=q.call(z,(r?U:N)+(r||o).toUpperCase()),s=-1<a;return r&&(i.setAttribute("is",r=r.toLowerCase()),s&&(s=l(o.toUpperCase(),r))),eA=!n.createElement.innerHTMLHelper,s&&S(i,j[a]),i},eo.cloneNode=function(t){var n=ec.call(this,!!t),r=s(n);return -1<r&&S(n,j[r]),t&&function(t){for(var n,r=0,i=t.length;r<i;r++)n=t[r],S(n,j[s(n)])}(n.querySelectorAll(V)),n}),-2<q.call(z,U+i)+q.call(z,N+i)&&f(t),!H.test(i)||-1<q.call(G,i))throw Error("The type "+t+" is invalid");var i,c,d=function(){return m?n.createElement(v,i):n.createElement(v)},p=r||X,m=Y.call(p,P),v=m?r[P].toUpperCase():i;return m&&-1<q.call(z,N+v)&&f(v),c=z.push((m?U:N)+i)-1,V=V.concat(V.length?",":"",m?v+'[is="'+t.toLowerCase()+'"]':v),d.prototype=j[c]=Y.call(p,"prototype")?p.prototype:en(eo),o(n.querySelectorAll(V),L),d}}}(window,document,Object,"registerElement")},{}],13:[function(t,n,r){n.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(t,n,r){"use strict";var i,o,a,s,l=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw TypeError()},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,u=Object.getPrototypeOf||function(t){return t.__proto__},h=o?u(o):i,d=a?a.constructor:i,p=s?u(s):i,f=s?s():i,m="undefined"==typeof Uint8Array?i:u(Uint8Array),v={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":c?u([][Symbol.iterator]()):i,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":i,"$ %AsyncFunction%":d,"$ %AsyncFunctionPrototype%":d?d.prototype:i,"$ %AsyncGenerator%":s?u(f):i,"$ %AsyncGeneratorFunction%":p,"$ %AsyncGeneratorPrototype%":p?p.prototype:i,"$ %AsyncIteratorPrototype%":f&&c&&Symbol.asyncIterator?f[Symbol.asyncIterator]():i,"$ %Atomics%":"undefined"==typeof Atomics?i:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?i:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?i:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?i:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?i:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":o?u(o()):i,"$ %GeneratorFunction%":h,"$ %GeneratorPrototype%":h?h.prototype:i,"$ %Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?i:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?i:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?i:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":c?u(u([][Symbol.iterator]())):i,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?i:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&c?u(new Map()[Symbol.iterator]()):i,"$ %MapPrototype%":"undefined"==typeof Map?i:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?i:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?i:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?i:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?i:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?i:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?i:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?i:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?i:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?i:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&c?u(new Set()[Symbol.iterator]()):i,"$ %SetPrototype%":"undefined"==typeof Set?i:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":c?u(""[Symbol.iterator]()):i,"$ %StringPrototype%":String.prototype,"$ %Symbol%":c?Symbol:i,"$ %SymbolPrototype%":c?Symbol.prototype:i,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":l,"$ %TypedArray%":m,"$ %TypedArrayPrototype%":m?m.prototype:i,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?i:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?i:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?i:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?i:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?i:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?i:WeakSet.prototype};n.exports=function(t,n){if(arguments.length>1&&"boolean"!=typeof n)throw TypeError('"allowMissing" argument must be a boolean');var r="$ "+t;if(!(r in v))throw SyntaxError("intrinsic "+t+" does not exist!");if(void 0===v[r]&&!n)throw TypeError("intrinsic "+t+" exists, but is not available. Please file an issue!");return v[r]}},{}],15:[function(t,n,r){"use strict";var i=t("./GetIntrinsic"),o=i("%Object%"),a=i("%TypeError%"),s=i("%String%"),l=t("./helpers/assertRecord"),c=t("./helpers/isNaN"),u=t("./helpers/isFinite"),h=t("./helpers/sign"),d=t("./helpers/mod"),p=t("is-callable"),f=t("es-to-primitive/es5"),m=t("has");n.exports={ToPrimitive:f,ToBoolean:function(t){return!!t},ToNumber:function(t){return+t},ToInteger:function(t){var n=this.ToNumber(t);return c(n)?0:0!==n&&u(n)?h(n)*Math.floor(Math.abs(n)):n},ToInt32:function(t){return this.ToNumber(t)>>0},ToUint32:function(t){return this.ToNumber(t)>>>0},ToUint16:function(t){var n=this.ToNumber(t);return c(n)||0===n||!u(n)?0:d(h(n)*Math.floor(Math.abs(n)),65536)},ToString:function(t){return s(t)},ToObject:function(t){return this.CheckObjectCoercible(t),o(t)},CheckObjectCoercible:function(t,n){if(null==t)throw new a(n||"Cannot call method on "+t);return t},IsCallable:p,SameValue:function(t,n){return t===n?0!==t||1/t==1/n:c(t)&&c(n)},Type:function(t){return null===t?"Null":void 0===t?"Undefined":"function"==typeof t||"object"==typeof t?"Object":"number"==typeof t?"Number":"boolean"==typeof t?"Boolean":"string"==typeof t?"String":void 0},IsPropertyDescriptor:function(t){if("Object"!==this.Type(t))return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(m(t,r)&&!n[r])return!1;var i=m(t,"[[Value]]"),o=m(t,"[[Get]]")||m(t,"[[Set]]");if(i&&o)throw new a("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(t){return void 0!==t&&(l(this,"Property Descriptor","Desc",t),!!(m(t,"[[Get]]")||m(t,"[[Set]]")))},IsDataDescriptor:function(t){return void 0!==t&&(l(this,"Property Descriptor","Desc",t),!!(m(t,"[[Value]]")||m(t,"[[Writable]]")))},IsGenericDescriptor:function(t){return void 0!==t&&(l(this,"Property Descriptor","Desc",t),!(this.IsAccessorDescriptor(t)||this.IsDataDescriptor(t)))},FromPropertyDescriptor:function(t){if(void 0===t)return t;if(l(this,"Property Descriptor","Desc",t),this.IsDataDescriptor(t))return{value:t["[[Value]]"],writable:!!t["[[Writable]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};if(this.IsAccessorDescriptor(t))return{get:t["[[Get]]"],set:t["[[Set]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};throw new a("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(t){if("Object"!==this.Type(t))throw new a("ToPropertyDescriptor requires an object");var n={};if(m(t,"enumerable")&&(n["[[Enumerable]]"]=this.ToBoolean(t.enumerable)),m(t,"configurable")&&(n["[[Configurable]]"]=this.ToBoolean(t.configurable)),m(t,"value")&&(n["[[Value]]"]=t.value),m(t,"writable")&&(n["[[Writable]]"]=this.ToBoolean(t.writable)),m(t,"get")){var r=t.get;if(void 0!==r&&!this.IsCallable(r))throw TypeError("getter must be a function");n["[[Get]]"]=r}if(m(t,"set")){var i=t.set;if(void 0!==i&&!this.IsCallable(i))throw new a("setter must be a function");n["[[Set]]"]=i}if((m(n,"[[Get]]")||m(n,"[[Set]]"))&&(m(n,"[[Value]]")||m(n,"[[Writable]]")))throw new a("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return n}}},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(t,n,r){"use strict";var i=t("../GetIntrinsic"),o=i("%TypeError%"),a=i("%SyntaxError%"),s=t("has"),l={"Property Descriptor":function(t,n){if("Object"!==t.Type(n))return!1;var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var i in n)if(s(n,i)&&!r[i])return!1;var a=s(n,"[[Value]]"),l=s(n,"[[Get]]")||s(n,"[[Set]]");if(a&&l)throw new o("Property Descriptors may not be both accessor and data descriptors");return!0}};n.exports=function(t,n,r,i){var s=l[n];if("function"!=typeof s)throw new a("unknown record type: "+n);if(!s(t,i))throw new o(r+" must be a "+n);console.log(s(t,i),i)}},{"../GetIntrinsic":14,has:28}],17:[function(t,n,r){var i=Number.isNaN||function(t){return t!=t};n.exports=Number.isFinite||function(t){return"number"==typeof t&&!i(t)&&t!==1/0&&t!==-1/0}},{}],18:[function(t,n,r){n.exports=Number.isNaN||function(t){return t!=t}},{}],19:[function(t,n,r){n.exports=function(t,n){var r=t%n;return Math.floor(r>=0?r:r+n)}},{}],20:[function(t,n,r){n.exports=function(t){return t>=0?1:-1}},{}],21:[function(t,n,r){"use strict";var i=Object.prototype.toString,o=t("./helpers/isPrimitive"),a=t("is-callable"),s={"[[DefaultValue]]":function(t){var n;if(n=arguments.length>1?arguments[1]:"[object Date]"===i.call(t)?String:Number,n===String||n===Number){var r,s,l=n===String?["toString","valueOf"]:["valueOf","toString"];for(s=0;s<l.length;++s)if(a(t[l[s]])&&o(r=t[l[s]]()))return r;throw TypeError("No default value")}throw TypeError("invalid [[DefaultValue]] hint supplied")}};n.exports=function(t){return o(t)?t:arguments.length>1?s["[[DefaultValue]]"](t,arguments[1]):s["[[DefaultValue]]"](t)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(t,n,r){n.exports=function(t){return null===t||"function"!=typeof t&&"object"!=typeof t}},{}],23:[function(t,n,r){var i=t("dtype");n.exports=function(t,n,r){if(!t)throw TypeError("must specify data as first parameter");if(r=0|+(r||0),Array.isArray(t)&&t[0]&&"number"==typeof t[0][0]){var o,a,s,l,c=t[0].length,u=t.length*c;n&&"string"!=typeof n||(n=new(i(n||"float32"))(u+r));var h=n.length-r;if(u!==h)throw Error("source length "+u+" ("+c+"x"+t.length+") does not match destination length "+h);for(o=0,s=r;o<t.length;o++)for(a=0;a<c;a++)n[s++]=null===t[o][a]?NaN:t[o][a]}else if(n&&"string"!=typeof n)n.set(t,r);else{var d=i(n||"float32");if(Array.isArray(t)||"array"===n)for(o=0,n=new d(t.length+r),s=r,l=n.length;s<l;s++,o++)n[s]=null===t[o]?NaN:t[o];else 0===r?n=new d(t):(n=new d(t.length+r)).set(t,r)}return n}},{dtype:13}],24:[function(t,n,r){"use strict";var i=t("is-callable"),o=Object.prototype.toString,a=Object.prototype.hasOwnProperty,s=function(t,n,r){for(var i=0,o=t.length;i<o;i++)a.call(t,i)&&(null==r?n(t[i],i,t):n.call(r,t[i],i,t))},l=function(t,n,r){for(var i=0,o=t.length;i<o;i++)null==r?n(t.charAt(i),i,t):n.call(r,t.charAt(i),i,t)},c=function(t,n,r){for(var i in t)a.call(t,i)&&(null==r?n(t[i],i,t):n.call(r,t[i],i,t))};n.exports=function(t,n,r){var a;if(!i(n))throw TypeError("iterator must be a function");arguments.length>=3&&(a=r),"[object Array]"===o.call(t)?s(t,n,a):"string"==typeof t?l(t,n,a):c(t,n,a)}},{"is-callable":32}],25:[function(t,n,r){"use strict";var i=Array.prototype.slice,o=Object.prototype.toString;n.exports=function(t){var n,r=this;if("function"!=typeof r||"[object Function]"!==o.call(r))throw TypeError("Function.prototype.bind called on incompatible "+r);for(var a=i.call(arguments,1),s=Math.max(0,r.length-a.length),l=[],c=0;c<s;c++)l.push("$"+c);if(n=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(!(this instanceof n))return r.apply(t,a.concat(i.call(arguments)));var o=r.apply(this,a.concat(i.call(arguments)));return Object(o)===o?o:this}),r.prototype){var u=function(){};u.prototype=r.prototype,n.prototype=new u,u.prototype=null}return n}},{}],26:[function(t,n,r){"use strict";var i=t("./implementation");n.exports=Function.prototype.bind||i},{"./implementation":25}],27:[function(t,n,i){(function(t){var r;"undefined"!=typeof window?r=window:void 0!==t?r=t:"undefined"!=typeof self?r=self:r={},n.exports=r}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,n,r){"use strict";var i=t("function-bind");n.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(t,n,r){r.read=function(t,n,r,i,o){var a,s,l=8*o-i-1,c=(1<<l)-1,u=c>>1,h=-7,d=r?o-1:0,p=r?-1:1,f=t[n+d];for(d+=p,a=f&(1<<-h)-1,f>>=-h,h+=l;h>0;a=256*a+t[n+d],d+=p,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=i;h>0;s=256*s+t[n+d],d+=p,h-=8);if(0===a)a=1-u;else{if(a===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),a-=u}return(f?-1:1)*s*Math.pow(2,a-i)},r.write=function(t,n,r,i,o,a){var s,l,c,u=8*a-o-1,h=(1<<u)-1,d=h>>1,p=23===o?5960464477539062e-23:0,f=i?0:a-1,m=i?1:-1,v=n<0||0===n&&1/n<0?1:0;for(isNaN(n=Math.abs(n))||n===1/0?(l=isNaN(n)?1:0,s=h):(s=Math.floor(Math.log(n)/Math.LN2),n*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?n+=p/c:n+=p*Math.pow(2,1-d),n*c>=2&&(s++,c/=2),s+d>=h?(l=0,s=h):s+d>=1?(l=(n*c-1)*Math.pow(2,o),s+=d):(l=n*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;t[r+f]=255&l,f+=m,l/=256,o-=8);for(s=s<<o|l,u+=o;u>0;t[r+f]=255&s,f+=m,s/=256,u-=8);t[r+f-m]|=128*v}},{}],30:[function(t,n,r){"function"==typeof Object.create?n.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}},{}],31:[function(t,n,r){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */n.exports=function(t){return null!=t&&(i(t)||"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))||!!t._isBuffer)}},{}],32:[function(t,n,r){"use strict";var i=Function.prototype.toString,o=/^\s*class\b/,a=function(t){try{var n=i.call(t);return o.test(n)}catch(t){return!1}},s=function(t){try{if(a(t))return!1;return i.call(t),!0}catch(t){return!1}},l=Object.prototype.toString,c="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;n.exports=function(t){if(!t||"function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;if(c)return s(t);if(a(t))return!1;var n=l.call(t);return"[object Function]"===n||"[object GeneratorFunction]"===n}},{}],33:[function(t,n,r){n.exports=function(t){var n=i.call(t);return"[object Function]"===n||"function"==typeof t&&"[object RegExp]"!==n||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)};var i=Object.prototype.toString},{}],34:[function(t,n,r){"use strict";n.exports=function(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}},{}],35:[function(t,n,r){var i={}.toString;n.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},{}],36:[function(t,n,r){var i=t("word-wrapper"),o=t("xtend"),a=t("as-number"),s=["x","e","a","o","n","s","r","c","u","m","v","w","z"],l=["m","w"],c=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"];function u(t){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(t)}function h(t,n){if(!t.chars||0===t.chars.length)return null;var r=p(t.chars,n);return r>=0?t.chars[r]:null}function d(t,n,r){if(!t.kernings||0===t.kernings.length)return 0;for(var i=t.kernings,o=0;o<i.length;o++){var a=i[o];if(a.first===n&&a.second===r)return a.amount}return 0}function p(t,n,r){r=r||0;for(var i=r;i<t.length;i++)if(t[i].id===n)return i;return -1}n.exports=function(t){return new u(t)},u.prototype.update=function(t){if(t=o({measure:this._measure},t),this._opt=t,this._opt.tabSize=a(this._opt.tabSize,4),!t.font)throw Error("must provide a valid bitmap font");var n,r=this.glyphs,l=t.text||"",u=t.font;this._setupSpaceGlyphs(u);var h=i.lines(l,t),f=t.width||0;r.length=0;var m=h.reduce(function(t,n){return Math.max(t,n.width,f)},0),v=0,g=0,y=a(t.lineHeight,u.common.lineHeight),b=u.common.base,A=y-b,x=t.letterSpacing||0,w=y*h.length-A,E="center"===(n=this._opt.align)?1:"right"===n?2:0;g-=w,this._width=m,this._height=w,this._descender=y-b,this._baseline=b,this._xHeight=function(t){for(var n=0;n<s.length;n++){var r=s[n].charCodeAt(0),i=p(t.chars,r);if(i>=0)return t.chars[i].height}return 0}(u),this._capHeight=function(t){for(var n=0;n<c.length;n++){var r=c[n].charCodeAt(0),i=p(t.chars,r);if(i>=0)return t.chars[i].height}return 0}(u),this._lineHeight=y,this._ascender=y-A-this._xHeight;var M=this;h.forEach(function(t,n){for(var i,o=t.start,a=t.end,s=t.width,c=o;c<a;c++){var h=l.charCodeAt(c),p=M.getGlyph(u,h);if(p){i&&(v+=d(u,i.id,p.id));var f=v;1===E?f+=(m-s)/2:2===E&&(f+=m-s),r.push({position:[f,g],data:p,index:c,line:n}),v+=p.xadvance+x,i=p}}g+=y,v=0}),this._linesTotal=h.length},u.prototype._setupSpaceGlyphs=function(t){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,t.chars&&0!==t.chars.length){var n=h(t,32)||function(t){for(var n=0;n<l.length;n++){var r=l[n].charCodeAt(0),i=p(t.chars,r);if(i>=0)return t.chars[i]}return 0}(t)||t.chars[0],r=this._opt.tabSize*n.xadvance;this._fallbackSpaceGlyph=n,this._fallbackTabGlyph=o(n,{x:0,y:0,xadvance:r,id:9,xoffset:0,yoffset:0,width:0,height:0})}},u.prototype.getGlyph=function(t,n){var r=h(t,n);return r||(9===n?this._fallbackTabGlyph:32===n?this._fallbackSpaceGlyph:null)},u.prototype.computeMetrics=function(t,n,r,i){var o,a,s=this._opt.letterSpacing||0,l=this._opt.font,c=0,u=0,h=0;if(!l.chars||0===l.chars.length)return{start:n,end:n,width:0};r=Math.min(t.length,r);for(var p=n;p<r;p++){var f=t.charCodeAt(p),o=this.getGlyph(l,f);if(o){o.xoffset;var m=(c+=a?d(l,a.id,o.id):0)+o.xadvance+s,v=c+o.width;if(v>=i||m>=i)break;c=m,u=v,a=o}h++}return a&&(u+=a.xoffset),{start:n,end:n+h,width:u}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(t){Object.defineProperty(u.prototype,t,{get:Function(["return function "+t+"() {","  return this._"+t,"}"].join("\n"))(),configurable:!0})})},{"as-number":2,"word-wrapper":69,xtend:72}],37:[function(t,n,r){(function(r){var i=t("xhr"),o=function(){},a=t("parse-bmfont-ascii"),s=t("parse-bmfont-xml"),l=t("parse-bmfont-binary"),c=t("./lib/is-binary"),u=t("xtend"),h=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;n.exports=function(t,n){n="function"==typeof n?n:o,"string"==typeof t?t={uri:t}:t||(t={}),t.binary&&(t=function(t){if(h)return u(t,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw Error("your browser does not support XHR loading");var n=new self.XMLHttpRequest;return n.overrideMimeType("text/plain; charset=x-user-defined"),u({xhr:n},t)}(t)),i(t,function(i,u,h){if(i)return n(i);if(!/^2/.test(u.statusCode))return n(Error("http status code: "+u.statusCode));if(!h)return n(Error("no body result"));var d,p,f=!1;d=h,"[object ArrayBuffer]"===Object.prototype.toString.call(d)&&(h=new r(new Uint8Array(h),"binary")),c(h)&&(f=!0,"string"==typeof h&&(h=new r(h,"binary"))),f||(r.isBuffer(h)&&(h=h.toString(t.encoding)),h=h.trim());try{var m=u.headers["content-type"];p=f?l(h):/json/.test(m)||"{"===h.charAt(0)?JSON.parse(h):/xml/.test(m)||"<"===h.charAt(0)?s(h):a(h)}catch(t){n(Error("error parsing font "+t.message)),n=o}n(null,p)})}}).call(this,t("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:70,xtend:72}],38:[function(t,n,r){(function(r){var i=t("buffer-equal"),o=new r([66,77,70,3]);n.exports=function(t){return"string"==typeof t?"BMF"===t.substring(0,3):t.length>4&&i(t.slice(0,4),o)}}).call(this,t("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(t,n,r){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;n.exports=!function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var i=Object.getOwnPropertyNames(n).map(function(t){return n[t]});if("0123456789"!==i.join(""))return!1;var o={};if("abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},o)).join(""))return!1;return!0}catch(t){return!1}}()?function(t,n){for(var r,s,l=function(t){if(null==t)throw TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var u in r=Object(arguments[c]))o.call(r,u)&&(l[u]=r[u]);if(i){s=i(r);for(var h=0;h<s.length;h++)a.call(r,s[h])&&(l[s[h]]=r[s[h]])}}return l}:Object.assign},{}],40:[function(t,n,r){"use strict";var i;if(!Object.keys){var o=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=t("./isArguments"),l=Object.prototype.propertyIsEnumerable,c=!l.call({toString:null},"toString"),u=l.call(function(){},"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(t){var n=t.constructor;return n&&n.prototype===t},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!p["$"+t]&&o.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{d(window[t])}catch(t){return!0}}catch(t){return!0}return!1}(),m=function(t){if("undefined"==typeof window||!f)return d(t);try{return d(t)}catch(t){return!1}};i=function(t){var n=null!==t&&"object"==typeof t,r="[object Function]"===a.call(t),i=s(t),l=n&&"[object String]"===a.call(t),d=[];if(!n&&!r&&!i)throw TypeError("Object.keys called on a non-object");var p=u&&r;if(l&&t.length>0&&!o.call(t,0))for(var f=0;f<t.length;++f)d.push(String(f));if(i&&t.length>0)for(var v=0;v<t.length;++v)d.push(String(v));else for(var g in t)!(p&&"prototype"===g)&&o.call(t,g)&&d.push(String(g));if(c)for(var y=m(t),b=0;b<h.length;++b)!(y&&"constructor"===h[b])&&o.call(t,h[b])&&d.push(h[b]);return d}}n.exports=i},{"./isArguments":42}],41:[function(t,n,r){"use strict";var i=Array.prototype.slice,o=t("./isArguments"),a=Object.keys,s=a?function(t){return a(t)}:t("./implementation"),l=Object.keys;s.shim=function(){return Object.keys?!function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)&&(Object.keys=function(t){return o(t)?l(i.call(t)):l(t)}):Object.keys=s,Object.keys||s},n.exports=s},{"./implementation":40,"./isArguments":42}],42:[function(t,n,r){"use strict";var i=Object.prototype.toString;n.exports=function(t){var n=i.call(t),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),r}},{}],43:[function(t,n,r){n.exports=function(t){if(!t)throw Error("no data provided");t=t.toString().trim();var n={pages:[],chars:[],kernings:[]},r=t.split(/\r\n?|\n/g);if(0===r.length)throw Error("no data in BMFont file");for(var o=0;o<r.length;o++){var a=function(t,n){if(!(t=t.replace(/\t+/g," ").trim()))return null;var r=t.indexOf(" ");if(-1===r)throw Error("no named row at line "+n);var o=t.substring(0,r);t=(t=(t=(t=t.substring(r+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(t){return t.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var a=[],s=0;s<t.length;s++){var l=t[s];0===s?a.push({key:l[0],data:""}):s===t.length-1?a[a.length-1].data=i(l[0]):(a[a.length-1].data=i(l[0]),a.push({key:l[1],data:""}))}var c={key:o,data:{}};return a.forEach(function(t){c.data[t.key]=t.data}),c}(r[o],o);if(a){if("page"===a.key){if("number"!=typeof a.data.id)throw Error("malformed file at line "+o+" -- needs page id=N");if("string"!=typeof a.data.file)throw Error("malformed file at line "+o+' -- needs page file="path"');n.pages[a.data.id]=a.data.file}else"chars"===a.key||"kernings"===a.key||("char"===a.key?n.chars.push(a.data):"kerning"===a.key?n.kernings.push(a.data):n[a.key]=a.data)}}return n};function i(t){return t&&0!==t.length?0===t.indexOf('"')||0===t.indexOf("'")?t.substring(1,t.length-1):-1!==t.indexOf(",")?t.split(",").map(function(t){return parseInt(t,10)}):parseInt(t,10):""}},{}],44:[function(t,n,r){var i=[66,77,70];function o(t,n){for(var r=n;r<t.length&&0!==t[r];r++);return t.slice(n,r)}n.exports=function(t){if(t.length<6)throw Error("invalid buffer length for BMFont");if(!i.every(function(n,r){return t.readUInt8(r)===n}))throw Error("BMFont missing BMF byte header");var n=3;if(t.readUInt8(n++)>3)throw Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var r={kernings:[],chars:[]},a=0;a<5;a++)n+=function(t,n,r){if(r>n.length-1)return 0;var i=n.readUInt8(r++),a=n.readInt32LE(r);switch(r+=4,i){case 1:t.info=function(t,n){var r={};r.size=t.readInt16LE(n);var i=t.readUInt8(n+2);return r.smooth=i>>7&1,r.unicode=i>>6&1,r.italic=i>>5&1,r.bold=i>>4&1,i>>3&1&&(r.fixedHeight=1),r.charset=t.readUInt8(n+3)||"",r.stretchH=t.readUInt16LE(n+4),r.aa=t.readUInt8(n+6),r.padding=[t.readInt8(n+7),t.readInt8(n+8),t.readInt8(n+9),t.readInt8(n+10)],r.spacing=[t.readInt8(n+11),t.readInt8(n+12)],r.outline=t.readUInt8(n+13),r.face=o(t,n+14).toString("utf8"),r}(n,r);break;case 2:t.common=function(t,n){var r={};return r.lineHeight=t.readUInt16LE(n),r.base=t.readUInt16LE(n+2),r.scaleW=t.readUInt16LE(n+4),r.scaleH=t.readUInt16LE(n+6),r.pages=t.readUInt16LE(n+8),t.readUInt8(n+10),r.packed=0,r.alphaChnl=t.readUInt8(n+11),r.redChnl=t.readUInt8(n+12),r.greenChnl=t.readUInt8(n+13),r.blueChnl=t.readUInt8(n+14),r}(n,r);break;case 3:t.pages=function(t,n,r){for(var i=[],a=o(t,n),s=a.length+1,l=r/s,c=0;c<l;c++)i[c]=t.slice(n,n+a.length).toString("utf8"),n+=s;return i}(n,r,a);break;case 4:t.chars=function(t,n,r){for(var i=[],o=r/20,a=0;a<o;a++){var s={},l=20*a;s.id=t.readUInt32LE(n+0+l),s.x=t.readUInt16LE(n+4+l),s.y=t.readUInt16LE(n+6+l),s.width=t.readUInt16LE(n+8+l),s.height=t.readUInt16LE(n+10+l),s.xoffset=t.readInt16LE(n+12+l),s.yoffset=t.readInt16LE(n+14+l),s.xadvance=t.readInt16LE(n+16+l),s.page=t.readUInt8(n+18+l),s.chnl=t.readUInt8(n+19+l),i[a]=s}return i}(n,r,a);break;case 5:t.kernings=function(t,n,r){for(var i=[],o=r/10,a=0;a<o;a++){var s={},l=10*a;s.first=t.readUInt32LE(n+0+l),s.second=t.readUInt32LE(n+4+l),s.amount=t.readInt16LE(n+8+l),i[a]=s}return i}(n,r,a)}return 5+a}(r,t,n);return r}},{}],45:[function(t,n,r){var i=t("./parse-attribs"),o=t("xml-parse-from-string"),a={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function s(t){return(function(t){for(var n=[],r=0;r<t.attributes.length;r++)n.push(t.attributes[r]);return n})(t).reduce(function(t,n){var r;return t[a[(r=n.nodeName).toLowerCase()]||r]=n.nodeValue,t},{})}n.exports=function(t){var n=o(t=t.toString()),r={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(t){var o=n.getElementsByTagName(t)[0];o&&(r[t]=i(s(o)))});var a=n.getElementsByTagName("pages")[0];if(!a)throw Error("malformed file -- no <pages> element");for(var l=a.getElementsByTagName("page"),c=0;c<l.length;c++){var u=l[c],h=parseInt(u.getAttribute("id"),10),d=u.getAttribute("file");if(isNaN(h))throw Error('malformed file -- page "id" attribute is NaN');if(!d)throw Error('malformed file -- needs page "file" attribute');r.pages[parseInt(h,10)]=d}return["chars","kernings"].forEach(function(t){var o=n.getElementsByTagName(t)[0];if(o)for(var a=t.substring(0,t.length-1),l=o.getElementsByTagName(a),c=0;c<l.length;c++){var u=l[c];r[t].push(i(s(u)))}}),r}},{"./parse-attribs":46,"xml-parse-from-string":71}],46:[function(t,n,r){var i="chasrset";n.exports=function(t){for(var n in i in t&&(t.charset=t[i],delete t[i]),t)"face"!==n&&"charset"!==n&&("padding"===n||"spacing"===n?t[n]=t[n].split(",").map(function(t){return parseInt(t,10)}):t[n]=parseInt(t[n],10));return t}},{}],47:[function(t,n,r){var i=t("string.prototype.trim"),o=t("for-each");n.exports=function(t){if(!t)return{};var n={};return o(i(t).split("\n"),function(t){var r,o=t.indexOf(":"),a=i(t.slice(0,o)).toLowerCase(),s=i(t.slice(o+1));void 0===n[a]?n[a]=s:(r=n[a],"[object Array]"===Object.prototype.toString.call(r))?n[a].push(s):n[a]=[n[a],s]}),n}},{"for-each":24,"string.prototype.trim":53}],48:[function(t,n,i){(function(t){var r=t.performance||{},i=function(){for(var t=["now","webkitNow","msNow","mozNow","oNow"];t.length;){var n=t.shift();if(n in r)return r[n].bind(r)}var i=Date.now||function(){return new Date().getTime()},o=(r.timing||{}).navigationStart||i();return function(){return i()-o}}();i.performanceNow=r.now,i.noConflict=function(){r.now=i.performanceNow},i.conflict=function(){r.now=i},i.conflict(),n.exports=i}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(t,n,r){var i,o,a,s=n.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function u(t){if(i===setTimeout)return setTimeout(t,0);if((i===l||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(n){try{return i.call(null,t,0)}catch(n){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:l}catch(t){i=l}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(t){o=c}}();var h=[],d=!1,p=-1;function f(){d&&a&&(d=!1,a.length?h=a.concat(h):p=-1,h.length&&m())}function m(){if(!d){var t=u(f);d=!0;for(var n=h.length;n;){for(a=h,h=[];++p<n;)a&&a[p].run();p=-1,n=h.length}a=null,d=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(t)}}function v(t,n){this.fun=t,this.array=n}function g(){}s.nextTick=function(t){var n=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];h.push(new v(t,n)),1!==h.length||d||u(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(t){return[]},s.binding=function(t){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],50:[function(t,n,r){(function(t){!function(r){var i=setTimeout,o="function"==typeof t&&t||function(t){i(t,1)};function a(t,n){return function(){t.apply(n,arguments)}}var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function l(t){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");if("function"!=typeof t)throw TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(t,a(u,this),a(h,this))}function c(t){var n=this;if(null===this._state){this._deferreds.push(t);return}o(function(){var r,i=n._state?t.onFulfilled:t.onRejected;if(null===i){(n._state?t.resolve:t.reject)(n._value);return}try{r=i(n._value)}catch(n){t.reject(n);return}t.resolve(r)})}function u(t){try{if(t===this)throw TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n){f(a(n,t),a(u,this),a(h,this));return}}this._state=!0,this._value=t,d.call(this)}catch(t){h.call(this,t)}}function h(t){this._state=!1,this._value=t,d.call(this)}function d(){for(var t=0,n=this._deferreds.length;t<n;t++)c.call(this,this._deferreds[t]);this._deferreds=null}function p(t,n,r,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=r,this.reject=i}function f(t,n,r){var i=!1;try{t(function(t){i||(i=!0,n(t))},function(t){i||(i=!0,r(t))})}catch(t){if(i)return;i=!0,r(t)}}l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,n){var r=this;return new l(function(i,o){c.call(r,new p(t,n,i,o))})},l.all=function(){var t=Array.prototype.slice.call(1==arguments.length&&s(arguments[0])?arguments[0]:arguments);return new l(function(n,r){if(0===t.length)return n([]);for(var i=t.length,o=0;o<t.length;o++)!function o(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l){l.call(s,function(t){o(a,t)},r);return}}t[a]=s,0==--i&&n(t)}catch(t){r(t)}}(o,t[o])})},l.resolve=function(t){return t&&"object"==typeof t&&t.constructor===l?t:new l(function(n){n(t)})},l.reject=function(t){return new l(function(n,r){r(t)})},l.race=function(t){return new l(function(n,r){for(var i=0,o=t.length;i<o;i++)t[i].then(n,r)})},l._setImmediateFn=function(t){o=t},void 0!==n&&n.exports?n.exports=l:r.Promise||(r.Promise=l)}(this)}).call(this,t("timers").setImmediate)},{timers:67}],51:[function(t,n,r){var i=t("dtype"),o=t("an-array"),a=t("is-buffer"),s=[0,2,3],l=[2,1,3];n.exports=function(t,n){t&&(o(t)||a(t))||(n=t||{},t=null);for(var r="string"==typeof(n="number"==typeof n?{count:n}:n||{}).type?n.type:"uint16",c="number"==typeof n.count?n.count:1,u=n.start||0,h=!1!==n.clockwise?s:l,d=h[0],p=h[1],f=h[2],m=6*c,v=t||new(i(r))(m),g=0,y=0;g<m;g+=6,y+=4){var b=g+u;v[b+0]=y+0,v[b+1]=y+1,v[b+2]=y+2,v[b+3]=y+d,v[b+4]=y+p,v[b+5]=y+f}return v}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(t,n,r){"use strict";var i=t("function-bind"),o=t("es-abstract/es5"),a=i.call(Function.call,String.prototype.replace),s=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,l=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;n.exports=function(){return a(a(o.ToString(o.CheckObjectCoercible(this)),s,""),l,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(t,n,r){"use strict";var i=t("function-bind"),o=t("define-properties"),a=t("./implementation"),s=t("./polyfill"),l=t("./shim"),c=i.call(Function.call,s());o(c,{getPolyfill:s,implementation:a,shim:l}),n.exports=c},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(t,n,r){"use strict";var i=t("./implementation");n.exports=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:i}},{"./implementation":52}],55:[function(t,n,r){"use strict";var i=t("define-properties"),o=t("./polyfill");n.exports=function(){var t=o();return i(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},{"./polyfill":54,"define-properties":11}],56:[function(t,n,r){"use strict";var i,o={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},a={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},s=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],l={},c={};function u(t,n,r){return Math.min(Math.max(t,n),r)}function h(t,n){return t.indexOf(n)>-1}function d(t,n){return t.apply(null,n)}var p=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,f=/^rgb/,m=/^hsl/,v={arr:function(t){return Array.isArray(t)},obj:function(t){return h(Object.prototype.toString.call(t),"Object")},pth:function(t){return v.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return t.nodeType||v.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return p.test(t)},rgb:function(t){return f.test(t)},hsl:function(t){return m.test(t)},col:function(t){return v.hex(t)||v.rgb(t)||v.hsl(t)},key:function(t){return!o.hasOwnProperty(t)&&!a.hasOwnProperty(t)&&"targets"!==t&&"keyframes"!==t}},g=/\(([^)]+)\)/;function y(t){var n=g.exec(t);return n?n[1].split(",").map(function(t){return parseFloat(t)}):[]}function b(t,n){var r=y(t),i=u(v.und(r[0])?1:r[0],.1,100),o=u(v.und(r[1])?100:r[1],.1,100),a=u(v.und(r[2])?10:r[2],.1,100),s=u(v.und(r[3])?0:r[3],.1,100),l=Math.sqrt(o/i),h=a/(2*Math.sqrt(o*i)),d=h<1?l*Math.sqrt(1-h*h):0,p=h<1?(h*l+-s)/d:-s+l;function f(t){var r=n?n*t/1e3:t;return(r=h<1?Math.exp(-r*h*l)*(1*Math.cos(d*r)+p*Math.sin(d*r)):(1+p*r)*Math.exp(-r*l),0===t||1===t)?t:1-r}return n?f:function(){var n=c[t];if(n)return n;for(var r=1/6,i=0,o=0;;)if(1===f(i+=r)){if(++o>=16)break}else o=0;var a=i*r*1e3;return c[t]=a,a}}function A(t,n){void 0===t&&(t=1),void 0===n&&(n=.5);var r=u(t,1,10),i=u(n,.1,2);return function(t){return 0===t||1===t?t:-r*Math.pow(2,10*(t-1))*Math.sin(2*Math.PI*(t-1-i/(2*Math.PI)*Math.asin(1/r))/i)}}function x(t){return void 0===t&&(t=10),function(n){return 1/t*Math.round(n*t)}}var w=function(){function t(t,n,r){return(((1-3*r+3*n)*t+(3*r-6*n))*t+3*n)*t}function n(t,n,r){return 3*(1-3*r+3*n)*t*t+2*(3*r-6*n)*t+3*n}return function(r,i,o,a){if(0<=r&&r<=1&&0<=o&&o<=1){var s=new Float32Array(11);if(r!==i||o!==a)for(var l=0;l<11;++l)s[l]=t(.1*l,r,o);return function(l){return r===i&&o===a||0===l||1===l?l:t(function(i){for(var a=0,l=1;10!==l&&s[l]<=i;++l)a+=.1;var c=a+(i-s[--l])/(s[l+1]-s[l])*.1,u=n(c,r,o);return u>=.001?function(r,i,o,a){for(var s=0;s<4;++s){var l=n(i,o,a);if(0===l)break;var c=t(i,o,a)-r;i-=c/l}return i}(i,c,r,o):0===u?c:function(n,r,i,o,a){var s,l,c=0;do(s=t(l=r+(i-r)/2,o,a)-n)>0?i=l:r=l;while(Math.abs(s)>1e-7&&++c<10);return l}(i,a,a+.1,r,o)}(l),i,a)}}}}(),E=function(){var t=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],n={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],A],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(t,n){return function(r){return 1-A(t,n)(1-r)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(t,n){return function(r){return r<.5?A(t,n)(2*r)/2:1-A(t,n)(-2*r+2)/2}}]},r={linear:[.25,.25,.75,.75]};for(var i in n)for(var o=0,a=n[i].length;o<a;o++)r["ease"+i+t[o]]=n[i][o];return r}();function M(t,n){if(v.fnc(t))return t;var r=t.split("(")[0],i=E[r],o=y(t);switch(r){case"spring":return b(t,n);case"cubicBezier":return d(w,o);case"steps":return d(x,o);default:return v.fnc(i)?d(i,o):d(w,i)}}function _(t){try{return document.querySelectorAll(t)}catch(t){return}}var T=[];function S(t,n){for(var r=T,i=t.length,o=arguments.length>=2?arguments[1]:void 0,a=0;a<i;a++)if(a in t){var s=t[a];n.call(o,s,a,t)&&r.push(s)}return(T=t).length=0,r}function C(t,n){n||(n=[]);for(var r=0,i=t.length;r<i;r++){var o=t[r];Array.isArray(o)?C(o,n):n.push(o)}return n}function L(t){return v.arr(t)?t:(v.str(t)&&(t=_(t)||t),t instanceof NodeList||t instanceof HTMLCollection)?[].slice.call(t):[t]}function R(t,n){return t.some(function(t){return t===n})}function P(t){var n={};for(var r in t)n[r]=t[r];return n}function D(t,n){var r=P(t);for(var i in t)r[i]=n.hasOwnProperty(i)?n[i]:t[i];return r}function O(t,n){var r=P(t);for(var i in n)r[i]=v.und(t[i])?n[i]:t[i];return r}var I=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g,B=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,F=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,k=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,N=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g,U=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function H(t){var n=U.exec(t);if(n)return n[2]}function G(t,n){return v.fnc(t)?t(n.target,n.id,n.total):t}function z(t,n){return t.getAttribute(n)}function j(t,n,r){if(R([r,"deg","rad","turn"],H(n)))return n;var i=l[n+r];if(!v.und(i))return i;var o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=100+r;var s=100/o.offsetWidth;a.removeChild(o);var c=s*parseFloat(n);return l[n+r]=c,c}function V(t,n,r){if(n in t.style){var i=n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=t.style[n]||getComputedStyle(t).getPropertyValue(i)||"0";return r?j(t,o,r):o}}function W(t,n){return v.dom(t)&&!v.inp(t)&&(z(t,n)||v.svg(t)&&t[n])?"attribute":v.dom(t)&&R(s,n)?"transform":v.dom(t)&&"transform"!==n&&V(t,n)?"css":null!=t[n]?"object":void 0}var q=/(\w+)\(([^)]*)\)/g;function X(t){if(v.dom(t)){for(var n,r=t.style.transform||"",i=new Map;n=q.exec(r);)i.set(n[1],n[2]);return i}}function Y(t,n,r,i){switch(W(t,n)){case"transform":var o,a;return o=h(n,"scale")?1:0+(h(n,"translate")||"perspective"===n?"px":h(n,"rotate")||h(n,"skew")?"deg":void 0),a=X(t).get(n)||o,i&&(i.transforms.list.set(n,a),i.transforms.last=n),r?j(t,a,r):a;case"css":return V(t,n,r);case"attribute":return z(t,n);default:return t[n]||0}}var Q=/^(\*=|\+=|-=)/;function Z(t,n){var r=Q.exec(t);if(!r)return t;var i=H(t)||0,o=parseFloat(n),a=parseFloat(t.replace(r[0],""));switch(r[0][0]){case"+":return o+a+i;case"-":return o-a+i;case"*":return o*a+i}}var K=/\s/g;function J(t,n){if(v.col(t)){var r,i,o,a;return r=t,v.rgb(r)?(i=I.exec(r))?"rgba("+i[1]+",1)":r:v.hex(r)?(o=r.replace(B,function(t,n,r,i){return n+n+r+r+i+i}),"rgba("+parseInt((a=F.exec(o))[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+",1)"):v.hsl(r)?function(t){var n,r,i,o=k.exec(t)||N.exec(t),a=parseInt(o[1],10)/360,s=parseInt(o[2],10)/100,l=parseInt(o[3],10)/100,c=o[4]||1;function u(t,n,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?t+(n-t)*6*r:r<.5?n:r<2/3?t+(n-t)*(2/3-r)*6:t}if(0==s)n=r=i=l;else{var h=l<.5?l*(1+s):l+s-l*s,d=2*l-h;n=u(d,h,a+1/3),r=u(d,h,a),i=u(d,h,a-1/3)}return"rgba("+255*n+","+255*r+","+255*i+","+c+")"}(r):void 0}var s=H(t),l=s?t.substr(0,t.length-s.length):t;return n&&!K.test(t)?l+n:l}function $(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function ee(t){for(var n,r=t.points,i=0,o=0;o<r.numberOfItems;o++){var a=r.getItem(o);o>0&&(i+=$(n,a)),n=a}return i}function et(t){var n;if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return 2*Math.PI*z(t,"r");case"rect":return 2*z(t,"width")+2*z(t,"height");case"line":return $({x:z(t,"x1"),y:z(t,"y1")},{x:z(t,"x2"),y:z(t,"y2")});case"polyline":return ee(t);case"polygon":return n=t.points,ee(t)+$(n.getItem(n.numberOfItems-1),n.getItem(0))}}function en(t,n){var r=n||{},i=r.el||function(t){for(var n=t.parentNode;v.svg(n)&&(n=n.parentNode,v.svg(n.parentNode)););return n}(t),o=i.getBoundingClientRect(),a=z(i,"viewBox"),s=o.width,l=o.height,c=r.viewBox||(a?a.split(" "):[0,0,s,l]);return{el:i,viewBox:c,x:c[0]/1,y:c[1]/1,w:s/c[2],h:l/c[3]}}var er=/-?\d*\.?\d+/g;function ei(t,n){var r=J(v.pth(t)?t.totalLength:t,n)+"";return{original:r,numbers:r.match(er)?r.match(er).map(Number):[0],strings:v.str(t)||n?r.split(er):[]}}function eo(t){return S(t?C(v.arr(t)?t.map(L):L(t)):[],function(t,n,r){return r.indexOf(t)===n})}function ea(t){var n=eo(t);return n.map(function(t,r){return{target:t,id:r,total:n.length,transforms:{list:X(t)}}})}var es=/^spring/,el={css:function(t,n,r){return t.style[n]=r},attribute:function(t,n,r){return t.setAttribute(n,r)},object:function(t,n,r){return t[n]=r},transform:function(t,n,r,i,o){if(i.list.set(n,r),n===i.last||o){var a="";i.list.forEach(function(t,n){a+=n+"("+t+") "}),t.style.transform=a}}};function ec(t,n){for(var r=ea(t),i=0,o=r.length;i<o;i++){var a=r[i];for(var s in n){var l=G(n[s],a),c=a.target,u=H(l),h=Y(c,s,u,a),d=Z(J(l,u||H(h)),h);el[W(c,s)](c,s,d,a.transforms,!0)}}}function eu(t,n){var r=t.length,i=function(t){return t.timelineOffset?t.timelineOffset:0},o={};return o.duration=r?Math.max.apply(Math,t.map(function(t){return i(t)+t.duration})):n.duration,o.delay=r?Math.min.apply(Math,t.map(function(t){return i(t)+t.delay})):n.delay,o.endDelay=r?o.duration-Math.max.apply(Math,t.map(function(t){return i(t)+t.duration-t.endDelay})):n.endDelay,o}var eh=0,ed=[],ep=[],ef=function(){function t(){i=requestAnimationFrame(n)}function n(n){var r=ed.length;if(r){for(var o=0;o<r;){var a=ed[o];if(a.paused){var s=ed.indexOf(a);s>-1&&(ed.splice(s,1),r=ed.length)}else a.tick(n);o++}t()}else i=cancelAnimationFrame(i)}return t}();function em(t){void 0===t&&(t={});var n,r,s,l,c,h,d,p,f,m=0,g=0,y=0,A=0,x=null;function w(){return window.Promise&&new Promise(function(t){return x=t})}var E=w(),_=(r=D(o,n=t),l=function(t,n){var r=[],i=n.keyframes;for(var o in i&&(n=O(function(t){for(var n=S(C(t.map(function(t){return Object.keys(t)})),function(t){return v.key(t)}).reduce(function(t,n){return 0>t.indexOf(n)&&t.push(n),t},[]),r={},i=0;i<n.length;i++)!function(i){var o=n[i];r[o]=t.map(function(t){var n={};for(var r in t)v.key(r)?r==o&&(n.value=t[r]):n[r]=t[r];return n})}(i);return r}(i),n)),n)v.key(o)&&r.push({name:o,tweens:function(t,n){var r=P(n);if(es.test(r.easing)&&(r.duration=b(r.easing)),v.arr(t)){var i=t.length;2!==i||v.obj(t[0])?v.fnc(n.duration)||(r.duration=n.duration/i):t={value:t}}var o=v.arr(t)?t:[t];return o.map(function(t,r){var i=v.obj(t)&&!v.pth(t)?t:{value:t};return v.und(i.delay)&&(i.delay=r?0:n.delay),v.und(i.endDelay)&&(i.endDelay=r===o.length-1?n.endDelay:0),i}).map(function(t){return O(t,r)})}(n[o],t)});return r}(s=D(a,n),n),d=eu(h=S(C((c=ea(n.targets)).map(function(t){return l.map(function(n){return function(t,n){var r=W(t.target,n.name);if(r){var i,o=n.tweens.map(function(r){var o=function(t,n){var r={};for(var i in t){var o=G(t[i],n);v.arr(o)&&1===(o=o.map(function(t){return G(t,n)})).length&&(o=o[0]),r[i]=o}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}(r,t),a=o.value,s=v.arr(a)?a[1]:a,l=H(s),c=Y(t.target,n.name,l,t),u=i?i.to.original:c,h=v.arr(a)?a[0]:u,d=H(h)||H(c),p=l||d;return v.und(s)&&(s=u),o.from=ei(h,p),o.to=ei(Z(s,h),p),o.start=i?i.end:0,o.end=o.start+o.delay+o.duration+o.endDelay,o.easing=M(o.easing,o.duration),o.isPath=v.pth(a),o.isColor=v.col(o.from.original),o.isColor&&(o.round=1),i=o,o}),a=o[o.length-1];return{type:r,property:n.name,animatable:t,tweens:o,duration:a.end,delay:o[0].delay,endDelay:a.endDelay}}}(t,n)})})),function(t){return!v.und(t)}),s),p=eh,eh++,O(r,{id:p,children:[],animatables:c,animations:h,duration:d.duration,delay:d.delay,endDelay:d.endDelay}));function T(){_.reversed=!_.reversed;for(var t=0,n=f.length;t<n;t++)f[t].reversed=_.reversed}function L(t){return _.reversed?_.duration-t:t}function R(){m=0,g=L(_.currentTime)*(1/em.speed)}function I(t,n){n&&n.seek(t-n.timelineOffset)}function B(t){for(var n=0,r=_.animations,i=r.length;n<i;){var o=r[n],a=o.animatable,s=o.tweens,l=s.length-1,c=s[l];l&&(c=S(s,function(n){return t<n.end})[0]||c);for(var h=u(t-c.start-c.delay,0,c.duration)/c.duration,d=isNaN(h)?1:c.easing(h),p=c.to.strings,f=c.round,m=[],v=c.to.numbers.length,g=void 0,y=0;y<v;y++){var b=void 0,A=c.to.numbers[y],x=c.from.numbers[y]||0;b=c.isPath?function(t,n){function r(r){void 0===r&&(r=0);var i=n+r>=1?n+r:0;return t.el.getPointAtLength(i)}var i=en(t.el,t.svg),o=r(),a=r(-1),s=r(1);switch(t.property){case"x":return(o.x-i.x)*i.w;case"y":return(o.y-i.y)*i.h;case"angle":return 180*Math.atan2(s.y-a.y,s.x-a.x)/Math.PI}}(c.value,d*A):x+d*(A-x),f&&!(c.isColor&&y>2)&&(b=Math.round(b*f)/f),m.push(b)}var w=p.length;if(w){g=p[0];for(var E=0;E<w;E++){p[E];var M=p[E+1],T=m[E];isNaN(T)||(M?g+=T+M:g+=T+" ")}}else g=m[0];el[o.type](a.target,o.property,g,a.transforms),o.currentValue=g,n++}}function F(t){_[t]&&!_.passThrough&&_[t](_)}function k(t){var n=_.duration,r=_.delay,i=n-_.endDelay,o=L(t);_.progress=u(o/n*100,0,100),_.reversePlayback=o<_.currentTime,f&&function(t){if(_.reversePlayback)for(var n=A;n--;)I(t,f[n]);else for(var r=0;r<A;r++)I(t,f[r])}(o),!_.began&&_.currentTime>0&&(_.began=!0,F("begin"),F("loopBegin")),o<=r&&0!==_.currentTime&&B(0),(o>=i&&_.currentTime!==n||!n)&&B(n),o>r&&o<i?(_.changeBegan||(_.changeBegan=!0,_.changeCompleted=!1,F("changeBegin")),F("change"),B(o)):_.changeBegan&&(_.changeCompleted=!0,_.changeBegan=!1,F("changeComplete")),_.currentTime=u(o,0,n),_.began&&F("update"),t>=n&&(g=0,_.remaining&&!0!==_.remaining&&_.remaining--,_.remaining?(m=y,F("loopComplete"),F("loopBegin"),"alternate"===_.direction&&T()):(_.paused=!0,!_.completed&&(_.completed=!0,F("loopComplete"),F("complete"),"Promise"in window&&(x(),E=w()))))}return _.reset=function(){var t=_.direction;_.passThrough=!1,_.currentTime=0,_.progress=0,_.paused=!0,_.began=!1,_.changeBegan=!1,_.completed=!1,_.changeCompleted=!1,_.reversePlayback=!1,_.reversed="reverse"===t,_.remaining=_.loop,A=(f=_.children).length;for(var n=A;n--;)_.children[n].reset();(_.reversed&&!0!==_.loop||"alternate"===t&&1===_.loop)&&_.remaining++,B(0)},_.set=function(t,n){return ec(t,n),_},_.tick=function(t){y=t,m||(m=y),k((y+(g-m))*em.speed)},_.seek=function(t){k(L(t))},_.pause=function(){_.paused=!0,R()},_.play=function(){_.paused&&(_.paused=!1,ed.push(_),R(),i||ef())},_.reverse=function(){T(),R()},_.restart=function(){_.reset(),_.play()},_.finished=E,_.reset(),_.autoplay&&_.play(),_}function ev(t,n){for(var r=n.length;r--;)R(t,n[r].animatable.target)&&n.splice(r,1)}document.addEventListener("visibilitychange",function(){if(document.hidden){for(var t=0,n=ed.length;t<n;t++)activeInstance[t].pause();ep=ed.slice(0),ed=[]}else for(var r=0,i=ep.length;r<i;r++)ep[r].play()}),em.version="3.0.0",em.speed=1,em.running=ed,em.remove=function(t){for(var n=eo(t),r=ed.length;r--;){var i=ed[r],o=i.animations,a=i.children;ev(n,o);for(var s=a.length;s--;){var l=a[s],c=l.animations;ev(n,c),c.length||l.children.length||a.splice(s,1)}o.length||a.length||i.pause()}},em.get=Y,em.set=ec,em.convertPx=j,em.path=function(t,n){var r=v.str(t)?_(t)[0]:t,i=n||100;return function(t){return{property:t,el:r,svg:en(r),totalLength:et(r)*(i/100)}}},em.setDashoffset=function(t){var n=et(t);return t.setAttribute("stroke-dasharray",n),n},em.stagger=function(t,n){void 0===n&&(n={});var r=n.direction||"normal",i=n.easing?M(n.easing):null,o=n.grid,a=n.axis,s=n.from||0,l="first"===s,c="center"===s,u="last"===s,h=v.arr(t),d=h?parseFloat(t[0]):parseFloat(t),p=h?parseFloat(t[1]):0,f=H(h?t[1]:t)||0,m=n.start||0+(h?d:0),g=[],y=0;return function(t,n,v){if(l&&(s=0),c&&(s=(v-1)/2),u&&(s=v-1),!g.length){for(var b=0;b<v;b++){if(o){var A=c?(o[0]-1)/2:s%o[0],x=c?(o[1]-1)/2:Math.floor(s/o[0]),w=b%o[0],E=Math.floor(b/o[0]),M=A-w,_=x-E,T=Math.sqrt(M*M+_*_);"x"===a&&(T=-M),"y"===a&&(T=-_),g.push(T)}else g.push(Math.abs(s-b));y=Math.max.apply(Math,g)}i&&(g=g.map(function(t){return i(t/y)*y})),"reverse"===r&&(g=g.map(function(t){return a?t<0?-1*t:-t:Math.abs(y-t)}))}var S=h?(p-d)/y:d;return m+Math.round(100*g[n])/100*S+f}},em.timeline=function(t){void 0===t&&(t={});var n=em(t);return n.duration=0,n.add=function(r,i){var o=ed.indexOf(n),s=n.children;function l(t){t.passThrough=!0}o>-1&&ed.splice(o,1);for(var c=0;c<s.length;c++)l(s[c]);var u=O(r,D(a,t));u.targets=u.targets||t.targets;var h=n.duration;u.autoplay=!1,u.direction=n.direction,u.timelineOffset=v.und(i)?h:Z(i,h),l(n),n.seek(u.timelineOffset);var d=em(u);l(d),s.push(d);var p=eu(s,t);return n.delay=p.delay,n.endDelay=p.endDelay,n.duration=p.duration,n.seek(0),n.reset(),n.autoplay&&n.play(),n},n},em.easing=M,em.penner=E,em.random=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},n.exports=em},{}],57:[function(n,r,i){var o,a;o=this,a=function(t){"use strict";void 0===Number.EPSILON&&(Number.EPSILON=2220446049250313e-31),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n});var n,i,o,a,s,l,c=function(t){var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,n,r){return Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{c({},"")}catch(t){c=function(t,n,r){return t[n]=r}}function u(t,r,i,o){var a,s=Object.create((r&&r.prototype instanceof v?r:v).prototype),l=new S(o||[]);return s._invoke=(a=d,function(r,o){if(a===p)throw Error("Generator is already running");if(a===f){if("throw"===r)throw o;return L()}for(l.method=r,l.arg=o;;){var s=l.delegate;if(s){var c=function t(r,i){var o=r.iterator[i.method];if(o===n){if(i.delegate=null,"throw"===i.method){if(r.iterator.return&&(i.method="return",i.arg=n,t(r,i),"throw"===i.method))return m;i.method="throw",i.arg=TypeError("The iterator does not provide a 'throw' method")}return m}var a=h(o,r.iterator,i.arg);if("throw"===a.type)return i.method="throw",i.arg=a.arg,i.delegate=null,m;var s=a.arg;return s?s.done?(i[r.resultName]=s.value,i.next=r.nextLoc,"return"!==i.method&&(i.method="next",i.arg=n),i.delegate=null,m):s:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,m)}(s,l);if(c){if(c===m)continue;return c}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(a===d)throw a=f,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);a=p;var u=h(t,i,l);if("normal"===u.type){if(a=l.done?f:"suspendedYield",u.arg===m)continue;return{value:u.arg,done:l.done}}"throw"===u.type&&(a=f,l.method="throw",l.arg=u.arg)}}),s}function h(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var d="suspendedStart",p="executing",f="completed",m={};function v(){}function g(){}function y(){}var b={};b[a]=function(){return this};var A=Object.getPrototypeOf,x=A&&A(A(C([])));x&&x!==r&&i.call(x,a)&&(b=x);var w=y.prototype=v.prototype=Object.create(b);function E(t){["next","throw","return"].forEach(function(n){c(t,n,function(t){return this._invoke(n,t)})})}function M(t,n){var r;this._invoke=function(o,a){function s(){return new n(function(r,s){!function r(o,a,s,l){var c=h(t[o],t,a);if("throw"===c.type)l(c.arg);else{var u=c.arg,d=u.value;return d&&"object"==typeof d&&i.call(d,"__await")?n.resolve(d.__await).then(function(t){r("next",t,s,l)},function(t){r("throw",t,s,l)}):n.resolve(d).then(function(t){u.value=t,s(u)},function(t){return r("throw",t,s,l)})}}(o,a,r,s)})}return r=r?r.then(s,s):s()}}function _(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function T(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function C(t){if(t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=n,r.done=!0,r};return s.next=s}}return{next:L}}function L(){return{value:n,done:!0}}return g.prototype=w.constructor=y,y.constructor=g,g.displayName=c(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===g||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},E(M.prototype),M.prototype[s]=function(){return this},t.AsyncIterator=M,t.async=function(n,r,i,o,a){void 0===a&&(a=Promise);var s=new M(u(n,r,i,o),a);return t.isGeneratorFunction(r)?s:s.next().then(function(t){return t.done?t.value:s.next()})},E(w),c(w,l,"Generator"),w[a]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var i=n.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},t.values=C,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(i,o){return l.type="throw",l.arg=t,r.next=i,o&&(r.method="next",r.arg=n),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],l=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else if(u){if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=n&&n<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return(s.type=t,s.arg=n,a)?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),m},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var o=i.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:C(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=n),m}},t}("object"==typeof r?r.exports:{});try{regeneratorRuntime=c}catch(t){Function("r","regeneratorRuntime = r")(c)}var u="300 es";function h(t,n,r,i,o,a,s){try{var l=t[a](s),c=l.value}catch(t){r(t);return}l.done?n(c):Promise.resolve(c).then(i,o)}function d(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function p(t,n,r){return n&&d(t.prototype,n),r&&d(t,r),t}function f(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function m(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}function g(){}Object.assign(g.prototype,{addEventListener:function(t,n){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(n)&&r[t].push(n)},hasEventListener:function(t,n){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(n)},removeEventListener:function(t,n){if(void 0!==this._listeners){var r=this._listeners[t];if(void 0!==r){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var n=this._listeners[t.type];if(void 0!==n){t.target=this;for(var r=n.slice(0),i=0,o=r.length;i<o;i++)r[i].call(this,t)}}}});for(var y=[],b=0;b<256;b++)y[b]=(b<16?"0":"")+b.toString(16);var A=1234567,x={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(y[255&t]+y[t>>8&255]+y[t>>16&255]+y[t>>24&255]+"-"+y[255&n]+y[n>>8&255]+"-"+y[n>>16&15|64]+y[n>>24&255]+"-"+y[63&r|128]+y[r>>8&255]+"-"+y[r>>16&255]+y[r>>24&255]+y[255&i]+y[i>>8&255]+y[i>>16&255]+y[i>>24&255]).toUpperCase()},clamp:function(t,n,r){return Math.max(n,Math.min(r,t))},euclideanModulo:function(t,n){return(t%n+n)%n},mapLinear:function(t,n,r,i,o){return i+(t-n)*(o-i)/(r-n)},lerp:function(t,n,r){return(1-r)*t+r*n},damp:function(t,n,r,i){return x.lerp(t,n,1-Math.exp(-r*i))},pingpong:function(t,n){return void 0===n&&(n=1),n-Math.abs(x.euclideanModulo(t,2*n)-n)},smoothstep:function(t,n,r){return t<=n?0:t>=r?1:(t=(t-n)/(r-n))*t*(3-2*t)},smootherstep:function(t,n,r){return t<=n?0:t>=r?1:(t=(t-n)/(r-n))*t*t*(t*(6*t-15)+10)},randInt:function(t,n){return t+Math.floor(Math.random()*(n-t+1))},randFloat:function(t,n){return t+Math.random()*(n-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(A=t%2147483647),((A=16807*A%2147483647)-1)/2147483646},degToRad:function(t){return t*x.DEG2RAD},radToDeg:function(t){return t*x.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)==0&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,n,r,i,o){var a=Math.cos,s=Math.sin,l=a(r/2),c=s(r/2),u=a((n+i)/2),h=s((n+i)/2),d=a((n-i)/2),p=s((n-i)/2),f=a((i-n)/2),m=s((i-n)/2);switch(o){case"XYX":t.set(l*h,c*d,c*p,l*u);break;case"YZY":t.set(c*p,l*h,c*d,l*u);break;case"ZXZ":t.set(c*d,c*p,l*h,l*u);break;case"XZX":t.set(l*h,c*m,c*f,l*u);break;case"YXY":t.set(c*f,l*h,c*m,l*u);break;case"ZYZ":t.set(c*m,c*f,l*h,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}},w=function(){function t(t,n){void 0===t&&(t=0),void 0===n&&(n=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=n}var n=t.prototype;return n.set=function(t,n){return this.x=t,this.y=n,this},n.setScalar=function(t){return this.x=t,this.y=t,this},n.setX=function(t){return this.x=t,this},n.setY=function(t){return this.y=t,this},n.setComponent=function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw Error("index is out of range: "+t)}return this},n.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},n.clone=function(){return new this.constructor(this.x,this.y)},n.copy=function(t){return this.x=t.x,this.y=t.y,this},n.add=function(t,n){return void 0!==n?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this)},n.addScalar=function(t){return this.x+=t,this.y+=t,this},n.addVectors=function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this},n.addScaledVector=function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this},n.sub=function(t,n){return void 0!==n?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this)},n.subScalar=function(t){return this.x-=t,this.y-=t,this},n.subVectors=function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},n.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this},n.divideScalar=function(t){return this.multiplyScalar(1/t)},n.applyMatrix3=function(t){var n=this.x,r=this.y,i=t.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this},n.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},n.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},n.clamp=function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this},n.clampScalar=function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this},n.clampLength=function(t,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))},n.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},n.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},n.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},n.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},n.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.dot=function(t){return this.x*t.x+this.y*t.y},n.cross=function(t){return this.x*t.y-this.y*t.x},n.lengthSq=function(){return this.x*this.x+this.y*this.y},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},n.normalize=function(){return this.divideScalar(this.length()||1)},n.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},n.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},n.distanceToSquared=function(t){var n=this.x-t.x,r=this.y-t.y;return n*n+r*r},n.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},n.setLength=function(t){return this.normalize().multiplyScalar(t)},n.lerp=function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this},n.lerpVectors=function(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this},n.equals=function(t){return t.x===this.x&&t.y===this.y},n.fromArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t},n.fromBufferAttribute=function(t,n,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this},n.rotateAround=function(t,n){var r=Math.cos(n),i=Math.sin(n),o=this.x-t.x,a=this.y-t.y;return this.x=o*r-a*i+t.x,this.y=o*i+a*r+t.y,this},n.random=function(){return this.x=Math.random(),this.y=Math.random(),this},p(t,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),t}(),E=function(){function t(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var n=t.prototype;return n.set=function(t,n,r,i,o,a,s,l,c){var u=this.elements;return u[0]=t,u[1]=i,u[2]=s,u[3]=n,u[4]=o,u[5]=l,u[6]=r,u[7]=a,u[8]=c,this},n.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},n.clone=function(){return new this.constructor().fromArray(this.elements)},n.copy=function(t){var n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this},n.extractBasis=function(t,n,r){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},n.setFromMatrix4=function(t){var n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this},n.multiply=function(t){return this.multiplyMatrices(this,t)},n.premultiply=function(t){return this.multiplyMatrices(t,this)},n.multiplyMatrices=function(t,n){var r=t.elements,i=n.elements,o=this.elements,a=r[0],s=r[3],l=r[6],c=r[1],u=r[4],h=r[7],d=r[2],p=r[5],f=r[8],m=i[0],v=i[3],g=i[6],y=i[1],b=i[4],A=i[7],x=i[2],w=i[5],E=i[8];return o[0]=a*m+s*y+l*x,o[3]=a*v+s*b+l*w,o[6]=a*g+s*A+l*E,o[1]=c*m+u*y+h*x,o[4]=c*v+u*b+h*w,o[7]=c*g+u*A+h*E,o[2]=d*m+p*y+f*x,o[5]=d*v+p*b+f*w,o[8]=d*g+p*A+f*E,this},n.multiplyScalar=function(t){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this},n.determinant=function(){var t=this.elements,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return n*a*u-n*s*c-r*o*u+r*s*l+i*o*c-i*a*l},n.invert=function(){var t=this.elements,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=u*a-s*c,d=s*l-u*o,p=c*o-a*l,f=n*h+r*d+i*p;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var m=1/f;return t[0]=h*m,t[1]=(i*c-u*r)*m,t[2]=(s*r-i*a)*m,t[3]=d*m,t[4]=(u*n-i*l)*m,t[5]=(i*o-s*n)*m,t[6]=p*m,t[7]=(r*l-c*n)*m,t[8]=(a*n-r*o)*m,this},n.transpose=function(){var t,n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this},n.getNormalMatrix=function(t){return this.setFromMatrix4(t).copy(this).invert().transpose()},n.transposeIntoArray=function(t){var n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this},n.setUvTransform=function(t,n,r,i,o,a,s){var l=Math.cos(o),c=Math.sin(o);return this.set(r*l,r*c,-r*(l*a+c*s)+a+t,-i*c,i*l,-i*(-c*a+l*s)+s+n,0,0,1),this},n.scale=function(t,n){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=n,r[4]*=n,r[7]*=n,this},n.rotate=function(t){var n=Math.cos(t),r=Math.sin(t),i=this.elements,o=i[0],a=i[3],s=i[6],l=i[1],c=i[4],u=i[7];return i[0]=n*o+r*l,i[3]=n*a+r*c,i[6]=n*s+r*u,i[1]=-r*o+n*l,i[4]=-r*a+n*c,i[7]=-r*s+n*u,this},n.translate=function(t,n){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=n*r[2],r[4]+=n*r[5],r[7]+=n*r[8],this},n.equals=function(t){for(var n=this.elements,r=t.elements,i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0},n.fromArray=function(t,n){void 0===n&&(n=0);for(var r=0;r<9;r++)this.elements[r]=t[r+n];return this},n.toArray=function(t,n){void 0===t&&(t=[]),void 0===n&&(n=0);var r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t},t}(),M={getDataURL:function(t){if(/^data:/i.test(t.src)||"undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)r=t;else{void 0===n&&(n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),n.width=t.width,n.height=t.height;var r,i=n.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),r=n}return r.width>2048||r.height>2048?r.toDataURL("image/jpeg",.6):r.toDataURL("image/png")}},_=0;function T(t,n,r,i,o,a,s,l,c,u){void 0===t&&(t=T.DEFAULT_IMAGE),void 0===n&&(n=T.DEFAULT_MAPPING),void 0===r&&(r=1001),void 0===i&&(i=1001),void 0===o&&(o=1006),void 0===a&&(a=1008),void 0===s&&(s=1023),void 0===l&&(l=1009),void 0===c&&(c=1),void 0===u&&(u=3e3),Object.defineProperty(this,"id",{value:_++}),this.uuid=x.generateUUID(),this.name="",this.image=t,this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=i,this.magFilter=o,this.minFilter=a,this.anisotropy=c,this.format=s,this.internalFormat=null,this.type=l,this.offset=new w(0,0),this.repeat=new w(1,1),this.center=new w(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new E,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.version=0,this.onUpdate=null}function S(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?M.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}T.DEFAULT_IMAGE=void 0,T.DEFAULT_MAPPING=300,T.prototype=Object.assign(Object.create(g.prototype),{constructor:T,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var i,o=this.image;if(void 0===o.uuid&&(o.uuid=x.generateUUID()),!n&&void 0===t.images[o.uuid]){if(Array.isArray(o)){i=[];for(var a=0,s=o.length;a<s;a++)o[a].isDataTexture?i.push(S(o[a].image)):i.push(S(o[a]))}else i=S(o);t.images[o.uuid]={uuid:o.uuid,url:i}}r.image=o.uuid}return n||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(T.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});var C=function(){function t(t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=n,this.z=r,this.w=i}var n=t.prototype;return n.set=function(t,n,r,i){return this.x=t,this.y=n,this.z=r,this.w=i,this},n.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},n.setX=function(t){return this.x=t,this},n.setY=function(t){return this.y=t,this},n.setZ=function(t){return this.z=t,this},n.setW=function(t){return this.w=t,this},n.setComponent=function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw Error("index is out of range: "+t)}return this},n.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},n.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},n.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},n.add=function(t,n){return void 0!==n?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},n.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},n.addVectors=function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this},n.addScaledVector=function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this},n.sub=function(t,n){return void 0!==n?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},n.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},n.subVectors=function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},n.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.applyMatrix4=function(t){var n=this.x,r=this.y,i=this.z,o=this.w,a=t.elements;return this.x=a[0]*n+a[4]*r+a[8]*i+a[12]*o,this.y=a[1]*n+a[5]*r+a[9]*i+a[13]*o,this.z=a[2]*n+a[6]*r+a[10]*i+a[14]*o,this.w=a[3]*n+a[7]*r+a[11]*i+a[15]*o,this},n.divideScalar=function(t){return this.multiplyScalar(1/t)},n.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this},n.setAxisAngleFromRotationMatrix=function(t){var n,r,i,o,a=t.elements,s=a[0],l=a[4],c=a[8],u=a[1],h=a[5],d=a[9],p=a[2],f=a[6],m=a[10];if(.01>Math.abs(l-u)&&.01>Math.abs(c-p)&&.01>Math.abs(d-f)){if(.1>Math.abs(l+u)&&.1>Math.abs(c+p)&&.1>Math.abs(d+f)&&.1>Math.abs(s+h+m-3))return this.set(1,0,0,0),this;n=Math.PI;var v=(s+1)/2,g=(h+1)/2,y=(m+1)/2,b=(l+u)/4,A=(c+p)/4,x=(d+f)/4;return v>g&&v>y?v<.01?(r=0,i=.707106781,o=.707106781):(i=b/(r=Math.sqrt(v)),o=A/r):g>y?g<.01?(r=.707106781,i=0,o=.707106781):(r=b/(i=Math.sqrt(g)),o=x/i):y<.01?(r=.707106781,i=.707106781,o=0):(r=A/(o=Math.sqrt(y)),i=x/o),this.set(r,i,o,n),this}var w=Math.sqrt((f-d)*(f-d)+(c-p)*(c-p)+(u-l)*(u-l));return .001>Math.abs(w)&&(w=1),this.x=(f-d)/w,this.y=(c-p)/w,this.z=(u-l)/w,this.w=Math.acos((s+h+m-1)/2),this},n.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},n.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},n.clamp=function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this.w=Math.max(t.w,Math.min(n.w,this.w)),this},n.clampScalar=function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this.w=Math.max(t,Math.min(n,this.w)),this},n.clampLength=function(t,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))},n.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},n.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},n.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},n.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},n.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},n.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},n.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},n.normalize=function(){return this.divideScalar(this.length()||1)},n.setLength=function(t){return this.normalize().multiplyScalar(t)},n.lerp=function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this},n.lerpVectors=function(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this.w=t.w+(n.w-t.w)*r,this},n.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},n.fromArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t},n.fromBufferAttribute=function(t,n,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this},n.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},p(t,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),t}(),L=function(t){function n(n,r,i){var o;return Object.defineProperty(m(o=t.call(this)||this),"isWebGLRenderTarget",{value:!0}),o.width=n,o.height=r,o.scissor=new C(0,0,n,r),o.scissorTest=!1,o.viewport=new C(0,0,n,r),i=i||{},o.texture=new T(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),o.texture.image={},o.texture.image.width=n,o.texture.image.height=r,o.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,o.texture.minFilter=void 0!==i.minFilter?i.minFilter:1006,o.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,o.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,o.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,o}f(n,t);var r=n.prototype;return r.setSize=function(t,n){(this.width!==t||this.height!==n)&&(this.width=t,this.height=n,this.texture.image.width=t,this.texture.image.height=n,this.dispose()),this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n)},r.clone=function(){return new this.constructor().copy(this)},r.copy=function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},r.dispose=function(){this.dispatchEvent({type:"dispose"})},n}(g),R=function(t){function n(n,r,i){var o;return Object.defineProperty(m(o=t.call(this,n,r,i)||this),"isWebGLMultisampleRenderTarget",{value:!0}),o.samples=4,o}return f(n,t),n.prototype.copy=function(n){return t.prototype.copy.call(this,n),this.samples=n.samples,this},n}(L),P=function(){function t(t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=n,this._z=r,this._w=i}t.slerp=function(t,n,r,i){return r.copy(t).slerp(n,i)},t.slerpFlat=function(t,n,r,i,o,a,s){var l=r[i+0],c=r[i+1],u=r[i+2],h=r[i+3],d=o[a+0],p=o[a+1],f=o[a+2],m=o[a+3];if(h!==m||l!==d||c!==p||u!==f){var v=1-s,g=l*d+c*p+u*f+h*m,y=g>=0?1:-1,b=1-g*g;if(b>Number.EPSILON){var A=Math.sqrt(b),x=Math.atan2(A,g*y);v=Math.sin(v*x)/A,s=Math.sin(s*x)/A}var w=s*y;if(l=l*v+d*w,c=c*v+p*w,u=u*v+f*w,h=h*v+m*w,v===1-s){var E=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=E,c*=E,u*=E,h*=E}}t[n]=l,t[n+1]=c,t[n+2]=u,t[n+3]=h},t.multiplyQuaternionsFlat=function(t,n,r,i,o,a){var s=r[i],l=r[i+1],c=r[i+2],u=r[i+3],h=o[a],d=o[a+1],p=o[a+2],f=o[a+3];return t[n]=s*f+u*h+l*p-c*d,t[n+1]=l*f+u*d+c*h-s*p,t[n+2]=c*f+u*p+s*d-l*h,t[n+3]=u*f-s*h-l*d-c*p,t};var n=t.prototype;return n.set=function(t,n,r,i){return this._x=t,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this},n.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},n.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},n.setFromEuler=function(t,n){if(!(t&&t.isEuler))throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,i=t._y,o=t._z,a=t._order,s=Math.cos,l=Math.sin,c=s(r/2),u=s(i/2),h=s(o/2),d=l(r/2),p=l(i/2),f=l(o/2);switch(a){case"XYZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"YXZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"ZXY":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"ZYX":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"YZX":this._x=d*u*h+c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h-d*p*f;break;case"XZY":this._x=d*u*h-c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==n&&this._onChangeCallback(),this},n.setFromAxisAngle=function(t,n){var r=n/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this},n.setFromRotationMatrix=function(t){var n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],l=n[9],c=n[2],u=n[6],h=n[10],d=r+s+h;if(d>0){var p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(u-l)*p,this._y=(o-c)*p,this._z=(a-i)*p}else if(r>s&&r>h){var f=2*Math.sqrt(1+r-s-h);this._w=(u-l)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(o+c)/f}else if(s>h){var m=2*Math.sqrt(1+s-r-h);this._w=(o-c)/m,this._x=(i+a)/m,this._y=.25*m,this._z=(l+u)/m}else{var v=2*Math.sqrt(1+h-r-s);this._w=(a-i)/v,this._x=(o+c)/v,this._y=(l+u)/v,this._z=.25*v}return this._onChangeCallback(),this},n.setFromUnitVectors=function(t,n){var r=t.dot(n)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x),this._w=r,this.normalize()},n.angleTo=function(t){return 2*Math.acos(Math.abs(x.clamp(this.dot(t),-1,1)))},n.rotateTowards=function(t,n){var r=this.angleTo(t);if(0===r)return this;var i=Math.min(1,n/r);return this.slerp(t,i),this},n.identity=function(){return this.set(0,0,0,1)},n.invert=function(){return this.conjugate()},n.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},n.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},n.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},n.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},n.normalize=function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},n.multiply=function(t,n){return void 0!==n?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,n)):this.multiplyQuaternions(this,t)},n.premultiply=function(t){return this.multiplyQuaternions(t,this)},n.multiplyQuaternions=function(t,n){var r=t._x,i=t._y,o=t._z,a=t._w,s=n._x,l=n._y,c=n._z,u=n._w;return this._x=r*u+a*s+i*c-o*l,this._y=i*u+a*l+o*s-r*c,this._z=o*u+a*c+r*l-i*s,this._w=a*u-r*s-i*l-o*c,this._onChangeCallback(),this},n.slerp=function(t,n){if(0===n)return this;if(1===n)return this.copy(t);var r=this._x,i=this._y,o=this._z,a=this._w,s=a*t._w+r*t._x+i*t._y+o*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=a,this._x=r,this._y=i,this._z=o,this;var l=1-s*s;if(l<=Number.EPSILON){var c=1-n;return this._w=c*a+n*this._w,this._x=c*r+n*this._x,this._y=c*i+n*this._y,this._z=c*o+n*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(l),h=Math.atan2(u,s),d=Math.sin((1-n)*h)/u,p=Math.sin(n*h)/u;return this._w=a*d+this._w*p,this._x=r*d+this._x*p,this._y=i*d+this._y*p,this._z=o*d+this._z*p,this._onChangeCallback(),this},n.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},n.fromArray=function(t,n){return void 0===n&&(n=0),this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t},n.fromBufferAttribute=function(t,n){return this._x=t.getX(n),this._y=t.getY(n),this._z=t.getZ(n),this._w=t.getW(n),this},n._onChange=function(t){return this._onChangeCallback=t,this},n._onChangeCallback=function(){},p(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),t}(),D=function(){function t(t,n,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=n,this.z=r}var n=t.prototype;return n.set=function(t,n,r){return void 0===r&&(r=this.z),this.x=t,this.y=n,this.z=r,this},n.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},n.setX=function(t){return this.x=t,this},n.setY=function(t){return this.y=t,this},n.setZ=function(t){return this.z=t,this},n.setComponent=function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw Error("index is out of range: "+t)}return this},n.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},n.clone=function(){return new this.constructor(this.x,this.y,this.z)},n.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},n.add=function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},n.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},n.addVectors=function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this},n.addScaledVector=function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this},n.sub=function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},n.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},n.subVectors=function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this},n.multiply=function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,n)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},n.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.multiplyVectors=function(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this},n.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(I.setFromEuler(t))},n.applyAxisAngle=function(t,n){return this.applyQuaternion(I.setFromAxisAngle(t,n))},n.applyMatrix3=function(t){var n=this.x,r=this.y,i=this.z,o=t.elements;return this.x=o[0]*n+o[3]*r+o[6]*i,this.y=o[1]*n+o[4]*r+o[7]*i,this.z=o[2]*n+o[5]*r+o[8]*i,this},n.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},n.applyMatrix4=function(t){var n=this.x,r=this.y,i=this.z,o=t.elements,a=1/(o[3]*n+o[7]*r+o[11]*i+o[15]);return this.x=(o[0]*n+o[4]*r+o[8]*i+o[12])*a,this.y=(o[1]*n+o[5]*r+o[9]*i+o[13])*a,this.z=(o[2]*n+o[6]*r+o[10]*i+o[14])*a,this},n.applyQuaternion=function(t){var n=this.x,r=this.y,i=this.z,o=t.x,a=t.y,s=t.z,l=t.w,c=l*n+a*i-s*r,u=l*r+s*n-o*i,h=l*i+o*r-a*n,d=-o*n-a*r-s*i;return this.x=c*l+-(d*o)+-(u*s)- -(h*a),this.y=u*l+-(d*a)+-(h*o)- -(c*s),this.z=h*l+-(d*s)+-(c*a)- -(u*o),this},n.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},n.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},n.transformDirection=function(t){var n=this.x,r=this.y,i=this.z,o=t.elements;return this.x=o[0]*n+o[4]*r+o[8]*i,this.y=o[1]*n+o[5]*r+o[9]*i,this.z=o[2]*n+o[6]*r+o[10]*i,this.normalize()},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},n.divideScalar=function(t){return this.multiplyScalar(1/t)},n.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},n.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},n.clamp=function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this},n.clampScalar=function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this},n.clampLength=function(t,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(n,r)))},n.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},n.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},n.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},n.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},n.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},n.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},n.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},n.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},n.normalize=function(){return this.divideScalar(this.length()||1)},n.setLength=function(t){return this.normalize().multiplyScalar(t)},n.lerp=function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this},n.lerpVectors=function(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this},n.cross=function(t,n){return void 0!==n?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,n)):this.crossVectors(this,t)},n.crossVectors=function(t,n){var r=t.x,i=t.y,o=t.z,a=n.x,s=n.y,l=n.z;return this.x=i*l-o*s,this.y=o*a-r*l,this.z=r*s-i*a,this},n.projectOnVector=function(t){var n=t.lengthSq();if(0===n)return this.set(0,0,0);var r=t.dot(this)/n;return this.copy(t).multiplyScalar(r)},n.projectOnPlane=function(t){return O.copy(this).projectOnVector(t),this.sub(O)},n.reflect=function(t){return this.sub(O.copy(t).multiplyScalar(2*this.dot(t)))},n.angleTo=function(t){var n=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===n)return Math.PI/2;var r=this.dot(t)/n;return Math.acos(x.clamp(r,-1,1))},n.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},n.distanceToSquared=function(t){var n=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return n*n+r*r+i*i},n.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},n.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},n.setFromSphericalCoords=function(t,n,r){var i=Math.sin(n)*t;return this.x=i*Math.sin(r),this.y=Math.cos(n)*t,this.z=i*Math.cos(r),this},n.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},n.setFromCylindricalCoords=function(t,n,r){return this.x=t*Math.sin(n),this.y=r,this.z=t*Math.cos(n),this},n.setFromMatrixPosition=function(t){var n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this},n.setFromMatrixScale=function(t){var n=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=r,this.z=i,this},n.setFromMatrixColumn=function(t,n){return this.fromArray(t.elements,4*n)},n.setFromMatrix3Column=function(t,n){return this.fromArray(t.elements,3*n)},n.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},n.fromArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t},n.fromBufferAttribute=function(t,n,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this},n.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},t}(),O=new D,I=new P,B=function(){function t(t,n){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==t?t:new D(Infinity,Infinity,Infinity),this.max=void 0!==n?n:new D(-1/0,-1/0,-1/0)}var n=t.prototype;return n.set=function(t,n){return this.min.copy(t),this.max.copy(n),this},n.setFromArray=function(t){for(var n=Infinity,r=Infinity,i=Infinity,o=-1/0,a=-1/0,s=-1/0,l=0,c=t.length;l<c;l+=3){var u=t[l],h=t[l+1],d=t[l+2];u<n&&(n=u),h<r&&(r=h),d<i&&(i=d),u>o&&(o=u),h>a&&(a=h),d>s&&(s=d)}return this.min.set(n,r,i),this.max.set(o,a,s),this},n.setFromBufferAttribute=function(t){for(var n=Infinity,r=Infinity,i=Infinity,o=-1/0,a=-1/0,s=-1/0,l=0,c=t.count;l<c;l++){var u=t.getX(l),h=t.getY(l),d=t.getZ(l);u<n&&(n=u),h<r&&(r=h),d<i&&(i=d),u>o&&(o=u),h>a&&(a=h),d>s&&(s=d)}return this.min.set(n,r,i),this.max.set(o,a,s),this},n.setFromPoints=function(t){this.makeEmpty();for(var n=0,r=t.length;n<r;n++)this.expandByPoint(t[n]);return this},n.setFromCenterAndSize=function(t,n){var r=N.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this},n.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},n.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this},n.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},n.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new D),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},n.getSize=function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new D),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},n.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},n.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},n.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},n.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var n=t.geometry;void 0!==n&&(null===n.boundingBox&&n.computeBoundingBox(),U.copy(n.boundingBox),U.applyMatrix4(t.matrixWorld),this.union(U));for(var r=t.children,i=0,o=r.length;i<o;i++)this.expandByObject(r[i]);return this},n.containsPoint=function(t){return!(t.x<this.min.x)&&!(t.x>this.max.x)&&!(t.y<this.min.y)&&!(t.y>this.max.y)&&!(t.z<this.min.z)&&!(t.z>this.max.z)},n.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},n.getParameter=function(t,n){return void 0===n&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new D),n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},n.intersectsBox=function(t){return!(t.max.x<this.min.x)&&!(t.min.x>this.max.x)&&!(t.max.y<this.min.y)&&!(t.min.y>this.max.y)&&!(t.max.z<this.min.z)&&!(t.min.z>this.max.z)},n.intersectsSphere=function(t){return this.clampPoint(t.center,N),N.distanceToSquared(t.center)<=t.radius*t.radius},n.intersectsPlane=function(t){var n,r;return t.normal.x>0?(n=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),n<=-t.constant&&r>=-t.constant},n.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(q),X.subVectors(this.max,q),H.subVectors(t.a,q),G.subVectors(t.b,q),z.subVectors(t.c,q),j.subVectors(G,H),V.subVectors(z,G),W.subVectors(H,z);var n=[0,-j.z,j.y,0,-V.z,V.y,0,-W.z,W.y,j.z,0,-j.x,V.z,0,-V.x,W.z,0,-W.x,-j.y,j.x,0,-V.y,V.x,0,-W.y,W.x,0];return!!(F(n,H,G,z,X)&&F(n=[1,0,0,0,1,0,0,0,1],H,G,z,X))&&(Y.crossVectors(j,V),F(n=[Y.x,Y.y,Y.z],H,G,z,X))},n.clampPoint=function(t,n){return void 0===n&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new D),n.copy(t).clamp(this.min,this.max)},n.distanceToPoint=function(t){return N.copy(t).clamp(this.min,this.max).sub(t).length()},n.getBoundingSphere=function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(N).length(),t},n.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},n.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},n.applyMatrix4=function(t){return this.isEmpty()||(k[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),k[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),k[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),k[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),k[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),k[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),k[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),k[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(k)),this},n.translate=function(t){return this.min.add(t),this.max.add(t),this},n.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t}();function F(t,n,r,i,o){for(var a=0,s=t.length-3;a<=s;a+=3){Q.fromArray(t,a);var l=o.x*Math.abs(Q.x)+o.y*Math.abs(Q.y)+o.z*Math.abs(Q.z),c=n.dot(Q),u=r.dot(Q),h=i.dot(Q);if(Math.max(-Math.max(c,u,h),Math.min(c,u,h))>l)return!1}return!0}var k=[new D,new D,new D,new D,new D,new D,new D,new D],N=new D,U=new B,H=new D,G=new D,z=new D,j=new D,V=new D,W=new D,q=new D,X=new D,Y=new D,Q=new D,Z=new B,K=function(){function t(t,n){this.center=void 0!==t?t:new D,this.radius=void 0!==n?n:-1}var n=t.prototype;return n.set=function(t,n){return this.center.copy(t),this.radius=n,this},n.setFromPoints=function(t,n){var r=this.center;void 0!==n?r.copy(n):Z.setFromPoints(t).getCenter(r);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,r.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},n.isEmpty=function(){return this.radius<0},n.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},n.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},n.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},n.intersectsSphere=function(t){var n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n},n.intersectsBox=function(t){return t.intersectsSphere(this)},n.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},n.clampPoint=function(t,n){var r=this.center.distanceToSquared(t);return void 0===n&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new D),n.copy(t),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},n.getBoundingBox=function(t){return(void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new B),this.isEmpty())?t.makeEmpty():(t.set(this.center,this.center),t.expandByScalar(this.radius)),t},n.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},n.translate=function(t){return this.center.add(t),this},n.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},t}(),J=new D,$=new D,ee=new D,et=new D,en=new D,er=new D,ei=new D,eo=function(){function t(t,n){this.origin=void 0!==t?t:new D,this.direction=void 0!==n?n:new D(0,0,-1)}var n=t.prototype;return n.set=function(t,n){return this.origin.copy(t),this.direction.copy(n),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},n.at=function(t,n){return void 0===n&&(console.warn("THREE.Ray: .at() target is now required"),n=new D),n.copy(this.direction).multiplyScalar(t).add(this.origin)},n.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},n.recast=function(t){return this.origin.copy(this.at(t,J)),this},n.closestPointToPoint=function(t,n){void 0===n&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new D),n.subVectors(t,this.origin);var r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},n.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},n.distanceSqToPoint=function(t){var n=J.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(J.copy(this.direction).multiplyScalar(n).add(this.origin),J.distanceToSquared(t))},n.distanceSqToSegment=function(t,n,r,i){$.copy(t).add(n).multiplyScalar(.5),ee.copy(n).sub(t).normalize(),et.copy(this.origin).sub($);var o,a,s,l,c=.5*t.distanceTo(n),u=-this.direction.dot(ee),h=et.dot(this.direction),d=-et.dot(ee),p=et.lengthSq(),f=Math.abs(1-u*u);if(f>0){if(o=u*d-h,a=u*h-d,l=c*f,o>=0){if(a>=-l){if(a<=l){var m=1/f;o*=m,a*=m,s=o*(o+u*a+2*h)+a*(u*o+a+2*d)+p}else s=-(o=Math.max(0,-(u*(a=c)+h)))*o+a*(a+2*d)+p}else s=-(o=Math.max(0,-(u*(a=-c)+h)))*o+a*(a+2*d)+p}else a<=-l?(a=(o=Math.max(0,-(-u*c+h)))>0?-c:Math.min(Math.max(-c,-d),c),s=-o*o+a*(a+2*d)+p):a<=l?(o=0,s=(a=Math.min(Math.max(-c,-d),c))*(a+2*d)+p):(a=(o=Math.max(0,-(u*c+h)))>0?c:Math.min(Math.max(-c,-d),c),s=-o*o+a*(a+2*d)+p)}else a=u>0?-c:c,s=-(o=Math.max(0,-(u*a+h)))*o+a*(a+2*d)+p;return r&&r.copy(this.direction).multiplyScalar(o).add(this.origin),i&&i.copy(ee).multiplyScalar(a).add($),s},n.intersectSphere=function(t,n){J.subVectors(t.center,this.origin);var r=J.dot(this.direction),i=J.dot(J)-r*r,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,l=r+a;return s<0&&l<0?null:s<0?this.at(l,n):this.at(s,n)},n.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},n.distanceToPlane=function(t){var n=t.normal.dot(this.direction);if(0===n)return 0===t.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(t.normal)+t.constant)/n;return r>=0?r:null},n.intersectPlane=function(t,n){var r=this.distanceToPlane(t);return null===r?null:this.at(r,n)},n.intersectsPlane=function(t){var n=t.distanceToPoint(this.origin);return!!(0===n||t.normal.dot(this.direction)*n<0)},n.intersectBox=function(t,n){var r,i,o,a,s,l,c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return(c>=0?(r=(t.min.x-d.x)*c,i=(t.max.x-d.x)*c):(r=(t.max.x-d.x)*c,i=(t.min.x-d.x)*c),u>=0?(o=(t.min.y-d.y)*u,a=(t.max.y-d.y)*u):(o=(t.max.y-d.y)*u,a=(t.min.y-d.y)*u),r>a||o>i)?null:((o>r||r!=r)&&(r=o),(a<i||i!=i)&&(i=a),h>=0?(s=(t.min.z-d.z)*h,l=(t.max.z-d.z)*h):(s=(t.max.z-d.z)*h,l=(t.min.z-d.z)*h),r>l||s>i)?null:((s>r||r!=r)&&(r=s),(l<i||i!=i)&&(i=l),i<0)?null:this.at(r>=0?r:i,n)},n.intersectsBox=function(t){return null!==this.intersectBox(t,J)},n.intersectTriangle=function(t,n,r,i,o){en.subVectors(n,t),er.subVectors(r,t),ei.crossVectors(en,er);var a,s=this.direction.dot(ei);if(s>0){if(i)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}et.subVectors(this.origin,t);var l=a*this.direction.dot(er.crossVectors(et,er));if(l<0)return null;var c=a*this.direction.dot(en.cross(et));if(c<0||l+c>s)return null;var u=-a*et.dot(ei);return u<0?null:this.at(u/s,o)},n.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},n.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}(),ea=function(){function t(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var n=t.prototype;return n.set=function(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,v){var g=this.elements;return g[0]=t,g[4]=n,g[8]=r,g[12]=i,g[1]=o,g[5]=a,g[9]=s,g[13]=l,g[2]=c,g[6]=u,g[10]=h,g[14]=d,g[3]=p,g[7]=f,g[11]=m,g[15]=v,this},n.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},n.clone=function(){return new t().fromArray(this.elements)},n.copy=function(t){var n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this},n.copyPosition=function(t){var n=this.elements,r=t.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this},n.setFromMatrix3=function(t){var n=t.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this},n.extractBasis=function(t,n,r){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},n.makeBasis=function(t,n,r){return this.set(t.x,n.x,r.x,0,t.y,n.y,r.y,0,t.z,n.z,r.z,0,0,0,0,1),this},n.extractRotation=function(t){var n=this.elements,r=t.elements,i=1/es.setFromMatrixColumn(t,0).length(),o=1/es.setFromMatrixColumn(t,1).length(),a=1/es.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},n.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,r=t.x,i=t.y,o=t.z,a=Math.cos(r),s=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(o),h=Math.sin(o);if("XYZ"===t.order){var d=a*u,p=a*h,f=s*u,m=s*h;n[0]=l*u,n[4]=-l*h,n[8]=c,n[1]=p+f*c,n[5]=d-m*c,n[9]=-s*l,n[2]=m-d*c,n[6]=f+p*c,n[10]=a*l}else if("YXZ"===t.order){var v=l*u,g=l*h,y=c*u,b=c*h;n[0]=v+b*s,n[4]=y*s-g,n[8]=a*c,n[1]=a*h,n[5]=a*u,n[9]=-s,n[2]=g*s-y,n[6]=b+v*s,n[10]=a*l}else if("ZXY"===t.order){var A=l*u,x=l*h,w=c*u,E=c*h;n[0]=A-E*s,n[4]=-a*h,n[8]=w+x*s,n[1]=x+w*s,n[5]=a*u,n[9]=E-A*s,n[2]=-a*c,n[6]=s,n[10]=a*l}else if("ZYX"===t.order){var M=a*u,_=a*h,T=s*u,S=s*h;n[0]=l*u,n[4]=T*c-_,n[8]=M*c+S,n[1]=l*h,n[5]=S*c+M,n[9]=_*c-T,n[2]=-c,n[6]=s*l,n[10]=a*l}else if("YZX"===t.order){var C=a*l,L=a*c,R=s*l,P=s*c;n[0]=l*u,n[4]=P-C*h,n[8]=R*h+L,n[1]=h,n[5]=a*u,n[9]=-s*u,n[2]=-c*u,n[6]=L*h+R,n[10]=C-P*h}else if("XZY"===t.order){var D=a*l,O=a*c,I=s*l,B=s*c;n[0]=l*u,n[4]=-h,n[8]=c*u,n[1]=D*h+B,n[5]=a*u,n[9]=O*h-I,n[2]=I*h-O,n[6]=s*u,n[10]=B*h+D}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},n.makeRotationFromQuaternion=function(t){return this.compose(ec,t,eu)},n.lookAt=function(t,n,r){var i=this.elements;return ep.subVectors(t,n),0===ep.lengthSq()&&(ep.z=1),ep.normalize(),eh.crossVectors(r,ep),0===eh.lengthSq()&&(1===Math.abs(r.z)?ep.x+=1e-4:ep.z+=1e-4,ep.normalize(),eh.crossVectors(r,ep)),eh.normalize(),ed.crossVectors(ep,eh),i[0]=eh.x,i[4]=ed.x,i[8]=ep.x,i[1]=eh.y,i[5]=ed.y,i[9]=ep.y,i[2]=eh.z,i[6]=ed.z,i[10]=ep.z,this},n.multiply=function(t,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,n)):this.multiplyMatrices(this,t)},n.premultiply=function(t){return this.multiplyMatrices(t,this)},n.multiplyMatrices=function(t,n){var r=t.elements,i=n.elements,o=this.elements,a=r[0],s=r[4],l=r[8],c=r[12],u=r[1],h=r[5],d=r[9],p=r[13],f=r[2],m=r[6],v=r[10],g=r[14],y=r[3],b=r[7],A=r[11],x=r[15],w=i[0],E=i[4],M=i[8],_=i[12],T=i[1],S=i[5],C=i[9],L=i[13],R=i[2],P=i[6],D=i[10],O=i[14],I=i[3],B=i[7],F=i[11],k=i[15];return o[0]=a*w+s*T+l*R+c*I,o[4]=a*E+s*S+l*P+c*B,o[8]=a*M+s*C+l*D+c*F,o[12]=a*_+s*L+l*O+c*k,o[1]=u*w+h*T+d*R+p*I,o[5]=u*E+h*S+d*P+p*B,o[9]=u*M+h*C+d*D+p*F,o[13]=u*_+h*L+d*O+p*k,o[2]=f*w+m*T+v*R+g*I,o[6]=f*E+m*S+v*P+g*B,o[10]=f*M+m*C+v*D+g*F,o[14]=f*_+m*L+v*O+g*k,o[3]=y*w+b*T+A*R+x*I,o[7]=y*E+b*S+A*P+x*B,o[11]=y*M+b*C+A*D+x*F,o[15]=y*_+b*L+A*O+x*k,this},n.multiplyScalar=function(t){var n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this},n.determinant=function(){var t=this.elements,n=t[0],r=t[4],i=t[8],o=t[12],a=t[1],s=t[5],l=t[9],c=t[13],u=t[2],h=t[6],d=t[10],p=t[14];return t[3]*(+o*l*h-i*c*h-o*s*d+r*c*d+i*s*p-r*l*p)+t[7]*(+n*l*p-n*c*d+o*a*d-i*a*p+i*c*u-o*l*u)+t[11]*(+n*c*h-n*s*p-o*a*h+r*a*p+o*s*u-r*c*u)+t[15]*(-i*s*u-n*l*h+n*s*d+i*a*h-r*a*d+r*l*u)},n.transpose=function(){var t,n=this.elements;return t=n[1],n[1]=n[4],n[4]=t,t=n[2],n[2]=n[8],n[8]=t,t=n[6],n[6]=n[9],n[9]=t,t=n[3],n[3]=n[12],n[12]=t,t=n[7],n[7]=n[13],n[13]=t,t=n[11],n[11]=n[14],n[14]=t,this},n.setPosition=function(t,n,r){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=n,i[14]=r),this},n.invert=function(){var t=this.elements,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],v=t[14],g=t[15],y=h*v*c-m*d*c+m*l*p-s*v*p-h*l*g+s*d*g,b=f*d*c-u*v*c-f*l*p+a*v*p+u*l*g-a*d*g,A=u*m*c-f*h*c+f*s*p-a*m*p-u*s*g+a*h*g,x=f*h*l-u*m*l-f*s*d+a*m*d+u*s*v-a*h*v,w=n*y+r*b+i*A+o*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var E=1/w;return t[0]=y*E,t[1]=(m*d*o-h*v*o-m*i*p+r*v*p+h*i*g-r*d*g)*E,t[2]=(s*v*o-m*l*o+m*i*c-r*v*c-s*i*g+r*l*g)*E,t[3]=(h*l*o-s*d*o-h*i*c+r*d*c+s*i*p-r*l*p)*E,t[4]=b*E,t[5]=(u*v*o-f*d*o+f*i*p-n*v*p-u*i*g+n*d*g)*E,t[6]=(f*l*o-a*v*o-f*i*c+n*v*c+a*i*g-n*l*g)*E,t[7]=(a*d*o-u*l*o+u*i*c-n*d*c-a*i*p+n*l*p)*E,t[8]=A*E,t[9]=(f*h*o-u*m*o-f*r*p+n*m*p+u*r*g-n*h*g)*E,t[10]=(a*m*o-f*s*o+f*r*c-n*m*c-a*r*g+n*s*g)*E,t[11]=(u*s*o-a*h*o-u*r*c+n*h*c+a*r*p-n*s*p)*E,t[12]=x*E,t[13]=(u*m*i-f*h*i+f*r*d-n*m*d-u*r*v+n*h*v)*E,t[14]=(f*s*i-a*m*i-f*r*l+n*m*l+a*r*v-n*s*v)*E,t[15]=(a*h*i-u*s*i+u*r*l-n*h*l-a*r*d+n*s*d)*E,this},n.scale=function(t){var n=this.elements,r=t.x,i=t.y,o=t.z;return n[0]*=r,n[4]*=i,n[8]*=o,n[1]*=r,n[5]*=i,n[9]*=o,n[2]*=r,n[6]*=i,n[10]*=o,n[3]*=r,n[7]*=i,n[11]*=o,this},n.getMaxScaleOnAxis=function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},n.makeTranslation=function(t,n,r){return this.set(1,0,0,t,0,1,0,n,0,0,1,r,0,0,0,1),this},n.makeRotationX=function(t){var n=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this},n.makeRotationY=function(t){var n=Math.cos(t),r=Math.sin(t);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this},n.makeRotationZ=function(t){var n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this},n.makeRotationAxis=function(t,n){var r=Math.cos(n),i=Math.sin(n),o=1-r,a=t.x,s=t.y,l=t.z,c=o*a,u=o*s;return this.set(c*a+r,c*s-i*l,c*l+i*s,0,c*s+i*l,u*s+r,u*l-i*a,0,c*l-i*s,u*l+i*a,o*l*l+r,0,0,0,0,1),this},n.makeScale=function(t,n,r){return this.set(t,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this},n.makeShear=function(t,n,r){return this.set(1,n,r,0,t,1,r,0,t,n,1,0,0,0,0,1),this},n.compose=function(t,n,r){var i=this.elements,o=n._x,a=n._y,s=n._z,l=n._w,c=o+o,u=a+a,h=s+s,d=o*c,p=o*u,f=o*h,m=a*u,v=a*h,g=s*h,y=l*c,b=l*u,A=l*h,x=r.x,w=r.y,E=r.z;return i[0]=(1-(m+g))*x,i[1]=(p+A)*x,i[2]=(f-b)*x,i[3]=0,i[4]=(p-A)*w,i[5]=(1-(d+g))*w,i[6]=(v+y)*w,i[7]=0,i[8]=(f+b)*E,i[9]=(v-y)*E,i[10]=(1-(d+m))*E,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},n.decompose=function(t,n,r){var i=this.elements,o=es.set(i[0],i[1],i[2]).length(),a=es.set(i[4],i[5],i[6]).length(),s=es.set(i[8],i[9],i[10]).length();0>this.determinant()&&(o=-o),t.x=i[12],t.y=i[13],t.z=i[14],el.copy(this);var l=1/o,c=1/a,u=1/s;return el.elements[0]*=l,el.elements[1]*=l,el.elements[2]*=l,el.elements[4]*=c,el.elements[5]*=c,el.elements[6]*=c,el.elements[8]*=u,el.elements[9]*=u,el.elements[10]*=u,n.setFromRotationMatrix(el),r.x=o,r.y=a,r.z=s,this},n.makePerspective=function(t,n,r,i,o,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements;return s[0]=2*o/(n-t),s[4]=0,s[8]=(n+t)/(n-t),s[12]=0,s[1]=0,s[5]=2*o/(r-i),s[9]=(r+i)/(r-i),s[13]=0,s[2]=0,s[6]=0,s[10]=-(a+o)/(a-o),s[14]=-2*a*o/(a-o),s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},n.makeOrthographic=function(t,n,r,i,o,a){var s=this.elements,l=1/(n-t),c=1/(r-i),u=1/(a-o);return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-((n+t)*l),s[1]=0,s[5]=2*c,s[9]=0,s[13]=-((r+i)*c),s[2]=0,s[6]=0,s[10]=-2*u,s[14]=-((a+o)*u),s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},n.equals=function(t){for(var n=this.elements,r=t.elements,i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0},n.fromArray=function(t,n){void 0===n&&(n=0);for(var r=0;r<16;r++)this.elements[r]=t[r+n];return this},n.toArray=function(t,n){void 0===t&&(t=[]),void 0===n&&(n=0);var r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t[n+9]=r[9],t[n+10]=r[10],t[n+11]=r[11],t[n+12]=r[12],t[n+13]=r[13],t[n+14]=r[14],t[n+15]=r[15],t},t}(),es=new D,el=new ea,ec=new D(0,0,0),eu=new D(1,1,1),eh=new D,ed=new D,ep=new D,ef=function(){function t(n,r,i,o){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=t.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=n,this._y=r,this._z=i,this._order=o}var n=t.prototype;return n.set=function(t,n,r,i){return this._x=t,this._y=n,this._z=r,this._order=i||this._order,this._onChangeCallback(),this},n.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},n.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},n.setFromRotationMatrix=function(t,n,r){var i=x.clamp,o=t.elements,a=o[0],s=o[4],l=o[8],c=o[1],u=o[5],h=o[9],d=o[2],p=o[6],f=o[10];switch(n=n||this._order){case"XYZ":this._y=Math.asin(i(l,-1,1)),.9999999>Math.abs(l)?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-i(h,-1,1)),.9999999>Math.abs(h)?(this._y=Math.atan2(l,f),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,a),this._z=0);break;case"ZXY":this._x=Math.asin(i(p,-1,1)),.9999999>Math.abs(p)?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(c,a));break;case"ZYX":this._y=Math.asin(-i(d,-1,1)),.9999999>Math.abs(d)?(this._x=Math.atan2(p,f),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(i(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(l,f));break;case"XZY":this._z=Math.asin(-i(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(p,u),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!1!==r&&this._onChangeCallback(),this},n.setFromQuaternion=function(t,n,r){return em.makeRotationFromQuaternion(t),this.setFromRotationMatrix(em,n,r)},n.setFromVector3=function(t,n){return this.set(t.x,t.y,t.z,n||this._order)},n.reorder=function(t){return ev.setFromEuler(this),this.setFromQuaternion(ev,t)},n.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},n.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t},n.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new D(this._x,this._y,this._z)},n._onChange=function(t){return this._onChangeCallback=t,this},n._onChangeCallback=function(){},p(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),t}();ef.DefaultOrder="XYZ",ef.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var em=new ea,ev=new P,eg=function(){function t(){this.mask=1}var n=t.prototype;return n.set=function(t){this.mask=1<<t|0},n.enable=function(t){this.mask|=1<<t|0},n.enableAll=function(){this.mask=-1},n.toggle=function(t){this.mask^=1<<t|0},n.disable=function(t){this.mask&=~(1<<t|0)},n.disableAll=function(){this.mask=0},n.test=function(t){return(this.mask&t.mask)!=0},t}(),ey=0,eb=new D,eA=new P,ex=new ea,ew=new D,eE=new D,eM=new D,e_=new P,eT=new D(1,0,0),eS=new D(0,1,0),eC=new D(0,0,1),eL={type:"added"},eR={type:"removed"};function eP(){Object.defineProperty(this,"id",{value:ey++}),this.uuid=x.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=eP.DefaultUp.clone();var t=new D,n=new ef,r=new P,i=new D(1,1,1);n._onChange(function(){r.setFromEuler(n,!1)}),r._onChange(function(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new ea},normalMatrix:{value:new E}}),this.matrix=new ea,this.matrixWorld=new ea,this.matrixAutoUpdate=eP.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new eg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}eP.DefaultUp=new D(0,1,0),eP.DefaultMatrixAutoUpdate=!0,eP.prototype=Object.assign(Object.create(g.prototype),{constructor:eP,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,n){this.quaternion.setFromAxisAngle(t,n)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,n){return eA.setFromAxisAngle(t,n),this.quaternion.multiply(eA),this},rotateOnWorldAxis:function(t,n){return eA.setFromAxisAngle(t,n),this.quaternion.premultiply(eA),this},rotateX:function(t){return this.rotateOnAxis(eT,t)},rotateY:function(t){return this.rotateOnAxis(eS,t)},rotateZ:function(t){return this.rotateOnAxis(eC,t)},translateOnAxis:function(t,n){return eb.copy(t).applyQuaternion(this.quaternion),this.position.add(eb.multiplyScalar(n)),this},translateX:function(t){return this.translateOnAxis(eT,t)},translateY:function(t){return this.translateOnAxis(eS,t)},translateZ:function(t){return this.translateOnAxis(eC,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(ex.copy(this.matrixWorld).invert())},lookAt:function(t,n,r){t.isVector3?ew.copy(t):ew.set(t,n,r);var i=this.parent;this.updateWorldMatrix(!0,!1),eE.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ex.lookAt(eE,ew,this.up):ex.lookAt(ew,eE,this.up),this.quaternion.setFromRotationMatrix(ex),i&&(ex.extractRotation(i.matrixWorld),eA.setFromRotationMatrix(ex),this.quaternion.premultiply(eA.invert()))},add:function(t){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(eL)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this},remove:function(t){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}var r=this.children.indexOf(t);return -1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(eR)),this},clear:function(){for(var t=0;t<this.children.length;t++){var n=this.children[t];n.parent=null,n.dispatchEvent(eR)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),ex.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ex.multiply(t.parent.matrixWorld)),t.applyMatrix4(ex),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,n){if(this[t]===n)return this;for(var r=0,i=this.children.length;r<i;r++){var o=this.children[r].getObjectByProperty(t,n);if(void 0!==o)return o}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new D),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new P),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eE,t,eM),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new D),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eE,e_,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new D),this.updateWorldMatrix(!0,!1);var n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].traverseVisible(t)}},traverseAncestors:function(t){var n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,n){var r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n)for(var i=this.children,o=0,a=i.length;o<a;o++)i[o].updateWorldMatrix(!1,!0)},toJSON:function(t){var n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function o(n,r){return void 0===n[r.uuid]&&(n[r.uuid]=r.toJSON(t)),r.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=o(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var s=a.shapes;if(Array.isArray(s))for(var l=0,c=s.length;l<c;l++){var u=s[l];o(t.shapes,u)}else o(t.shapes,s)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){for(var h=[],d=0,p=this.material.length;d<p;d++)h.push(o(t.materials,this.material[d]));i.material=h}else i.material=o(t.materials,this.material)}if(this.children.length>0){i.children=[];for(var f=0;f<this.children.length;f++)i.children.push(this.children[f].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(var m=0;m<this.animations.length;m++){var v=this.animations[m];i.animations.push(o(t.animations,v))}}if(n){var g=M(t.geometries),y=M(t.materials),b=M(t.textures),A=M(t.images),x=M(t.shapes),w=M(t.skeletons),E=M(t.animations);g.length>0&&(r.geometries=g),y.length>0&&(r.materials=y),b.length>0&&(r.textures=b),A.length>0&&(r.images=A),x.length>0&&(r.shapes=x),w.length>0&&(r.skeletons=w),E.length>0&&(r.animations=E)}return r.object=i,r;function M(t){var n=[];for(var r in t){var i=t[r];delete i.metadata,n.push(i)}return n}},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,n){if(void 0===n&&(n=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(var r=0;r<t.children.length;r++){var i=t.children[r];this.add(i.clone())}return this}});var eD=new D,eO=new D,eI=new E,eB=function(){function t(t,n){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==t?t:new D(1,0,0),this.constant=void 0!==n?n:0}var n=t.prototype;return n.set=function(t,n){return this.normal.copy(t),this.constant=n,this},n.setComponents=function(t,n,r,i){return this.normal.set(t,n,r),this.constant=i,this},n.setFromNormalAndCoplanarPoint=function(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this},n.setFromCoplanarPoints=function(t,n,r){var i=eD.subVectors(r,n).cross(eO.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},n.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},n.negate=function(){return this.constant*=-1,this.normal.negate(),this},n.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},n.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},n.projectPoint=function(t,n){return void 0===n&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new D),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},n.intersectLine=function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new D);var r=t.delta(eD),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;if(!(o<0)&&!(o>1))return n.copy(r).multiplyScalar(o).add(t.start)},n.intersectsLine=function(t){var n=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return n<0&&r>0||r<0&&n>0},n.intersectsBox=function(t){return t.intersectsPlane(this)},n.intersectsSphere=function(t){return t.intersectsPlane(this)},n.coplanarPoint=function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new D),t.copy(this.normal).multiplyScalar(-this.constant)},n.applyMatrix4=function(t,n){var r=n||eI.getNormalMatrix(t),i=this.coplanarPoint(eD).applyMatrix4(t),o=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(o),this},n.translate=function(t){return this.constant-=t.dot(this.normal),this},n.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},t}(),eF=new D,ek=new D,eN=new D,eU=new D,eH=new D,eG=new D,ez=new D,ej=new D,eV=new D,eW=new D,eq=function(){function t(t,n,r){this.a=void 0!==t?t:new D,this.b=void 0!==n?n:new D,this.c=void 0!==r?r:new D}t.getNormal=function(t,n,r,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new D),i.subVectors(r,n),eF.subVectors(t,n),i.cross(eF);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)},t.getBarycoord=function(t,n,r,i,o){eF.subVectors(i,n),ek.subVectors(r,n),eN.subVectors(t,n);var a=eF.dot(eF),s=eF.dot(ek),l=eF.dot(eN),c=ek.dot(ek),u=ek.dot(eN),h=a*c-s*s;if(void 0===o&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),o=new D),0===h)return o.set(-2,-1,-1);var d=1/h,p=(c*l-s*u)*d,f=(a*u-s*l)*d;return o.set(1-p-f,f,p)},t.containsPoint=function(t,n,r,i){return this.getBarycoord(t,n,r,i,eU),eU.x>=0&&eU.y>=0&&eU.x+eU.y<=1},t.getUV=function(t,n,r,i,o,a,s,l){return this.getBarycoord(t,n,r,i,eU),l.set(0,0),l.addScaledVector(o,eU.x),l.addScaledVector(a,eU.y),l.addScaledVector(s,eU.z),l},t.isFrontFacing=function(t,n,r,i){return eF.subVectors(r,n),ek.subVectors(t,n),0>eF.cross(ek).dot(i)};var n=t.prototype;return n.set=function(t,n,r){return this.a.copy(t),this.b.copy(n),this.c.copy(r),this},n.setFromPointsAndIndices=function(t,n,r,i){return this.a.copy(t[n]),this.b.copy(t[r]),this.c.copy(t[i]),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},n.getArea=function(){return eF.subVectors(this.c,this.b),ek.subVectors(this.a,this.b),.5*eF.cross(ek).length()},n.getMidpoint=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new D),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},n.getNormal=function(n){return t.getNormal(this.a,this.b,this.c,n)},n.getPlane=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new eB),t.setFromCoplanarPoints(this.a,this.b,this.c)},n.getBarycoord=function(n,r){return t.getBarycoord(n,this.a,this.b,this.c,r)},n.getUV=function(n,r,i,o,a){return t.getUV(n,this.a,this.b,this.c,r,i,o,a)},n.containsPoint=function(n){return t.containsPoint(n,this.a,this.b,this.c)},n.isFrontFacing=function(n){return t.isFrontFacing(this.a,this.b,this.c,n)},n.intersectsBox=function(t){return t.intersectsTriangle(this)},n.closestPointToPoint=function(t,n){void 0===n&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new D);var r,i,o=this.a,a=this.b,s=this.c;eH.subVectors(a,o),eG.subVectors(s,o),ej.subVectors(t,o);var l=eH.dot(ej),c=eG.dot(ej);if(l<=0&&c<=0)return n.copy(o);eV.subVectors(t,a);var u=eH.dot(eV),h=eG.dot(eV);if(u>=0&&h<=u)return n.copy(a);var d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return r=l/(l-u),n.copy(o).addScaledVector(eH,r);eW.subVectors(t,s);var p=eH.dot(eW),f=eG.dot(eW);if(f>=0&&p<=f)return n.copy(s);var m=p*c-l*f;if(m<=0&&c>=0&&f<=0)return i=c/(c-f),n.copy(o).addScaledVector(eG,i);var v=u*f-p*h;if(v<=0&&h-u>=0&&p-f>=0)return ez.subVectors(s,a),i=(h-u)/(h-u+(p-f)),n.copy(a).addScaledVector(ez,i);var g=1/(v+m+d);return r=m*g,i=d*g,n.copy(o).addScaledVector(eH,r).addScaledVector(eG,i)},n.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},t}(),eX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},eY={h:0,s:0,l:0},eQ={h:0,s:0,l:0};function eZ(t,n,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?t+(n-t)*6*r:r<.5?n:r<2/3?t+(n-t)*6*(2/3-r):t}function eK(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function eJ(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var e$=function(){function t(t,n,r){return(Object.defineProperty(this,"isColor",{value:!0}),void 0===n&&void 0===r)?this.set(t):this.setRGB(t,n,r)}var n=t.prototype;return n.set=function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},n.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},n.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},n.setRGB=function(t,n,r){return this.r=t,this.g=n,this.b=r,this},n.setHSL=function(t,n,r){if(t=x.euclideanModulo(t,1),n=x.clamp(n,0,1),r=x.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=eZ(o,i,t+1/3),this.g=eZ(o,i,t),this.b=eZ(o,i,t-1/3)}return this},n.setStyle=function(t){function n(n){void 0!==n&&1>parseFloat(n)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){var r,i,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,n(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,n(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){var s=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return n(i[4]),this.setHSL(s,l,c)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){var u=r[1],h=u.length;if(3===h)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},n.setColorName=function(t){var n=eX[t];return void 0!==n?this.setHex(n):console.warn("THREE.Color: Unknown color "+t),this},n.clone=function(){return new this.constructor(this.r,this.g,this.b)},n.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},n.copyGammaToLinear=function(t,n){return void 0===n&&(n=2),this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},n.copyLinearToGamma=function(t,n){void 0===n&&(n=2);var r=n>0?1/n:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},n.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},n.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},n.copySRGBToLinear=function(t){return this.r=eK(t.r),this.g=eK(t.g),this.b=eK(t.b),this},n.copyLinearToSRGB=function(t){return this.r=eJ(t.r),this.g=eJ(t.g),this.b=eJ(t.b),this},n.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},n.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},n.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},n.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},n.getHSL=function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var n,r,i=this.r,o=this.g,a=this.b,s=Math.max(i,o,a),l=Math.min(i,o,a),c=(l+s)/2;if(l===s)n=0,r=0;else{var u=s-l;switch(r=c<=.5?u/(s+l):u/(2-s-l),s){case i:n=(o-a)/u+(o<a?6:0);break;case o:n=(a-i)/u+2;break;case a:n=(i-o)/u+4}n/=6}return t.h=n,t.s=r,t.l=c,t},n.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},n.offsetHSL=function(t,n,r){return this.getHSL(eY),eY.h+=t,eY.s+=n,eY.l+=r,this.setHSL(eY.h,eY.s,eY.l),this},n.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},n.addColors=function(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this},n.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},n.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},n.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},n.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},n.lerp=function(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this},n.lerpColors=function(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this},n.lerpHSL=function(t,n){this.getHSL(eY),t.getHSL(eQ);var r=x.lerp(eY.h,eQ.h,n),i=x.lerp(eY.s,eQ.s,n),o=x.lerp(eY.l,eQ.l,n);return this.setHSL(r,i,o),this},n.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},n.fromArray=function(t,n){return void 0===n&&(n=0),this.r=t[n],this.g=t[n+1],this.b=t[n+2],this},n.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t},n.fromBufferAttribute=function(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},n.toJSON=function(){return this.getHex()},t}();e$.NAMES=eX,e$.prototype.r=1,e$.prototype.g=1,e$.prototype.b=1;var e0=function(){function t(t,n,r,i,o,a){void 0===a&&(a=0),this.a=t,this.b=n,this.c=r,this.normal=i&&i.isVector3?i:new D,this.vertexNormals=Array.isArray(i)?i:[],this.color=o&&o.isColor?o:new e$,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=a}var n=t.prototype;return n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var n=0,r=t.vertexNormals.length;n<r;n++)this.vertexNormals[n]=t.vertexNormals[n].clone();for(var i=0,o=t.vertexColors.length;i<o;i++)this.vertexColors[i]=t.vertexColors[i].clone();return this},t}(),e1=0;function e2(){Object.defineProperty(this,"id",{value:e1++}),this.uuid=x.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function e3(t){e2.call(this),this.type="MeshBasicMaterial",this.color=new e$(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}e2.prototype=Object.assign(Object.create(g.prototype),{constructor:e2,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(var n in t){var r=t[n];if(void 0===r){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if("shading"===n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}var i=this[n];if(void 0===i){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}},toJSON:function(t){var n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){var n=[];for(var r in t){var i=t[r];delete i.metadata,n.push(i)}return n}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.morphNormals&&(r.morphNormals=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){var o=i(t.textures),a=i(t.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var n=t.clippingPlanes,r=null;if(null!==n){var i=n.length;r=Array(i);for(var o=0;o!==i;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(e2.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),e3.prototype=Object.create(e2.prototype),e3.prototype.constructor=e3,e3.prototype.isMeshBasicMaterial=!0,e3.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var e4=new D,e5=new w;function e6(t,n,r){if(Array.isArray(t))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===r,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function e7(t,n,r){e6.call(this,new Int8Array(t),n,r)}function e8(t,n,r){e6.call(this,new Uint8Array(t),n,r)}function e9(t,n,r){e6.call(this,new Uint8ClampedArray(t),n,r)}function te(t,n,r){e6.call(this,new Int16Array(t),n,r)}function tt(t,n,r){e6.call(this,new Uint16Array(t),n,r)}function tn(t,n,r){e6.call(this,new Int32Array(t),n,r)}function tr(t,n,r){e6.call(this,new Uint32Array(t),n,r)}function ti(t,n,r){e6.call(this,new Uint16Array(t),n,r)}function to(t,n,r){e6.call(this,new Float32Array(t),n,r)}function ta(t,n,r){e6.call(this,new Float64Array(t),n,r)}function ts(t){if(0===t.length)return-1/0;for(var n=t[0],r=1,i=t.length;r<i;++r)t[r]>n&&(n=t[r]);return n}Object.defineProperty(e6.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(e6.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,n,r){t*=this.itemSize,r*=n.itemSize;for(var i=0,o=this.itemSize;i<o;i++)this.array[t+i]=n.array[r+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var n=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new e$),n[r++]=a.r,n[r++]=a.g,n[r++]=a.b}return this},copyVector2sArray:function(t){for(var n=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new w),n[r++]=a.x,n[r++]=a.y}return this},copyVector3sArray:function(t){for(var n=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new D),n[r++]=a.x,n[r++]=a.y,n[r++]=a.z}return this},copyVector4sArray:function(t){for(var n=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new C),n[r++]=a.x,n[r++]=a.y,n[r++]=a.z,n[r++]=a.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(var n=0,r=this.count;n<r;n++)e5.fromBufferAttribute(this,n),e5.applyMatrix3(t),this.setXY(n,e5.x,e5.y);else if(3===this.itemSize)for(var i=0,o=this.count;i<o;i++)e4.fromBufferAttribute(this,i),e4.applyMatrix3(t),this.setXYZ(i,e4.x,e4.y,e4.z);return this},applyMatrix4:function(t){for(var n=0,r=this.count;n<r;n++)e4.x=this.getX(n),e4.y=this.getY(n),e4.z=this.getZ(n),e4.applyMatrix4(t),this.setXYZ(n,e4.x,e4.y,e4.z);return this},applyNormalMatrix:function(t){for(var n=0,r=this.count;n<r;n++)e4.x=this.getX(n),e4.y=this.getY(n),e4.z=this.getZ(n),e4.applyNormalMatrix(t),this.setXYZ(n,e4.x,e4.y,e4.z);return this},transformDirection:function(t){for(var n=0,r=this.count;n<r;n++)e4.x=this.getX(n),e4.y=this.getY(n),e4.z=this.getZ(n),e4.transformDirection(t),this.setXYZ(n,e4.x,e4.y,e4.z);return this},set:function(t,n){return void 0===n&&(n=0),this.array.set(t,n),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,n){return this.array[t*this.itemSize]=n,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,n){return this.array[t*this.itemSize+1]=n,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,n){return this.array[t*this.itemSize+2]=n,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,n){return this.array[t*this.itemSize+3]=n,this},setXY:function(t,n,r){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=r,this},setXYZ:function(t,n,r,i){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this},setXYZW:function(t,n,r,i,o){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=o,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),e7.prototype=Object.create(e6.prototype),e7.prototype.constructor=e7,e8.prototype=Object.create(e6.prototype),e8.prototype.constructor=e8,e9.prototype=Object.create(e6.prototype),e9.prototype.constructor=e9,te.prototype=Object.create(e6.prototype),te.prototype.constructor=te,tt.prototype=Object.create(e6.prototype),tt.prototype.constructor=tt,tn.prototype=Object.create(e6.prototype),tn.prototype.constructor=tn,tr.prototype=Object.create(e6.prototype),tr.prototype.constructor=tr,ti.prototype=Object.create(e6.prototype),ti.prototype.constructor=ti,ti.prototype.isFloat16BufferAttribute=!0,to.prototype=Object.create(e6.prototype),to.prototype.constructor=to,ta.prototype=Object.create(e6.prototype),ta.prototype.constructor=ta;var tl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function tc(t,n){return new tl[t](n)}var tu=0,th=new ea,td=new eP,tp=new D,tf=new B,tm=new B,tv=new D;function tg(){Object.defineProperty(this,"id",{value:tu++}),this.uuid=x.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}tg.prototype=Object.assign(Object.create(g.prototype),{constructor:tg,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(ts(t)>65535?tr:tt)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,n){return this.attributes[t]=n,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,n,r){void 0===r&&(r=0),this.groups.push({start:t,count:n,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,n){this.drawRange.start=t,this.drawRange.count=n},applyMatrix4:function(t){var n=this.attributes.position;void 0!==n&&(n.applyMatrix4(t),n.needsUpdate=!0);var r=this.attributes.normal;if(void 0!==r){var i=new E().getNormalMatrix(t);r.applyNormalMatrix(i),r.needsUpdate=!0}var o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(t),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return th.makeRotationX(t),this.applyMatrix4(th),this},rotateY:function(t){return th.makeRotationY(t),this.applyMatrix4(th),this},rotateZ:function(t){return th.makeRotationZ(t),this.applyMatrix4(th),this},translate:function(t,n,r){return th.makeTranslation(t,n,r),this.applyMatrix4(th),this},scale:function(t,n,r){return th.makeScale(t,n,r),this.applyMatrix4(th),this},lookAt:function(t){return td.lookAt(t),td.updateMatrix(),this.applyMatrix4(td.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(tp).negate(),this.translate(tp.x,tp.y,tp.z),this},setFromPoints:function(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];n.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new to(n,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new B);var t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(Infinity,Infinity,Infinity));return}if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),n)for(var r=0,i=n.length;r<i;r++){var o=n[r];tf.setFromBufferAttribute(o),this.morphTargetsRelative?(tv.addVectors(this.boundingBox.min,tf.min),this.boundingBox.expandByPoint(tv),tv.addVectors(this.boundingBox.max,tf.max),this.boundingBox.expandByPoint(tv)):(this.boundingBox.expandByPoint(tf.min),this.boundingBox.expandByPoint(tf.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new K);var t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new D,1/0);return}if(t){var r=this.boundingSphere.center;if(tf.setFromBufferAttribute(t),n)for(var i=0,o=n.length;i<o;i++){var a=n[i];tm.setFromBufferAttribute(a),this.morphTargetsRelative?(tv.addVectors(tf.min,tm.min),tf.expandByPoint(tv),tv.addVectors(tf.max,tm.max),tf.expandByPoint(tv)):(tf.expandByPoint(tm.min),tf.expandByPoint(tm.max))}tf.getCenter(r);for(var s=0,l=0,c=t.count;l<c;l++)tv.fromBufferAttribute(t,l),s=Math.max(s,r.distanceToSquared(tv));if(n)for(var u=0,h=n.length;u<h;u++)for(var d=n[u],p=this.morphTargetsRelative,f=0,m=d.count;f<m;f++)tv.fromBufferAttribute(d,f),p&&(tp.fromBufferAttribute(t,f),tv.add(tp)),s=Math.max(s,r.distanceToSquared(tv));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var t=this.index,n=this.attributes;if(null===t||void 0===n.position||void 0===n.normal||void 0===n.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}var r=t.array,i=n.position.array,o=n.normal.array,a=n.uv.array,s=i.length/3;void 0===n.tangent&&this.setAttribute("tangent",new e6(new Float32Array(4*s),4));for(var l=n.tangent.array,c=[],u=[],h=0;h<s;h++)c[h]=new D,u[h]=new D;var d=new D,p=new D,f=new D,m=new w,v=new w,g=new w,y=new D,b=new D,A=this.groups;0===A.length&&(A=[{start:0,count:r.length}]);for(var x=0,E=A.length;x<E;++x)for(var M=A[x],_=M.start,T=M.count,S=_,C=_+T;S<C;S+=3)!function(t,n,r){d.fromArray(i,3*t),p.fromArray(i,3*n),f.fromArray(i,3*r),m.fromArray(a,2*t),v.fromArray(a,2*n),g.fromArray(a,2*r),p.sub(d),f.sub(d),v.sub(m),g.sub(m);var o=1/(v.x*g.y-g.x*v.y);isFinite(o)&&(y.copy(p).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(o),b.copy(f).multiplyScalar(v.x).addScaledVector(p,-g.x).multiplyScalar(o),c[t].add(y),c[n].add(y),c[r].add(y),u[t].add(b),u[n].add(b),u[r].add(b))}(r[S+0],r[S+1],r[S+2]);var L=new D,R=new D,P=new D,O=new D;function I(t){P.fromArray(o,3*t),O.copy(P);var n=c[t];L.copy(n),L.sub(P.multiplyScalar(P.dot(n))).normalize(),R.crossVectors(O,n);var r=R.dot(u[t]);l[4*t]=L.x,l[4*t+1]=L.y,l[4*t+2]=L.z,l[4*t+3]=r<0?-1:1}for(var B=0,F=A.length;B<F;++B)for(var k=A[B],N=k.start,U=k.count,H=N,G=N+U;H<G;H+=3)I(r[H+0]),I(r[H+1]),I(r[H+2])},computeVertexNormals:function(){var t=this.index,n=this.getAttribute("position");if(void 0!==n){var r=this.getAttribute("normal");if(void 0===r)r=new e6(new Float32Array(3*n.count),3),this.setAttribute("normal",r);else for(var i=0,o=r.count;i<o;i++)r.setXYZ(i,0,0,0);var a=new D,s=new D,l=new D,c=new D,u=new D,h=new D,d=new D,p=new D;if(t)for(var f=0,m=t.count;f<m;f+=3){var v=t.getX(f+0),g=t.getX(f+1),y=t.getX(f+2);a.fromBufferAttribute(n,v),s.fromBufferAttribute(n,g),l.fromBufferAttribute(n,y),d.subVectors(l,s),p.subVectors(a,s),d.cross(p),c.fromBufferAttribute(r,v),u.fromBufferAttribute(r,g),h.fromBufferAttribute(r,y),c.add(d),u.add(d),h.add(d),r.setXYZ(v,c.x,c.y,c.z),r.setXYZ(g,u.x,u.y,u.z),r.setXYZ(y,h.x,h.y,h.z)}else for(var b=0,A=n.count;b<A;b+=3)a.fromBufferAttribute(n,b+0),s.fromBufferAttribute(n,b+1),l.fromBufferAttribute(n,b+2),d.subVectors(l,s),p.subVectors(a,s),d.cross(p),r.setXYZ(b+0,d.x,d.y,d.z),r.setXYZ(b+1,d.x,d.y,d.z),r.setXYZ(b+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(t,n){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}void 0===n&&(n=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var i in r)if(void 0!==t.attributes[i])for(var o=r[i].array,a=t.attributes[i],s=a.array,l=a.itemSize*n,c=Math.min(s.length,o.length-l),u=0,h=l;u<c;u++,h++)o[h]=s[u];return this},normalizeNormals:function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)tv.fromBufferAttribute(t,n),tv.normalize(),t.setXYZ(n,tv.x,tv.y,tv.z)},toNonIndexed:function(){function t(t,n){for(var r=t.array,i=t.itemSize,o=t.normalized,a=new r.constructor(n.length*i),s=0,l=0,c=0,u=n.length;c<u;c++){s=n[c]*i;for(var h=0;h<i;h++)a[l++]=r[s++]}return new e6(a,i,o)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var n=new tg,r=this.index.array,i=this.attributes;for(var o in i){var a=t(i[o],r);n.setAttribute(o,a)}var s=this.morphAttributes;for(var l in s){for(var c=[],u=s[l],h=0,d=u.length;h<d;h++){var p=t(u[h],r);c.push(p)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,m=0,v=f.length;m<v;m++){var g=f[m];n.addGroup(g.start,g.count,g.materialIndex)}return n},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var n=this.parameters;for(var r in n)void 0!==n[r]&&(t[r]=n[r]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var o=this.attributes;for(var a in o){var s=o[a],l=s.toJSON(t.data);""!==s.name&&(l.name=s.name),t.data.attributes[a]=l}var c={},u=!1;for(var h in this.morphAttributes){for(var d=this.morphAttributes[h],p=[],f=0,m=d.length;f<m;f++){var v=d[f],g=v.toJSON(t.data);""!==v.name&&(g.name=v.name),p.push(g)}p.length>0&&(c[h]=p,u=!0)}u&&(t.data.morphAttributes=c,t.data.morphTargetsRelative=this.morphTargetsRelative);var y=this.groups;y.length>0&&(t.data.groups=JSON.parse(JSON.stringify(y)));var b=this.boundingSphere;return null!==b&&(t.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),t},clone:function(){return new tg().copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var n={};this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone(n));var i=t.attributes;for(var o in i){var a=i[o];this.setAttribute(o,a.clone(n))}var s=t.morphAttributes;for(var l in s){for(var c=[],u=s[l],h=0,d=u.length;h<d;h++)c.push(u[h].clone(n));this.morphAttributes[l]=c}this.morphTargetsRelative=t.morphTargetsRelative;for(var p=t.groups,f=0,m=p.length;f<m;f++){var v=p[f];this.addGroup(v.start,v.count,v.materialIndex)}var g=t.boundingBox;null!==g&&(this.boundingBox=g.clone());var y=t.boundingSphere;return null!==y&&(this.boundingSphere=y.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ty=new ea,tb=new eo,tA=new K,tx=new D,tw=new D,tE=new D,tM=new D,t_=new D,tT=new D,tS=new D,tC=new D,tL=new D,tR=new w,tP=new w,tD=new w,tO=new D,tI=new D;function tB(t,n){void 0===t&&(t=new tg),void 0===n&&(n=new e3),eP.call(this),this.type="Mesh",this.geometry=t,this.material=n,this.updateMorphTargets()}function tF(t,n,r,i,o,a,s,l,c,u,h,d){tx.fromBufferAttribute(o,u),tw.fromBufferAttribute(o,h),tE.fromBufferAttribute(o,d);var p=t.morphTargetInfluences;if(n.morphTargets&&a&&p){tS.set(0,0,0),tC.set(0,0,0),tL.set(0,0,0);for(var f=0,m=a.length;f<m;f++){var v=p[f],g=a[f];0!==v&&(tM.fromBufferAttribute(g,u),t_.fromBufferAttribute(g,h),tT.fromBufferAttribute(g,d),s?(tS.addScaledVector(tM,v),tC.addScaledVector(t_,v),tL.addScaledVector(tT,v)):(tS.addScaledVector(tM.sub(tx),v),tC.addScaledVector(t_.sub(tw),v),tL.addScaledVector(tT.sub(tE),v)))}tx.add(tS),tw.add(tC),tE.add(tL)}t.isSkinnedMesh&&(t.boneTransform(u,tx),t.boneTransform(h,tw),t.boneTransform(d,tE));var y=function(t,n,r,i,o,a,s,l){if(null===(1===n.side?i.intersectTriangle(s,a,o,!0,l):i.intersectTriangle(o,a,s,2!==n.side,l)))return null;tI.copy(l),tI.applyMatrix4(t.matrixWorld);var c=r.ray.origin.distanceTo(tI);return c<r.near||c>r.far?null:{distance:c,point:tI.clone(),object:t}}(t,n,r,i,tx,tw,tE,tO);if(y){l&&(tR.fromBufferAttribute(l,u),tP.fromBufferAttribute(l,h),tD.fromBufferAttribute(l,d),y.uv=eq.getUV(tO,tx,tw,tE,tR,tP,tD,new w)),c&&(tR.fromBufferAttribute(c,u),tP.fromBufferAttribute(c,h),tD.fromBufferAttribute(c,d),y.uv2=eq.getUV(tO,tx,tw,tE,tR,tP,tD,new w));var b=new e0(u,h,d);eq.getNormal(tx,tw,tE,b.normal),y.face=b}return y}tB.prototype=Object.assign(Object.create(eP.prototype),{constructor:tB,isMesh:!0,copy:function(t){return eP.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var n=t.morphAttributes,r=Object.keys(n);if(r.length>0){var i=n[r[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,a=i.length;o<a;o++){var s=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}else{var l=t.morphTargets;void 0!==l&&l.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,n){var r,i=this.geometry,o=this.material,a=this.matrixWorld;if(void 0!==o&&(null===i.boundingSphere&&i.computeBoundingSphere(),tA.copy(i.boundingSphere),tA.applyMatrix4(a),!1!==t.ray.intersectsSphere(tA))){if(ty.copy(a).invert(),tb.copy(t.ray).applyMatrix4(ty),null!==i.boundingBox&&!1===tb.intersectsBox(i.boundingBox))return;if(i.isBufferGeometry){var s=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,h=i.attributes.uv,d=i.attributes.uv2,p=i.groups,f=i.drawRange;if(null!==s){if(Array.isArray(o))for(var m=0,v=p.length;m<v;m++)for(var g=p[m],y=o[g.materialIndex],b=Math.max(g.start,f.start),A=Math.min(g.start+g.count,f.start+f.count),x=b;x<A;x+=3)(r=tF(this,y,t,tb,l,c,u,h,d,s.getX(x),s.getX(x+1),s.getX(x+2)))&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=g.materialIndex,n.push(r));else for(var w=Math.max(0,f.start),E=Math.min(s.count,f.start+f.count),M=w;M<E;M+=3)(r=tF(this,o,t,tb,l,c,u,h,d,s.getX(M),s.getX(M+1),s.getX(M+2)))&&(r.faceIndex=Math.floor(M/3),n.push(r))}else if(void 0!==l){if(Array.isArray(o))for(var _=0,T=p.length;_<T;_++)for(var S=p[_],C=o[S.materialIndex],L=Math.max(S.start,f.start),R=Math.min(S.start+S.count,f.start+f.count),P=L;P<R;P+=3)(r=tF(this,C,t,tb,l,c,u,h,d,P,P+1,P+2))&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=S.materialIndex,n.push(r));else for(var D=Math.max(0,f.start),O=Math.min(l.count,f.start+f.count),I=D;I<O;I+=3)(r=tF(this,o,t,tb,l,c,u,h,d,I,I+1,I+2))&&(r.faceIndex=Math.floor(I/3),n.push(r))}}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var tk=function(t){function n(n,r,i,o,a,s){void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),void 0===s&&(s=1),(l=t.call(this)||this).type="BoxGeometry",l.parameters={width:n,height:r,depth:i,widthSegments:o,heightSegments:a,depthSegments:s};var l,c=m(l);o=Math.floor(o),a=Math.floor(a);var u=[],h=[],d=[],p=[],f=0,v=0;function g(t,n,r,i,o,a,s,l,m,g,y){for(var b=a/m,A=s/g,x=a/2,w=s/2,E=l/2,M=m+1,_=g+1,T=0,S=0,C=new D,L=0;L<_;L++)for(var R=L*A-w,P=0;P<M;P++){var O=P*b-x;C[t]=O*i,C[n]=R*o,C[r]=E,h.push(C.x,C.y,C.z),C[t]=0,C[n]=0,C[r]=l>0?1:-1,d.push(C.x,C.y,C.z),p.push(P/m),p.push(1-L/g),T+=1}for(var I=0;I<g;I++)for(var B=0;B<m;B++){var F=f+B+M*I,k=f+B+M*(I+1),N=f+(B+1)+M*(I+1),U=f+(B+1)+M*I;u.push(F,k,U),u.push(k,N,U),S+=6}c.addGroup(v,S,y),v+=S,f+=T}return g("z","y","x",-1,-1,i,r,n,s=Math.floor(s),a,0),g("z","y","x",1,-1,i,r,-n,s,a,1),g("x","z","y",1,1,n,i,r,o,s,2),g("x","z","y",1,-1,n,i,-r,o,s,3),g("x","y","z",1,-1,n,r,i,o,a,4),g("x","y","z",-1,-1,n,r,-i,o,a,5),l.setIndex(u),l.setAttribute("position",new to(h,3)),l.setAttribute("normal",new to(d,3)),l.setAttribute("uv",new to(p,2)),l}return f(n,t),n}(tg);function tN(t){var n={};for(var r in t)for(var i in n[r]={},t[r]){var o=t[r][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture)?n[r][i]=o.clone():Array.isArray(o)?n[r][i]=o.slice():n[r][i]=o}return n}function tU(t){for(var n={},r=0;r<t.length;r++){var i=tN(t[r]);for(var o in i)n[o]=i[o]}return n}var tH={clone:tN,merge:tU};function tG(t){e2.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function tz(){eP.call(this),this.type="Camera",this.matrixWorldInverse=new ea,this.projectionMatrix=new ea,this.projectionMatrixInverse=new ea}function tj(t,n,r,i){void 0===t&&(t=50),void 0===n&&(n=1),void 0===r&&(r=.1),void 0===i&&(i=2e3),tz.call(this),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function tV(t,n,r){if(eP.call(this),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;var i=new tj(90,1,t,n);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new D(1,0,0)),this.add(i);var o=new tj(90,1,t,n);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new D(-1,0,0)),this.add(o);var a=new tj(90,1,t,n);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new D(0,1,0)),this.add(a);var s=new tj(90,1,t,n);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new D(0,-1,0)),this.add(s);var l=new tj(90,1,t,n);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new D(0,0,1)),this.add(l);var c=new tj(90,1,t,n);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new D(0,0,-1)),this.add(c),this.update=function(t,n){null===this.parent&&this.updateMatrixWorld();var u=t.xr.enabled,h=t.getRenderTarget();t.xr.enabled=!1;var d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(n,i),t.setRenderTarget(r,1),t.render(n,o),t.setRenderTarget(r,2),t.render(n,a),t.setRenderTarget(r,3),t.render(n,s),t.setRenderTarget(r,4),t.render(n,l),r.texture.generateMipmaps=d,t.setRenderTarget(r,5),t.render(n,c),t.setRenderTarget(h),t.xr.enabled=u}}function tW(t,n,r,i,o,a,s,l,c,u){t=void 0!==t?t:[],n=void 0!==n?n:301,s=void 0!==s?s:1022,T.call(this,t,n,r,i,o,a,s,l,c,u),this.flipY=!1,this._needsFlipEnvMap=!0}tG.prototype=Object.create(e2.prototype),tG.prototype.constructor=tG,tG.prototype.isShaderMaterial=!0,tG.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=tN(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},tG.prototype.toJSON=function(t){var n=e2.prototype.toJSON.call(this,t);for(var r in n.glslVersion=this.glslVersion,n.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?n.uniforms[r]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?n.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?n.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?n.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?n.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?n.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?n.uniforms[r]={type:"m4",value:i.toArray()}:n.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;var o={};for(var a in this.extensions)!0===this.extensions[a]&&(o[a]=!0);return Object.keys(o).length>0&&(n.extensions=o),n},tz.prototype=Object.assign(Object.create(eP.prototype),{constructor:tz,isCamera:!0,copy:function(t,n){return eP.prototype.copy.call(this,t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new D),this.updateWorldMatrix(!0,!1);var n=this.matrixWorld.elements;return t.set(-n[8],-n[9],-n[10]).normalize()},updateMatrixWorld:function(t){eP.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,n){eP.prototype.updateWorldMatrix.call(this,t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}}),tj.prototype=Object.assign(Object.create(tz.prototype),{constructor:tj,isPerspectiveCamera:!0,copy:function(t,n){return tz.prototype.copy.call(this,t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var n=.5*this.getFilmHeight()/t;this.fov=2*x.RAD2DEG*Math.atan(n),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*x.DEG2RAD*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*x.RAD2DEG*Math.atan(Math.tan(.5*x.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,n,r,i,o,a){this.aspect=t/n,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,n=t*Math.tan(.5*x.DEG2RAD*this.fov)/this.zoom,r=2*n,i=this.aspect*r,o=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var s=a.fullWidth,l=a.fullHeight;o+=a.offsetX*i/s,n-=a.offsetY*r/l,i*=a.width/s,r*=a.height/l}var c=this.filmOffset;0!==c&&(o+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,n,n-r,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var n=eP.prototype.toJSON.call(this,t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}),tV.prototype=Object.create(eP.prototype),tV.prototype.constructor=tV,tW.prototype=Object.create(T.prototype),tW.prototype.constructor=tW,tW.prototype.isCubeTexture=!0,Object.defineProperty(tW.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var tq=function(t){function n(n,r,i){var o;return Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),Object.defineProperty(m(o=t.call(this,n,n,r)||this),"isWebGLCubeRenderTarget",{value:!0}),r=r||{},o.texture=new tW(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),o.texture._needsFlipEnvMap=!1,o}f(n,t);var r=n.prototype;return r.fromEquirectangularTexture=function(t,n){this.texture.type=n.type,this.texture.format=1023,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;var r=new tk(5,5,5),i=new tG({name:"CubemapFromEquirect",uniforms:tN({tEquirect:{value:null}}),vertexShader:"\n\n				varying vec3 vWorldDirection;\n\n				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n				}\n\n				void main() {\n\n					vWorldDirection = transformDirection( position, modelMatrix );\n\n					#include <begin_vertex>\n					#include <project_vertex>\n\n				}\n			",fragmentShader:"\n\n				uniform sampler2D tEquirect;\n\n				varying vec3 vWorldDirection;\n\n				#include <common>\n\n				void main() {\n\n					vec3 direction = normalize( vWorldDirection );\n\n					vec2 sampleUV = equirectUv( direction );\n\n					gl_FragColor = texture2D( tEquirect, sampleUV );\n\n				}\n			",side:1,blending:0});i.uniforms.tEquirect.value=n;var o=new tB(r,i),a=n.minFilter;return 1008===n.minFilter&&(n.minFilter=1006),new tV(1,10,this).update(t,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this},r.clear=function(t,n,r,i){for(var o=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(n,r,i);t.setRenderTarget(o)},n}(L);function tX(t,n,r,i,o,a,s,l,c,u,h,d){T.call(this,null,a,s,l,c,u,i,o,h,d),this.image={data:t||null,width:n||1,height:r||1},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==u?u:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}tX.prototype=Object.create(T.prototype),tX.prototype.constructor=tX,tX.prototype.isDataTexture=!0;var tY=new K,tQ=new D,tZ=function(){function t(t,n,r,i,o,a){this.planes=[void 0!==t?t:new eB,void 0!==n?n:new eB,void 0!==r?r:new eB,void 0!==i?i:new eB,void 0!==o?o:new eB,void 0!==a?a:new eB]}var n=t.prototype;return n.set=function(t,n,r,i,o,a){var s=this.planes;return s[0].copy(t),s[1].copy(n),s[2].copy(r),s[3].copy(i),s[4].copy(o),s[5].copy(a),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){for(var n=this.planes,r=0;r<6;r++)n[r].copy(t.planes[r]);return this},n.setFromProjectionMatrix=function(t){var n=this.planes,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],u=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15];return n[0].setComponents(s-i,h-l,m-d,b-v).normalize(),n[1].setComponents(s+i,h+l,m+d,b+v).normalize(),n[2].setComponents(s+o,h+c,m+p,b+g).normalize(),n[3].setComponents(s-o,h-c,m-p,b-g).normalize(),n[4].setComponents(s-a,h-u,m-f,b-y).normalize(),n[5].setComponents(s+a,h+u,m+f,b+y).normalize(),this},n.intersectsObject=function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),tY.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(tY)},n.intersectsSprite=function(t){return tY.center.set(0,0,0),tY.radius=.7071067811865476,tY.applyMatrix4(t.matrixWorld),this.intersectsSphere(tY)},n.intersectsSphere=function(t){for(var n=this.planes,r=t.center,i=-t.radius,o=0;o<6;o++)if(n[o].distanceToPoint(r)<i)return!1;return!0},n.intersectsBox=function(t){for(var n=this.planes,r=0;r<6;r++){var i=n[r];if(tQ.x=i.normal.x>0?t.max.x:t.min.x,tQ.y=i.normal.y>0?t.max.y:t.min.y,tQ.z=i.normal.z>0?t.max.z:t.min.z,0>i.distanceToPoint(tQ))return!1}return!0},n.containsPoint=function(t){for(var n=this.planes,r=0;r<6;r++)if(0>n[r].distanceToPoint(t))return!1;return!0},t}();function tK(){var t=null,n=!1,r=null,i=null;function o(n,a){r(n,a),i=t.requestAnimationFrame(o)}return{start:function(){!0!==n&&null!==r&&(i=t.requestAnimationFrame(o),n=!0)},stop:function(){t.cancelAnimationFrame(i),n=!1},setAnimationLoop:function(t){r=t},setContext:function(n){t=n}}}function tJ(t,n){var r=n.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=i.get(n);r&&(t.deleteBuffer(r.buffer),i.delete(n))},update:function(n,o){if(n.isGLBufferAttribute){var a,s,l,c,u,h,d,p,f,m=i.get(n);(!m||m.version<n.version)&&i.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version});return}n.isInterleavedBufferAttribute&&(n=n.data);var v=i.get(n);void 0===v?i.set(n,(s=(a=n).array,l=a.usage,c=t.createBuffer(),t.bindBuffer(o,c),t.bufferData(o,s,l),a.onUploadCallback(),u=5126,s instanceof Float32Array?u=5126:s instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):s instanceof Uint16Array?a.isFloat16BufferAttribute?r?u=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):u=5123:s instanceof Int16Array?u=5122:s instanceof Uint32Array?u=5125:s instanceof Int32Array?u=5124:s instanceof Int8Array?u=5120:s instanceof Uint8Array&&(u=5121),{buffer:c,type:u,bytesPerElement:s.BYTES_PER_ELEMENT,version:a.version})):v.version<n.version&&(h=v.buffer,p=(d=n).array,f=d.updateRange,t.bindBuffer(o,h),-1===f.count?t.bufferSubData(o,0,p):(r?t.bufferSubData(o,f.offset*p.BYTES_PER_ELEMENT,p,f.offset,f.count):t.bufferSubData(o,f.offset*p.BYTES_PER_ELEMENT,p.subarray(f.offset,f.offset+f.count)),f.count=-1),v.version=n.version)}}}var t$=function(t){function n(n,r,i,o){void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=1),(a=t.call(this)||this).type="PlaneGeometry",a.parameters={width:n,height:r,widthSegments:i,heightSegments:o};for(var a,s=n/2,l=r/2,c=Math.floor(i),u=Math.floor(o),h=c+1,d=u+1,p=n/c,f=r/u,m=[],v=[],g=[],y=[],b=0;b<d;b++)for(var A=b*f-l,x=0;x<h;x++){var w=x*p-s;v.push(w,-A,0),g.push(0,0,1),y.push(x/c),y.push(1-b/u)}for(var E=0;E<u;E++)for(var M=0;M<c;M++){var _=M+h*E,T=M+h*(E+1),S=M+1+h*(E+1),C=M+1+h*E;m.push(_,T,C),m.push(T,S,C)}return a.setIndex(m),a.setAttribute("position",new to(v,3)),a.setAttribute("normal",new to(g,3)),a.setAttribute("uv",new to(y,2)),a}return f(n,t),n}(tg),t0={alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	return vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n#else\n	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n	}\n	return 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n	return Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + viewDir );\n	float dotNL = saturate( dot( normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	return specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	vec3 FssEss = F * brdf.x + brdf.y;\n	float Ess = brdf.x + brdf.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n	float invAlpha = 1.0 / roughness;\n	float cos2h = NoH * NoH;\n	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n	vec3 N = geometry.normal;\n	vec3 V = geometry.viewDir;\n	vec3 H = normalize( V + L );\n	float dotNH = saturate( dot( N, H ) );\n	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 );\n		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n		plane = clippingPlanes[ i ];\n		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n	}\n	#pragma unroll_loop_end\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		#pragma unroll_loop_start\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		#pragma unroll_loop_end\n		if ( clipped ) discard;\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n#ifdef CLEARCOAT\n	vec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n	return dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_maxMipLevel 8.0\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_maxTileSize 256.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n		vec2 f = fract( uv );\n		uv += 0.5 - f;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		if ( mipInt < cubeUV_maxMipLevel ) {\n			uv.y += 2.0 * cubeUV_maxTileSize;\n		}\n		uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n		uv *= texelSize;\n		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x += texelSize;\n		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.y += texelSize;\n		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x -= texelSize;\n		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		vec3 tm = mix( tl, tr, f.x );\n		vec3 bm = mix( bl, br, f.x );\n		return mix( tm, bm, f.y );\n	}\n	#define r0 1.0\n	#define v0 0.339\n	#define m0 - 2.0\n	#define r1 0.8\n	#define v1 0.276\n	#define m1 - 1.0\n	#define r4 0.4\n	#define v4 0.046\n	#define m4 2.0\n	#define r5 0.305\n	#define v5 0.016\n	#define m5 3.0\n	#define r6 0.21\n	#define v6 0.0038\n	#define m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= r1 ) {\n			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n		} else if ( roughness >= r4 ) {\n			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n		} else if ( roughness >= r5 ) {\n			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n		} else if ( roughness >= r6 ) {\n			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n	return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n	float maxComponent = max( max( value.r, value.g ), value.b );\n	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n	M = ceil( M * 255.0 ) / 255.0;\n	return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float D = max( maxRange / maxRGB, 1.0 );\n	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n	vec4 vResult;\n	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n	vResult.w = fract( Le );\n	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n	return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n	float Le = value.z * 255.0 + value.w;\n	vec3 Xp_Y_XYZp;\n	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n	return vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifndef ENVMAP_TYPE_CUBE_UV\n		envColor = envMapTexelToLinear( envColor );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform int maxMipLevel;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n	#ifdef ENVMAP_MODE_REFRACTION\n		uniform float refractionRatio;\n	#endif\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float sigma = PI * roughness * roughness / ( 1.0 + roughness );\n		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n		#else\n			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n		#endif\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n		#endif\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	fogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float fogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return texture2D( gradientMap, coord ).rgb;\n	#else\n		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n	#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n	vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n	vIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		directLight.color = pointLight.color;\n		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n		directLight.visible = ( directLight.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( angleCos > spotLight.coneCos ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )	(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float specularRoughness;\n	vec3 specularColor;\n#ifdef CLEARCOAT\n	float clearcoat;\n	float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	vec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometry.normal;\n		vec3 viewDir = geometry.viewDir;\n		vec3 position = geometry.position;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.specularRoughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(		0, 1,		0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	#ifdef CLEARCOAT\n		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = ccDotNL * directLight.color;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			ccIrradiance *= PI;\n		#endif\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	#ifdef USE_SHEEN\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n			material.specularRoughness,\n			directLight.direction,\n			geometry,\n			material.sheenColor\n		);\n	#else\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n	#endif\n	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef CLEARCOAT\n		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n		float ccDotNL = ccDotNV;\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	float clearcoatInv = 1.0 - clearcoatDHR;\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n	geometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointDirectLightIrradiance( pointLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotDirectLightIrradiance( spotLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	irradiance += getLightProbeIrradiance( lightProbe, geometry );\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n	#ifdef CLEARCOAT\n		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n		varying float vIsPerspective;\n	#else\n		uniform float logDepthBufFC;\n	#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n	#else\n		if ( isPerspectiveMatrix( projectionMatrix ) ) {\n			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n			gl_Position.z *= gl_Position.w;\n		}\n	#endif\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, uv );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	uniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	uniform float morphTargetBaseInfluence;\n	#ifndef USE_MORPHNORMALS\n		uniform float morphTargetInfluences[ 8 ];\n	#else\n		uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	transformed += morphTarget0 * morphTargetInfluences[ 0 ];\n	transformed += morphTarget1 * morphTargetInfluences[ 1 ];\n	transformed += morphTarget2 * morphTargetInfluences[ 2 ];\n	transformed += morphTarget3 * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n		transformed += morphTarget4 * morphTargetInfluences[ 4 ];\n		transformed += morphTarget5 * morphTargetInfluences[ 5 ];\n		transformed += morphTarget6 * morphTargetInfluences[ 6 ];\n		transformed += morphTarget7 * morphTargetInfluences[ 7 ];\n	#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#endif\n	#ifdef USE_TANGENT\n		vec3 tangent = normalize( vTangent );\n		vec3 bitangent = normalize( vBitangent );\n		#ifdef DOUBLE_SIDED\n			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		#endif\n		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n			mat3 vTBN = mat3( tangent, bitangent, normal );\n		#endif\n	#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	#ifdef USE_TANGENT\n		normal = normalize( vTBN * mapN );\n	#else\n		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n	#endif\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		float scale = sign( st1.t * st0.s - st0.t * st1.s );\n		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n		vec3 N = normalize( surf_norm );\n		mat3 tsn = mat3( S, T, N );\n		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		return normalize( tsn * mapN );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n	vec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	#ifdef USE_TANGENT\n		clearcoatNormal = normalize( vTBN * clearcoatMapN );\n	#else\n		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n	#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n	return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n							f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n							f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return shadow;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;\n		vec3 bd3D = normalize( lightToPosition );\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		vec4 shadowWorldPosition;\n	#endif\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform highp sampler2D boneTexture;\n		uniform int boneTextureSize;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureSize ) );\n			float y = floor( j / float( boneTextureSize ) );\n			float dx = 1.0 / float( boneTextureSize );\n			float dy = 1.0 / float( boneTextureSize );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,	1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n	totalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n	uniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n	varying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n	#ifdef UVS_VERTEX_ONLY\n		vec2 vUv;\n	#else\n		varying vec2 vUv;\n	#endif\n	uniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n	uniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	vec3 vReflect = vWorldDirection;\n	#include <envmap_fragment>\n	gl_FragColor = envColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	vec4 texColor = texture2D( tEquirect, sampleUV );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n	\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	#ifdef DOUBLE_SIDED\n		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n	#else\n		reflectedLight.indirectDiffuse += vIndirectFront;\n	#endif\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n		matcapColor = matcapTexelToLinear( matcapColor );\n	#else\n		vec4 matcapColor = vec4( 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#ifndef FLAT_SHADED\n		vNormal = normalize( transformedNormal );\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define REFLECTIVITY\n	#define CLEARCOAT\n	#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n	uniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n	uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#ifdef TRANSMISSION\n		float totalTransmission = transmission;\n	#endif\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <transmissionmap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#ifdef TRANSMISSION\n		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n	#endif\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}"},t1={common:{diffuse:{value:new e$(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new E},uv2Transform:{value:new E},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new w(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new e$(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new e$(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new E}},sprite:{diffuse:{value:new e$(15658734)},opacity:{value:1},center:{value:new w(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new E}}},t2={basic:{uniforms:tU([t1.common,t1.specularmap,t1.envmap,t1.aomap,t1.lightmap,t1.fog]),vertexShader:t0.meshbasic_vert,fragmentShader:t0.meshbasic_frag},lambert:{uniforms:tU([t1.common,t1.specularmap,t1.envmap,t1.aomap,t1.lightmap,t1.emissivemap,t1.fog,t1.lights,{emissive:{value:new e$(0)}}]),vertexShader:t0.meshlambert_vert,fragmentShader:t0.meshlambert_frag},phong:{uniforms:tU([t1.common,t1.specularmap,t1.envmap,t1.aomap,t1.lightmap,t1.emissivemap,t1.bumpmap,t1.normalmap,t1.displacementmap,t1.fog,t1.lights,{emissive:{value:new e$(0)},specular:{value:new e$(1118481)},shininess:{value:30}}]),vertexShader:t0.meshphong_vert,fragmentShader:t0.meshphong_frag},standard:{uniforms:tU([t1.common,t1.envmap,t1.aomap,t1.lightmap,t1.emissivemap,t1.bumpmap,t1.normalmap,t1.displacementmap,t1.roughnessmap,t1.metalnessmap,t1.fog,t1.lights,{emissive:{value:new e$(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:t0.meshphysical_vert,fragmentShader:t0.meshphysical_frag},toon:{uniforms:tU([t1.common,t1.aomap,t1.lightmap,t1.emissivemap,t1.bumpmap,t1.normalmap,t1.displacementmap,t1.gradientmap,t1.fog,t1.lights,{emissive:{value:new e$(0)}}]),vertexShader:t0.meshtoon_vert,fragmentShader:t0.meshtoon_frag},matcap:{uniforms:tU([t1.common,t1.bumpmap,t1.normalmap,t1.displacementmap,t1.fog,{matcap:{value:null}}]),vertexShader:t0.meshmatcap_vert,fragmentShader:t0.meshmatcap_frag},points:{uniforms:tU([t1.points,t1.fog]),vertexShader:t0.points_vert,fragmentShader:t0.points_frag},dashed:{uniforms:tU([t1.common,t1.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:t0.linedashed_vert,fragmentShader:t0.linedashed_frag},depth:{uniforms:tU([t1.common,t1.displacementmap]),vertexShader:t0.depth_vert,fragmentShader:t0.depth_frag},normal:{uniforms:tU([t1.common,t1.bumpmap,t1.normalmap,t1.displacementmap,{opacity:{value:1}}]),vertexShader:t0.normal_vert,fragmentShader:t0.normal_frag},sprite:{uniforms:tU([t1.sprite,t1.fog]),vertexShader:t0.sprite_vert,fragmentShader:t0.sprite_frag},background:{uniforms:{uvTransform:{value:new E},t2D:{value:null}},vertexShader:t0.background_vert,fragmentShader:t0.background_frag},cube:{uniforms:tU([t1.envmap,{opacity:{value:1}}]),vertexShader:t0.cube_vert,fragmentShader:t0.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:t0.equirect_vert,fragmentShader:t0.equirect_frag},distanceRGBA:{uniforms:tU([t1.common,t1.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:t0.distanceRGBA_vert,fragmentShader:t0.distanceRGBA_frag},shadow:{uniforms:tU([t1.lights,t1.fog,{color:{value:new e$(0)},opacity:{value:1}}]),vertexShader:t0.shadow_vert,fragmentShader:t0.shadow_frag}};function t3(t,n,r,i,o){var a,s,l=new e$(0),c=0,u=null,h=0,d=null;function p(t,n){r.buffers.color.setClear(t.r,t.g,t.b,n,o)}return{getClearColor:function(){return l},setClearColor:function(t,n){void 0===n&&(n=1),l.set(t),p(l,c=n)},getClearAlpha:function(){return c},setClearAlpha:function(t){p(l,c=t)},render:function(r,o,f,m){var v=!0===o.isScene?o.background:null;v&&v.isTexture&&(v=n.get(v));var g=t.xr,y=g.getSession&&g.getSession();y&&"additive"===y.environmentBlendMode&&(v=null),null===v?p(l,c):v&&v.isColor&&(p(v,1),m=!0),(t.autoClear||m)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),v&&(v.isCubeTexture||v.isWebGLCubeRenderTarget||306===v.mapping)?(void 0===s&&((s=new tB(new tk(1,1,1),new tG({name:"BackgroundCubeMaterial",uniforms:tN(t2.cube.uniforms),vertexShader:t2.cube.vertexShader,fragmentShader:t2.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(t,n,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),v.isWebGLCubeRenderTarget&&(v=v.texture),s.material.uniforms.envMap.value=v,s.material.uniforms.flipEnvMap.value=v.isCubeTexture&&v._needsFlipEnvMap?-1:1,(u!==v||h!==v.version||d!==t.toneMapping)&&(s.material.needsUpdate=!0,u=v,h=v.version,d=t.toneMapping),r.unshift(s,s.geometry,s.material,0,0,null)):v&&v.isTexture&&(void 0===a&&((a=new tB(new t$(2,2),new tG({name:"BackgroundMaterial",uniforms:tN(t2.background.uniforms),vertexShader:t2.background.vertexShader,fragmentShader:t2.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=v,!0===v.matrixAutoUpdate&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),(u!==v||h!==v.version||d!==t.toneMapping)&&(a.material.needsUpdate=!0,u=v,h=v.version,d=t.toneMapping),r.unshift(a,a.geometry,a.material,0,0,null))}}}function t4(t,n,r,i){var o=t.getParameter(34921),a=i.isWebGL2?null:n.get("OES_vertex_array_object"),s=i.isWebGL2||null!==a,l={},c=p(null),u=c;function h(n){return i.isWebGL2?t.bindVertexArray(n):a.bindVertexArrayOES(n)}function d(n){return i.isWebGL2?t.deleteVertexArray(n):a.deleteVertexArrayOES(n)}function p(t){for(var n=[],r=[],i=[],a=0;a<o;a++)n[a]=0,r[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:n,enabledAttributes:r,attributeDivisors:i,object:t,attributes:{},index:null}}function f(){for(var t=u.newAttributes,n=0,r=t.length;n<r;n++)t[n]=0}function m(t){v(t,0)}function v(r,o){var a=u.newAttributes,s=u.enabledAttributes,l=u.attributeDivisors;a[r]=1,0===s[r]&&(t.enableVertexAttribArray(r),s[r]=1),l[r]!==o&&((i.isWebGL2?t:n.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,o),l[r]=o)}function g(){for(var n=u.newAttributes,r=u.enabledAttributes,i=0,o=r.length;i<o;i++)r[i]!==n[i]&&(t.disableVertexAttribArray(i),r[i]=0)}function y(n,r,o,a,s,l){!0===i.isWebGL2&&(5124===o||5125===o)?t.vertexAttribIPointer(n,r,o,s,l):t.vertexAttribPointer(n,r,o,a,s,l)}function b(){A(),u!==c&&h((u=c).object)}function A(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(o,c,d,b,A){var x=!1;if(s){var w,E,M,_,T=(w=!0===c.wireframe,void 0===(E=l[b.id])&&(E={},l[b.id]=E),void 0===(M=E[d.id])&&(M={},E[d.id]=M),void 0===(_=M[w])&&(_=p(i.isWebGL2?t.createVertexArray():a.createVertexArrayOES()),M[w]=_),_);u!==T&&h((u=T).object),(x=function(t,n){var r=u.attributes,i=t.attributes,o=0;for(var a in i){var s=r[a],l=i[a];if(void 0===s||s.attribute!==l||s.data!==l.data)return!0;o++}return u.attributesNum!==o||u.index!==n}(b,A))&&function(t,n){var r={},i=t.attributes,o=0;for(var a in i){var s=i[a],l={};l.attribute=s,s.data&&(l.data=s.data),r[a]=l,o++}u.attributes=r,u.attributesNum=o,u.index=n}(b,A)}else{var S=!0===c.wireframe;(u.geometry!==b.id||u.program!==d.id||u.wireframe!==S)&&(u.geometry=b.id,u.program=d.id,u.wireframe=S,x=!0)}!0===o.isInstancedMesh&&(x=!0),null!==A&&r.update(A,34963),x&&(function(o,a,s,l){if(!1!==i.isWebGL2||!o.isInstancedMesh&&!l.isInstancedBufferGeometry||null!==n.get("ANGLE_instanced_arrays")){f();var c=l.attributes,u=s.getAttributes(),h=a.defaultAttributeValues;for(var d in u){var p=u[d];if(p>=0){var b=c[d];if(void 0!==b){var A=b.normalized,x=b.itemSize,w=r.get(b);if(void 0===w)continue;var E=w.buffer,M=w.type,_=w.bytesPerElement;if(b.isInterleavedBufferAttribute){var T=b.data,S=T.stride,C=b.offset;T&&T.isInstancedInterleavedBuffer?(v(p,T.meshPerAttribute),void 0===l._maxInstanceCount&&(l._maxInstanceCount=T.meshPerAttribute*T.count)):m(p),t.bindBuffer(34962,E),y(p,x,M,A,S*_,C*_)}else b.isInstancedBufferAttribute?(v(p,b.meshPerAttribute),void 0===l._maxInstanceCount&&(l._maxInstanceCount=b.meshPerAttribute*b.count)):m(p),t.bindBuffer(34962,E),y(p,x,M,A,0,0)}else if("instanceMatrix"===d){var L=r.get(o.instanceMatrix);if(void 0===L)continue;var R=L.buffer,P=L.type;v(p+0,1),v(p+1,1),v(p+2,1),v(p+3,1),t.bindBuffer(34962,R),t.vertexAttribPointer(p+0,4,P,!1,64,0),t.vertexAttribPointer(p+1,4,P,!1,64,16),t.vertexAttribPointer(p+2,4,P,!1,64,32),t.vertexAttribPointer(p+3,4,P,!1,64,48)}else if("instanceColor"===d){var D=r.get(o.instanceColor);if(void 0===D)continue;var O=D.buffer,I=D.type;v(p,1),t.bindBuffer(34962,O),t.vertexAttribPointer(p,3,I,!1,12,0)}else if(void 0!==h){var B=h[d];if(void 0!==B)switch(B.length){case 2:t.vertexAttrib2fv(p,B);break;case 3:t.vertexAttrib3fv(p,B);break;case 4:t.vertexAttrib4fv(p,B);break;default:t.vertexAttrib1fv(p,B)}}}}g()}}(o,c,d,b),null!==A&&t.bindBuffer(34963,r.get(A).buffer))},reset:b,resetDefaultState:A,dispose:function(){for(var t in b(),l){var n=l[t];for(var r in n){var i=n[r];for(var o in i)d(i[o].object),delete i[o];delete n[r]}delete l[t]}},releaseStatesOfGeometry:function(t){if(void 0!==l[t.id]){var n=l[t.id];for(var r in n){var i=n[r];for(var o in i)d(i[o].object),delete i[o];delete n[r]}delete l[t.id]}},releaseStatesOfProgram:function(t){for(var n in l){var r=l[n];if(void 0!==r[t.id]){var i=r[t.id];for(var o in i)d(i[o].object),delete i[o];delete r[t.id]}}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:g}}function t5(t,n,r,i){var o,a=i.isWebGL2;this.setMode=function(t){o=t},this.render=function(n,i){t.drawArrays(o,n,i),r.update(i,o,1)},this.renderInstances=function(i,s,l){var c,u;if(0!==l){if(a)c=t,u="drawArraysInstanced";else if(c=n.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===c){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}c[u](o,i,s,l),r.update(s,o,l)}}}function t6(t,n,r){function i(n){if("highp"===n){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";n="mediump"}return"mediump"===n&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o,a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,s=void 0!==r.precision?r.precision:"highp",l=i(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);var c=!0===r.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),v=t.getParameter(36348),g=t.getParameter(36349),y=h>0,b=a||!!n.get("OES_texture_float"),A=a?t.getParameter(36183):0;return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==o)return o;var r=n.get("EXT_texture_filter_anisotropic");return o=null!==r?t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:A}}function t7(t){var n=this,r=null,i=0,o=!1,a=!1,s=new eB,l=new E,c={value:null,needsUpdate:!1};function u(){c.value!==r&&(c.value=r,c.needsUpdate=i>0),n.numPlanes=i,n.numIntersection=0}function h(t,r,i,o){var a=null!==t?t.length:0,u=null;if(0!==a){if(u=c.value,!0!==o||null===u){var h=i+4*a,d=r.matrixWorldInverse;l.getNormalMatrix(d),(null===u||u.length<h)&&(u=new Float32Array(h));for(var p=0,f=i;p!==a;++p,f+=4)s.copy(t[p]).applyMatrix4(d,l),s.normal.toArray(u,f),u[f+3]=s.constant}c.value=u,c.needsUpdate=!0}return n.numPlanes=a,n.numIntersection=0,u}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=h(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,h(null)},this.endShadows=function(){a=!1,u()},this.setState=function(n,s,l){var d=n.clippingPlanes,p=n.clipIntersection,f=n.clipShadows,m=t.get(n);if(o&&null!==d&&0!==d.length&&(!a||f)){var v=a?0:i,g=4*v,y=m.clippingState||null;c.value=y,y=h(d,s,g,l);for(var b=0;b!==g;++b)y[b]=r[b];m.clippingState=y,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=v}else a?h(null):u()}}function t8(t){var n=new WeakMap;function r(t,n){return 303===n?t.mapping=301:304===n&&(t.mapping=302),t}function i(t){var r=t.target;r.removeEventListener("dispose",i);var o=n.get(r);void 0!==o&&(n.delete(r),o.dispose())}return{get:function(o){if(o&&o.isTexture){var a=o.mapping;if(303===a||304===a){if(n.has(o))return r(n.get(o).texture,o.mapping);var s=o.image;if(!s||!(s.height>0))return null;var l=t.getRenderList(),c=t.getRenderTarget(),u=new tq(s.height/2);return u.fromEquirectangularTexture(t,o),n.set(o,u),t.setRenderTarget(c),t.setRenderList(l),o.addEventListener("dispose",i),r(u.texture,o.mapping)}}return o},dispose:function(){n=new WeakMap}}}function t9(t){var n={};function r(r){var i;if(void 0!==n[r])return n[r];switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return n[r]=i,i}return{has:function(t){return null!==r(t)},init:function(t){t.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float")},get:function(t){var n=r(t);return null===n&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),n}}}function ne(t,n,r,i){var o={},a=new WeakMap;function s(t){var l=t.target;for(var c in null!==l.index&&n.remove(l.index),l.attributes)n.remove(l.attributes[c]);l.removeEventListener("dispose",s),delete o[l.id];var u=a.get(l);u&&(n.remove(u),a.delete(l)),i.releaseStatesOfGeometry(l),!0===l.isInstancedBufferGeometry&&delete l._maxInstanceCount,r.memory.geometries--}function l(t){var r=[],i=t.index,o=t.attributes.position,s=0;if(null!==i){var l=i.array;s=i.version;for(var c=0,u=l.length;c<u;c+=3){var h=l[c+0],d=l[c+1],p=l[c+2];r.push(h,d,d,p,p,h)}}else{var f=o.array;s=o.version;for(var m=0,v=f.length/3-1;m<v;m+=3){var g=m+0,y=m+1,b=m+2;r.push(g,y,y,b,b,g)}}var A=new(ts(r)>65535?tr:tt)(r,1);A.version=s;var x=a.get(t);x&&n.remove(x),a.set(t,A)}return{get:function(t,n){return!0===o[n.id]||(n.addEventListener("dispose",s),o[n.id]=!0,r.memory.geometries++),n},update:function(t){var r=t.attributes;for(var i in r)n.update(r[i],34962);var o=t.morphAttributes;for(var a in o)for(var s=o[a],l=0,c=s.length;l<c;l++)n.update(s[l],34962)},getWireframeAttribute:function(t){var n=a.get(t);if(n){var r=t.index;null!==r&&n.version<r.version&&l(t)}else l(t);return a.get(t)}}}function nt(t,n,r,i){var o,a,s,l=i.isWebGL2;this.setMode=function(t){o=t},this.setIndex=function(t){a=t.type,s=t.bytesPerElement},this.render=function(n,i){t.drawElements(o,i,a,n*s),r.update(i,o,1)},this.renderInstances=function(i,c,u){var h,d;if(0!==u){if(l)h=t,d="drawElementsInstanced";else if(h=n.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===h){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[d](o,c,a,i*s,u),r.update(c,o,u)}}}function nn(t){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(t,r,i){switch(n.calls++,r){case 4:n.triangles+=t/3*i;break;case 1:n.lines+=t/2*i;break;case 3:n.lines+=i*(t-1);break;case 2:n.lines+=i*t;break;case 0:n.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function nr(t,n){return t[0]-n[0]}function ni(t,n){return Math.abs(n[1])-Math.abs(t[1])}function no(t){for(var n={},r=new Float32Array(8),i=[],o=0;o<8;o++)i[o]=[o,0];return{update:function(o,a,s,l){var c=o.morphTargetInfluences,u=void 0===c?0:c.length,h=n[a.id];if(void 0===h){h=[];for(var d=0;d<u;d++)h[d]=[d,0];n[a.id]=h}for(var p=0;p<u;p++){var f=h[p];f[0]=p,f[1]=c[p]}h.sort(ni);for(var m=0;m<8;m++)m<u&&h[m][1]?(i[m][0]=h[m][0],i[m][1]=h[m][1]):(i[m][0]=Number.MAX_SAFE_INTEGER,i[m][1]=0);i.sort(nr);for(var v=s.morphTargets&&a.morphAttributes.position,g=s.morphNormals&&a.morphAttributes.normal,y=0,b=0;b<8;b++){var A=i[b],x=A[0],w=A[1];x!==Number.MAX_SAFE_INTEGER&&w?(v&&a.getAttribute("morphTarget"+b)!==v[x]&&a.setAttribute("morphTarget"+b,v[x]),g&&a.getAttribute("morphNormal"+b)!==g[x]&&a.setAttribute("morphNormal"+b,g[x]),r[b]=w,y+=w):(v&&!0===a.hasAttribute("morphTarget"+b)&&a.deleteAttribute("morphTarget"+b),g&&!0===a.hasAttribute("morphNormal"+b)&&a.deleteAttribute("morphNormal"+b),r[b]=0)}var E=a.morphTargetsRelative?1:1-y;l.getUniforms().setValue(t,"morphTargetBaseInfluence",E),l.getUniforms().setValue(t,"morphTargetInfluences",r)}}}function na(t,n,r,i){var o=new WeakMap;function a(t){var n=t.target;n.removeEventListener("dispose",a),r.remove(n.instanceMatrix),null!==n.instanceColor&&r.remove(n.instanceColor)}return{update:function(t){var s=i.render.frame,l=t.geometry,c=n.get(t,l);return o.get(c)!==s&&(n.update(c),o.set(c,s)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",a)&&t.addEventListener("dispose",a),r.update(t.instanceMatrix,34962),null!==t.instanceColor&&r.update(t.instanceColor,34962)),c},dispose:function(){o=new WeakMap}}}function ns(t,n,r,i){void 0===t&&(t=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),T.call(this,null),this.image={data:t,width:n,height:r,depth:i},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function nl(t,n,r,i){void 0===t&&(t=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),T.call(this,null),this.image={data:t,width:n,height:r,depth:i},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}t2.physical={uniforms:tU([t2.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new w(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new e$(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:t0.meshphysical_vert,fragmentShader:t0.meshphysical_frag},ns.prototype=Object.create(T.prototype),ns.prototype.constructor=ns,ns.prototype.isDataTexture2DArray=!0,nl.prototype=Object.create(T.prototype),nl.prototype.constructor=nl,nl.prototype.isDataTexture3D=!0;var nc=new T,nu=new ns,nh=new nl,nd=new tW,np=[],nf=[],nm=new Float32Array(16),nv=new Float32Array(9),ng=new Float32Array(4);function ny(t,n,r){var i=t[0];if(i<=0||i>0)return t;var o=n*r,a=np[o];if(void 0===a&&(a=new Float32Array(o),np[o]=a),0!==n){i.toArray(a,0);for(var s=1,l=0;s!==n;++s)l+=r,t[s].toArray(a,l)}return a}function nb(t,n){if(t.length!==n.length)return!1;for(var r=0,i=t.length;r<i;r++)if(t[r]!==n[r])return!1;return!0}function nA(t,n){for(var r=0,i=n.length;r<i;r++)t[r]=n[r]}function nx(t,n){var r=nf[n];void 0===r&&(r=new Int32Array(n),nf[n]=r);for(var i=0;i!==n;++i)r[i]=t.allocateTextureUnit();return r}function nw(t,n){var r=this.cache;r[0]!==n&&(t.uniform1f(this.addr,n),r[0]=n)}function nE(t,n){var r=this.cache;if(void 0!==n.x)(r[0]!==n.x||r[1]!==n.y)&&(t.uniform2f(this.addr,n.x,n.y),r[0]=n.x,r[1]=n.y);else{if(nb(r,n))return;t.uniform2fv(this.addr,n),nA(r,n)}}function nM(t,n){var r=this.cache;if(void 0!==n.x)(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z)&&(t.uniform3f(this.addr,n.x,n.y,n.z),r[0]=n.x,r[1]=n.y,r[2]=n.z);else if(void 0!==n.r)(r[0]!==n.r||r[1]!==n.g||r[2]!==n.b)&&(t.uniform3f(this.addr,n.r,n.g,n.b),r[0]=n.r,r[1]=n.g,r[2]=n.b);else{if(nb(r,n))return;t.uniform3fv(this.addr,n),nA(r,n)}}function n_(t,n){var r=this.cache;if(void 0!==n.x)(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z||r[3]!==n.w)&&(t.uniform4f(this.addr,n.x,n.y,n.z,n.w),r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=n.w);else{if(nb(r,n))return;t.uniform4fv(this.addr,n),nA(r,n)}}function nT(t,n){var r=this.cache,i=n.elements;if(void 0===i){if(nb(r,n))return;t.uniformMatrix2fv(this.addr,!1,n),nA(r,n)}else{if(nb(r,i))return;ng.set(i),t.uniformMatrix2fv(this.addr,!1,ng),nA(r,i)}}function nS(t,n){var r=this.cache,i=n.elements;if(void 0===i){if(nb(r,n))return;t.uniformMatrix3fv(this.addr,!1,n),nA(r,n)}else{if(nb(r,i))return;nv.set(i),t.uniformMatrix3fv(this.addr,!1,nv),nA(r,i)}}function nC(t,n){var r=this.cache,i=n.elements;if(void 0===i){if(nb(r,n))return;t.uniformMatrix4fv(this.addr,!1,n),nA(r,n)}else{if(nb(r,i))return;nm.set(i),t.uniformMatrix4fv(this.addr,!1,nm),nA(r,i)}}function nL(t,n,r){var i=this.cache,o=r.allocateTextureUnit();i[0]!==o&&(t.uniform1i(this.addr,o),i[0]=o),r.safeSetTexture2D(n||nc,o)}function nR(t,n,r){var i=this.cache,o=r.allocateTextureUnit();i[0]!==o&&(t.uniform1i(this.addr,o),i[0]=o),r.setTexture2DArray(n||nu,o)}function nP(t,n,r){var i=this.cache,o=r.allocateTextureUnit();i[0]!==o&&(t.uniform1i(this.addr,o),i[0]=o),r.setTexture3D(n||nh,o)}function nD(t,n,r){var i=this.cache,o=r.allocateTextureUnit();i[0]!==o&&(t.uniform1i(this.addr,o),i[0]=o),r.safeSetTextureCube(n||nd,o)}function nO(t,n){var r=this.cache;r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n)}function nI(t,n){var r=this.cache;nb(r,n)||(t.uniform2iv(this.addr,n),nA(r,n))}function nB(t,n){var r=this.cache;nb(r,n)||(t.uniform3iv(this.addr,n),nA(r,n))}function nF(t,n){var r=this.cache;nb(r,n)||(t.uniform4iv(this.addr,n),nA(r,n))}function nk(t,n){var r=this.cache;r[0]!==n&&(t.uniform1ui(this.addr,n),r[0]=n)}function nN(t,n){t.uniform1fv(this.addr,n)}function nU(t,n){t.uniform1iv(this.addr,n)}function nH(t,n){t.uniform2iv(this.addr,n)}function nG(t,n){t.uniform3iv(this.addr,n)}function nz(t,n){t.uniform4iv(this.addr,n)}function nj(t,n){var r=ny(n,this.size,2);t.uniform2fv(this.addr,r)}function nV(t,n){var r=ny(n,this.size,3);t.uniform3fv(this.addr,r)}function nW(t,n){var r=ny(n,this.size,4);t.uniform4fv(this.addr,r)}function nq(t,n){var r=ny(n,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}function nX(t,n){var r=ny(n,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}function nY(t,n){var r=ny(n,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}function nQ(t,n,r){var i=n.length,o=nx(r,i);t.uniform1iv(this.addr,o);for(var a=0;a!==i;++a)r.safeSetTexture2D(n[a]||nc,o[a])}function nZ(t,n,r){var i=n.length,o=nx(r,i);t.uniform1iv(this.addr,o);for(var a=0;a!==i;++a)r.safeSetTextureCube(n[a]||nd,o[a])}function nK(t,n,r){this.id=t,this.addr=r,this.cache=[],this.setValue=function(t){switch(t){case 5126:return nw;case 35664:return nE;case 35665:return nM;case 35666:return n_;case 35674:return nT;case 35675:return nS;case 35676:return nC;case 5124:case 35670:return nO;case 35667:case 35671:return nI;case 35668:case 35672:return nB;case 35669:case 35673:return nF;case 5125:return nk;case 35678:case 36198:case 36298:case 36306:case 35682:return nL;case 35679:case 36299:case 36307:return nP;case 35680:case 36300:case 36308:case 36293:return nD;case 36289:case 36303:case 36311:case 36292:return nR}}(n.type)}function nJ(t,n,r){this.id=t,this.addr=r,this.cache=[],this.size=n.size,this.setValue=function(t){switch(t){case 5126:return nN;case 35664:return nj;case 35665:return nV;case 35666:return nW;case 35674:return nq;case 35675:return nX;case 35676:return nY;case 5124:case 35670:return nU;case 35667:case 35671:return nH;case 35668:case 35672:return nG;case 35669:case 35673:return nz;case 35678:case 36198:case 36298:case 36306:case 35682:return nQ;case 35680:case 36300:case 36308:case 36293:return nZ}}(n.type)}function n$(t){this.id=t,this.seq=[],this.map={}}nJ.prototype.updateCache=function(t){var n=this.cache;t instanceof Float32Array&&n.length!==t.length&&(this.cache=new Float32Array(t.length)),nA(n,t)},n$.prototype.setValue=function(t,n,r){for(var i=this.seq,o=0,a=i.length;o!==a;++o){var s=i[o];s.setValue(t,n[s.id],r)}};var n0=/(\w+)(\])?(\[|\.)?/g;function n1(t,n){t.seq.push(n),t.map[n.id]=n}function n2(t,n){this.seq=[],this.map={};for(var r=t.getProgramParameter(n,35718),i=0;i<r;++i){var o=t.getActiveUniform(n,i),a=t.getUniformLocation(n,o.name);!function(t,n,r){var i=t.name,o=i.length;for(n0.lastIndex=0;;){var a=n0.exec(i),s=n0.lastIndex,l=a[1],c="]"===a[2],u=a[3];if(c&&(l|=0),void 0===u||"["===u&&s+2===o){n1(r,void 0===u?new nK(l,t,n):new nJ(l,t,n));break}var h=r.map[l];void 0===h&&n1(r,h=new n$(l)),r=h}}(o,a,this)}}function n3(t,n,r){var i=t.createShader(n);return t.shaderSource(i,r),t.compileShader(i),i}n2.prototype.setValue=function(t,n,r,i){var o=this.map[n];void 0!==o&&o.setValue(t,r,i)},n2.prototype.setOptional=function(t,n,r){var i=n[r];void 0!==i&&this.setValue(t,r,i)},n2.upload=function(t,n,r,i){for(var o=0,a=n.length;o!==a;++o){var s=n[o],l=r[s.id];!1!==l.needsUpdate&&s.setValue(t,l.value,i)}},n2.seqWithValue=function(t,n){for(var r=[],i=0,o=t.length;i!==o;++i){var a=t[i];a.id in n&&r.push(a)}return r};var n4=0;function n5(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function n6(t,n,r){var i=t.getShaderParameter(n,35713),o=t.getShaderInfoLog(n).trim();return i&&""===o?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+o+function(t){for(var n=t.split("\n"),r=0;r<n.length;r++)n[r]=r+1+": "+n[r];return n.join("\n")}(t.getShaderSource(n))}function n7(t,n){var r=n5(n);return"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function n8(t){return""!==t}function n9(t,n){return t.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function re(t,n){return t.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}var rt=/^[ \t]*#include +<([\w\d./]+)>/gm;function rn(t){return t.replace(rt,rr)}function rr(t,n){var r=t0[n];if(void 0===r)throw Error("Can not resolve #include <"+n+">");return rn(r)}var ri=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ro=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ra(t){return t.replace(ro,rl).replace(ri,rs)}function rs(t,n,r,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),rl(t,n,r,i)}function rl(t,n,r,i){for(var o="",a=parseInt(n);a<parseInt(r);a++)o+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return o}function rc(t){var n="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?n+="\n#define HIGH_PRECISION":"mediump"===t.precision?n+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(n+="\n#define LOW_PRECISION"),n}function ru(t,n,r,i){var o,a,s,l,c,h,d=t.getContext(),p=r.defines,f=r.vertexShader,m=r.fragmentShader,v=(o="SHADOWMAP_TYPE_BASIC",1===r.shadowMapType?o="SHADOWMAP_TYPE_PCF":2===r.shadowMapType?o="SHADOWMAP_TYPE_PCF_SOFT":3===r.shadowMapType&&(o="SHADOWMAP_TYPE_VSM"),o),g=function(t){var n="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:n="ENVMAP_TYPE_CUBE";break;case 306:case 307:n="ENVMAP_TYPE_CUBE_UV"}return n}(r),y=function(t){var n="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:n="ENVMAP_MODE_REFRACTION"}return n}(r),b=function(t){var n="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:n="ENVMAP_BLENDING_MULTIPLY";break;case 1:n="ENVMAP_BLENDING_MIX";break;case 2:n="ENVMAP_BLENDING_ADD"}return n}(r),A=t.gammaFactor>0?t.gammaFactor:1,x=r.isWebGL2?"":[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||"physical"===r.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(n8).join("\n"),w=function(t){var n=[];for(var r in t){var i=t[r];!1!==i&&n.push("#define "+r+" "+i)}return n.join("\n")}(p),E=d.createProgram(),M=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?((s=[w].filter(n8).join("\n")).length>0&&(s+="\n"),(l=[x,w].filter(n8).join("\n")).length>0&&(l+="\n")):(s=[rc(r),"#define SHADER_NAME "+r.shaderName,w,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+y:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+v:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(n8).join("\n"),l=[x,rc(r),"#define SHADER_NAME "+r.shaderName,w,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+A,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+g:"",r.envMap?"#define "+y:"",r.envMap?"#define "+b:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+v:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?t0.tonemapping_pars_fragment:"",0!==r.toneMapping?function(t,n){var r;switch(n){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="OptimizedCineon";break;case 4:r="ACESFilmic";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",n),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",t0.encodings_pars_fragment,r.map?n7("mapTexelToLinear",r.mapEncoding):"",r.matcap?n7("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?n7("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?n7("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?n7("lightMapTexelToLinear",r.lightMapEncoding):"","vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+(a=n5(r.outputEncoding))[0]+a[1]+"; }",r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(n8).join("\n")),f=re(f=n9(f=rn(f),r),r),m=re(m=n9(m=rn(m),r),r),f=ra(f),m=ra(m),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(M="#version 300 es\n",s="#define attribute in\n#define varying out\n#define texture2D texture\n"+s,l=["#define varying in",r.glslVersion===u?"":"out highp vec4 pc_fragColor;",r.glslVersion===u?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+l);var _=M+s+f,T=M+l+m,S=n3(d,35633,_),C=n3(d,35632,T);if(d.attachShader(E,S),d.attachShader(E,C),void 0!==r.index0AttributeName?d.bindAttribLocation(E,0,r.index0AttributeName):!0===r.morphTargets&&d.bindAttribLocation(E,0,"position"),d.linkProgram(E),t.debug.checkShaderErrors){var L=d.getProgramInfoLog(E).trim(),R=d.getShaderInfoLog(S).trim(),P=d.getShaderInfoLog(C).trim(),D=!0,O=!0;if(!1===d.getProgramParameter(E,35714)){D=!1;var I=n6(d,S,"vertex"),B=n6(d,C,"fragment");console.error("THREE.WebGLProgram: shader error: ",d.getError(),"35715",d.getProgramParameter(E,35715),"gl.getProgramInfoLog",L,I,B)}else""!==L?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",L):(""===R||""===P)&&(O=!1);O&&(this.diagnostics={runnable:D,programLog:L,vertexShader:{log:R,prefix:s},fragmentShader:{log:P,prefix:l}})}return d.deleteShader(S),d.deleteShader(C),this.getUniforms=function(){return void 0===c&&(c=new n2(d,E)),c},this.getAttributes=function(){return void 0===h&&(h=function(t,n){for(var r={},i=t.getProgramParameter(n,35721),o=0;o<i;o++){var a=t.getActiveAttrib(n,o).name;r[a]=t.getAttribLocation(n,a)}return r}(d,E)),h},this.destroy=function(){i.releaseStatesOfProgram(this),d.deleteProgram(E),this.program=void 0},this.name=r.shaderName,this.id=n4++,this.cacheKey=n,this.usedTimes=1,this.program=E,this.vertexShader=S,this.fragmentShader=C,this}function rh(t,n,r,i,o,a){var s=[],l=i.isWebGL2,c=i.logarithmicDepthBuffer,u=i.floatVertexTextures,h=i.maxVertexUniforms,d=i.vertexTextures,p=i.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},m=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function v(t){var n;return t&&t.isTexture?n=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=3e3,n}return{getParameters:function(o,s,m,g,y){var b,A,x=g.fog,w=o.isMeshStandardMaterial?g.environment:null,E=n.get(o.envMap||w),M=f[o.type],_=y.isSkinnedMesh?function(t){var n=t.skeleton.bones;if(u)return 1024;var r=Math.min(Math.floor((h-20)/4),n.length);return r<n.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+n.length+" bones. This GPU supports "+r+"."),0):r}(y):0;if(null!==o.precision&&(p=i.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead."),M){var T=t2[M];b=T.vertexShader,A=T.fragmentShader}else b=o.vertexShader,A=o.fragmentShader;var S=t.getRenderTarget();return{isWebGL2:l,shaderID:M,shaderName:o.type,vertexShader:b,fragmentShader:A,defines:o.defines,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:p,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:d,outputEncoding:null!==S?v(S.texture):t.outputEncoding,map:!!o.map,mapEncoding:v(o.map),matcap:!!o.matcap,matcapEncoding:v(o.matcap),envMap:!!E,envMapMode:E&&E.mapping,envMapEncoding:v(E),envMapCubeUV:!!E&&(306===E.mapping||307===E.mapping),lightMap:!!o.lightMap,lightMapEncoding:v(o.lightMap),aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:v(o.emissiveMap),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:1===o.normalMapType,tangentSpaceNormalMap:0===o.normalMapType,clearcoatMap:!!o.clearcoatMap,clearcoatRoughnessMap:!!o.clearcoatRoughnessMap,clearcoatNormalMap:!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,alphaMap:!!o.alphaMap,gradientMap:!!o.gradientMap,sheen:!!o.sheen,transmissionMap:!!o.transmissionMap,combine:o.combine,vertexTangents:o.normalMap&&o.vertexTangents,vertexColors:o.vertexColors,vertexUvs:!!o.map||!!o.bumpMap||!!o.normalMap||!!o.specularMap||!!o.alphaMap||!!o.emissiveMap||!!o.roughnessMap||!!o.metalnessMap||!!o.clearcoatMap||!!o.clearcoatRoughnessMap||!!o.clearcoatNormalMap||!!o.displacementMap||!!o.transmissionMap,uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmissionMap)&&!!o.displacementMap,fog:!!x,useFog:o.fog,fogExp2:x&&x.isFogExp2,flatShading:o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:c,skinning:o.skinning&&_>0,maxBones:_,useVertexTexture:u,morphTargets:o.morphTargets,morphNormals:o.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&m.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,alphaTest:o.alphaTest,doubleSided:2===o.side,flipSided:1===o.side,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(n.fragmentShader),r.push(n.vertexShader)),void 0!==n.defines)for(var i in n.defines)r.push(i),r.push(n.defines[i]);if(!1===n.isRawShaderMaterial){for(var o=0;o<m.length;o++)r.push(n[m[o]]);r.push(t.outputEncoding),r.push(t.gammaFactor)}return r.push(n.customProgramCacheKey),r.join()},getUniforms:function(t){var n,r=f[t.type];if(r){var i=t2[r];n=tH.clone(i.uniforms)}else n=t.uniforms;return n},acquireProgram:function(n,r){for(var i,a=0,l=s.length;a<l;a++){var c=s[a];if(c.cacheKey===r){i=c,++i.usedTimes;break}}return void 0===i&&(i=new ru(t,r,n,o),s.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){var n=s.indexOf(t);s[n]=s[s.length-1],s.pop(),t.destroy()}},programs:s}}function rd(){var t=new WeakMap;return{get:function(n){var r=t.get(n);return void 0===r&&(r={},t.set(n,r)),r},remove:function(n){t.delete(n)},update:function(n,r,i){t.get(n)[r]=i},dispose:function(){t=new WeakMap}}}function rp(t,n){return t.groupOrder!==n.groupOrder?t.groupOrder-n.groupOrder:t.renderOrder!==n.renderOrder?t.renderOrder-n.renderOrder:t.program!==n.program?t.program.id-n.program.id:t.material.id!==n.material.id?t.material.id-n.material.id:t.z!==n.z?t.z-n.z:t.id-n.id}function rf(t,n){return t.groupOrder!==n.groupOrder?t.groupOrder-n.groupOrder:t.renderOrder!==n.renderOrder?t.renderOrder-n.renderOrder:t.z!==n.z?n.z-t.z:t.id-n.id}function rm(t){var n=[],r=0,i=[],o=[],a={id:-1};function s(i,o,s,l,c,u){var h=n[r],d=t.get(s);return void 0===h?(h={id:i.id,object:i,geometry:o,material:s,program:d.program||a,groupOrder:l,renderOrder:i.renderOrder,z:c,group:u},n[r]=h):(h.id=i.id,h.object=i,h.geometry=o,h.material=s,h.program=d.program||a,h.groupOrder=l,h.renderOrder=i.renderOrder,h.z=c,h.group=u),r++,h}return{opaque:i,transparent:o,init:function(){r=0,i.length=0,o.length=0},push:function(t,n,r,a,l,c){var u=s(t,n,r,a,l,c);(!0===r.transparent?o:i).push(u)},unshift:function(t,n,r,a,l,c){var u=s(t,n,r,a,l,c);(!0===r.transparent?o:i).unshift(u)},finish:function(){for(var t=r,i=n.length;t<i;t++){var o=n[t];if(null===o.id)break;o.id=null,o.object=null,o.geometry=null,o.material=null,o.program=null,o.group=null}},sort:function(t,n){i.length>1&&i.sort(t||rp),o.length>1&&o.sort(n||rf)}}}function rv(t){var n=new WeakMap;return{get:function(r,i){var o,a=n.get(r);return void 0===a?(o=new rm(t),n.set(r,new WeakMap),n.get(r).set(i,o)):void 0===(o=a.get(i))&&(o=new rm(t),a.set(i,o)),o},dispose:function(){n=new WeakMap}}}function rg(){var t={};return{get:function(n){var r;if(void 0!==t[n.id])return t[n.id];switch(n.type){case"DirectionalLight":r={direction:new D,color:new e$};break;case"SpotLight":r={position:new D,direction:new D,color:new e$,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new D,color:new e$,distance:0,decay:0};break;case"HemisphereLight":r={direction:new D,skyColor:new e$,groundColor:new e$};break;case"RectAreaLight":r={color:new e$,position:new D,halfWidth:new D,halfHeight:new D}}return t[n.id]=r,r}}}var ry=0;function rb(t,n){return(n.castShadow?1:0)-(t.castShadow?1:0)}function rA(t,n){for(var r,i=new rg,o=(r={},{get:function(t){var n;if(void 0!==r[t.id])return r[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new w};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new w,shadowCameraNear:1,shadowCameraFar:1e3}}return r[t.id]=n,n}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=0;s<9;s++)a.probe.push(new D);var l=new D,c=new ea,u=new ea;return{setup:function(r){for(var s=0,l=0,c=0,u=0;u<9;u++)a.probe[u].set(0,0,0);var h=0,d=0,p=0,f=0,m=0,v=0,g=0,y=0;r.sort(rb);for(var b=0,A=r.length;b<A;b++){var x=r[b],w=x.color,E=x.intensity,M=x.distance,_=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)s+=w.r*E,l+=w.g*E,c+=w.b*E;else if(x.isLightProbe)for(var T=0;T<9;T++)a.probe[T].addScaledVector(x.sh.coefficients[T],E);else if(x.isDirectionalLight){var S=i.get(x);if(S.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){var C=x.shadow,L=o.get(x);L.shadowBias=C.bias,L.shadowNormalBias=C.normalBias,L.shadowRadius=C.radius,L.shadowMapSize=C.mapSize,a.directionalShadow[h]=L,a.directionalShadowMap[h]=_,a.directionalShadowMatrix[h]=x.shadow.matrix,v++}a.directional[h]=S,h++}else if(x.isSpotLight){var R=i.get(x);if(R.position.setFromMatrixPosition(x.matrixWorld),R.color.copy(w).multiplyScalar(E),R.distance=M,R.coneCos=Math.cos(x.angle),R.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),R.decay=x.decay,x.castShadow){var P=x.shadow,D=o.get(x);D.shadowBias=P.bias,D.shadowNormalBias=P.normalBias,D.shadowRadius=P.radius,D.shadowMapSize=P.mapSize,a.spotShadow[p]=D,a.spotShadowMap[p]=_,a.spotShadowMatrix[p]=x.shadow.matrix,y++}a.spot[p]=R,p++}else if(x.isRectAreaLight){var O=i.get(x);O.color.copy(w).multiplyScalar(E),O.halfWidth.set(.5*x.width,0,0),O.halfHeight.set(0,.5*x.height,0),a.rectArea[f]=O,f++}else if(x.isPointLight){var I=i.get(x);if(I.color.copy(x.color).multiplyScalar(x.intensity),I.distance=x.distance,I.decay=x.decay,x.castShadow){var B=x.shadow,F=o.get(x);F.shadowBias=B.bias,F.shadowNormalBias=B.normalBias,F.shadowRadius=B.radius,F.shadowMapSize=B.mapSize,F.shadowCameraNear=B.camera.near,F.shadowCameraFar=B.camera.far,a.pointShadow[d]=F,a.pointShadowMap[d]=_,a.pointShadowMatrix[d]=x.shadow.matrix,g++}a.point[d]=I,d++}else if(x.isHemisphereLight){var k=i.get(x);k.skyColor.copy(x.color).multiplyScalar(E),k.groundColor.copy(x.groundColor).multiplyScalar(E),a.hemi[m]=k,m++}}f>0&&(n.isWebGL2?(a.rectAreaLTC1=t1.LTC_FLOAT_1,a.rectAreaLTC2=t1.LTC_FLOAT_2):!0===t.has("OES_texture_float_linear")?(a.rectAreaLTC1=t1.LTC_FLOAT_1,a.rectAreaLTC2=t1.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=t1.LTC_HALF_1,a.rectAreaLTC2=t1.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=s,a.ambient[1]=l,a.ambient[2]=c;var N=a.hash;(N.directionalLength!==h||N.pointLength!==d||N.spotLength!==p||N.rectAreaLength!==f||N.hemiLength!==m||N.numDirectionalShadows!==v||N.numPointShadows!==g||N.numSpotShadows!==y)&&(a.directional.length=h,a.spot.length=p,a.rectArea.length=f,a.point.length=d,a.hemi.length=m,a.directionalShadow.length=v,a.directionalShadowMap.length=v,a.pointShadow.length=g,a.pointShadowMap.length=g,a.spotShadow.length=y,a.spotShadowMap.length=y,a.directionalShadowMatrix.length=v,a.pointShadowMatrix.length=g,a.spotShadowMatrix.length=y,N.directionalLength=h,N.pointLength=d,N.spotLength=p,N.rectAreaLength=f,N.hemiLength=m,N.numDirectionalShadows=v,N.numPointShadows=g,N.numSpotShadows=y,a.version=ry++)},setupView:function(t,n){for(var r=0,i=0,o=0,s=0,h=0,d=n.matrixWorldInverse,p=0,f=t.length;p<f;p++){var m=t[p];if(m.isDirectionalLight){var v=a.directional[r];v.direction.setFromMatrixPosition(m.matrixWorld),l.setFromMatrixPosition(m.target.matrixWorld),v.direction.sub(l),v.direction.transformDirection(d),r++}else if(m.isSpotLight){var g=a.spot[o];g.position.setFromMatrixPosition(m.matrixWorld),g.position.applyMatrix4(d),g.direction.setFromMatrixPosition(m.matrixWorld),l.setFromMatrixPosition(m.target.matrixWorld),g.direction.sub(l),g.direction.transformDirection(d),o++}else if(m.isRectAreaLight){var y=a.rectArea[s];y.position.setFromMatrixPosition(m.matrixWorld),y.position.applyMatrix4(d),u.identity(),c.copy(m.matrixWorld),c.premultiply(d),u.extractRotation(c),y.halfWidth.set(.5*m.width,0,0),y.halfHeight.set(0,.5*m.height,0),y.halfWidth.applyMatrix4(u),y.halfHeight.applyMatrix4(u),s++}else if(m.isPointLight){var b=a.point[i];b.position.setFromMatrixPosition(m.matrixWorld),b.position.applyMatrix4(d),i++}else if(m.isHemisphereLight){var A=a.hemi[h];A.direction.setFromMatrixPosition(m.matrixWorld),A.direction.transformDirection(d),A.direction.normalize(),h++}}},state:a}}function rx(t,n){var r=new rA(t,n),i=[],o=[];return{init:function(){i.length=0,o.length=0},state:{lightsArray:i,shadowsArray:o,lights:r},setupLights:function(){r.setup(i)},setupLightsView:function(t){r.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){o.push(t)}}}function rw(t,n){var r=new WeakMap;return{get:function(i,o){var a;return void 0===o&&(o=0),!1===r.has(i)?(a=new rx(t,n),r.set(i,[]),r.get(i).push(a)):o>=r.get(i).length?(a=new rx(t,n),r.get(i).push(a)):a=r.get(i)[o],a},dispose:function(){r=new WeakMap}}}function rE(t){e2.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function rM(t){e2.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function r_(t,n,r){var i=new tZ,o=new w,a=new w,s=new C,l=[],c=[],u={},h={0:1,1:0,2:2},d=new tG({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new w},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean * HALF_SAMPLE_RATE;\n	squared_mean = squared_mean * HALF_SAMPLE_RATE;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;var f=new tg;f.setAttribute("position",new e6(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new tB(f,d),v=this;function g(t,n,r){var i=t<<0|n<<1|r<<2,o=l[i];return void 0===o&&(o=new rE({depthPacking:3201,morphTargets:t,skinning:n}),l[i]=o),o}function y(t,n,r){var i=t<<0|n<<1|r<<2,o=c[i];return void 0===o&&(o=new rM({morphTargets:t,skinning:n}),c[i]=o),o}function b(n,r,i,o,a,s,l){var c=null,d=g,p=n.customDepthMaterial;if(!0===o.isPointLight&&(d=y,p=n.customDistanceMaterial),void 0===p){var f=!1;!0===i.morphTargets&&(f=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);var m=!1;!0===n.isSkinnedMesh&&(!0===i.skinning?m=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",n)),c=d(f,m,!0===n.isInstancedMesh)}else c=p;if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var v=c.uuid,b=i.uuid,A=u[v];void 0===A&&(A={},u[v]=A);var x=A[b];void 0===x&&(x=c.clone(),A[b]=x),c=x}return c.visible=i.visible,c.wireframe=i.wireframe,3===l?c.side=null!==i.shadowSide?i.shadowSide:i.side:c.side=null!==i.shadowSide?i.shadowSide:h[i.side],c.clipShadows=i.clipShadows,c.clippingPlanes=i.clippingPlanes,c.clipIntersection=i.clipIntersection,c.wireframeLinewidth=i.wireframeLinewidth,c.linewidth=i.linewidth,!0===o.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(o.matrixWorld),c.nearDistance=a,c.farDistance=s),c}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(l,c,u){if(!1!==v.enabled&&(!1!==v.autoUpdate||!1!==v.needsUpdate)&&0!==l.length){var h=t.getRenderTarget(),f=t.getActiveCubeFace(),g=t.getActiveMipmapLevel(),y=t.state;y.setBlending(0),y.buffers.color.setClear(1,1,1,1),y.buffers.depth.setTest(!0),y.setScissorTest(!1);for(var A=0,x=l.length;A<x;A++){var w=l[A],E=w.shadow;if(void 0===E){console.warn("THREE.WebGLShadowMap:",w,"has no shadow.");continue}if(!1!==E.autoUpdate||!1!==E.needsUpdate){o.copy(E.mapSize);var M=E.getFrameExtents();if(o.multiply(M),a.copy(E.mapSize),(o.x>r||o.y>r)&&(o.x>r&&(a.x=Math.floor(r/M.x),o.x=a.x*M.x,E.mapSize.x=a.x),o.y>r&&(a.y=Math.floor(r/M.y),o.y=a.y*M.y,E.mapSize.y=a.y)),null===E.map&&!E.isPointLightShadow&&3===this.type){var _={minFilter:1006,magFilter:1006,format:1023};E.map=new L(o.x,o.y,_),E.map.texture.name=w.name+".shadowMap",E.mapPass=new L(o.x,o.y,_),E.camera.updateProjectionMatrix()}if(null===E.map){var T={minFilter:1003,magFilter:1003,format:1023};E.map=new L(o.x,o.y,T),E.map.texture.name=w.name+".shadowMap",E.camera.updateProjectionMatrix()}t.setRenderTarget(E.map),t.clear();for(var S=E.getViewportCount(),C=0;C<S;C++){var R=E.getViewport(C);s.set(a.x*R.x,a.y*R.y,a.x*R.z,a.y*R.w),y.viewport(s),E.updateMatrices(w,C),i=E.getFrustum(),function r(o,a,s,l,c){if(!1!==o.visible){if(o.layers.test(a.layers)&&(o.isMesh||o.isLine||o.isPoints)&&(o.castShadow||o.receiveShadow&&3===c)&&(!o.frustumCulled||i.intersectsObject(o))){o.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,o.matrixWorld);var u=n.update(o),h=o.material;if(Array.isArray(h))for(var d=u.groups,p=0,f=d.length;p<f;p++){var m=d[p],v=h[m.materialIndex];if(v&&v.visible){var g=b(o,u,v,l,s.near,s.far,c);t.renderBufferDirect(s,null,u,g,o,m)}}else if(h.visible){var y=b(o,u,h,l,s.near,s.far,c);t.renderBufferDirect(s,null,u,y,o,null)}}for(var A=o.children,x=0,w=A.length;x<w;x++)r(A[x],a,s,l,c)}}(c,u,E.camera,w,this.type)}E.isPointLightShadow||3!==this.type||function(r,i){var o=n.update(m);d.uniforms.shadow_pass.value=r.map.texture,d.uniforms.resolution.value=r.mapSize,d.uniforms.radius.value=r.radius,t.setRenderTarget(r.mapPass),t.clear(),t.renderBufferDirect(i,null,o,d,m,null),p.uniforms.shadow_pass.value=r.mapPass.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,t.setRenderTarget(r.map),t.clear(),t.renderBufferDirect(i,null,o,p,m,null)}(E,u),E.needsUpdate=!1}}v.needsUpdate=!1,t.setRenderTarget(h,f,g)}}}function rT(t,n,r){var i,o,a=r.isWebGL2,s=new function(){var n=!1,r=new C,i=null,o=new C(0,0,0,0);return{setMask:function(r){i===r||n||(t.colorMask(r,r,r,r),i=r)},setLocked:function(t){n=t},setClear:function(n,i,a,s,l){!0===l&&(n*=s,i*=s,a*=s),r.set(n,i,a,s),!1===o.equals(r)&&(t.clearColor(n,i,a,s),o.copy(r))},reset:function(){n=!1,i=null,o.set(-1,0,0,0)}}},l=new function(){var n=!1,r=null,i=null,o=null;return{setTest:function(t){t?F(2929):k(2929)},setMask:function(i){r===i||n||(t.depthMask(i),r=i)},setFunc:function(n){if(i!==n){if(n)switch(n){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}else t.depthFunc(515);i=n}},setLocked:function(t){n=t},setClear:function(n){o!==n&&(t.clearDepth(n),o=n)},reset:function(){n=!1,r=null,i=null,o=null}}},c=new function(){var n=!1,r=null,i=null,o=null,a=null,s=null,l=null,c=null,u=null;return{setTest:function(t){n||(t?F(2960):k(2960))},setMask:function(i){r===i||n||(t.stencilMask(i),r=i)},setFunc:function(n,r,s){(i!==n||o!==r||a!==s)&&(t.stencilFunc(n,r,s),i=n,o=r,a=s)},setOp:function(n,r,i){(s!==n||l!==r||c!==i)&&(t.stencilOp(n,r,i),s=n,l=r,c=i)},setLocked:function(t){n=t},setClear:function(n){u!==n&&(t.clearStencil(n),u=n)},reset:function(){n=!1,r=null,i=null,o=null,a=null,s=null,l=null,c=null,u=null}}},u={},h=null,d=null,p=null,f=null,m=null,v=null,g=null,y=null,b=null,A=!1,x=null,w=null,E=null,M=null,_=null,T=t.getParameter(35661),S=!1,L=t.getParameter(7938);-1!==L.indexOf("WebGL")?S=parseFloat(/^WebGL (\d)/.exec(L)[1])>=1:-1!==L.indexOf("OpenGL ES")&&(S=parseFloat(/^OpenGL ES (\d)/.exec(L)[1])>=2);var R=null,P={},D=new C,O=new C;function I(n,r,i){var o=new Uint8Array(4),a=t.createTexture();t.bindTexture(n,a),t.texParameteri(n,10241,9728),t.texParameteri(n,10240,9728);for(var s=0;s<i;s++)t.texImage2D(r+s,0,6408,1,1,0,6408,5121,o);return a}var B={};function F(n){!0!==u[n]&&(t.enable(n),u[n]=!0)}function k(n){!1!==u[n]&&(t.disable(n),u[n]=!1)}B[3553]=I(3553,3553,1),B[34067]=I(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),F(2929),l.setFunc(3),z(!1),j(1),F(2884),G(0);var N=((i={})[100]=32774,i[101]=32778,i[102]=32779,i);if(a)N[103]=32775,N[104]=32776;else{var U=n.get("EXT_blend_minmax");null!==U&&(N[103]=U.MIN_EXT,N[104]=U.MAX_EXT)}var H=((o={})[200]=0,o[201]=1,o[202]=768,o[204]=770,o[210]=776,o[208]=774,o[206]=772,o[203]=769,o[205]=771,o[209]=775,o[207]=773,o);function G(n,r,i,o,a,s,l,c){if(0===n){d&&(k(3042),d=!1);return}if(d||(F(3042),d=!0),5!==n){if(n!==p||c!==A){if((100!==f||100!==g)&&(t.blendEquation(32774),f=100,g=100),c)switch(n){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",n)}else switch(n){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",n)}m=null,v=null,y=null,b=null,p=n,A=c}return}a=a||r,s=s||i,l=l||o,(r!==f||a!==g)&&(t.blendEquationSeparate(N[r],N[a]),f=r,g=a),(i!==m||o!==v||s!==y||l!==b)&&(t.blendFuncSeparate(H[i],H[o],H[s],H[l]),m=i,v=o,y=s,b=l),p=n,A=null}function z(n){x!==n&&(n?t.frontFace(2304):t.frontFace(2305),x=n)}function j(n){0!==n?(F(2884),n!==w&&(1===n?t.cullFace(1029):2===n?t.cullFace(1028):t.cullFace(1032))):k(2884),w=n}function V(n,r,i){n?(F(32823),(M!==r||_!==i)&&(t.polygonOffset(r,i),M=r,_=i)):k(32823)}function W(n){void 0===n&&(n=33984+T-1),R!==n&&(t.activeTexture(n),R=n)}return{buffers:{color:s,depth:l,stencil:c},enable:F,disable:k,useProgram:function(n){return h!==n&&(t.useProgram(n),h=n,!0)},setBlending:G,setMaterial:function(t,n){2===t.side?k(2884):F(2884);var r=1===t.side;n&&(r=!r),z(r),1===t.blending&&!1===t.transparent?G(0):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),s.setMask(t.colorWrite);var i=t.stencilWrite;c.setTest(i),i&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),V(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:z,setCullFace:j,setLineWidth:function(n){n!==E&&(S&&t.lineWidth(n),E=n)},setPolygonOffset:V,setScissorTest:function(t){t?F(3089):k(3089)},activeTexture:W,bindTexture:function(n,r){null===R&&W();var i=P[R];void 0===i&&(i={type:void 0,texture:void 0},P[R]=i),(i.type!==n||i.texture!==r)&&(t.bindTexture(n,r||B[n]),i.type=n,i.texture=r)},unbindTexture:function(){var n=P[R];void 0!==n&&void 0!==n.type&&(t.bindTexture(n.type,null),n.type=void 0,n.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(n){!1===D.equals(n)&&(t.scissor(n.x,n.y,n.z,n.w),D.copy(n))},viewport:function(n){!1===O.equals(n)&&(t.viewport(n.x,n.y,n.z,n.w),O.copy(n))},reset:function(){u={},R=null,P={},h=null,d=null,p=null,f=null,m=null,v=null,g=null,y=null,b=null,A=!1,x=null,w=null,E=null,M=null,_=null,s.reset(),l.reset(),c.reset()}}}function rS(t,n,r,i,o,a,s){var l,c,u,h=o.isWebGL2,d=o.maxTextures,p=o.maxCubemapSize,f=o.maxTextureSize,m=o.maxSamples,v=new WeakMap,g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function y(t,n){return g?new OffscreenCanvas(t,n):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function b(t,n,r,i){var o=1;if((t.width>i||t.height>i)&&(o=i/Math.max(t.width,t.height)),o<1||!0===n){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var a=n?x.floorPowerOfTwo:Math.floor,s=a(o*t.width),l=a(o*t.height);void 0===u&&(u=y(s,l));var c=r?y(s,l):u;return c.width=s,c.height=l,c.getContext("2d").drawImage(t,0,0,s,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+l+")."),c}"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function A(t){return x.isPowerOfTwo(t.width)&&x.isPowerOfTwo(t.height)}function w(t,n){return t.generateMipmaps&&n&&1003!==t.minFilter&&1006!==t.minFilter}function E(n,r,o,a){t.generateMipmap(n),i.get(r).__maxMipLevel=Math.log(Math.max(o,a))*Math.LOG2E}function M(r,i,o){if(!1===h)return i;if(null!==r){if(void 0!==t[r])return t[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}var a=i;return 6403===i&&(5126===o&&(a=33326),5131===o&&(a=33325),5121===o&&(a=33321)),6407===i&&(5126===o&&(a=34837),5131===o&&(a=34843),5121===o&&(a=32849)),6408===i&&(5126===o&&(a=34836),5131===o&&(a=34842),5121===o&&(a=32856)),(33325===a||33326===a||34842===a||34836===a)&&n.get("EXT_color_buffer_float"),a}function _(t){return 1003===t||1004===t||1005===t?9728:9729}function T(n){var r,o=n.target;o.removeEventListener("dispose",T),void 0!==(r=i.get(o)).__webglInit&&(t.deleteTexture(r.__webglTexture),i.remove(o)),o.isVideoTexture&&v.delete(o),s.memory.textures--}function S(n){var r=n.target;r.removeEventListener("dispose",S),function(n){var r=i.get(n),o=i.get(n.texture);if(n){if(void 0!==o.__webglTexture&&t.deleteTexture(o.__webglTexture),n.depthTexture&&n.depthTexture.dispose(),n.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)t.deleteFramebuffer(r.__webglFramebuffer[a]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[a]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);i.remove(n.texture),i.remove(n)}}(r),s.memory.textures--}var C=0;function L(t,n){var o,a=i.get(t);if(t.isVideoTexture&&(o=s.render.frame,v.get(t)!==o&&(v.set(t,o),t.update())),t.version>0&&a.__version!==t.version){var l=t.image;if(void 0===l)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===l.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{B(a,t,n);return}}r.activeTexture(33984+n),r.bindTexture(3553,a.__webglTexture)}function R(n,o){var s=i.get(n);if(n.version>0&&s.__version!==n.version){(function(n,i,o){if(6===i.image.length){I(n,i),r.activeTexture(33984+o),r.bindTexture(34067,n.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment);for(var s,l=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),c=i.image[0]&&i.image[0].isDataTexture,u=[],d=0;d<6;d++)l||c?u[d]=c?i.image[d].image:i.image[d]:u[d]=b(i.image[d],!1,!0,p);var f=u[0],m=A(f)||h,v=a.convert(i.format),g=a.convert(i.type),y=M(i.internalFormat,v,g);if(O(34067,i,m),l){for(var x=0;x<6;x++){s=u[x].mipmaps;for(var _=0;_<s.length;_++){var T=s[_];1023!==i.format&&1022!==i.format?null!==v?r.compressedTexImage2D(34069+x,_,y,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+x,_,y,T.width,T.height,0,v,g,T.data)}}n.__maxMipLevel=s.length-1}else{s=i.mipmaps;for(var S=0;S<6;S++)if(c){r.texImage2D(34069+S,0,y,u[S].width,u[S].height,0,v,g,u[S].data);for(var C=0;C<s.length;C++){var L=s[C].image[S].image;r.texImage2D(34069+S,C+1,y,L.width,L.height,0,v,g,L.data)}}else{r.texImage2D(34069+S,0,y,v,g,u[S]);for(var R=0;R<s.length;R++){var P=s[R];r.texImage2D(34069+S,R+1,y,v,g,P.image[S])}}n.__maxMipLevel=s.length}w(i,m)&&E(34067,i,f.width,f.height),n.__version=i.version,i.onUpdate&&i.onUpdate(i)}})(s,n,o);return}r.activeTexture(33984+o),r.bindTexture(34067,s.__webglTexture)}var P=((l={})[1e3]=10497,l[1001]=33071,l[1002]=33648,l),D=((c={})[1003]=9728,c[1004]=9984,c[1005]=9986,c[1006]=9729,c[1007]=9985,c[1008]=9987,c);function O(r,a,s){s?(t.texParameteri(r,10242,P[a.wrapS]),t.texParameteri(r,10243,P[a.wrapT]),(32879===r||35866===r)&&t.texParameteri(r,32882,P[a.wrapR]),t.texParameteri(r,10240,D[a.magFilter]),t.texParameteri(r,10241,D[a.minFilter])):(t.texParameteri(r,10242,33071),t.texParameteri(r,10243,33071),(32879===r||35866===r)&&t.texParameteri(r,32882,33071),(1001!==a.wrapS||1001!==a.wrapT)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(r,10240,_(a.magFilter)),t.texParameteri(r,10241,_(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var l=n.get("EXT_texture_filter_anisotropic");if(l){if(1015===a.type&&null===n.get("OES_texture_float_linear")||1016===a.type&&null===(h||n.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(t.texParameterf(r,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,o.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function I(n,r){void 0===n.__webglInit&&(n.__webglInit=!0,r.addEventListener("dispose",T),n.__webglTexture=t.createTexture(),s.memory.textures++)}function B(n,i,o){var s,l=3553;i.isDataTexture2DArray&&(l=35866),i.isDataTexture3D&&(l=32879),I(n,i),r.activeTexture(33984+o),r.bindTexture(l,n.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment);var c=!h&&(1001!==i.wrapS||1001!==i.wrapT||1003!==i.minFilter&&1006!==i.minFilter)&&!1===A(i.image),u=b(i.image,c,!1,f),d=A(u)||h,p=a.convert(i.format),m=a.convert(i.type),v=M(i.internalFormat,p,m);O(l,i,d);var g=i.mipmaps;if(i.isDepthTexture)v=6402,h?v=1015===i.type?36012:1014===i.type?33190:1020===i.type?35056:33189:1015===i.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===i.format&&6402===v&&1012!==i.type&&1014!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=1012,m=a.convert(i.type)),1027===i.format&&6402===v&&(v=34041,1020!==i.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=1020,m=a.convert(i.type))),r.texImage2D(3553,0,v,u.width,u.height,0,p,m,null);else if(i.isDataTexture){if(g.length>0&&d){for(var y=0,x=g.length;y<x;y++)s=g[y],r.texImage2D(3553,y,v,s.width,s.height,0,p,m,s.data);i.generateMipmaps=!1,n.__maxMipLevel=g.length-1}else r.texImage2D(3553,0,v,u.width,u.height,0,p,m,u.data),n.__maxMipLevel=0}else if(i.isCompressedTexture){for(var _=0,T=g.length;_<T;_++)s=g[_],1023!==i.format&&1022!==i.format?null!==p?r.compressedTexImage2D(3553,_,v,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,_,v,s.width,s.height,0,p,m,s.data);n.__maxMipLevel=g.length-1}else if(i.isDataTexture2DArray)r.texImage3D(35866,0,v,u.width,u.height,u.depth,0,p,m,u.data),n.__maxMipLevel=0;else if(i.isDataTexture3D)r.texImage3D(32879,0,v,u.width,u.height,u.depth,0,p,m,u.data),n.__maxMipLevel=0;else if(g.length>0&&d){for(var S=0,C=g.length;S<C;S++)s=g[S],r.texImage2D(3553,S,v,p,m,s);i.generateMipmaps=!1,n.__maxMipLevel=g.length-1}else r.texImage2D(3553,0,v,p,m,u),n.__maxMipLevel=0;w(i,d)&&E(l,i,u.width,u.height),n.__version=i.version,i.onUpdate&&i.onUpdate(i)}function F(n,o,s,l){var c=a.convert(o.texture.format),u=a.convert(o.texture.type),h=M(o.texture.internalFormat,c,u);r.texImage2D(l,0,h,o.width,o.height,0,c,u,null),t.bindFramebuffer(36160,n),t.framebufferTexture2D(36160,s,l,i.get(o.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function k(n,r,i){if(t.bindRenderbuffer(36161,n),r.depthBuffer&&!r.stencilBuffer){var o=33189;if(i){var s=r.depthTexture;s&&s.isDepthTexture&&(1015===s.type?o=36012:1014===s.type&&(o=33190));var l=N(r);t.renderbufferStorageMultisample(36161,l,o,r.width,r.height)}else t.renderbufferStorage(36161,o,r.width,r.height);t.framebufferRenderbuffer(36160,36096,36161,n)}else if(r.depthBuffer&&r.stencilBuffer){if(i){var c=N(r);t.renderbufferStorageMultisample(36161,c,35056,r.width,r.height)}else t.renderbufferStorage(36161,34041,r.width,r.height);t.framebufferRenderbuffer(36160,33306,36161,n)}else{var u=a.convert(r.texture.format),h=a.convert(r.texture.type),d=M(r.texture.internalFormat,u,h);if(i){var p=N(r);t.renderbufferStorageMultisample(36161,p,d,r.width,r.height)}else t.renderbufferStorage(36161,d,r.width,r.height)}t.bindRenderbuffer(36161,null)}function N(t){return h&&t.isWebGLMultisampleRenderTarget?Math.min(m,t.samples):0}var U=!1,H=!1;this.allocateTextureUnit=function(){var t=C;return t>=d&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+d),C+=1,t},this.resetTextureUnits=function(){C=0},this.setTexture2D=L,this.setTexture2DArray=function(t,n){var o=i.get(t);if(t.version>0&&o.__version!==t.version){B(o,t,n);return}r.activeTexture(33984+n),r.bindTexture(35866,o.__webglTexture)},this.setTexture3D=function(t,n){var o=i.get(t);if(t.version>0&&o.__version!==t.version){B(o,t,n);return}r.activeTexture(33984+n),r.bindTexture(32879,o.__webglTexture)},this.setTextureCube=R,this.setupRenderTarget=function(n){var o=i.get(n),l=i.get(n.texture);n.addEventListener("dispose",S),l.__webglTexture=t.createTexture(),s.memory.textures++;var c=!0===n.isWebGLCubeRenderTarget,u=!0===n.isWebGLMultisampleRenderTarget,d=A(n)||h;if(h&&1022===n.texture.format&&(1015===n.texture.type||1016===n.texture.type)&&(n.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){o.__webglFramebuffer=[];for(var p=0;p<6;p++)o.__webglFramebuffer[p]=t.createFramebuffer()}else if(o.__webglFramebuffer=t.createFramebuffer(),u){if(h){o.__webglMultisampledFramebuffer=t.createFramebuffer(),o.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,o.__webglColorRenderbuffer);var f=a.convert(n.texture.format),m=a.convert(n.texture.type),v=M(n.texture.internalFormat,f,m),g=N(n);t.renderbufferStorageMultisample(36161,g,v,n.width,n.height),t.bindFramebuffer(36160,o.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,o.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),n.depthBuffer&&(o.__webglDepthRenderbuffer=t.createRenderbuffer(),k(o.__webglDepthRenderbuffer,n,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}if(c){r.bindTexture(34067,l.__webglTexture),O(34067,n.texture,d);for(var y=0;y<6;y++)F(o.__webglFramebuffer[y],n,36064,34069+y);w(n.texture,d)&&E(34067,n.texture,n.width,n.height),r.bindTexture(34067,null)}else r.bindTexture(3553,l.__webglTexture),O(3553,n.texture,d),F(o.__webglFramebuffer,n,36064,3553),w(n.texture,d)&&E(3553,n.texture,n.width,n.height),r.bindTexture(3553,null);n.depthBuffer&&function(n){var r=i.get(n),o=!0===n.isWebGLCubeRenderTarget;if(n.depthTexture){if(o)throw Error("target.depthTexture not supported in Cube render targets");!function(n,r){if(r&&r.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,n),!(r.depthTexture&&r.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),L(r.depthTexture,0);var o=i.get(r.depthTexture).__webglTexture;if(1026===r.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,o,0);else if(1027===r.depthTexture.format)t.framebufferTexture2D(36160,33306,3553,o,0);else throw Error("Unknown depthTexture format")}(r.__webglFramebuffer,n)}else if(o){r.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(36160,r.__webglFramebuffer[a]),r.__webglDepthbuffer[a]=t.createRenderbuffer(),k(r.__webglDepthbuffer[a],n,!1)}else t.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),k(r.__webglDepthbuffer,n,!1);t.bindFramebuffer(36160,null)}(n)},this.updateRenderTargetMipmap=function(t){var n=t.texture;if(w(n,A(t)||h)){var o=t.isWebGLCubeRenderTarget?34067:3553,a=i.get(n).__webglTexture;r.bindTexture(o,a),E(o,n,t.width,t.height),r.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(n){if(n.isWebGLMultisampleRenderTarget){if(h){var r=i.get(n);t.bindFramebuffer(36008,r.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,r.__webglFramebuffer);var o=n.width,a=n.height,s=16384;n.depthBuffer&&(s|=256),n.stencilBuffer&&(s|=1024),t.blitFramebuffer(0,0,o,a,0,0,o,a,s,9728),t.bindFramebuffer(36160,r.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}},this.safeSetTexture2D=function(t,n){t&&t.isWebGLRenderTarget&&(!1===U&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),U=!0),t=t.texture),L(t,n)},this.safeSetTextureCube=function(t,n){t&&t.isWebGLCubeRenderTarget&&(!1===H&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),H=!0),t=t.texture),R(t,n)}}function rC(t,n,r){var i=r.isWebGL2;return{convert:function(t){var r;if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t)return i?5131:null!==(r=n.get("OES_texture_half_float"))?r.HALF_FLOAT_OES:null;if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(r=n.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(r=n.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return null!==(r=n.get("WEBGL_compressed_texture_etc1"))?r.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&null!==(r=n.get("WEBGL_compressed_texture_etc"))){if(37492===t)return r.COMPRESSED_RGB8_ETC2;if(37496===t)return r.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(r=n.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(r=n.get("EXT_texture_compression_bptc"))?t:null:1020===t?i?34042:null!==(r=n.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function rL(){eP.call(this),this.type="Group"}function rR(t){void 0===t&&(t=[]),tj.call(this),this.cameras=t}rE.prototype=Object.create(e2.prototype),rE.prototype.constructor=rE,rE.prototype.isMeshDepthMaterial=!0,rE.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},rM.prototype=Object.create(e2.prototype),rM.prototype.constructor=rM,rM.prototype.isMeshDistanceMaterial=!0,rM.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},rL.prototype=Object.assign(Object.create(eP.prototype),{constructor:rL,isGroup:!0}),rR.prototype=Object.assign(Object.create(tj.prototype),{constructor:rR,isArrayCamera:!0});var rP=new D,rD=new D;function rO(t){var n=this,r=null,i=null,o=null,a=[],s=new ea,l=new ea,c=1,u="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(i=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",x,!1));var h=new ea,d=new P,p=new D,f=new tj;f.viewport=new C,f.layers.enable(1);var m=new tj;m.viewport=new C,m.layers.enable(2);var v=new rR([f,m]);v.layers.enable(1),v.layers.enable(2);var g,y,b,A=new w;function x(){if(n.isPresenting=null!==r&&!0===r.isPresenting){var i=r.getEyeParameters("left");g=2*i.renderWidth*c,y=i.renderHeight*c,b=t.getPixelRatio(),t.getSize(A),t.setDrawingBufferSize(g,y,1),f.viewport.set(0,0,g/2,y),m.viewport.set(g/2,0,g/2,y),T.start(),n.dispatchEvent({type:"sessionstart"})}else n.enabled&&t.setDrawingBufferSize(A.width,A.height,b),T.stop(),n.dispatchEvent({type:"sessionend"})}var E=[],M=[];function _(t,n){null!==n&&4===n.length&&t.set(n[0]*g,n[1]*y,n[2]*g,n[3]*y)}this.enabled=!1,this.getController=function(t){var n=a[t];return void 0===n&&((n=new rL).matrixAutoUpdate=!1,n.visible=!1,a[t]=n),n},this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t),T.setContext(t)},this.setFramebufferScaleFactor=function(t){c=t},this.setReferenceSpaceType=function(t){u=t},this.setPoseTarget=function(t){void 0!==t&&(o=t)},this.getCamera=function(t){var n="local-floor"===u?1.6:0;if(r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(i),"local-floor"===u){var c=r.stageParameters;c?s.fromArray(c.sittingToStandingTransform):s.makeTranslation(0,n,0)}var g=i.pose,y=null!==o?o:t;y.matrix.copy(s),y.matrix.decompose(y.position,y.quaternion,y.scale),null!==g.orientation&&(d.fromArray(g.orientation),y.quaternion.multiply(d)),null!==g.position&&(d.setFromRotationMatrix(s),p.fromArray(g.position),p.applyQuaternion(d),y.position.add(p)),y.updateMatrixWorld();for(var b=y.children,A=0,x=b.length;A<x;A++)b[A].updateMatrixWorld(!0);f.near=t.near,m.near=t.near,f.far=t.far,m.far=t.far,f.matrixWorldInverse.fromArray(i.leftViewMatrix),m.matrixWorldInverse.fromArray(i.rightViewMatrix),l.getInverse(s),"local-floor"===u&&(f.matrixWorldInverse.multiply(l),m.matrixWorldInverse.multiply(l));var w=y.parent;null!==w&&(h.getInverse(w.matrixWorld),f.matrixWorldInverse.multiply(h),m.matrixWorldInverse.multiply(h)),f.matrixWorld.getInverse(f.matrixWorldInverse),m.matrixWorld.getInverse(m.matrixWorldInverse),f.projectionMatrix.fromArray(i.leftProjectionMatrix),m.projectionMatrix.fromArray(i.rightProjectionMatrix),function(t,n,r){rP.setFromMatrixPosition(n.matrixWorld),rD.setFromMatrixPosition(r.matrixWorld);var i=rP.distanceTo(rD),o=n.projectionMatrix.elements,a=r.projectionMatrix.elements,s=o[14]/(o[10]-1),l=o[14]/(o[10]+1),c=(o[9]+1)/o[5],u=(o[9]-1)/o[5],h=(o[8]-1)/o[0],d=(a[8]+1)/a[0],p=i/(-h+d),f=-(p*h);n.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(f),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var m=s+p,v=l+p;t.projectionMatrix.makePerspective(s*h-f,s*d+(i-f),c*l/v*m,u*l/v*m,m,v)}(v,f,m);var T=r.getLayers();if(T.length){var S=T[0];_(f.viewport,S.leftBounds),_(m.viewport,S.rightBounds)}return function(){for(var t=0;t<a.length;t++){var n=a[t],r=function(t){for(var n=navigator.getGamepads&&navigator.getGamepads(),r=0,i=n.length;r<i;r++){var o=n[r];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("HTC Vive Focus")||o.id.startsWith("Spatial Controller"))){var a=o.hand;if(0===t&&(""===a||"right"===a)||1===t&&"left"===a)return o}}}(t);if(void 0!==r&&void 0!==r.pose){if(null===r.pose)return;var i=r.pose;!1===i.hasPosition&&n.position.set(.2,-.6,-.05),null!==i.position&&n.position.fromArray(i.position),null!==i.orientation&&n.quaternion.fromArray(i.orientation),n.matrix.compose(n.position,n.quaternion,n.scale),n.matrix.premultiply(s),n.matrix.decompose(n.position,n.quaternion,n.scale),n.matrixWorldNeedsUpdate=!0,n.visible=!0;var o="Daydream Controller"===r.id?0:1;void 0===E[t]&&(E[t]=!1),E[t]!==r.buttons[o].pressed&&(E[t]=r.buttons[o].pressed,!0===E[t]?n.dispatchEvent({type:"selectstart"}):(n.dispatchEvent({type:"selectend"}),n.dispatchEvent({type:"select"}))),o=2,void 0===M[t]&&(M[t]=!1),void 0!==r.buttons[o]&&M[t]!==r.buttons[o].pressed&&(M[t]=r.buttons[o].pressed,!0===M[t]?n.dispatchEvent({type:"squeezestart"}):(n.dispatchEvent({type:"squeezeend"}),n.dispatchEvent({type:"squeeze"})))}else n.visible=!1}}(),v},this.getStandingMatrix=function(){return s},this.isPresenting=!1;var T=new tK;this.setAnimationLoop=function(t){T.setAnimationLoop(t),this.isPresenting&&T.start()},this.submitFrame=function(){this.isPresenting&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",x)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function rI(){this._targetRay=null,this._grip=null,this._hand=null}function rB(t,n){var r,i,o,a=this,s=null,l=1,c=null,u="local-floor",d=null,p=null,f=[],m=new Map,v=[],g=new tj;g.layers.enable(1),g.viewport=new C;var y=new tj;y.layers.enable(2),y.viewport=new C;var b=[g,y],A=new rR;A.layers.enable(1),A.layers.enable(2);var x=null,w=null;function E(t){var n=m.get(t.inputSource);n&&n.dispatchEvent({type:t.type,data:t.inputSource})}function M(){m.forEach(function(t,n){t.disconnect(n)}),m.clear(),x=null,w=null,t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),P.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function _(t){for(var n=s.inputSources,r=0;r<f.length;r++)m.set(n[r],f[r]);for(var i=0;i<t.removed.length;i++){var o=t.removed[i],a=m.get(o);a&&(a.dispatchEvent({type:"disconnected",data:o}),m.delete(o))}for(var l=0;l<t.added.length;l++){var c=t.added[l],u=m.get(c);u&&u.dispatchEvent({type:"connected",data:c})}}this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return d},this.getController=function(t){var n=f[t];return void 0===n&&(n=new rI,f[t]=n),n.getTargetRaySpace()},this.getControllerGrip=function(t){var n=f[t];return void 0===n&&(n=new rI,f[t]=n),n.getGripSpace()},this.getHand=function(t){var n=f[t];return void 0===n&&(n=new rI,f[t]=n),n.getHandSpace()},this.setFramebufferScaleFactor=function(t){l=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){u=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c},this.getSession=function(){return s},this.setSession=(r=regeneratorRuntime.mark(function t(r){var i,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null!==(s=r))){t.next=24;break}if(s.addEventListener("select",E),s.addEventListener("selectstart",E),s.addEventListener("selectend",E),s.addEventListener("squeeze",E),s.addEventListener("squeezestart",E),s.addEventListener("squeezeend",E),s.addEventListener("end",M),s.addEventListener("inputsourceschange",_),!(!0!==(i=n.getContextAttributes()).xrCompatible)){t.next=14;break}return t.next=14,n.makeXRCompatible();case 14:return h={antialias:i.antialias,alpha:i.alpha,depth:i.depth,stencil:i.stencil,framebufferScaleFactor:l},o=new XRWebGLLayer(s,n,h),window.XRWebGLBinding&&this.layersEnabled?this.addLayer(o):s.updateRenderState({baseLayer:o}),t.next=19,s.requestReferenceSpace(u);case 19:c=t.sent,P.setContext(s),P.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 24:case"end":return t.stop()}},t,this)}),i=function(){var t=this,n=arguments;return new Promise(function(i,o){var a=r.apply(t,n);function s(t){h(a,i,o,s,l,"next",t)}function l(t){h(a,i,o,s,l,"throw",t)}s(void 0)})},function(t){return i.apply(this,arguments)}),this.addLayer=function(t){window.XRWebGLBinding&&this.layersEnabled&&s&&(v.push(t),s.updateRenderState({layers:v}))},this.removeLayer=function(t){window.XRWebGLBinding&&this.layersEnabled&&s&&(v.splice(v.indexOf(t),1),s.updateRenderState({layers:v}))};var T=new D,S=new D;function L(t,n){null===n?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(n.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.setPoseTarget=function(t){void 0!==t&&(p=t)},this.getCamera=function(t){A.near=y.near=g.near=t.near,A.far=y.far=g.far=t.far,(x!==A.near||w!==A.far)&&(s.updateRenderState({depthNear:A.near,depthFar:A.far}),x=A.near,w=A.far);var n=t.parent,r=A.cameras,i=p||t;L(A,n);for(var o=0;o<r.length;o++)L(r[o],n);i.matrixWorld.copy(A.matrixWorld);for(var a=i.children,l=0,c=a.length;l<c;l++)a[l].updateMatrixWorld(!0);return 2===r.length?function(t,n,r){T.setFromMatrixPosition(n.matrixWorld),S.setFromMatrixPosition(r.matrixWorld);var i=T.distanceTo(S),o=n.projectionMatrix.elements,a=r.projectionMatrix.elements,s=o[14]/(o[10]-1),l=o[14]/(o[10]+1),c=(o[9]+1)/o[5],u=(o[9]-1)/o[5],h=(o[8]-1)/o[0],d=(a[8]+1)/a[0],p=i/(-h+d),f=-(p*h);n.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(f),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();var m=s+p,v=l+p;t.projectionMatrix.makePerspective(s*h-f,s*d+(i-f),c*l/v*m,u*l/v*m,m,v)}(A,g,y):A.projectionMatrix.copy(g.projectionMatrix),A};var R=null,P=new tK;P.setAnimationLoop(function(n,r){if(null!==(d=r.getViewerPose(c))){var i=d.views;t.setFramebuffer(o.framebuffer);var a=!1;i.length!==A.cameras.length&&(A.cameras.length=0,a=!0);for(var l=0;l<i.length;l++){var u=i[l],h=o.getViewport(u),p=b[l];p.matrix.fromArray(u.transform.matrix),p.projectionMatrix.fromArray(u.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===l&&A.matrix.copy(p.matrix),!0===a&&A.cameras.push(p)}}for(var m=s.inputSources,v=0;v<f.length;v++){var g=f[v],y=m[v];g.update(y,r,c)}R&&R(n,r)}),this.setAnimationLoop=function(t){R=t},this.dispose=function(){}}function rF(t){function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.specularMap&&(n.specularMap.value=r.specularMap);var i,o,a=t.get(r).envMap;if(a){n.envMap.value=a,n.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,n.reflectivity.value=r.reflectivity,n.refractionRatio.value=r.refractionRatio;var s=t.get(a).__maxMipLevel;void 0!==s&&(n.maxMipLevel.value=s)}r.lightMap&&(n.lightMap.value=r.lightMap,n.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?i=r.map:r.specularMap?i=r.specularMap:r.displacementMap?i=r.displacementMap:r.normalMap?i=r.normalMap:r.bumpMap?i=r.bumpMap:r.roughnessMap?i=r.roughnessMap:r.metalnessMap?i=r.metalnessMap:r.alphaMap?i=r.alphaMap:r.emissiveMap?i=r.emissiveMap:r.clearcoatMap?i=r.clearcoatMap:r.clearcoatNormalMap?i=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(i=r.clearcoatRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),n.uvTransform.value.copy(i.matrix)),r.aoMap?o=r.aoMap:r.lightMap&&(o=r.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uv2Transform.value.copy(o.matrix))}function r(n,r){n.roughness.value=r.roughness,n.metalness.value=r.metalness,r.roughnessMap&&(n.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(n.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,1===r.side&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),1===r.side&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),t.get(r).envMap&&(n.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(t,n){t.fogColor.value.copy(n.color),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,i,o,a){var s,l;i.isMeshBasicMaterial?n(t,i):i.isMeshLambertMaterial?(n(t,i),i.emissiveMap&&(t.emissiveMap.value=i.emissiveMap)):i.isMeshToonMaterial?(n(t,i),i.gradientMap&&(t.gradientMap.value=i.gradientMap),i.emissiveMap&&(t.emissiveMap.value=i.emissiveMap),i.bumpMap&&(t.bumpMap.value=i.bumpMap,t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias)):i.isMeshPhongMaterial?(n(t,i),t.specular.value.copy(i.specular),t.shininess.value=Math.max(i.shininess,1e-4),i.emissiveMap&&(t.emissiveMap.value=i.emissiveMap),i.bumpMap&&(t.bumpMap.value=i.bumpMap,t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias)):i.isMeshStandardMaterial?(n(t,i),i.isMeshPhysicalMaterial?(r(t,i),t.reflectivity.value=i.reflectivity,t.clearcoat.value=i.clearcoat,t.clearcoatRoughness.value=i.clearcoatRoughness,i.sheen&&t.sheen.value.copy(i.sheen),i.clearcoatMap&&(t.clearcoatMap.value=i.clearcoatMap),i.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=i.clearcoatRoughnessMap),i.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(i.clearcoatNormalScale),t.clearcoatNormalMap.value=i.clearcoatNormalMap,1===i.side&&t.clearcoatNormalScale.value.negate()),t.transmission.value=i.transmission,i.transmissionMap&&(t.transmissionMap.value=i.transmissionMap)):r(t,i)):i.isMeshMatcapMaterial?(n(t,i),i.matcap&&(t.matcap.value=i.matcap),i.bumpMap&&(t.bumpMap.value=i.bumpMap,t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias)):i.isMeshDepthMaterial?(n(t,i),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(n(t,i),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias),t.referencePosition.value.copy(i.referencePosition),t.nearDistance.value=i.nearDistance,t.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(n(t,i),i.bumpMap&&(t.bumpMap.value=i.bumpMap,t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(t.diffuse.value.copy(i.color),t.opacity.value=i.opacity,i.isLineDashedMaterial&&(t.dashSize.value=i.dashSize,t.totalSize.value=i.dashSize+i.gapSize,t.scale.value=i.scale)):i.isPointsMaterial?(t.diffuse.value.copy(i.color),t.opacity.value=i.opacity,t.size.value=i.size*o,t.scale.value=.5*a,i.map&&(t.map.value=i.map),i.alphaMap&&(t.alphaMap.value=i.alphaMap),i.map?s=i.map:i.alphaMap&&(s=i.alphaMap),void 0!==s&&(!0===s.matrixAutoUpdate&&s.updateMatrix(),t.uvTransform.value.copy(s.matrix))):i.isSpriteMaterial?(t.diffuse.value.copy(i.color),t.opacity.value=i.opacity,t.rotation.value=i.rotation,i.map&&(t.map.value=i.map),i.alphaMap&&(t.alphaMap.value=i.alphaMap),i.map?l=i.map:i.alphaMap&&(l=i.alphaMap),void 0!==l&&(!0===l.matrixAutoUpdate&&l.updateMatrix(),t.uvTransform.value.copy(l.matrix))):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function rk(t){var n,r,i,o,a,s,l,c,u,h,d,p,f,m,v,g,y,b,A,E,M,_,T,S=void 0!==(t=t||{}).canvas?t.canvas:((r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",r),L=void 0!==t.context?t.context:null,R=void 0!==t.alpha&&t.alpha,P=void 0===t.depth||t.depth,O=void 0===t.stencil||t.stencil,I=void 0!==t.antialias&&t.antialias,B=void 0===t.premultipliedAlpha||t.premultipliedAlpha,F=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,k=void 0!==t.powerPreference?t.powerPreference:"default",N=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,U=null,H=null,G=[];this.domElement=S,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var z=this,j=!1,V=null,W=0,q=0,X=null,Y=null,Q=-1,Z=null,K=new C,J=new C,$=null,ee=S.width,et=S.height,en=1,er=null,ei=null,eo=new C(0,0,ee,et),es=new C(0,0,ee,et),el=!1,ec=new tZ,eu=!1,eh=!1,ed=new ea,ep=new D,ef={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function em(){return null===X?en:1}var ev=L;function eg(t,n){for(var r=0;r<t.length;r++){var i=t[r],o=S.getContext(i,n);if(null!==o)return o}return null}try{if(S.addEventListener("webglcontextlost",ew,!1),S.addEventListener("webglcontextrestored",eE,!1),null===ev){var ey=["webgl2","webgl","experimental-webgl"];if(!0===z.isWebGL1Renderer&&ey.shift(),ev=eg(ey,{alpha:R,depth:P,stencil:O,antialias:I,premultipliedAlpha:B,preserveDrawingBuffer:F,powerPreference:k,failIfMajorPerformanceCaveat:N}),null===ev){if(eg(ey))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}}void 0===ev.getShaderPrecisionFormat&&(ev.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function eb(){i=new t9(ev),o=new t6(ev,i,t),i.init(o),_=new rC(ev,i,o),(a=new rT(ev,i,o)).scissor(J.copy(es).multiplyScalar(en).floor()),a.viewport(K.copy(eo).multiplyScalar(en).floor()),s=new nn(ev),l=new rd,c=new rS(ev,i,a,l,o,_,s),u=new t8(z),h=new tJ(ev,o),T=new t4(ev,i,h,o),d=new ne(ev,h,s,T),p=new na(ev,d,h,s),A=new no(ev),y=new t7(l),f=new rh(z,u,i,o,T,y),m=new rF(l),v=new rv(l),g=new rw(i,o),b=new t3(z,u,a,p,B),E=new t5(ev,i,s,o),M=new nt(ev,i,s,o),s.programs=f.programs,z.capabilities=o,z.extensions=i,z.properties=l,z.renderLists=v,z.state=a,z.info=s}eb();var eA="undefined"!=typeof navigator&&"xr"in navigator?new rB(z,ev):new rO(z);this.xr=eA;var ex=new r_(z,p,o.maxTextureSize);function ew(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),j=!0}function eE(){console.log("THREE.WebGLRenderer: Context Restored."),j=!1,eb()}function eM(t){var n=t.target;n.removeEventListener("dispose",eM),e_(n),l.remove(n)}function e_(t){var n=l.get(t).program;void 0!==n&&f.releaseProgram(n)}this.shadowMap=ex,this.getContext=function(){return ev},this.getContextAttributes=function(){return ev.getContextAttributes()},this.forceContextLoss=function(){var t=i.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=i.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return en},this.setPixelRatio=function(t){void 0!==t&&(en=t,this.setSize(ee,et,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new w),t.set(ee,et)},this.setSize=function(t,n,r){if(eA.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ee=t,et=n,S.width=Math.floor(t*en),S.height=Math.floor(n*en),!1!==r&&(S.style.width=t+"px",S.style.height=n+"px"),this.setViewport(0,0,t,n)},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new w),t.set(ee*en,et*en).floor()},this.setDrawingBufferSize=function(t,n,r){ee=t,et=n,en=r,S.width=Math.floor(t*r),S.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new C),t.copy(K)},this.getViewport=function(t){return t.copy(eo)},this.setViewport=function(t,n,r,i){t.isVector4?eo.set(t.x,t.y,t.z,t.w):eo.set(t,n,r,i),a.viewport(K.copy(eo).multiplyScalar(en).floor())},this.getScissor=function(t){return t.copy(es)},this.setScissor=function(t,n,r,i){t.isVector4?es.set(t.x,t.y,t.z,t.w):es.set(t,n,r,i),a.scissor(J.copy(es).multiplyScalar(en).floor())},this.getScissorTest=function(){return el},this.setScissorTest=function(t){a.setScissorTest(el=t)},this.setOpaqueSort=function(t){er=t},this.setTransparentSort=function(t){ei=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new e$),t.copy(b.getClearColor())},this.setClearColor=function(){b.setClearColor.apply(b,arguments)},this.getClearAlpha=function(){return b.getClearAlpha()},this.setClearAlpha=function(){b.setClearAlpha.apply(b,arguments)},this.clear=function(t,n,r){var i=0;(void 0===t||t)&&(i|=16384),(void 0===n||n)&&(i|=256),(void 0===r||r)&&(i|=1024),ev.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){S.removeEventListener("webglcontextlost",ew,!1),S.removeEventListener("webglcontextrestored",eE,!1),v.dispose(),g.dispose(),l.dispose(),u.dispose(),p.dispose(),T.dispose(),eA.dispose(),eS.stop()},this.renderBufferImmediate=function(t,n){T.initAttributes();var r=l.get(t);t.hasPositions&&!r.position&&(r.position=ev.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=ev.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=ev.createBuffer()),t.hasColors&&!r.color&&(r.color=ev.createBuffer());var i=n.getAttributes();t.hasPositions&&(ev.bindBuffer(34962,r.position),ev.bufferData(34962,t.positionArray,35048),T.enableAttribute(i.position),ev.vertexAttribPointer(i.position,3,5126,!1,0,0)),t.hasNormals&&(ev.bindBuffer(34962,r.normal),ev.bufferData(34962,t.normalArray,35048),T.enableAttribute(i.normal),ev.vertexAttribPointer(i.normal,3,5126,!1,0,0)),t.hasUvs&&(ev.bindBuffer(34962,r.uv),ev.bufferData(34962,t.uvArray,35048),T.enableAttribute(i.uv),ev.vertexAttribPointer(i.uv,2,5126,!1,0,0)),t.hasColors&&(ev.bindBuffer(34962,r.color),ev.bufferData(34962,t.colorArray,35048),T.enableAttribute(i.color),ev.vertexAttribPointer(i.color,3,5126,!1,0,0)),T.disableUnusedAttributes(),ev.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,r,i,o,s){null===n&&(n=ef);var l,c=o.isMesh&&0>o.matrixWorld.determinant(),u=eP(t,n,i,o);a.setMaterial(i,c);var p=r.index,f=r.attributes.position;if(null===p){if(void 0===f||0===f.count)return}else if(0===p.count)return;var m=1;!0===i.wireframe&&(p=d.getWireframeAttribute(r),m=2),(i.morphTargets||i.morphNormals)&&A.update(o,r,i,u),T.setup(o,i,u,r,p);var v=E;null!==p&&(l=h.get(p),(v=M).setIndex(l));var g=null!==p?p.count:f.count,y=r.drawRange.start*m,b=r.drawRange.count*m,x=null!==s?s.start*m:0,w=null!==s?s.count*m:1/0,_=Math.max(y,x),S=Math.max(0,Math.min(g,y+b,x+w)-1-_+1);if(0!==S){if(o.isMesh)!0===i.wireframe?(a.setLineWidth(i.wireframeLinewidth*em()),v.setMode(1)):v.setMode(4);else if(o.isLine){var C=i.linewidth;void 0===C&&(C=1),a.setLineWidth(C*em()),o.isLineSegments?v.setMode(1):o.isLineLoop?v.setMode(2):v.setMode(3)}else o.isPoints?v.setMode(0):o.isSprite&&v.setMode(4);if(o.isInstancedMesh)v.renderInstances(_,S,o.count);else if(r.isInstancedBufferGeometry){var L=Math.min(r.instanceCount,r._maxInstanceCount);v.renderInstances(_,S,L)}else v.render(_,S)}},this.compile=function(t,n){(H=g.get(t)).init(),t.traverseVisible(function(t){t.isLight&&t.layers.test(n.layers)&&(H.pushLight(t),t.castShadow&&H.pushShadow(t))}),H.setupLights();var r=new WeakMap;t.traverse(function(n){var i=n.material;if(i){if(Array.isArray(i))for(var o=0;o<i.length;o++){var a=i[o];!1===r.has(a)&&(eR(a,t,n),r.set(a))}else!1===r.has(i)&&(eR(i,t,n),r.set(i))}})};var eT=null,eS=new tK;function eC(t,n,r){for(var i=!0===n.isScene?n.overrideMaterial:null,o=0,s=t.length;o<s;o++){var l=t[o],c=l.object,u=l.geometry,h=null===i?l.material:i,d=l.group;if(r.isArrayCamera)for(var p=r.cameras,f=0,m=p.length;f<m;f++){var v=p[f];c.layers.test(v.layers)&&(a.viewport(K.copy(v.viewport)),H.setupLightsView(v),eL(c,n,v,u,h,d))}else eL(c,n,r,u,h,d)}}function eL(t,n,r,i,o,s){if(t.onBeforeRender(z,n,r,i,o,s),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var l=eP(r,n,o,t);a.setMaterial(o),T.reset(),function(t,n){t.render(function(t){z.renderBufferImmediate(t,n)})}(t,l)}else z.renderBufferDirect(r,n,i,o,t,s);t.onAfterRender(z,n,r,i,o,s)}function eR(t,n,r){!0!==n.isScene&&(n=ef);var i=l.get(t),o=H.state.lights,a=H.state.shadowsArray,s=o.state.version,c=f.getParameters(t,o.state,a,n,r),h=f.getProgramCacheKey(c),d=i.program,p=!0;if(i.environment=t.isMeshStandardMaterial?n.environment:null,i.fog=n.fog,i.envMap=u.get(t.envMap||i.environment),void 0===d)t.addEventListener("dispose",eM);else if(d.cacheKey!==h)e_(t);else if(i.lightsStateVersion!==s)p=!1;else{if(void 0!==c.shaderID)return;p=!1}p&&(c.uniforms=f.getUniforms(t),t.onBeforeCompile(c,z),d=f.acquireProgram(c,h),i.program=d,i.uniforms=c.uniforms,i.outputEncoding=c.outputEncoding);var m=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(i.numClippingPlanes=y.numPlanes,i.numIntersection=y.numIntersection,m.clippingPlanes=y.uniform),i.needsLights=t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights,i.lightsStateVersion=s,i.needsLights&&(m.ambientLightColor.value=o.state.ambient,m.lightProbe.value=o.state.probe,m.directionalLights.value=o.state.directional,m.directionalLightShadows.value=o.state.directionalShadow,m.spotLights.value=o.state.spot,m.spotLightShadows.value=o.state.spotShadow,m.rectAreaLights.value=o.state.rectArea,m.ltc_1.value=o.state.rectAreaLTC1,m.ltc_2.value=o.state.rectAreaLTC2,m.pointLights.value=o.state.point,m.pointLightShadows.value=o.state.pointShadow,m.hemisphereLights.value=o.state.hemi,m.directionalShadowMap.value=o.state.directionalShadowMap,m.directionalShadowMatrix.value=o.state.directionalShadowMatrix,m.spotShadowMap.value=o.state.spotShadowMap,m.spotShadowMatrix.value=o.state.spotShadowMatrix,m.pointShadowMap.value=o.state.pointShadowMap,m.pointShadowMatrix.value=o.state.pointShadowMatrix);var v=i.program.getUniforms(),g=n2.seqWithValue(v.seq,m);i.uniformsList=g}function eP(t,n,r,i){!0!==n.isScene&&(n=ef),c.resetTextureUnits();var s,h=n.fog,d=r.isMeshStandardMaterial?n.environment:null,p=null===X?z.outputEncoding:X.texture.encoding,f=u.get(r.envMap||d),v=l.get(r),g=H.state.lights;if(!0===eu&&(!0===eh||t!==Z)){var b=t===Z&&r.id===Q;y.setState(r,t,b)}r.version===v.__version?r.fog&&v.fog!==h?eR(r,n,i):v.environment!==d?eR(r,n,i):v.needsLights&&v.lightsStateVersion!==g.state.version?eR(r,n,i):void 0!==v.numClippingPlanes&&(v.numClippingPlanes!==y.numPlanes||v.numIntersection!==y.numIntersection)?eR(r,n,i):v.outputEncoding!==p?eR(r,n,i):v.envMap!==f&&eR(r,n,i):(eR(r,n,i),v.__version=r.version);var A=!1,w=!1,E=!1,M=v.program,_=M.getUniforms(),T=v.uniforms;if(a.useProgram(M.program)&&(A=!0,w=!0,E=!0),r.id!==Q&&(Q=r.id,w=!0),A||Z!==t){if(_.setValue(ev,"projectionMatrix",t.projectionMatrix),o.logarithmicDepthBuffer&&_.setValue(ev,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),Z!==t&&(Z=t,w=!0,E=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){var S=_.map.cameraPosition;void 0!==S&&S.setValue(ev,ep.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&_.setValue(ev,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||r.skinning)&&_.setValue(ev,"viewMatrix",t.matrixWorldInverse)}if(r.skinning){_.setOptional(ev,i,"bindMatrix"),_.setOptional(ev,i,"bindMatrixInverse");var C=i.skeleton;if(C){var L=C.bones;if(o.floatVertexTextures){if(null===C.boneTexture){var R=Math.sqrt(4*L.length),P=new Float32Array((R=Math.max(R=x.ceilPowerOfTwo(R),4))*R*4);P.set(C.boneMatrices);var D=new tX(P,R,R,1023,1015);C.boneMatrices=P,C.boneTexture=D,C.boneTextureSize=R}_.setValue(ev,"boneTexture",C.boneTexture,c),_.setValue(ev,"boneTextureSize",C.boneTextureSize)}else _.setOptional(ev,C,"boneMatrices")}}return(w||v.receiveShadow!==i.receiveShadow)&&(v.receiveShadow=i.receiveShadow,_.setValue(ev,"receiveShadow",i.receiveShadow)),w&&(_.setValue(ev,"toneMappingExposure",z.toneMappingExposure),v.needsLights&&(s=E,T.ambientLightColor.needsUpdate=s,T.lightProbe.needsUpdate=s,T.directionalLights.needsUpdate=s,T.directionalLightShadows.needsUpdate=s,T.pointLights.needsUpdate=s,T.pointLightShadows.needsUpdate=s,T.spotLights.needsUpdate=s,T.spotLightShadows.needsUpdate=s,T.rectAreaLights.needsUpdate=s,T.hemisphereLights.needsUpdate=s),h&&r.fog&&m.refreshFogUniforms(T,h),m.refreshMaterialUniforms(T,r,en,et),n2.upload(ev,v.uniformsList,T,c)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(n2.upload(ev,v.uniformsList,T,c),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&_.setValue(ev,"center",i.center),_.setValue(ev,"modelViewMatrix",i.modelViewMatrix),_.setValue(ev,"normalMatrix",i.normalMatrix),_.setValue(ev,"modelMatrix",i.matrixWorld),M}eS.setAnimationLoop(function(t){!eA.isPresenting&&eT&&eT(t)}),"undefined"!=typeof window&&eS.setContext(window),this.setAnimationLoop=function(t){eT=t,eA.setAnimationLoop(t),null===t?eS.stop():eS.start()},this.render=function(t,n){if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),i=arguments[3]),void 0!==n&&!0!==n.isCamera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!0!==j){T.resetDefaultState(),Q=-1,Z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),!0===eA.enabled&&!0===eA.isPresenting&&(n=eA.getCamera(n)),!0===t.isScene&&t.onBeforeRender(z,t,n,r||X),(H=g.get(t,G.length)).init(),G.push(H),ed.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),ec.setFromProjectionMatrix(ed),eh=this.localClippingEnabled,eu=y.init(this.clippingPlanes,eh,n),(U=v.get(t,n)).init(),function t(n,r,i,o){if(!1!==n.visible){if(n.layers.test(r.layers)){if(n.isGroup)i=n.renderOrder;else if(n.isLOD)!0===n.autoUpdate&&n.update(r);else if(n.isLight)H.pushLight(n),n.castShadow&&H.pushShadow(n);else if(n.isSprite){if(!n.frustumCulled||ec.intersectsSprite(n)){o&&ep.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ed);var a=p.update(n),l=n.material;l.visible&&U.push(n,a,l,i,ep.z,null)}}else if(n.isImmediateRenderObject)o&&ep.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ed),U.push(n,null,n.material,i,ep.z,null);else if((n.isMesh||n.isLine||n.isPoints)&&(n.isSkinnedMesh&&n.skeleton.frame!==s.render.frame&&(n.skeleton.update(),n.skeleton.frame=s.render.frame),!n.frustumCulled||ec.intersectsObject(n))){o&&ep.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ed);var c=p.update(n),u=n.material;if(Array.isArray(u))for(var h=c.groups,d=0,f=h.length;d<f;d++){var m=h[d],v=u[m.materialIndex];v&&v.visible&&U.push(n,c,v,i,ep.z,m)}else u.visible&&U.push(n,c,u,i,ep.z,null)}}for(var g=n.children,y=0,b=g.length;y<b;y++)t(g[y],r,i,o)}}(t,n,0,z.sortObjects),U.finish(),!0===z.sortObjects&&U.sort(er,ei),!0===eu&&y.beginShadows();var r,i,o=H.state.shadowsArray;ex.render(o,t,n),H.setupLights(),H.setupLightsView(n),!0===eu&&y.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),b.render(U,t,n,i);var l=U.opaque,u=U.transparent;l.length>0&&eC(l,t,n),u.length>0&&eC(u,t,n),!0===t.isScene&&t.onAfterRender(z,t,n),null!==X&&(c.updateRenderTargetMipmap(X),c.updateMultisampleRenderTarget(X)),a.buffers.depth.setTest(!0),a.buffers.depth.setMask(!0),a.buffers.color.setMask(!0),a.setPolygonOffset(!1),eA.enabled&&eA.submitFrame&&eA.submitFrame(),G.pop(),H=G.length>0?G[G.length-1]:null,U=null}},this.setTexture2D=(n=!1,function(t,r){t&&t.isWebGLRenderTarget&&(n||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),n=!0),t=t.texture),c.setTexture2D(t,r)}),this.setFramebuffer=function(t){V!==t&&null===X&&ev.bindFramebuffer(36160,t),V=t},this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return q},this.getRenderList=function(){return U},this.setRenderList=function(t){U=t},this.getRenderTarget=function(){return X},this.setRenderTarget=function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),X=t,W=n,q=r,t&&void 0===l.get(t).__webglFramebuffer&&c.setupRenderTarget(t);var i=V,o=!1;if(t){var s=l.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=s[n],o=!0):i=t.isWebGLMultisampleRenderTarget?l.get(t).__webglMultisampledFramebuffer:s,K.copy(t.viewport),J.copy(t.scissor),$=t.scissorTest}else K.copy(eo).multiplyScalar(en).floor(),J.copy(es).multiplyScalar(en).floor(),$=el;if(Y!==i&&(ev.bindFramebuffer(36160,i),Y=i),a.viewport(K),a.scissor(J),a.setScissorTest($),o){var u=l.get(t.texture);ev.framebufferTexture2D(36160,36064,34069+n,u.__webglTexture,r)}},this.readRenderTargetPixels=function(t,n,r,a,s,c,u){if(!(t&&t.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var h=l.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==u&&(h=h[u]),h){var d=!1;h!==Y&&(ev.bindFramebuffer(36160,h),d=!0);try{var p=t.texture,f=p.format,m=p.type;if(1023!==f&&_.convert(f)!==ev.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}var v=1016===m&&(i.has("EXT_color_buffer_half_float")||o.isWebGL2&&i.has("EXT_color_buffer_float"));if(1009!==m&&_.convert(m)!==ev.getParameter(35738)&&!(1015===m&&(o.isWebGL2||i.has("OES_texture_float")||i.has("WEBGL_color_buffer_float")))&&!v){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}36053===ev.checkFramebufferStatus(36160)?n>=0&&n<=t.width-a&&r>=0&&r<=t.height-s&&ev.readPixels(n,r,a,s,_.convert(f),_.convert(m),c):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{d&&ev.bindFramebuffer(36160,Y)}}},this.copyFramebufferToTexture=function(t,n,r){void 0===r&&(r=0);var i=Math.pow(2,-r),o=Math.floor(n.image.width*i),s=Math.floor(n.image.height*i),l=_.convert(n.format);c.setTexture2D(n,0),ev.copyTexImage2D(3553,r,l,t.x,t.y,o,s,0),a.unbindTexture()},this.copyTextureToTexture=function(t,n,r,i){void 0===i&&(i=0);var o=n.image.width,s=n.image.height,l=_.convert(r.format),u=_.convert(r.type);c.setTexture2D(r,0),ev.pixelStorei(37440,r.flipY),ev.pixelStorei(37441,r.premultiplyAlpha),ev.pixelStorei(3317,r.unpackAlignment),n.isDataTexture?ev.texSubImage2D(3553,i,t.x,t.y,o,s,l,u,n.image.data):n.isCompressedTexture?ev.compressedTexSubImage2D(3553,i,t.x,t.y,n.mipmaps[0].width,n.mipmaps[0].height,l,n.mipmaps[0].data):ev.texSubImage2D(3553,i,t.x,t.y,l,u,n.image),0===i&&r.generateMipmaps&&ev.generateMipmap(3553),a.unbindTexture()},this.initTexture=function(t){c.setTexture2D(t,0),a.unbindTexture()},this.resetState=function(){a.reset(),T.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function rN(t){rk.call(this,t)}Object.assign(rO.prototype,g.prototype),Object.assign(rI.prototype,{constructor:rI,getHandSpace:function(){return null===this._hand&&(this._hand=new rL,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new rL,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new rL,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,n,r){var i=null,o=null,a=null,s=this._targetRay,l=this._grip,c=this._hand;if(t&&"visible-blurred"!==n.session.visibilityState){if(c&&t.hand){a=!0;for(var u,h=function(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return v(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(t,void 0)}}(t))){r&&(t=r);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=t[Symbol.iterator]()).next.bind(r)}(t.hand.values());!(u=h()).done;){var d=u.value,p=n.getJointPose(d,r);if(void 0===c.joints[d.jointName]){var f=new rL;f.matrixAutoUpdate=!1,f.visible=!1,c.joints[d.jointName]=f,c.add(f)}var m=c.joints[d.jointName];null!==p&&(m.matrix.fromArray(p.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=p.radius),m.visible=null!==p}var g=c.joints["index-finger-tip"],y=c.joints["thumb-tip"],b=g.position.distanceTo(y.position);c.inputState.pinching&&b>.025?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&b<=.015&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&null!==(i=n.getPose(t.targetRaySpace,r))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)),null!==l&&t.gripSpace&&null!==(o=n.getPose(t.gripSpace,r))&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale))}return null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==o),null!==c&&(c.visible=null!==a),this}}),Object.assign(rB.prototype,g.prototype),rN.prototype=Object.assign(Object.create(rk.prototype),{constructor:rN,isWebGL1Renderer:!0});var rU=function(){function t(t,n){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new e$(t),this.density=void 0!==n?n:25e-5}var n=t.prototype;return n.clone=function(){return new t(this.color,this.density)},n.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},t}(),rH=function(){function t(t,n,r){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new e$(t),this.near=void 0!==n?n:1,this.far=void 0!==r?r:1e3}var n=t.prototype;return n.clone=function(){return new t(this.color,this.near,this.far)},n.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},t}(),rG=function(t){function n(){var n;return Object.defineProperty(m(n=t.call(this)||this),"isScene",{value:!0}),n.type="Scene",n.background=null,n.environment=null,n.fog=null,n.overrideMaterial=null,n.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:m(n)})),n}f(n,t);var r=n.prototype;return r.copy=function(n,r){return t.prototype.copy.call(this,n,r),null!==n.background&&(this.background=n.background.clone()),null!==n.environment&&(this.environment=n.environment.clone()),null!==n.fog&&(this.fog=n.fog.clone()),null!==n.overrideMaterial&&(this.overrideMaterial=n.overrideMaterial.clone()),this.autoUpdate=n.autoUpdate,this.matrixAutoUpdate=n.matrixAutoUpdate,this},r.toJSON=function(n){var r=t.prototype.toJSON.call(this,n);return null!==this.background&&(r.object.background=this.background.toJSON(n)),null!==this.environment&&(r.object.environment=this.environment.toJSON(n)),null!==this.fog&&(r.object.fog=this.fog.toJSON()),r},n}(eP);function rz(t,n){this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=x.generateUUID()}Object.defineProperty(rz.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(rz.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,n,r){t*=this.stride,r*=n.stride;for(var i=0,o=this.stride;i<o;i++)this.array[t+i]=n.array[r+i];return this},set:function(t,n){return void 0===n&&(n=0),this.array.set(t,n),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=x.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var n=new rz(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return n.setUsage(this.usage),n},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=x.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var rj=new D;function rV(t,n,r,i){this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=!0===i}function rW(t){e2.call(this),this.type="SpriteMaterial",this.color=new e$(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(rV.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(rV.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var n=0,r=this.data.count;n<r;n++)rj.x=this.getX(n),rj.y=this.getY(n),rj.z=this.getZ(n),rj.applyMatrix4(t),this.setXYZ(n,rj.x,rj.y,rj.z);return this},setX:function(t,n){return this.data.array[t*this.data.stride+this.offset]=n,this},setY:function(t,n){return this.data.array[t*this.data.stride+this.offset+1]=n,this},setZ:function(t,n){return this.data.array[t*this.data.stride+this.offset+2]=n,this},setW:function(t,n){return this.data.array[t*this.data.stride+this.offset+3]=n,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=r,this},setXYZ:function(t,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=r,this.data.array[t+2]=i,this},setXYZW:function(t,n,r,i,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=r,this.data.array[t+2]=i,this.data.array[t+3]=o,this},clone:function(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new rV(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)n.push(this.data.array[i+o]);return new e6(new this.array.constructor(n),this.itemSize,this.normalized)},toJSON:function(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)n.push(this.data.array[i+o]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}}),rW.prototype=Object.create(e2.prototype),rW.prototype.constructor=rW,rW.prototype.isSpriteMaterial=!0,rW.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var rq=new D,rX=new D,rY=new D,rQ=new w,rZ=new w,rK=new ea,rJ=new D,r$=new D,r0=new D,r1=new w,r2=new w,r3=new w;function r4(t){if(eP.call(this),this.type="Sprite",void 0===i){i=new tg;var n=new rz(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);i.setIndex([0,1,2,0,2,3]),i.setAttribute("position",new rV(n,3,0,!1)),i.setAttribute("uv",new rV(n,2,3,!1))}this.geometry=i,this.material=void 0!==t?t:new rW,this.center=new w(.5,.5)}function r5(t,n,r,i,o,a){rQ.subVectors(t,r).addScalar(.5).multiply(i),void 0!==o?(rZ.x=a*rQ.x-o*rQ.y,rZ.y=o*rQ.x+a*rQ.y):rZ.copy(rQ),t.copy(n),t.x+=rZ.x,t.y+=rZ.y,t.applyMatrix4(rK)}r4.prototype=Object.assign(Object.create(eP.prototype),{constructor:r4,isSprite:!0,raycast:function(t,n){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),rX.setFromMatrixScale(this.matrixWorld),rK.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),rY.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&rX.multiplyScalar(-rY.z);var r,i,o=this.material.rotation;0!==o&&(i=Math.cos(o),r=Math.sin(o));var a=this.center;r5(rJ.set(-.5,-.5,0),rY,a,rX,r,i),r5(r$.set(.5,-.5,0),rY,a,rX,r,i),r5(r0.set(.5,.5,0),rY,a,rX,r,i),r1.set(0,0),r2.set(1,0),r3.set(1,1);var s=t.ray.intersectTriangle(rJ,r$,r0,!1,rq);if(null!==s||(r5(r$.set(-.5,.5,0),rY,a,rX,r,i),r2.set(0,1),null!==(s=t.ray.intersectTriangle(rJ,r0,r$,!1,rq)))){var l=t.ray.origin.distanceTo(rq);l<t.near||l>t.far||n.push({distance:l,point:rq.clone(),uv:eq.getUV(rq,rJ,r$,r0,r1,r2,r3,new w),face:null,object:this})}},copy:function(t){return eP.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});var r6=new D,r7=new D;function r8(){eP.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}r8.prototype=Object.assign(Object.create(eP.prototype),{constructor:r8,isLOD:!0,copy:function(t){eP.prototype.copy.call(this,t,!1);for(var n=t.levels,r=0,i=n.length;r<i;r++){var o=n[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,n){void 0===n&&(n=0),n=Math.abs(n);var r,i=this.levels;for(r=0;r<i.length&&!(n<i[r].distance);r++);return i.splice(r,0,{distance:n,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var n,r,i=this.levels;if(i.length>0){for(n=1,r=i.length;n<r&&!(t<i[n].distance);n++);return i[n-1].object}return null},raycast:function(t,n){if(this.levels.length>0){r6.setFromMatrixPosition(this.matrixWorld);var r=t.ray.origin.distanceTo(r6);this.getObjectForDistance(r).raycast(t,n)}},update:function(t){var n=this.levels;if(n.length>1){r6.setFromMatrixPosition(t.matrixWorld),r7.setFromMatrixPosition(this.matrixWorld);var r,i,o=r6.distanceTo(r7)/t.zoom;for(r=1,n[0].object.visible=!0,i=n.length;r<i;r++)if(o>=n[r].distance)n[r-1].object.visible=!1,n[r].object.visible=!0;else break;for(this._currentLevel=r-1;r<i;r++)n[r].object.visible=!1}},toJSON:function(t){var n=eP.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(n.object.autoUpdate=!1),n.object.levels=[];for(var r=this.levels,i=0,o=r.length;i<o;i++){var a=r[i];n.object.levels.push({object:a.object.uuid,distance:a.distance})}return n}});var r9=new D,ie=new C,it=new C,ir=new D,ii=new ea;function io(t,n){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),tB.call(this,t,n),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ea,this.bindMatrixInverse=new ea}function ia(){eP.call(this),this.type="Bone"}io.prototype=Object.assign(Object.create(tB.prototype),{constructor:io,isSkinnedMesh:!0,copy:function(t){return tB.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,n){this.skeleton=t,void 0===n&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new C,n=this.geometry.attributes.skinWeight,r=0,i=n.count;r<i;r++){t.x=n.getX(r),t.y=n.getY(r),t.z=n.getZ(r),t.w=n.getW(r);var o=1/t.manhattanLength();o!==1/0?t.multiplyScalar(o):t.set(1,0,0,0),n.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){tB.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,n){var r=this.skeleton,i=this.geometry;ie.fromBufferAttribute(i.attributes.skinIndex,t),it.fromBufferAttribute(i.attributes.skinWeight,t),r9.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(var o=0;o<4;o++){var a=it.getComponent(o);if(0!==a){var s=ie.getComponent(o);ii.multiplyMatrices(r.bones[s].matrixWorld,r.boneInverses[s]),n.addScaledVector(ir.copy(r9).applyMatrix4(ii),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}),ia.prototype=Object.assign(Object.create(eP.prototype),{constructor:ia,isBone:!0});var is=new ea,il=new ea;function ic(t,n){void 0===t&&(t=[]),void 0===n&&(n=[]),this.uuid=x.generateUUID(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(ic.prototype,{init:function(){var t=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===n.length)this.calculateInverses();else if(t.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new ea)}},calculateInverses:function(){this.boneInverses.length=0;for(var t=0,n=this.bones.length;t<n;t++){var r=new ea;this.bones[t]&&r.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(r)}},pose:function(){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];r&&r.matrixWorld.copy(this.boneInverses[t]).invert()}for(var i=0,o=this.bones.length;i<o;i++){var a=this.bones[i];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}},update:function(){for(var t=this.bones,n=this.boneInverses,r=this.boneMatrices,i=this.boneTexture,o=0,a=t.length;o<a;o++){var s=t[o]?t[o].matrixWorld:il;is.multiplyMatrices(s,n[o]),is.toArray(r,16*o)}null!==i&&(i.needsUpdate=!0)},clone:function(){return new ic(this.bones,this.boneInverses)},getBoneByName:function(t){for(var n=0,r=this.bones.length;n<r;n++){var i=this.bones[n];if(i.name===t)return i}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,n){this.uuid=t.uuid;for(var r=0,i=t.bones.length;r<i;r++){var o=t.bones[r],a=n[o];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new ia),this.bones.push(a),this.boneInverses.push(new ea().fromArray(t.boneInverses[r]))}return this.init(),this},toJSON:function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var n=this.bones,r=this.boneInverses,i=0,o=n.length;i<o;i++){var a=n[i];t.bones.push(a.uuid);var s=r[i];t.boneInverses.push(s.toArray())}return t}});var iu=new ea,ih=new ea,id=[],ip=new tB;function im(t,n,r){tB.call(this,t,n),this.instanceMatrix=new e6(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}function iv(t){e2.call(this),this.type="LineBasicMaterial",this.color=new e$(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}im.prototype=Object.assign(Object.create(tB.prototype),{constructor:im,isInstancedMesh:!0,copy:function(t){return tB.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,n){n.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,n){n.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,n){var r=this.matrixWorld,i=this.count;if(ip.geometry=this.geometry,ip.material=this.material,void 0!==ip.material)for(var o=0;o<i;o++){this.getMatrixAt(o,iu),ih.multiplyMatrices(r,iu),ip.matrixWorld=ih,ip.raycast(t,id);for(var a=0,s=id.length;a<s;a++){var l=id[a];l.instanceId=o,l.object=this,n.push(l)}id.length=0}},setColorAt:function(t,n){null===this.instanceColor&&(this.instanceColor=new e6(new Float32Array(3*this.count),3)),n.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,n){n.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),iv.prototype=Object.create(e2.prototype),iv.prototype.constructor=iv,iv.prototype.isLineBasicMaterial=!0,iv.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var ig=new D,iy=new D,ib=new ea,iA=new eo,ix=new K;function iw(t,n){void 0===t&&(t=new tg),void 0===n&&(n=new iv),eP.call(this),this.type="Line",this.geometry=t,this.material=n,this.updateMorphTargets()}iw.prototype=Object.assign(Object.create(eP.prototype),{constructor:iw,isLine:!0,copy:function(t){return eP.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var n=t.attributes.position,r=[0],i=1,o=n.count;i<o;i++)ig.fromBufferAttribute(n,i-1),iy.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=ig.distanceTo(iy);t.setAttribute("lineDistance",new to(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,n){var r=this.geometry,i=this.matrixWorld,o=t.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),ix.copy(r.boundingSphere),ix.applyMatrix4(i),ix.radius+=o,!1!==t.ray.intersectsSphere(ix)){ib.copy(i).invert(),iA.copy(t.ray).applyMatrix4(ib);var a=o/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=new D,c=new D,u=new D,h=new D,d=this.isLineSegments?2:1;if(r.isBufferGeometry){var p=r.index,f=r.attributes.position;if(null!==p)for(var m=p.array,v=0,g=m.length-1;v<g;v+=d){var y=m[v],b=m[v+1];if(l.fromBufferAttribute(f,y),c.fromBufferAttribute(f,b),!(iA.distanceSqToSegment(l,c,h,u)>s)){h.applyMatrix4(this.matrixWorld);var A=t.ray.origin.distanceTo(h);A<t.near||A>t.far||n.push({distance:A,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var x=0,w=f.count-1;x<w;x+=d)if(l.fromBufferAttribute(f,x),c.fromBufferAttribute(f,x+1),!(iA.distanceSqToSegment(l,c,h,u)>s)){h.applyMatrix4(this.matrixWorld);var E=t.ray.origin.distanceTo(h);E<t.near||E>t.far||n.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var n=t.morphAttributes,r=Object.keys(n);if(r.length>0){var i=n[r[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,a=i.length;o<a;o++){var s=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}else{var l=t.morphTargets;void 0!==l&&l.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var iE=new D,iM=new D;function i_(t,n){iw.call(this,t,n),this.type="LineSegments"}function iT(t,n){iw.call(this,t,n),this.type="LineLoop"}function iS(t){e2.call(this),this.type="PointsMaterial",this.color=new e$(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}i_.prototype=Object.assign(Object.create(iw.prototype),{constructor:i_,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var n=t.attributes.position,r=[],i=0,o=n.count;i<o;i+=2)iE.fromBufferAttribute(n,i),iM.fromBufferAttribute(n,i+1),r[i]=0===i?0:r[i-1],r[i+1]=r[i]+iE.distanceTo(iM);t.setAttribute("lineDistance",new to(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),iT.prototype=Object.assign(Object.create(iw.prototype),{constructor:iT,isLineLoop:!0}),iS.prototype=Object.create(e2.prototype),iS.prototype.constructor=iS,iS.prototype.isPointsMaterial=!0,iS.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var iC=new ea,iL=new eo,iR=new K,iP=new D;function iD(t,n){void 0===t&&(t=new tg),void 0===n&&(n=new iS),eP.call(this),this.type="Points",this.geometry=t,this.material=n,this.updateMorphTargets()}function iO(t,n,r,i,o,a,s){var l=iL.distanceSqToPoint(t);if(l<r){var c=new D;iL.closestPointToPoint(t,c),c.applyMatrix4(i);var u=o.ray.origin.distanceTo(c);if(u<o.near||u>o.far)return;a.push({distance:u,distanceToRay:Math.sqrt(l),point:c,index:n,face:null,object:s})}}function iI(t,n,r,i,o,a,s,l,c){T.call(this,t,n,r,i,o,a,s,l,c),this.format=void 0!==s?s:1022,this.minFilter=void 0!==a?a:1006,this.magFilter=void 0!==o?o:1006,this.generateMipmaps=!1;var u=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function n(){u.needsUpdate=!0,t.requestVideoFrameCallback(n)})}function iB(t,n,r,i,o,a,s,l,c,u,h,d){T.call(this,null,a,s,l,c,u,i,o,h,d),this.image={width:n,height:r},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function iF(t,n,r,i,o,a,s,l,c){T.call(this,t,n,r,i,o,a,s,l,c),this.needsUpdate=!0}function ik(t,n,r,i,o,a,s,l,c,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&1026===u&&(r=1012),void 0===r&&1027===u&&(r=1020),T.call(this,null,i,o,a,s,l,u,r,c),this.image={width:t,height:n},this.magFilter=void 0!==s?s:1003,this.minFilter=void 0!==l?l:1003,this.flipY=!1,this.generateMipmaps=!1}iD.prototype=Object.assign(Object.create(eP.prototype),{constructor:iD,isPoints:!0,copy:function(t){return eP.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,n){var r=this.geometry,i=this.matrixWorld,o=t.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),iR.copy(r.boundingSphere),iR.applyMatrix4(i),iR.radius+=o,!1!==t.ray.intersectsSphere(iR)){iC.copy(i).invert(),iL.copy(t.ray).applyMatrix4(iC);var a=o/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(r.isBufferGeometry){var l=r.index,c=r.attributes.position;if(null!==l)for(var u=l.array,h=0,d=u.length;h<d;h++){var p=u[h];iP.fromBufferAttribute(c,p),iO(iP,p,s,i,t,n,this)}else for(var f=0,m=c.count;f<m;f++)iP.fromBufferAttribute(c,f),iO(iP,f,s,i,t,n,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){var n=t.morphAttributes,r=Object.keys(n);if(r.length>0){var i=n[r[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,a=i.length;o<a;o++){var s=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}else{var l=t.morphTargets;void 0!==l&&l.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),iI.prototype=Object.assign(Object.create(T.prototype),{constructor:iI,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),iB.prototype=Object.create(T.prototype),iB.prototype.constructor=iB,iB.prototype.isCompressedTexture=!0,iF.prototype=Object.create(T.prototype),iF.prototype.constructor=iF,iF.prototype.isCanvasTexture=!0,ik.prototype=Object.create(T.prototype),ik.prototype.constructor=ik,ik.prototype.isDepthTexture=!0;var iN=function(t){function n(n,r,i,o){void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),(a=t.call(this)||this).type="CircleGeometry",a.parameters={radius:n,segments:r,thetaStart:i,thetaLength:o},r=Math.max(3,r);var a,s=[],l=[],c=[],u=[],h=new D,d=new w;l.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(var p=0,f=3;p<=r;p++,f+=3){var m=i+p/r*o;h.x=n*Math.cos(m),h.y=n*Math.sin(m),l.push(h.x,h.y,h.z),c.push(0,0,1),d.x=(l[f]/n+1)/2,d.y=(l[f+1]/n+1)/2,u.push(d.x,d.y)}for(var v=1;v<=r;v++)s.push(v,v+1,0);return a.setIndex(s),a.setAttribute("position",new to(l,3)),a.setAttribute("normal",new to(c,3)),a.setAttribute("uv",new to(u,2)),a}return f(n,t),n}(tg),iU=function(t){function n(n,r,i,o,a,s,l,c){void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=8),void 0===a&&(a=1),void 0===s&&(s=!1),void 0===l&&(l=0),void 0===c&&(c=2*Math.PI),(u=t.call(this)||this).type="CylinderGeometry",u.parameters={radiusTop:n,radiusBottom:r,height:i,radialSegments:o,heightSegments:a,openEnded:s,thetaStart:l,thetaLength:c};var u,h=m(u);o=Math.floor(o),a=Math.floor(a);var d=[],p=[],f=[],v=[],g=0,y=[],b=i/2,A=0;function x(t){for(var i=g,a=new w,s=new D,u=0,m=!0===t?n:r,y=!0===t?1:-1,x=1;x<=o;x++)p.push(0,b*y,0),f.push(0,y,0),v.push(.5,.5),g++;for(var E=g,M=0;M<=o;M++){var _=M/o*c+l,T=Math.cos(_),S=Math.sin(_);s.x=m*S,s.y=b*y,s.z=m*T,p.push(s.x,s.y,s.z),f.push(0,y,0),a.x=.5*T+.5,a.y=.5*S*y+.5,v.push(a.x,a.y),g++}for(var C=0;C<o;C++){var L=i+C,R=E+C;!0===t?d.push(R,R+1,L):d.push(R+1,R,L),u+=3}h.addGroup(A,u,!0===t?1:2),A+=u}return function(){for(var t=new D,s=new D,u=0,m=(r-n)/i,x=0;x<=a;x++){for(var w=[],E=x/a,M=E*(r-n)+n,_=0;_<=o;_++){var T=_/o,S=T*c+l,C=Math.sin(S),L=Math.cos(S);s.x=M*C,s.y=-E*i+b,s.z=M*L,p.push(s.x,s.y,s.z),t.set(C,m,L).normalize(),f.push(t.x,t.y,t.z),v.push(T,1-E),w.push(g++)}y.push(w)}for(var R=0;R<o;R++)for(var P=0;P<a;P++){var O=y[P][R],I=y[P+1][R],B=y[P+1][R+1],F=y[P][R+1];d.push(O,I,F),d.push(I,B,F),u+=6}h.addGroup(A,u,0),A+=u}(),!1===s&&(n>0&&x(!0),r>0&&x(!1)),u.setIndex(d),u.setAttribute("position",new to(p,3)),u.setAttribute("normal",new to(f,3)),u.setAttribute("uv",new to(v,2)),u}return f(n,t),n}(tg),iH=function(t){function n(n,r,i,o,a,s,l){var c;return void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=1),void 0===a&&(a=!1),void 0===s&&(s=0),void 0===l&&(l=2*Math.PI),(c=t.call(this,0,n,r,i,o,a,s,l)||this).type="ConeGeometry",c.parameters={radius:n,height:r,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l},c}return f(n,t),n}(iU),iG=function(t){function n(n,r,i,o){void 0===i&&(i=1),void 0===o&&(o=0),(a=t.call(this)||this).type="PolyhedronGeometry",a.parameters={vertices:n,indices:r,radius:i,detail:o};var a,s=[],l=[];function c(t){s.push(t.x,t.y,t.z)}function u(t,r){var i=3*t;r.x=n[i+0],r.y=n[i+1],r.z=n[i+2]}function h(t,n,r,i){i<0&&1===t.x&&(l[n]=t.x-1),0===r.x&&0===r.z&&(l[n]=i/2/Math.PI+.5)}function d(t){return Math.atan2(t.z,-t.x)}return function(t){for(var n=new D,i=new D,o=new D,a=0;a<r.length;a+=3)u(r[a+0],n),u(r[a+1],i),u(r[a+2],o),function(t,n,r,i){for(var o=i+1,a=[],s=0;s<=o;s++){a[s]=[];for(var l=t.clone().lerp(r,s/o),u=n.clone().lerp(r,s/o),h=o-s,d=0;d<=h;d++)0===d&&s===o?a[s][d]=l:a[s][d]=l.clone().lerp(u,d/h)}for(var p=0;p<o;p++)for(var f=0;f<2*(o-p)-1;f++){var m=Math.floor(f/2);f%2==0?(c(a[p][m+1]),c(a[p+1][m]),c(a[p][m])):(c(a[p][m+1]),c(a[p+1][m+1]),c(a[p+1][m]))}}(n,i,o,t)}(o),function(t){for(var n=new D,r=0;r<s.length;r+=3)n.x=s[r+0],n.y=s[r+1],n.z=s[r+2],n.normalize().multiplyScalar(t),s[r+0]=n.x,s[r+1]=n.y,s[r+2]=n.z}(i),function(){for(var t=new D,n=0;n<s.length;n+=3){t.x=s[n+0],t.y=s[n+1],t.z=s[n+2];var r=d(t)/2/Math.PI+.5,i=Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5;l.push(r,1-i)}(function(){for(var t=new D,n=new D,r=new D,i=new D,o=new w,a=new w,c=new w,u=0,p=0;u<s.length;u+=9,p+=6){t.set(s[u+0],s[u+1],s[u+2]),n.set(s[u+3],s[u+4],s[u+5]),r.set(s[u+6],s[u+7],s[u+8]),o.set(l[p+0],l[p+1]),a.set(l[p+2],l[p+3]),c.set(l[p+4],l[p+5]),i.copy(t).add(n).add(r).divideScalar(3);var f=d(i);h(o,p+0,t,f),h(a,p+2,n,f),h(c,p+4,r,f)}})(),function(){for(var t=0;t<l.length;t+=6){var n=l[t+0],r=l[t+2],i=l[t+4],o=Math.max(n,r,i),a=Math.min(n,r,i);o>.9&&a<.1&&(n<.2&&(l[t+0]+=1),r<.2&&(l[t+2]+=1),i<.2&&(l[t+4]+=1))}}()}(),a.setAttribute("position",new to(s,3)),a.setAttribute("normal",new to(s.slice(),3)),a.setAttribute("uv",new to(l,2)),0===o?a.computeVertexNormals():a.normalizeNormals(),a}return f(n,t),n}(tg),iz=function(t){function n(n,r){void 0===n&&(n=1),void 0===r&&(r=0);var i,o=(1+Math.sqrt(5))/2,a=1/o;return(i=t.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-o,0,-a,o,0,a,-o,0,a,o,-a,-o,0,-a,o,0,a,-o,0,a,o,0,-o,0,-a,o,0,-a,-o,0,a,o,0,a],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],n,r)||this).type="DodecahedronGeometry",i.parameters={radius:n,detail:r},i}return f(n,t),n}(iG),ij=new D,iV=new D,iW=new D,iq=new eq,iX=function(t){function n(n,r){if((i=t.call(this)||this).type="EdgesGeometry",i.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===n.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),m(i);for(var i,o=Math.cos(x.DEG2RAD*r),a=n.getIndex(),s=n.getAttribute("position"),l=a?a.count:s.count,c=[0,0,0],u=["a","b","c"],h=[,,,],d={},p=[],f=0;f<l;f+=3){a?(c[0]=a.getX(f),c[1]=a.getX(f+1),c[2]=a.getX(f+2)):(c[0]=f,c[1]=f+1,c[2]=f+2);var v=iq.a,g=iq.b,y=iq.c;if(v.fromBufferAttribute(s,c[0]),g.fromBufferAttribute(s,c[1]),y.fromBufferAttribute(s,c[2]),iq.getNormal(iW),h[0]=Math.round(1e4*v.x)+","+Math.round(1e4*v.y)+","+Math.round(1e4*v.z),h[1]=Math.round(1e4*g.x)+","+Math.round(1e4*g.y)+","+Math.round(1e4*g.z),h[2]=Math.round(1e4*y.x)+","+Math.round(1e4*y.y)+","+Math.round(1e4*y.z),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var b=0;b<3;b++){var A=(b+1)%3,w=h[b],E=h[A],M=iq[u[b]],_=iq[u[A]],T=w+"_"+E,S=E+"_"+w;S in d&&d[S]?(iW.dot(d[S].normal)<=o&&(p.push(M.x,M.y,M.z),p.push(_.x,_.y,_.z)),d[S]=null):T in d||(d[T]={index0:c[b],index1:c[A],normal:iW.clone()})}}for(var C in d)if(d[C]){var L=d[C],R=L.index0,P=L.index1;ij.fromBufferAttribute(s,R),iV.fromBufferAttribute(s,P),p.push(ij.x,ij.y,ij.z),p.push(iV.x,iV.y,iV.z)}return i.setAttribute("position",new to(p,3)),i}return f(n,t),n}(tg),iY=function(t,n,r){r=r||2;var i,o,a,s,l,c,u,h=n&&n.length,d=h?n[0]*r:t.length,p=iQ(t,0,d,r,!0),f=[];if(!p||p.next===p.prev)return f;if(h&&(p=function(t,n,r,i){var o,a,s,l,c,u=[];for(o=0,a=n.length;o<a;o++)s=n[o]*i,l=o<a-1?n[o+1]*i:t.length,(c=iQ(t,s,l,i,!1))===c.next&&(c.steiner=!0),u.push(function(t){var n=t,r=t;do(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next;while(n!==t);return r}(c));for(u.sort(iK),o=0;o<u.length;o++)(function(t,n){if(n=function(t,n){var r,i,o,a=n,s=t.x,l=t.y,c=-1/0;do{if(l<=a.y&&l>=a.next.y&&a.next.y!==a.y){var u=a.x+(l-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(u<=s&&u>c){if(c=u,u===s){if(l===a.y)return a;if(l===a.next.y)return a.next}o=a.x<a.next.x?a:a.next}}a=a.next}while(a!==n);if(!o)return null;if(s===c)return o;var h,d=o,p=o.x,f=o.y,m=1/0;a=o;do s>=a.x&&a.x>=p&&s!==a.x&&i$(l<f?s:c,l,p,f,l<f?c:s,l,a.x,a.y)&&(h=Math.abs(l-a.y)/(s-a.x),i5(a,t)&&(h<m||h===m&&(a.x>o.x||a.x===o.x&&(r=o,i=a,0>i0(r.prev,r,i.prev)&&0>i0(i.next,r,r.next))))&&(o=a,m=h)),a=a.next;while(a!==d);return o}(t,n)){var r=i6(n,t);iZ(n,n.next),iZ(r,r.next)}})(u[o],r),r=iZ(r,r.next);return r}(t,n,p,r)),t.length>80*r){i=a=t[0],o=s=t[1];for(var m=r;m<d;m+=r)l=t[m],c=t[m+1],l<i&&(i=l),c<o&&(o=c),l>a&&(a=l),c>s&&(s=c);u=0!==(u=Math.max(a-i,s-o))?1/u:0}return function t(n,r,i,o,a,s,l){if(n){!l&&s&&function(t,n,r,i){var o=t;do null===o.z&&(o.z=iJ(o.x,o.y,n,r,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var n,r,i,o,a,s,l,c,u=1;do{for(r=t,t=null,a=null,s=0;r;){for(s++,i=r,l=0,n=0;n<u&&(l++,i=i.nextZ);n++);for(c=u;l>0||c>0&&i;)0!==l&&(0===c||!i||r.z<=i.z)?(o=r,r=r.nextZ,l--):(o=i,i=i.nextZ,c--),a?a.nextZ=o:t=o,o.prevZ=a,a=o;r=i}a.nextZ=null,u*=2}while(s>1)}(o)}(n,o,a,s);for(var c,u,h=n;n.prev!==n.next;){if(c=n.prev,u=n.next,s?function(t,n,r,i){var o=t.prev,a=t.next;if(i0(o,t,a)>=0)return!1;for(var s=o.x<t.x?o.x<a.x?o.x:a.x:t.x<a.x?t.x:a.x,l=o.y<t.y?o.y<a.y?o.y:a.y:t.y<a.y?t.y:a.y,c=o.x>t.x?o.x>a.x?o.x:a.x:t.x>a.x?t.x:a.x,u=o.y>t.y?o.y>a.y?o.y:a.y:t.y>a.y?t.y:a.y,h=iJ(s,l,n,r,i),d=iJ(c,u,n,r,i),p=t.prevZ,f=t.nextZ;p&&p.z>=h&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&i$(o.x,o.y,t.x,t.y,a.x,a.y,p.x,p.y)&&i0(p.prev,p,p.next)>=0||(p=p.prevZ,f!==t.prev&&f!==t.next&&i$(o.x,o.y,t.x,t.y,a.x,a.y,f.x,f.y)&&i0(f.prev,f,f.next)>=0))return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&i$(o.x,o.y,t.x,t.y,a.x,a.y,p.x,p.y)&&i0(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&i$(o.x,o.y,t.x,t.y,a.x,a.y,f.x,f.y)&&i0(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}(n,o,a,s):function(t){var n=t.prev,r=t.next;if(i0(n,t,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(i$(n.x,n.y,t.x,t.y,r.x,r.y,i.x,i.y)&&i0(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}(n)){r.push(c.i/i),r.push(n.i/i),r.push(u.i/i),i8(n),n=u.next,h=u.next;continue}if((n=u)===h){l?1===l?t(n=function(t,n,r){var i=t;do{var o=i.prev,a=i.next.next;!i1(o,a)&&i2(o,i,i.next,a)&&i5(o,a)&&i5(a,o)&&(n.push(o.i/r),n.push(i.i/r),n.push(a.i/r),i8(i),i8(i.next),i=t=a),i=i.next}while(i!==t);return iZ(i)}(iZ(n),r,i),r,i,o,a,s,2):2===l&&function(n,r,i,o,a,s){var l=n;do{for(var c,u,h=l.next.next;h!==l.prev;){if(l.i!==h.i&&(c=l,u=h,c.next.i!==u.i&&c.prev.i!==u.i&&!function(t,n){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==n.i&&r.next.i!==n.i&&i2(r,r.next,t,n))return!0;r=r.next}while(r!==t);return!1}(c,u)&&(i5(c,u)&&i5(u,c)&&function(t,n){var r=t,i=!1,o=(t.x+n.x)/2,a=(t.y+n.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&o<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==t);return i}(c,u)&&(i0(c.prev,c,u.prev)||i0(c,u.prev,u))||i1(c,u)&&i0(c.prev,c,c.next)>0&&i0(u.prev,u,u.next)>0))){var d=i6(l,h);l=iZ(l,l.next),d=iZ(d,d.next),t(l,r,i,o,a,s),t(d,r,i,o,a,s);return}h=h.next}l=l.next}while(l!==n)}(n,r,i,o,a,s):t(iZ(n),r,i,o,a,s,1);break}}}}(p,f,r,i,o,u),f};function iQ(t,n,r,i,o){var a,s;if(o===function(t,n,r,i){for(var o=0,a=n,s=r-i;a<r;a+=i)o+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return o}(t,n,r,i)>0)for(a=n;a<r;a+=i)s=i7(a,t[a],t[a+1],s);else for(a=r-i;a>=n;a-=i)s=i7(a,t[a],t[a+1],s);return s&&i1(s,s.next)&&(i8(s),s=s.next),s}function iZ(t,n){if(!t)return t;n||(n=t);var r,i=t;do if(r=!1,!i.steiner&&(i1(i,i.next)||0===i0(i.prev,i,i.next))){if(i8(i),(i=n=i.prev)===i.next)break;r=!0}else i=i.next;while(r||i!==n);return n}function iK(t,n){return t.x-n.x}function iJ(t,n,r,i,o){return(t=((t=((t=((t=((t=32767*(t-r)*o)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)|(n=((n=((n=((n=((n=32767*(n-i)*o)|n<<8)&16711935)|n<<4)&252645135)|n<<2)&858993459)|n<<1)&1431655765)<<1}function i$(t,n,r,i,o,a,s,l){return(o-s)*(n-l)-(t-s)*(a-l)>=0&&(t-s)*(i-l)-(r-s)*(n-l)>=0&&(r-s)*(a-l)-(o-s)*(i-l)>=0}function i0(t,n,r){return(n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y)}function i1(t,n){return t.x===n.x&&t.y===n.y}function i2(t,n,r,i){var o=i4(i0(t,n,r)),a=i4(i0(t,n,i)),s=i4(i0(r,i,t)),l=i4(i0(r,i,n));return!!(o!==a&&s!==l||0===o&&i3(t,r,n)||0===a&&i3(t,i,n)||0===s&&i3(r,t,i)||0===l&&i3(r,n,i))}function i3(t,n,r){return n.x<=Math.max(t.x,r.x)&&n.x>=Math.min(t.x,r.x)&&n.y<=Math.max(t.y,r.y)&&n.y>=Math.min(t.y,r.y)}function i4(t){return t>0?1:t<0?-1:0}function i5(t,n){return 0>i0(t.prev,t,t.next)?i0(t,n,t.next)>=0&&i0(t,t.prev,n)>=0:0>i0(t,n,t.prev)||0>i0(t,t.next,n)}function i6(t,n){var r=new i9(t.i,t.x,t.y),i=new i9(n.i,n.x,n.y),o=t.next,a=n.prev;return t.next=n,n.prev=t,r.next=o,o.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}function i7(t,n,r,i){var o=new i9(t,n,r);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function i8(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function i9(t,n,r){this.i=t,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var oe={area:function(t){for(var n=t.length,r=0,i=n-1,o=0;o<n;i=o++)r+=t[i].x*t[o].y-t[o].x*t[i].y;return .5*r},isClockWise:function(t){return 0>oe.area(t)},triangulateShape:function(t,n){var r=[],i=[],o=[];ot(t),on(r,t);var a=t.length;n.forEach(ot);for(var s=0;s<n.length;s++)i.push(a),a+=n[s].length,on(r,n[s]);for(var l=iY(r,i),c=0;c<l.length;c+=3)o.push(l.slice(c,c+3));return o}};function ot(t){var n=t.length;n>2&&t[n-1].equals(t[0])&&t.pop()}function on(t,n){for(var r=0;r<n.length;r++)t.push(n[r].x),t.push(n[r].y)}var or=function(t){function n(n,r){(i=t.call(this)||this).type="ExtrudeGeometry",i.parameters={shapes:n,options:r},n=Array.isArray(n)?n:[n];for(var i,o=m(i),a=[],s=[],l=0,c=n.length;l<c;l++)(function(t){var n=[],i=void 0!==r.curveSegments?r.curveSegments:12,l=void 0!==r.steps?r.steps:1,c=void 0!==r.depth?r.depth:100,u=void 0===r.bevelEnabled||r.bevelEnabled,h=void 0!==r.bevelThickness?r.bevelThickness:6,d=void 0!==r.bevelSize?r.bevelSize:h-2,p=void 0!==r.bevelOffset?r.bevelOffset:0,f=void 0!==r.bevelSegments?r.bevelSegments:3,m=r.extrudePath,v=void 0!==r.UVGenerator?r.UVGenerator:oi;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=r.amount);var g,y=!1;m&&(g=m.getSpacedPoints(l),y=!0,u=!1,G=m.computeFrenetFrames(l,!1),z=new D,j=new D,V=new D),u||(f=0,h=0,d=0,p=0);var b=t.extractPoints(i),A=b.shape,x=b.holes;if(!oe.isClockWise(A)){A=A.reverse();for(var E=0,M=x.length;E<M;E++){var _=x[E];oe.isClockWise(_)&&(x[E]=_.reverse())}}for(var T=oe.triangulateShape(A,x),S=A,C=0,L=x.length;C<L;C++){var R=x[C];A=A.concat(R)}function P(t,n,r){return n||console.error("THREE.ExtrudeGeometry: vec does not exist"),n.clone().multiplyScalar(r).add(t)}var O=A.length,I=T.length;function B(t,n,r){var i,o,a,s=t.x-n.x,l=t.y-n.y,c=r.x-t.x,u=r.y-t.y,h=s*s+l*l;if(Math.abs(s*u-l*c)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(c*c+u*u),f=n.x-l/d,m=n.y+s/d,v=((r.x-u/p-f)*u-(r.y+c/p-m)*c)/(s*u-l*c),g=(i=f+s*v-t.x)*i+(o=m+l*v-t.y)*o;if(g<=2)return new w(i,o);a=Math.sqrt(g/2)}else{var y=!1;s>Number.EPSILON?c>Number.EPSILON&&(y=!0):s<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(l)===Math.sign(u)&&(y=!0),y?(i=-l,o=s,a=Math.sqrt(h)):(i=s,o=l,a=Math.sqrt(h/2))}return new w(i/a,o/a)}for(var F=[],k=0,N=S.length,U=N-1,H=k+1;k<N;k++,U++,H++)U===N&&(U=0),H===N&&(H=0),F[k]=B(S[k],S[U],S[H]);for(var G,z,j,V,W,q=[],X=F.concat(),Y=0,Q=x.length;Y<Q;Y++){var Z=x[Y];W=[];for(var K=0,J=Z.length,$=J-1,ee=K+1;K<J;K++,$++,ee++)$===J&&($=0),ee===J&&(ee=0),W[K]=B(Z[K],Z[$],Z[ee]);q.push(W),X=X.concat(W)}for(var et=0;et<f;et++){for(var en=et/f,er=h*Math.cos(en*Math.PI/2),ei=d*Math.sin(en*Math.PI/2)+p,eo=0,ea=S.length;eo<ea;eo++){var es=P(S[eo],F[eo],ei);eI(es.x,es.y,-er)}for(var el=0,ec=x.length;el<ec;el++){var eu=x[el];W=q[el];for(var eh=0,ed=eu.length;eh<ed;eh++){var ep=P(eu[eh],W[eh],ei);eI(ep.x,ep.y,-er)}}}for(var ef=d+p,em=0;em<O;em++){var ev=u?P(A[em],X[em],ef):A[em];y?(j.copy(G.normals[0]).multiplyScalar(ev.x),z.copy(G.binormals[0]).multiplyScalar(ev.y),V.copy(g[0]).add(j).add(z),eI(V.x,V.y,V.z)):eI(ev.x,ev.y,0)}for(var eg=1;eg<=l;eg++)for(var ey=0;ey<O;ey++){var eb=u?P(A[ey],X[ey],ef):A[ey];y?(j.copy(G.normals[eg]).multiplyScalar(eb.x),z.copy(G.binormals[eg]).multiplyScalar(eb.y),V.copy(g[eg]).add(j).add(z),eI(V.x,V.y,V.z)):eI(eb.x,eb.y,c/l*eg)}for(var eA=f-1;eA>=0;eA--){for(var ex=eA/f,ew=h*Math.cos(ex*Math.PI/2),eE=d*Math.sin(ex*Math.PI/2)+p,eM=0,e_=S.length;eM<e_;eM++){var eT=P(S[eM],F[eM],eE);eI(eT.x,eT.y,c+ew)}for(var eS=0,eC=x.length;eS<eC;eS++){var eL=x[eS];W=q[eS];for(var eR=0,eP=eL.length;eR<eP;eR++){var eD=P(eL[eR],W[eR],eE);y?eI(eD.x,eD.y+g[l-1].y,g[l-1].x+ew):eI(eD.x,eD.y,c+ew)}}}function eO(t,n){for(var r=t.length;--r>=0;){var i=r,s=r-1;s<0&&(s=t.length-1);for(var c=0,u=l+2*f;c<u;c++){var h=O*c,d=O*(c+1);(function(t,n,r,i){eF(t),eF(n),eF(i),eF(n),eF(r),eF(i);var s=a.length/3,l=v.generateSideWallUV(o,a,s-6,s-3,s-2,s-1);ek(l[0]),ek(l[1]),ek(l[3]),ek(l[1]),ek(l[2]),ek(l[3])})(n+i+h,n+s+h,n+s+d,n+i+d)}}}function eI(t,r,i){n.push(t),n.push(r),n.push(i)}function eB(t,n,r){eF(t),eF(n),eF(r);var i=a.length/3,s=v.generateTopUV(o,a,i-3,i-2,i-1);ek(s[0]),ek(s[1]),ek(s[2])}function eF(t){a.push(n[3*t+0]),a.push(n[3*t+1]),a.push(n[3*t+2])}function ek(t){s.push(t.x),s.push(t.y)}(function(){var t=a.length/3;if(u){for(var n=0*O,r=0;r<I;r++){var i=T[r];eB(i[2]+n,i[1]+n,i[0]+n)}n=O*(l+2*f);for(var s=0;s<I;s++){var c=T[s];eB(c[0]+n,c[1]+n,c[2]+n)}}else{for(var h=0;h<I;h++){var d=T[h];eB(d[2],d[1],d[0])}for(var p=0;p<I;p++){var m=T[p];eB(m[0]+O*l,m[1]+O*l,m[2]+O*l)}}o.addGroup(t,a.length/3-t,0)})(),function(){var t=a.length/3,n=0;eO(S,0),n+=S.length;for(var r=0,i=x.length;r<i;r++){var s=x[r];eO(s,n),n+=s.length}o.addGroup(t,a.length/3-t,1)}()})(n[l]);return i.setAttribute("position",new to(a,3)),i.setAttribute("uv",new to(s,2)),i.computeVertexNormals(),i}return f(n,t),n.prototype.toJSON=function(){var t=tg.prototype.toJSON.call(this);return function(t,n,r){if(r.shapes=[],Array.isArray(t))for(var i=0,o=t.length;i<o;i++){var a=t[i];r.shapes.push(a.uuid)}else r.shapes.push(t.uuid);return void 0!==n.extrudePath&&(r.options.extrudePath=n.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,t)},n}(tg),oi={generateTopUV:function(t,n,r,i,o){var a=n[3*r],s=n[3*r+1],l=n[3*i],c=n[3*i+1],u=n[3*o],h=n[3*o+1];return[new w(a,s),new w(l,c),new w(u,h)]},generateSideWallUV:function(t,n,r,i,o,a){var s=n[3*r],l=n[3*r+1],c=n[3*r+2],u=n[3*i],h=n[3*i+1],d=n[3*i+2],p=n[3*o],f=n[3*o+1],m=n[3*o+2],v=n[3*a],g=n[3*a+1],y=n[3*a+2];return .01>Math.abs(l-h)?[new w(s,1-c),new w(u,1-d),new w(p,1-m),new w(v,1-y)]:[new w(l,1-c),new w(h,1-d),new w(f,1-m),new w(g,1-y)]}},oo=function(t){function n(n,r){void 0===n&&(n=1),void 0===r&&(r=0);var i,o=(1+Math.sqrt(5))/2;return(i=t.call(this,[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],n,r)||this).type="IcosahedronGeometry",i.parameters={radius:n,detail:r},i}return f(n,t),n}(iG),oa=function(t){function n(n,r,i,o){void 0===r&&(r=12),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),(a=t.call(this)||this).type="LatheGeometry",a.parameters={points:n,segments:r,phiStart:i,phiLength:o},r=Math.floor(r),o=x.clamp(o,0,2*Math.PI);for(var a,s=[],l=[],c=[],u=1/r,h=new D,d=new w,p=0;p<=r;p++)for(var f=i+p*u*o,m=Math.sin(f),v=Math.cos(f),g=0;g<=n.length-1;g++)h.x=n[g].x*m,h.y=n[g].y,h.z=n[g].x*v,l.push(h.x,h.y,h.z),d.x=p/r,d.y=g/(n.length-1),c.push(d.x,d.y);for(var y=0;y<r;y++)for(var b=0;b<n.length-1;b++){var A=b+y*n.length,E=A+n.length,M=A+n.length+1,_=A+1;s.push(A,E,_),s.push(E,M,_)}if(a.setIndex(s),a.setAttribute("position",new to(l,3)),a.setAttribute("uv",new to(c,2)),a.computeVertexNormals(),o===2*Math.PI)for(var T=a.attributes.normal.array,S=new D,C=new D,L=new D,R=r*n.length*3,P=0,O=0;P<n.length;P++,O+=3)S.x=T[O+0],S.y=T[O+1],S.z=T[O+2],C.x=T[R+O+0],C.y=T[R+O+1],C.z=T[R+O+2],L.addVectors(S,C).normalize(),T[O+0]=T[R+O+0]=L.x,T[O+1]=T[R+O+1]=L.y,T[O+2]=T[R+O+2]=L.z;return a}return f(n,t),n}(tg),os=function(t){function n(n,r){var i;return void 0===n&&(n=1),void 0===r&&(r=0),(i=t.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],n,r)||this).type="OctahedronGeometry",i.parameters={radius:n,detail:r},i}return f(n,t),n}(iG);function ol(t,n,r){tg.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:n,stacks:r};var i=[],o=[],a=[],s=[],l=new D,c=new D,u=new D,h=new D,d=new D;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var p=n+1,f=0;f<=r;f++)for(var m=f/r,v=0;v<=n;v++){var g=v/n;t(g,m,c),o.push(c.x,c.y,c.z),g-1e-5>=0?(t(g-1e-5,m,u),h.subVectors(c,u)):(t(g+1e-5,m,u),h.subVectors(u,c)),m-1e-5>=0?(t(g,m-1e-5,u),d.subVectors(c,u)):(t(g,m+1e-5,u),d.subVectors(u,c)),l.crossVectors(h,d).normalize(),a.push(l.x,l.y,l.z),s.push(g,m)}for(var y=0;y<r;y++)for(var b=0;b<n;b++){var A=y*p+b,x=y*p+b+1,w=(y+1)*p+b+1,E=(y+1)*p+b;i.push(A,x,E),i.push(x,w,E)}this.setIndex(i),this.setAttribute("position",new to(o,3)),this.setAttribute("normal",new to(a,3)),this.setAttribute("uv",new to(s,2))}ol.prototype=Object.create(tg.prototype),ol.prototype.constructor=ol;var oc=function(t){function n(n,r,i,o,a,s){void 0===n&&(n=.5),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=1),void 0===a&&(a=0),void 0===s&&(s=2*Math.PI),(l=t.call(this)||this).type="RingGeometry",l.parameters={innerRadius:n,outerRadius:r,thetaSegments:i,phiSegments:o,thetaStart:a,thetaLength:s},i=Math.max(3,i);for(var l,c=[],u=[],h=[],d=[],p=n,f=(r-n)/(o=Math.max(1,o)),m=new D,v=new w,g=0;g<=o;g++){for(var y=0;y<=i;y++){var b=a+y/i*s;m.x=p*Math.cos(b),m.y=p*Math.sin(b),u.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/r+1)/2,v.y=(m.y/r+1)/2,d.push(v.x,v.y)}p+=f}for(var A=0;A<o;A++)for(var x=A*(i+1),E=0;E<i;E++){var M=E+x,_=M+i+1,T=M+i+2,S=M+1;c.push(M,_,S),c.push(_,T,S)}return l.setIndex(c),l.setAttribute("position",new to(u,3)),l.setAttribute("normal",new to(h,3)),l.setAttribute("uv",new to(d,2)),l}return f(n,t),n}(tg),ou=function(t){function n(n,r){void 0===r&&(r=12),(i=t.call(this)||this).type="ShapeGeometry",i.parameters={shapes:n,curveSegments:r};var i,o=[],a=[],s=[],l=[],c=0,u=0;if(!1===Array.isArray(n))d(n);else for(var h=0;h<n.length;h++)d(n[h]),i.addGroup(c,u,h),c+=u,u=0;function d(t){var n=a.length/3,i=t.extractPoints(r),c=i.shape,h=i.holes;!1===oe.isClockWise(c)&&(c=c.reverse());for(var d=0,p=h.length;d<p;d++){var f=h[d];!0===oe.isClockWise(f)&&(h[d]=f.reverse())}for(var m=oe.triangulateShape(c,h),v=0,g=h.length;v<g;v++){var y=h[v];c=c.concat(y)}for(var b=0,A=c.length;b<A;b++){var x=c[b];a.push(x.x,x.y,0),s.push(0,0,1),l.push(x.x,x.y)}for(var w=0,E=m.length;w<E;w++){var M=m[w],_=M[0]+n,T=M[1]+n,S=M[2]+n;o.push(_,T,S),u+=3}}return i.setIndex(o),i.setAttribute("position",new to(a,3)),i.setAttribute("normal",new to(s,3)),i.setAttribute("uv",new to(l,2)),i}return f(n,t),n.prototype.toJSON=function(){var t=tg.prototype.toJSON.call(this);return function(t,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return n}(this.parameters.shapes,t)},n}(tg),oh=function(t){function n(n,r,i,o,a,s,l){void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=6),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),void 0===s&&(s=0),void 0===l&&(l=Math.PI),(c=t.call(this)||this).type="SphereGeometry",c.parameters={radius:n,widthSegments:r,heightSegments:i,phiStart:o,phiLength:a,thetaStart:s,thetaLength:l},r=Math.max(3,Math.floor(r)),i=Math.max(2,Math.floor(i));for(var c,u=Math.min(s+l,Math.PI),h=0,d=[],p=new D,f=new D,m=[],v=[],g=[],y=[],b=0;b<=i;b++){var A=[],x=b/i,w=0;0==b&&0==s?w=.5/r:b==i&&u==Math.PI&&(w=-.5/r);for(var E=0;E<=r;E++){var M=E/r;p.x=-n*Math.cos(o+M*a)*Math.sin(s+x*l),p.y=n*Math.cos(s+x*l),p.z=n*Math.sin(o+M*a)*Math.sin(s+x*l),v.push(p.x,p.y,p.z),f.copy(p).normalize(),g.push(f.x,f.y,f.z),y.push(M+w,1-x),A.push(h++)}d.push(A)}for(var _=0;_<i;_++)for(var T=0;T<r;T++){var S=d[_][T+1],C=d[_][T],L=d[_+1][T],R=d[_+1][T+1];(0!==_||s>0)&&m.push(S,C,R),(_!==i-1||u<Math.PI)&&m.push(C,L,R)}return c.setIndex(m),c.setAttribute("position",new to(v,3)),c.setAttribute("normal",new to(g,3)),c.setAttribute("uv",new to(y,2)),c}return f(n,t),n}(tg),od=function(t){function n(n,r){var i;return void 0===n&&(n=1),void 0===r&&(r=0),(i=t.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],n,r)||this).type="TetrahedronGeometry",i.parameters={radius:n,detail:r},i}return f(n,t),n}(iG),op=function(t){function n(n,r){void 0===r&&(r={});var i,o=r.font;if(!(o&&o.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new tg;var a=o.generateShapes(n,r.size);return r.depth=void 0!==r.height?r.height:50,void 0===r.bevelThickness&&(r.bevelThickness=10),void 0===r.bevelSize&&(r.bevelSize=8),void 0===r.bevelEnabled&&(r.bevelEnabled=!1),(i=t.call(this,a,r)||this).type="TextGeometry",i}return f(n,t),n}(or),of=function(t){function n(n,r,i,o,a){void 0===n&&(n=1),void 0===r&&(r=.4),void 0===i&&(i=8),void 0===o&&(o=6),void 0===a&&(a=2*Math.PI),(s=t.call(this)||this).type="TorusGeometry",s.parameters={radius:n,tube:r,radialSegments:i,tubularSegments:o,arc:a},i=Math.floor(i),o=Math.floor(o);for(var s,l=[],c=[],u=[],h=[],d=new D,p=new D,f=new D,m=0;m<=i;m++)for(var v=0;v<=o;v++){var g=v/o*a,y=m/i*Math.PI*2;p.x=(n+r*Math.cos(y))*Math.cos(g),p.y=(n+r*Math.cos(y))*Math.sin(g),p.z=r*Math.sin(y),c.push(p.x,p.y,p.z),d.x=n*Math.cos(g),d.y=n*Math.sin(g),f.subVectors(p,d).normalize(),u.push(f.x,f.y,f.z),h.push(v/o),h.push(m/i)}for(var b=1;b<=i;b++)for(var A=1;A<=o;A++){var x=(o+1)*b+A-1,w=(o+1)*(b-1)+A-1,E=(o+1)*(b-1)+A,M=(o+1)*b+A;l.push(x,w,M),l.push(w,E,M)}return s.setIndex(l),s.setAttribute("position",new to(c,3)),s.setAttribute("normal",new to(u,3)),s.setAttribute("uv",new to(h,2)),s}return f(n,t),n}(tg),om=function(t){function n(n,r,i,o,a,s){void 0===n&&(n=1),void 0===r&&(r=.4),void 0===i&&(i=64),void 0===o&&(o=8),void 0===a&&(a=2),void 0===s&&(s=3),(l=t.call(this)||this).type="TorusKnotGeometry",l.parameters={radius:n,tube:r,tubularSegments:i,radialSegments:o,p:a,q:s},i=Math.floor(i),o=Math.floor(o);for(var l,c=[],u=[],h=[],d=[],p=new D,f=new D,m=new D,v=new D,g=new D,y=new D,b=new D,A=0;A<=i;++A){var x=A/i*a*Math.PI*2;O(x,a,s,n,m),O(x+.01,a,s,n,v),y.subVectors(v,m),b.addVectors(v,m),g.crossVectors(y,b),b.crossVectors(g,y),g.normalize(),b.normalize();for(var w=0;w<=o;++w){var E=w/o*Math.PI*2,M=-r*Math.cos(E),_=r*Math.sin(E);p.x=m.x+(M*b.x+_*g.x),p.y=m.y+(M*b.y+_*g.y),p.z=m.z+(M*b.z+_*g.z),u.push(p.x,p.y,p.z),f.subVectors(p,m).normalize(),h.push(f.x,f.y,f.z),d.push(A/i),d.push(w/o)}}for(var T=1;T<=i;T++)for(var S=1;S<=o;S++){var C=(o+1)*(T-1)+(S-1),L=(o+1)*T+(S-1),R=(o+1)*T+S,P=(o+1)*(T-1)+S;c.push(C,L,P),c.push(L,R,P)}function O(t,n,r,i,o){var a=Math.cos(t),s=Math.sin(t),l=r/n*t,c=Math.cos(l);o.x=i*(2+c)*.5*a,o.y=i*(2+c)*s*.5,o.z=i*Math.sin(l)*.5}return l.setIndex(c),l.setAttribute("position",new to(u,3)),l.setAttribute("normal",new to(h,3)),l.setAttribute("uv",new to(d,2)),l}return f(n,t),n}(tg),ov=function(t){function n(n,r,i,o,a){void 0===r&&(r=64),void 0===i&&(i=1),void 0===o&&(o=8),void 0===a&&(a=!1),(s=t.call(this)||this).type="TubeGeometry",s.parameters={path:n,tubularSegments:r,radius:i,radialSegments:o,closed:a};var s,l=n.computeFrenetFrames(r,a);s.tangents=l.tangents,s.normals=l.normals,s.binormals=l.binormals;var c=new D,u=new D,h=new w,d=new D,p=[],f=[],m=[],v=[];function g(t){d=n.getPointAt(t/r,d);for(var a=l.normals[t],s=l.binormals[t],h=0;h<=o;h++){var m=h/o*Math.PI*2,v=Math.sin(m),g=-Math.cos(m);u.x=g*a.x+v*s.x,u.y=g*a.y+v*s.y,u.z=g*a.z+v*s.z,u.normalize(),f.push(u.x,u.y,u.z),c.x=d.x+i*u.x,c.y=d.y+i*u.y,c.z=d.z+i*u.z,p.push(c.x,c.y,c.z)}}return function(){for(var t=0;t<r;t++)g(t);g(!1===a?r:0),function(){for(var t=0;t<=r;t++)for(var n=0;n<=o;n++)h.x=t/r,h.y=n/o,m.push(h.x,h.y)}(),function(){for(var t=1;t<=r;t++)for(var n=1;n<=o;n++){var i=(o+1)*(t-1)+(n-1),a=(o+1)*t+(n-1),s=(o+1)*t+n,l=(o+1)*(t-1)+n;v.push(i,a,l),v.push(a,s,l)}}()}(),s.setIndex(v),s.setAttribute("position",new to(p,3)),s.setAttribute("normal",new to(f,3)),s.setAttribute("uv",new to(m,2)),s}return f(n,t),n.prototype.toJSON=function(){var t=tg.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},n}(tg),og=function(t){function n(n){if((r=t.call(this)||this).type="WireframeGeometry",!0===n.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),m(r);var r,i=[],o=[0,0],a={},s=new D;if(null!==n.index){var l=n.attributes.position,c=n.index,u=n.groups;0===u.length&&(u=[{start:0,count:c.count,materialIndex:0}]);for(var h=0,d=u.length;h<d;++h)for(var p=u[h],f=p.start,v=p.count,g=f,y=f+v;g<y;g+=3)for(var b=0;b<3;b++){var A=c.getX(g+b),x=c.getX(g+(b+1)%3);o[0]=Math.min(A,x),o[1]=Math.max(A,x);var w=o[0]+","+o[1];void 0===a[w]&&(a[w]={index1:o[0],index2:o[1]})}for(var E in a){var M=a[E];s.fromBufferAttribute(l,M.index1),i.push(s.x,s.y,s.z),s.fromBufferAttribute(l,M.index2),i.push(s.x,s.y,s.z)}}else for(var _=n.attributes.position,T=0,S=_.count/3;T<S;T++)for(var C=0;C<3;C++){var L=3*T+C;s.fromBufferAttribute(_,L),i.push(s.x,s.y,s.z);var R=3*T+(C+1)%3;s.fromBufferAttribute(_,R),i.push(s.x,s.y,s.z)}return r.setAttribute("position",new to(i,3)),r}return f(n,t),n}(tg),oy=Object.freeze({__proto__:null,BoxGeometry:tk,BoxBufferGeometry:tk,CircleGeometry:iN,CircleBufferGeometry:iN,ConeGeometry:iH,ConeBufferGeometry:iH,CylinderGeometry:iU,CylinderBufferGeometry:iU,DodecahedronGeometry:iz,DodecahedronBufferGeometry:iz,EdgesGeometry:iX,ExtrudeGeometry:or,ExtrudeBufferGeometry:or,IcosahedronGeometry:oo,IcosahedronBufferGeometry:oo,LatheGeometry:oa,LatheBufferGeometry:oa,OctahedronGeometry:os,OctahedronBufferGeometry:os,ParametricGeometry:ol,ParametricBufferGeometry:ol,PlaneGeometry:t$,PlaneBufferGeometry:t$,PolyhedronGeometry:iG,PolyhedronBufferGeometry:iG,RingGeometry:oc,RingBufferGeometry:oc,ShapeGeometry:ou,ShapeBufferGeometry:ou,SphereGeometry:oh,SphereBufferGeometry:oh,TetrahedronGeometry:od,TetrahedronBufferGeometry:od,TextGeometry:op,TextBufferGeometry:op,TorusGeometry:of,TorusBufferGeometry:of,TorusKnotGeometry:om,TorusKnotBufferGeometry:om,TubeGeometry:ov,TubeBufferGeometry:ov,WireframeGeometry:og});function ob(t){e2.call(this),this.type="ShadowMaterial",this.color=new e$(0),this.transparent=!0,this.setValues(t)}function oA(t){tG.call(this,t),this.type="RawShaderMaterial"}function ox(t){e2.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new e$(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e$(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function ow(t){ox.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new w(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=x.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function oE(t){e2.call(this),this.type="MeshPhongMaterial",this.color=new e$(16777215),this.specular=new e$(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e$(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function oM(t){e2.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new e$(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e$(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function o_(t){e2.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function oT(t){e2.call(this),this.type="MeshLambertMaterial",this.color=new e$(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e$(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function oS(t){e2.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new e$(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new w(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function oC(t){iv.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}ob.prototype=Object.create(e2.prototype),ob.prototype.constructor=ob,ob.prototype.isShadowMaterial=!0,ob.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this},oA.prototype=Object.create(tG.prototype),oA.prototype.constructor=oA,oA.prototype.isRawShaderMaterial=!0,ox.prototype=Object.create(e2.prototype),ox.prototype.constructor=ox,ox.prototype.isMeshStandardMaterial=!0,ox.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},ow.prototype=Object.create(ox.prototype),ow.prototype.constructor=ow,ow.prototype.isMeshPhysicalMaterial=!0,ow.prototype.copy=function(t){return ox.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new e$).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},oE.prototype=Object.create(e2.prototype),oE.prototype.constructor=oE,oE.prototype.isMeshPhongMaterial=!0,oE.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},oM.prototype=Object.create(e2.prototype),oM.prototype.constructor=oM,oM.prototype.isMeshToonMaterial=!0,oM.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},o_.prototype=Object.create(e2.prototype),o_.prototype.constructor=o_,o_.prototype.isMeshNormalMaterial=!0,o_.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},oT.prototype=Object.create(e2.prototype),oT.prototype.constructor=oT,oT.prototype.isMeshLambertMaterial=!0,oT.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},oS.prototype=Object.create(e2.prototype),oS.prototype.constructor=oS,oS.prototype.isMeshMatcapMaterial=!0,oS.prototype.copy=function(t){return e2.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},oC.prototype=Object.create(iv.prototype),oC.prototype.constructor=oC,oC.prototype.isLineDashedMaterial=!0,oC.prototype.copy=function(t){return iv.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var oL=Object.freeze({__proto__:null,ShadowMaterial:ob,SpriteMaterial:rW,RawShaderMaterial:oA,ShaderMaterial:tG,PointsMaterial:iS,MeshPhysicalMaterial:ow,MeshStandardMaterial:ox,MeshPhongMaterial:oE,MeshToonMaterial:oM,MeshNormalMaterial:o_,MeshLambertMaterial:oT,MeshDepthMaterial:rE,MeshDistanceMaterial:rM,MeshBasicMaterial:e3,MeshMatcapMaterial:oS,LineDashedMaterial:oC,LineBasicMaterial:iv,Material:e2}),oR={arraySlice:function(t,n,r){return oR.isTypedArray(t)?new t.constructor(t.subarray(n,void 0!==r?r:t.length)):t.slice(n,r)},convertArray:function(t,n,r){return t&&(r||t.constructor!==n)?"number"==typeof n.BYTES_PER_ELEMENT?new n(t):Array.prototype.slice.call(t):t},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var n=t.length,r=Array(n),i=0;i!==n;++i)r[i]=i;return r.sort(function(n,r){return t[n]-t[r]}),r},sortedArray:function(t,n,r){for(var i=t.length,o=new t.constructor(i),a=0,s=0;s!==i;++a)for(var l=r[a]*n,c=0;c!==n;++c)o[s++]=t[l+c];return o},flattenJSON:function(t,n,r,i){for(var o=1,a=t[0];void 0!==a&&void 0===a[i];)a=t[o++];if(void 0!==a){var s=a[i];if(void 0!==s){if(Array.isArray(s))do void 0!==(s=a[i])&&(n.push(a.time),r.push.apply(r,s)),a=t[o++];while(void 0!==a);else if(void 0!==s.toArray)do void 0!==(s=a[i])&&(n.push(a.time),s.toArray(r,r.length)),a=t[o++];while(void 0!==a);else do void 0!==(s=a[i])&&(n.push(a.time),r.push(s)),a=t[o++];while(void 0!==a)}}},subclip:function(t,n,r,i,o){void 0===o&&(o=30);var a=t.clone();a.name=n;for(var s=[],l=0;l<a.tracks.length;++l){for(var c=a.tracks[l],u=c.getValueSize(),h=[],d=[],p=0;p<c.times.length;++p){var f=c.times[p]*o;if(!(f<r)&&!(f>=i)){h.push(c.times[p]);for(var m=0;m<u;++m)d.push(c.values[p*u+m])}}0!==h.length&&(c.times=oR.convertArray(h,c.times.constructor),c.values=oR.convertArray(d,c.values.constructor),s.push(c))}a.tracks=s;for(var v=1/0,g=0;g<a.tracks.length;++g)v>a.tracks[g].times[0]&&(v=a.tracks[g].times[0]);for(var y=0;y<a.tracks.length;++y)a.tracks[y].shift(-1*v);return a.resetDuration(),a},makeClipAdditive:function(t,n,r,i){void 0===n&&(n=0),void 0===r&&(r=t),void 0===i&&(i=30),i<=0&&(i=30);for(var o=r.tracks.length,a=n/i,s=0;s<o;++s)if("continue"===function(n){var i=r.tracks[n],o=i.ValueTypeName;if("bool"===o||"string"===o)return"continue";var s=t.tracks.find(function(t){return t.name===i.name&&t.ValueTypeName===o});if(void 0===s)return"continue";var l=0,c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);var u=0,h=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);var d=i.times.length-1,p=void 0;if(a<=i.times[0]){var f=l,m=c-l;p=oR.arraySlice(i.values,f,m)}else if(a>=i.times[d]){var v=d*c+l,g=v+c-l;p=oR.arraySlice(i.values,v,g)}else{var y=i.createInterpolant(),b=l,A=c-l;y.evaluate(a),p=oR.arraySlice(y.resultBuffer,b,A)}"quaternion"===o&&new P().fromArray(p).normalize().conjugate().toArray(p);for(var x=s.times.length,w=0;w<x;++w){var E=w*h+u;if("quaternion"===o)P.multiplyQuaternionsFlat(s.values,E,p,0,s.values,E);else for(var M=h-2*u,_=0;_<M;++_)s.values[E+_]-=p[_]}}(s))continue;return t.blendMode=2501,t}};function oP(t,n,r,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r}function oD(t,n,r,i){oP.call(this,t,n,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function oO(t,n,r,i){oP.call(this,t,n,r,i)}function oI(t,n,r,i){oP.call(this,t,n,r,i)}function oB(t,n,r,i){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=oR.convertArray(n,this.TimeBufferType),this.values=oR.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function oF(t,n,r){oB.call(this,t,n,r)}function ok(t,n,r,i){oB.call(this,t,n,r,i)}function oN(t,n,r,i){oB.call(this,t,n,r,i)}function oU(t,n,r,i){oP.call(this,t,n,r,i)}function oH(t,n,r,i){oB.call(this,t,n,r,i)}function oG(t,n,r,i){oB.call(this,t,n,r,i)}function oz(t,n,r,i){oB.call(this,t,n,r,i)}function oj(t,n,r,i){void 0===n&&(n=-1),void 0===i&&(i=2500),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=x.generateUUID(),this.duration<0&&this.resetDuration()}Object.assign(oP.prototype,{evaluate:function(t){var n,r=this.parameterPositions,i=this._cachedIndex,o=r[i],a=r[i-1];e:{t:{n:{r:if(!(t<o)){for(var s=i+2;;){if(void 0===o){if(t<a)break r;return i=r.length,this._cachedIndex=i,this.afterEnd_(i-1,t,a)}if(i===s)break;if(a=o,t<(o=r[++i]))break t}n=r.length;break n}if(!(t>=a)){var l=r[1];t<l&&(i=2,a=l);for(var c=i-2;;){if(void 0===a)return this._cachedIndex=0,this.beforeStart_(0,t,o);if(i===c)break;if(o=a,t>=(a=r[--i-1]))break t}n=i,i=0;break n}break e}for(;i<n;){var u=i+n>>>1;t<r[u]?n=u:i=u+1}if(o=r[i],void 0===(a=r[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,o);if(void 0===o)return i=r.length,this._cachedIndex=i,this.afterEnd_(i-1,a,t)}this._cachedIndex=i,this.intervalChanged_(i,a,o)}return this.interpolate_(i,a,t,o)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,o=t*i,a=0;a!==i;++a)n[a]=r[o+a];return n},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(oP.prototype,{beforeStart_:oP.prototype.copySampleValue_,afterEnd_:oP.prototype.copySampleValue_}),oD.prototype=Object.assign(Object.create(oP.prototype),{constructor:oD,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,n,r){var i=this.parameterPositions,o=t-2,a=t+1,s=i[o],l=i[a];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:o=t,s=2*n-r;break;case 2402:o=i.length-2,s=n+i[o]-i[o+1];break;default:o=t,s=r}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:a=t,l=2*r-n;break;case 2402:a=1,l=r+i[1]-i[0];break;default:a=t-1,l=n}var c=(r-n)*.5,u=this.valueSize;this._weightPrev=c/(n-s),this._weightNext=c/(l-r),this._offsetPrev=o*u,this._offsetNext=a*u},interpolate_:function(t,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=t*s,c=l-s,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(r-n)/(i-n),m=f*f,v=m*f,g=-d*v+2*d*m-d*f,y=(1+d)*v+(-1.5-2*d)*m+(-.5+d)*f+1,b=(-1-p)*v+(1.5+p)*m+.5*f,A=p*v-p*m,x=0;x!==s;++x)o[x]=g*a[u+x]+y*a[c+x]+b*a[l+x]+A*a[h+x];return o}}),oO.prototype=Object.assign(Object.create(oP.prototype),{constructor:oO,interpolate_:function(t,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=t*s,c=l-s,u=(r-n)/(i-n),h=1-u,d=0;d!==s;++d)o[d]=a[c+d]*h+a[l+d]*u;return o}}),oI.prototype=Object.assign(Object.create(oP.prototype),{constructor:oI,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(oB,{toJSON:function(t){var n,r=t.constructor;if(void 0!==r.toJSON)n=r.toJSON(t);else{n={name:t.name,times:oR.convertArray(t.times,Array),values:oR.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(n.interpolation=i)}return n.type=t.ValueTypeName,n}}),Object.assign(oB.prototype,{constructor:oB,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new oI(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new oO(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new oD(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var n;switch(t){case 2300:n=this.InterpolantFactoryMethodDiscrete;break;case 2301:n=this.InterpolantFactoryMethodLinear;break;case 2302:n=this.InterpolantFactoryMethodSmooth}if(void 0===n){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(r)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var n=this.times,r=0,i=n.length;r!==i;++r)n[r]+=t;return this},scale:function(t){if(1!==t)for(var n=this.times,r=0,i=n.length;r!==i;++r)n[r]*=t;return this},trim:function(t,n){for(var r=this.times,i=r.length,o=0,a=i-1;o!==i&&r[o]<t;)++o;for(;-1!==a&&r[a]>n;)--a;if(++a,0!==o||a!==i){o>=a&&(o=(a=Math.max(a,1))-1);var s=this.getValueSize();this.times=oR.arraySlice(r,o,a),this.values=oR.arraySlice(this.values,o*s,a*s)}return this},validate:function(){var t=!0,n=this.getValueSize();n-Math.floor(n)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,i=this.values,o=r.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,s=0;s!==o;s++){var l=r[s];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),t=!1;break}if(null!==a&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,a),t=!1;break}a=l}if(void 0!==i&&oR.isTypedArray(i))for(var c=0,u=i.length;c!==u;++c){var h=i[c];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,h),t=!1;break}}return t},optimize:function(){for(var t=oR.arraySlice(this.times),n=oR.arraySlice(this.values),r=this.getValueSize(),i=2302===this.getInterpolation(),o=t.length-1,a=1,s=1;s<o;++s){var l=!1,c=t[s];if(c!==t[s+1]&&(1!==s||c!==t[0])){if(i)l=!0;else for(var u=s*r,h=u-r,d=u+r,p=0;p!==r;++p){var f=n[u+p];if(f!==n[h+p]||f!==n[d+p]){l=!0;break}}}if(l){if(s!==a){t[a]=t[s];for(var m=s*r,v=a*r,g=0;g!==r;++g)n[v+g]=n[m+g]}++a}}if(o>0){t[a]=t[o];for(var y=o*r,b=a*r,A=0;A!==r;++A)n[b+A]=n[y+A];++a}return a!==t.length?(this.times=oR.arraySlice(t,0,a),this.values=oR.arraySlice(n,0,a*r)):(this.times=t,this.values=n),this},clone:function(){var t=oR.arraySlice(this.times,0),n=oR.arraySlice(this.values,0),r=new this.constructor(this.name,t,n);return r.createInterpolant=this.createInterpolant,r}}),oF.prototype=Object.assign(Object.create(oB.prototype),{constructor:oF,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ok.prototype=Object.assign(Object.create(oB.prototype),{constructor:ok,ValueTypeName:"color"}),oN.prototype=Object.assign(Object.create(oB.prototype),{constructor:oN,ValueTypeName:"number"}),oU.prototype=Object.assign(Object.create(oP.prototype),{constructor:oU,interpolate_:function(t,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=(r-n)/(i-n),c=t*s,u=c+s;c!==u;c+=4)P.slerpFlat(o,0,a,c-s,a,c,l);return o}}),oH.prototype=Object.assign(Object.create(oB.prototype),{constructor:oH,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new oU(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),oG.prototype=Object.assign(Object.create(oB.prototype),{constructor:oG,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oz.prototype=Object.assign(Object.create(oB.prototype),{constructor:oz,ValueTypeName:"vector"}),Object.assign(oj,{parse:function(t){for(var n=[],r=t.tracks,i=1/(t.fps||1),o=0,a=r.length;o!==a;++o)n.push((function(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var n=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return oN;case"vector":case"vector2":case"vector3":case"vector4":return oz;case"color":return ok;case"quaternion":return oH;case"bool":case"boolean":return oF;case"string":return oG}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var r=[],i=[];oR.flattenJSON(t.keys,r,i,"value"),t.times=r,t.values=i}return void 0!==n.parse?n.parse(t):new n(t.name,t.times,t.values,t.interpolation)})(r[o]).scale(i));var s=new oj(t.name,t.duration,n,t.blendMode);return s.uuid=t.uuid,s},toJSON:function(t){for(var n=[],r=t.tracks,i={name:t.name,duration:t.duration,tracks:n,uuid:t.uuid,blendMode:t.blendMode},o=0,a=r.length;o!==a;++o)n.push(oB.toJSON(r[o]));return i},CreateFromMorphTargetSequence:function(t,n,r,i){for(var o=n.length,a=[],s=0;s<o;s++){var l=[],c=[];l.push((s+o-1)%o,s,(s+1)%o),c.push(0,1,0);var u=oR.getKeyframeOrder(l);l=oR.sortedArray(l,1,u),c=oR.sortedArray(c,1,u),i||0!==l[0]||(l.push(o),c.push(c[0])),a.push(new oN(".morphTargetInfluences["+n[s].name+"]",l,c).scale(1/r))}return new oj(t,-1,a)},findByName:function(t,n){var r=t;Array.isArray(t)||(r=t.geometry&&t.geometry.animations||t.animations);for(var i=0;i<r.length;i++)if(r[i].name===n)return r[i];return null},CreateClipsFromMorphTargetSequences:function(t,n,r){for(var i={},o=/^([\w-]*?)([\d]+)$/,a=0,s=t.length;a<s;a++){var l=t[a],c=l.name.match(o);if(c&&c.length>1){var u=c[1],h=i[u];h||(i[u]=h=[]),h.push(l)}}var d=[];for(var p in i)d.push(oj.CreateFromMorphTargetSequence(p,i[p],n,r));return d},parseAnimation:function(t,n){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(t,n,r,i,o){if(0!==r.length){var a=[],s=[];oR.flattenJSON(r,a,s,i),0!==a.length&&o.push(new t(n,a,s))}},i=[],o=t.name||"default",a=t.fps||30,s=t.blendMode,l=t.length||-1,c=t.hierarchy||[],u=0;u<c.length;u++){var h=c[u].keys;if(h&&0!==h.length){if(h[0].morphTargets){var d={},p=void 0;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(var f=0;f<h[p].morphTargets.length;f++)d[h[p].morphTargets[f]]=-1;for(var m in d){for(var v=[],g=[],y=0;y!==h[p].morphTargets.length;++y){var b=h[p];v.push(b.time),g.push(b.morphTarget===m?1:0)}i.push(new oN(".morphTargetInfluence["+m+"]",v,g))}l=d.length*(a||1)}else{var A=".bones["+n[u].name+"]";r(oz,A+".position",h,"pos",i),r(oH,A+".quaternion",h,"rot",i),r(oz,A+".scale",h,"scl",i)}}}return 0===i.length?null:new oj(o,l,i,s)}}),Object.assign(oj.prototype,{resetDuration:function(){for(var t=this.tracks,n=0,r=0,i=t.length;r!==i;++r){var o=this.tracks[r];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,n=0;n<this.tracks.length;n++)t=t&&this.tracks[n].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],n=0;n<this.tracks.length;n++)t.push(this.tracks[n].clone());return new oj(this.name,this.duration,t,this.blendMode)},toJSON:function(){return oj.toJSON(this)}});var oV={enabled:!1,files:{},add:function(t,n){!1!==this.enabled&&(this.files[t]=n)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function oW(t,n,r){var i=this,o=!1,a=0,s=0,l=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(t){s++,!1===o&&void 0!==i.onStart&&i.onStart(t,a,s),o=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,s),a===s&&(o=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return l?l(t):t},this.setURLModifier=function(t){return l=t,this},this.addHandler=function(t,n){return c.push(t,n),this},this.removeHandler=function(t){var n=c.indexOf(t);return -1!==n&&c.splice(n,2),this},this.getHandler=function(t){for(var n=0,r=c.length;n<r;n+=2){var i=c[n],o=c[n+1];if(i.global&&(i.lastIndex=0),i.test(t))return o}return null}}var oq=new oW;function oX(t){this.manager=void 0!==t?t:oq,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(oX.prototype,{load:function(){},loadAsync:function(t,n){var r=this;return new Promise(function(i,o){r.load(t,i,n,o)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var oY={};function oQ(t){oX.call(this,t)}function oZ(t){oX.call(this,t)}function oK(t){oX.call(this,t)}function oJ(t){oX.call(this,t)}function o$(t){oX.call(this,t)}function o0(t){oX.call(this,t)}function o1(t){oX.call(this,t)}function o2(){this.type="Curve",this.arcLengthDivisions=200}function o3(t,n,r,i,o,a,s,l){o2.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=n||0,this.xRadius=r||1,this.yRadius=i||1,this.aStartAngle=o||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=s||!1,this.aRotation=l||0}function o4(t,n,r,i,o,a){o3.call(this,t,n,r,r,i,o,a),this.type="ArcCurve"}function o5(){var t=0,n=0,r=0,i=0;function o(o,a,s,l){t=o,n=s,r=-3*o+3*a-2*s-l,i=2*o-2*a+s+l}return{initCatmullRom:function(t,n,r,i,a){o(n,r,a*(r-t),a*(i-n))},initNonuniformCatmullRom:function(t,n,r,i,a,s,l){var c=(n-t)/a-(r-t)/(a+s)+(r-n)/s,u=(r-n)/s-(i-n)/(s+l)+(i-r)/l;o(n,r,c*=s,u*=s)},calc:function(o){var a=o*o;return t+n*o+r*a+a*o*i}}}oQ.prototype=Object.assign(Object.create(oX.prototype),{constructor:oQ,load:function(t,n,r,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,a=oV.get(t);if(void 0!==a)return o.manager.itemStart(t),setTimeout(function(){n&&n(a),o.manager.itemEnd(t)},0),a;if(void 0!==oY[t]){oY[t].push({onLoad:n,onProgress:r,onError:i});return}var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var l=s[1],c=!!s[2],u=s[3];u=decodeURIComponent(u),c&&(u=atob(u));try{var h,d,p=(this.responseType||"").toLowerCase();switch(p){case"arraybuffer":case"blob":for(var f=new Uint8Array(u.length),m=0;m<u.length;m++)f[m]=u.charCodeAt(m);d="blob"===p?new Blob([f.buffer],{type:l}):f.buffer;break;case"document":d=new DOMParser().parseFromString(u,l);break;case"json":d=JSON.parse(u);break;default:d=u}setTimeout(function(){n&&n(d),o.manager.itemEnd(t)},0)}catch(n){setTimeout(function(){i&&i(n),o.manager.itemError(t),o.manager.itemEnd(t)},0)}}else{for(var v in oY[t]=[],oY[t].push({onLoad:n,onProgress:r,onError:i}),(h=new XMLHttpRequest).open("GET",t,!0),h.addEventListener("load",function(n){var r=this.response,i=oY[t];if(delete oY[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),oV.add(t,r);for(var a=0,s=i.length;a<s;a++){var l=i[a];l.onLoad&&l.onLoad(r)}o.manager.itemEnd(t)}else{for(var c=0,u=i.length;c<u;c++){var h=i[c];h.onError&&h.onError(n)}o.manager.itemError(t),o.manager.itemEnd(t)}},!1),h.addEventListener("progress",function(n){for(var r=oY[t],i=0,o=r.length;i<o;i++){var a=r[i];a.onProgress&&a.onProgress(n)}},!1),h.addEventListener("error",function(n){var r=oY[t];delete oY[t];for(var i=0,a=r.length;i<a;i++){var s=r[i];s.onError&&s.onError(n)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),h.addEventListener("abort",function(n){var r=oY[t];delete oY[t];for(var i=0,a=r.length;i<a;i++){var s=r[i];s.onError&&s.onError(n)}o.manager.itemError(t),o.manager.itemEnd(t)},!1),void 0!==this.responseType&&(h.responseType=this.responseType),void 0!==this.withCredentials&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)h.setRequestHeader(v,this.requestHeader[v]);h.send(null)}return o.manager.itemStart(t),h},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}}),oZ.prototype=Object.assign(Object.create(oX.prototype),{constructor:oZ,load:function(t,n,r,i){var o=this,a=new oQ(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,function(r){try{n(o.parse(JSON.parse(r)))}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)},parse:function(t){for(var n=[],r=0;r<t.length;r++){var i=oj.parse(t[r]);n.push(i)}return n}}),oK.prototype=Object.assign(Object.create(oX.prototype),{constructor:oK,load:function(t,n,r,i){var o=this,a=[],s=new iB,l=new oQ(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(o.withCredentials);var c=0;if(Array.isArray(t))for(var u=0,h=t.length;u<h;++u)!function(u){l.load(t[u],function(t){var r=o.parse(t,!0);a[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(c+=1)&&(1===r.mipmapCount&&(s.minFilter=1006),s.image=a,s.format=r.format,s.needsUpdate=!0,n&&n(s))},r,i)}(u);else l.load(t,function(t){var r=o.parse(t,!0);if(r.isCubemap){for(var i=r.mipmaps.length/r.mipmapCount,l=0;l<i;l++){a[l]={mipmaps:[]};for(var c=0;c<r.mipmapCount;c++)a[l].mipmaps.push(r.mipmaps[l*r.mipmapCount+c]),a[l].format=r.format,a[l].width=r.width,a[l].height=r.height}s.image=a}else s.image.width=r.width,s.image.height=r.height,s.mipmaps=r.mipmaps;1===r.mipmapCount&&(s.minFilter=1006),s.format=r.format,s.needsUpdate=!0,n&&n(s)},r,i);return s}}),oJ.prototype=Object.assign(Object.create(oX.prototype),{constructor:oJ,load:function(t,n,r,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,a=oV.get(t);if(void 0!==a)return o.manager.itemStart(t),setTimeout(function(){n&&n(a),o.manager.itemEnd(t)},0),a;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");function l(){s.removeEventListener("load",l,!1),s.removeEventListener("error",c,!1),oV.add(t,this),n&&n(this),o.manager.itemEnd(t)}function c(n){s.removeEventListener("load",l,!1),s.removeEventListener("error",c,!1),i&&i(n),o.manager.itemError(t),o.manager.itemEnd(t)}return s.addEventListener("load",l,!1),s.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(t),s.src=t,s}}),o$.prototype=Object.assign(Object.create(oX.prototype),{constructor:o$,load:function(t,n,r,i){var o=new tW,a=new oJ(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var s=0,l=0;l<t.length;++l)!function(r){a.load(t[r],function(t){o.images[r]=t,6==++s&&(o.needsUpdate=!0,n&&n(o))},void 0,i)}(l);return o}}),o0.prototype=Object.assign(Object.create(oX.prototype),{constructor:o0,load:function(t,n,r,i){var o=this,a=new tX,s=new oQ(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(o.withCredentials),s.load(t,function(t){var r=o.parse(t);r&&(void 0!==r.image?a.image=r.image:void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data),a.wrapS=void 0!==r.wrapS?r.wrapS:1001,a.wrapT=void 0!==r.wrapT?r.wrapT:1001,a.magFilter=void 0!==r.magFilter?r.magFilter:1006,a.minFilter=void 0!==r.minFilter?r.minFilter:1006,a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.encoding&&(a.encoding=r.encoding),void 0!==r.flipY&&(a.flipY=r.flipY),void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps,a.minFilter=1008),1===r.mipmapCount&&(a.minFilter=1006),a.needsUpdate=!0,n&&n(a,r))},r,i),a}}),o1.prototype=Object.assign(Object.create(oX.prototype),{constructor:o1,load:function(t,n,r,i){var o=new T,a=new oJ(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(r){o.image=r;var i=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);o.format=i?1022:1023,o.needsUpdate=!0,void 0!==n&&n(o)},r,i),o}}),Object.assign(o2.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,n){var r=this.getUtoTmapping(t);return this.getPoint(r,n)},getPoints:function(t){void 0===t&&(t=5);for(var n=[],r=0;r<=t;r++)n.push(this.getPoint(r/t));return n},getSpacedPoints:function(t){void 0===t&&(t=5);for(var n=[],r=0;r<=t;r++)n.push(this.getPointAt(r/t));return n},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n,r=[],i=this.getPoint(0),o=0;r.push(0);for(var a=1;a<=t;a++)r.push(o+=(n=this.getPoint(a/t)).distanceTo(i)),i=n;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,n){var r=this.getLengths(),i=0,o=r.length;a=n||t*r[o-1];for(var a,s,l=0,c=o-1;l<=c;)if((s=r[i=Math.floor(l+(c-l)/2)]-a)<0)l=i+1;else if(s>0)c=i-1;else{c=i;break}if(r[i=c]===a)return i/(o-1);var u=r[i],h=r[i+1];return(i+(a-u)/(h-u))/(o-1)},getTangent:function(t,n){var r=t-1e-4,i=t+1e-4;r<0&&(r=0),i>1&&(i=1);var o=this.getPoint(r),a=this.getPoint(i),s=n||(o.isVector2?new w:new D);return s.copy(a).sub(o).normalize(),s},getTangentAt:function(t,n){var r=this.getUtoTmapping(t);return this.getTangent(r,n)},computeFrenetFrames:function(t,n){for(var r=new D,i=[],o=[],a=[],s=new D,l=new ea,c=0;c<=t;c++){var u=c/t;i[c]=this.getTangentAt(u,new D),i[c].normalize()}o[0]=new D,a[0]=new D;var h=Number.MAX_VALUE,d=Math.abs(i[0].x),p=Math.abs(i[0].y),f=Math.abs(i[0].z);d<=h&&(h=d,r.set(1,0,0)),p<=h&&(h=p,r.set(0,1,0)),f<=h&&r.set(0,0,1),s.crossVectors(i[0],r).normalize(),o[0].crossVectors(i[0],s),a[0].crossVectors(i[0],o[0]);for(var m=1;m<=t;m++){if(o[m]=o[m-1].clone(),a[m]=a[m-1].clone(),s.crossVectors(i[m-1],i[m]),s.length()>Number.EPSILON){s.normalize();var v=Math.acos(x.clamp(i[m-1].dot(i[m]),-1,1));o[m].applyMatrix4(l.makeRotationAxis(s,v))}a[m].crossVectors(i[m],o[m])}if(!0===n){var g=Math.acos(x.clamp(o[0].dot(o[t]),-1,1));g/=t,i[0].dot(s.crossVectors(o[0],o[t]))>0&&(g=-g);for(var y=1;y<=t;y++)o[y].applyMatrix4(l.makeRotationAxis(i[y],g*y)),a[y].crossVectors(i[y],o[y])}return{tangents:i,normals:o,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),o3.prototype=Object.create(o2.prototype),o3.prototype.constructor=o3,o3.prototype.isEllipseCurve=!0,o3.prototype.getPoint=function(t,n){for(var r=n||new w,i=2*Math.PI,o=this.aEndAngle-this.aStartAngle,a=Math.abs(o)<Number.EPSILON;o<0;)o+=i;for(;o>i;)o-=i;o<Number.EPSILON&&(o=a?0:i),!0!==this.aClockwise||a||(o===i?o=-i:o-=i);var s=this.aStartAngle+t*o,l=this.aX+this.xRadius*Math.cos(s),c=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,p=c-this.aY;l=d*u-p*h+this.aX,c=d*h+p*u+this.aY}return r.set(l,c)},o3.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},o3.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},o3.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},o4.prototype=Object.create(o3.prototype),o4.prototype.constructor=o4,o4.prototype.isArcCurve=!0;var o6=new D,o7=new o5,o8=new o5,o9=new o5;function ae(t,n,r,i){void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r="centripetal"),void 0===i&&(i=.5),o2.call(this),this.type="CatmullRomCurve3",this.points=t,this.closed=n,this.curveType=r,this.tension=i}function at(t,n,r,i,o){var a=(i-n)*.5,s=(o-r)*.5,l=t*t;return t*l*(2*r-2*i+a+s)+(-3*r+3*i-2*a-s)*l+a*t+r}function an(t,n,r,i){var o;return(o=1-t)*o*n+2*(1-t)*t*r+t*t*i}function ar(t,n,r,i,o){var a,s;return(a=1-t)*a*a*n+3*(s=1-t)*s*t*r+3*(1-t)*t*t*i+t*t*t*o}function ai(t,n,r,i){void 0===t&&(t=new w),void 0===n&&(n=new w),void 0===r&&(r=new w),void 0===i&&(i=new w),o2.call(this),this.type="CubicBezierCurve",this.v0=t,this.v1=n,this.v2=r,this.v3=i}function ao(t,n,r,i){void 0===t&&(t=new D),void 0===n&&(n=new D),void 0===r&&(r=new D),void 0===i&&(i=new D),o2.call(this),this.type="CubicBezierCurve3",this.v0=t,this.v1=n,this.v2=r,this.v3=i}function aa(t,n){void 0===t&&(t=new w),void 0===n&&(n=new w),o2.call(this),this.type="LineCurve",this.v1=t,this.v2=n}function as(t,n){void 0===t&&(t=new D),void 0===n&&(n=new D),o2.call(this),this.type="LineCurve3",this.v1=t,this.v2=n}function al(t,n,r){void 0===t&&(t=new w),void 0===n&&(n=new w),void 0===r&&(r=new w),o2.call(this),this.type="QuadraticBezierCurve",this.v0=t,this.v1=n,this.v2=r}function ac(t,n,r){void 0===t&&(t=new D),void 0===n&&(n=new D),void 0===r&&(r=new D),o2.call(this),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=n,this.v2=r}function au(t){void 0===t&&(t=[]),o2.call(this),this.type="SplineCurve",this.points=t}ae.prototype=Object.create(o2.prototype),ae.prototype.constructor=ae,ae.prototype.isCatmullRomCurve3=!0,ae.prototype.getPoint=function(t,n){void 0===n&&(n=new D);var r,i,o=n,a=this.points,s=a.length,l=(s-(this.closed?0:1))*t,c=Math.floor(l),u=l-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/s)+1)*s:0===u&&c===s-1&&(c=s-2,u=1),this.closed||c>0?r=a[(c-1)%s]:(o6.subVectors(a[0],a[1]).add(a[0]),r=o6);var h=a[c%s],d=a[(c+1)%s];if(this.closed||c+2<s?i=a[(c+2)%s]:(o6.subVectors(a[s-1],a[s-2]).add(a[s-1]),i=o6),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(r.distanceToSquared(h),p),m=Math.pow(h.distanceToSquared(d),p),v=Math.pow(d.distanceToSquared(i),p);m<1e-4&&(m=1),f<1e-4&&(f=m),v<1e-4&&(v=m),o7.initNonuniformCatmullRom(r.x,h.x,d.x,i.x,f,m,v),o8.initNonuniformCatmullRom(r.y,h.y,d.y,i.y,f,m,v),o9.initNonuniformCatmullRom(r.z,h.z,d.z,i.z,f,m,v)}else"catmullrom"===this.curveType&&(o7.initCatmullRom(r.x,h.x,d.x,i.x,this.tension),o8.initCatmullRom(r.y,h.y,d.y,i.y,this.tension),o9.initCatmullRom(r.z,h.z,d.z,i.z,this.tension));return o.set(o7.calc(u),o8.calc(u),o9.calc(u)),o},ae.prototype.copy=function(t){o2.prototype.copy.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ae.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);t.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},ae.prototype.fromJSON=function(t){o2.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(new D().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ai.prototype=Object.create(o2.prototype),ai.prototype.constructor=ai,ai.prototype.isCubicBezierCurve=!0,ai.prototype.getPoint=function(t,n){void 0===n&&(n=new w);var r=n,i=this.v0,o=this.v1,a=this.v2,s=this.v3;return r.set(ar(t,i.x,o.x,a.x,s.x),ar(t,i.y,o.y,a.y,s.y)),r},ai.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ai.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ai.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ao.prototype=Object.create(o2.prototype),ao.prototype.constructor=ao,ao.prototype.isCubicBezierCurve3=!0,ao.prototype.getPoint=function(t,n){void 0===n&&(n=new D);var r=n,i=this.v0,o=this.v1,a=this.v2,s=this.v3;return r.set(ar(t,i.x,o.x,a.x,s.x),ar(t,i.y,o.y,a.y,s.y),ar(t,i.z,o.z,a.z,s.z)),r},ao.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ao.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ao.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},aa.prototype=Object.create(o2.prototype),aa.prototype.constructor=aa,aa.prototype.isLineCurve=!0,aa.prototype.getPoint=function(t,n){void 0===n&&(n=new w);var r=n;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},aa.prototype.getPointAt=function(t,n){return this.getPoint(t,n)},aa.prototype.getTangent=function(t,n){var r=n||new w;return r.copy(this.v2).sub(this.v1).normalize(),r},aa.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},aa.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},aa.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},as.prototype=Object.create(o2.prototype),as.prototype.constructor=as,as.prototype.isLineCurve3=!0,as.prototype.getPoint=function(t,n){void 0===n&&(n=new D);var r=n;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},as.prototype.getPointAt=function(t,n){return this.getPoint(t,n)},as.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},as.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},as.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},al.prototype=Object.create(o2.prototype),al.prototype.constructor=al,al.prototype.isQuadraticBezierCurve=!0,al.prototype.getPoint=function(t,n){void 0===n&&(n=new w);var r=n,i=this.v0,o=this.v1,a=this.v2;return r.set(an(t,i.x,o.x,a.x),an(t,i.y,o.y,a.y)),r},al.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},al.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},al.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ac.prototype=Object.create(o2.prototype),ac.prototype.constructor=ac,ac.prototype.isQuadraticBezierCurve3=!0,ac.prototype.getPoint=function(t,n){void 0===n&&(n=new D);var r=n,i=this.v0,o=this.v1,a=this.v2;return r.set(an(t,i.x,o.x,a.x),an(t,i.y,o.y,a.y),an(t,i.z,o.z,a.z)),r},ac.prototype.copy=function(t){return o2.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ac.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ac.prototype.fromJSON=function(t){return o2.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},au.prototype=Object.create(o2.prototype),au.prototype.constructor=au,au.prototype.isSplineCurve=!0,au.prototype.getPoint=function(t,n){void 0===n&&(n=new w);var r=n,i=this.points,o=(i.length-1)*t,a=Math.floor(o),s=o-a,l=i[0===a?a:a-1],c=i[a],u=i[a>i.length-2?i.length-1:a+1],h=i[a>i.length-3?i.length-1:a+2];return r.set(at(s,l.x,c.x,u.x,h.x),at(s,l.y,c.y,u.y,h.y)),r},au.prototype.copy=function(t){o2.prototype.copy.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(i.clone())}return this},au.prototype.toJSON=function(){var t=o2.prototype.toJSON.call(this);t.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];t.points.push(i.toArray())}return t},au.prototype.fromJSON=function(t){o2.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(new w().fromArray(i))}return this};var ah=Object.freeze({__proto__:null,ArcCurve:o4,CatmullRomCurve3:ae,CubicBezierCurve:ai,CubicBezierCurve3:ao,EllipseCurve:o3,LineCurve:aa,LineCurve3:as,QuadraticBezierCurve:al,QuadraticBezierCurve3:ac,SplineCurve:au});function ad(){o2.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ap(t){ad.call(this),this.type="Path",this.currentPoint=new w,t&&this.setFromPoints(t)}function af(t){ap.call(this,t),this.uuid=x.generateUUID(),this.type="Shape",this.holes=[]}function am(t,n){void 0===n&&(n=1),eP.call(this),this.type="Light",this.color=new e$(t),this.intensity=n}function av(t,n,r){am.call(this,t,r),this.type="HemisphereLight",this.position.copy(eP.DefaultUp),this.updateMatrix(),this.groundColor=new e$(n)}function ag(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new w(512,512),this.map=null,this.mapPass=null,this.matrix=new ea,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tZ,this._frameExtents=new w(1,1),this._viewportCount=1,this._viewports=[new C(0,0,1,1)]}function ay(){ag.call(this,new tj(50,1,.5,500)),this.focus=1}function ab(t,n,r,i,o,a){am.call(this,t,n),this.type="SpotLight",this.position.copy(eP.DefaultUp),this.updateMatrix(),this.target=new eP,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==o?o:0,this.decay=void 0!==a?a:1,this.shadow=new ay}function aA(){ag.call(this,new tj(90,1,.5,500)),this._frameExtents=new w(4,2),this._viewportCount=6,this._viewports=[new C(2,1,1,1),new C(0,1,1,1),new C(3,1,1,1),new C(1,1,1,1),new C(3,0,1,1),new C(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}function ax(t,n,r,i){am.call(this,t,n),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==i?i:1,this.shadow=new aA}function aw(t,n,r,i,o,a){void 0===t&&(t=-1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=-1),void 0===o&&(o=.1),void 0===a&&(a=2e3),tz.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=n,this.top=r,this.bottom=i,this.near=o,this.far=a,this.updateProjectionMatrix()}function aE(){ag.call(this,new aw(-5,5,5,-5,.5,500))}function aM(t,n){am.call(this,t,n),this.type="DirectionalLight",this.position.copy(eP.DefaultUp),this.updateMatrix(),this.target=new eP,this.shadow=new aE}function a_(t,n){am.call(this,t,n),this.type="AmbientLight"}function aT(t,n,r,i){am.call(this,t,n),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==i?i:10}ad.prototype=Object.assign(Object.create(o2.prototype),{constructor:ad,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);t.equals(n)||this.curves.push(new aa(n,t))},getPoint:function(t){for(var n=t*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var o=r[i]-n,a=this.curves[i],s=a.getLength(),l=0===s?0:1-o/s;return a.getPointAt(l)}i++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],n=0,r=0,i=this.curves.length;r<i;r++)t.push(n+=this.curves[r].getLength());return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var n=[],r=0;r<=t;r++)n.push(this.getPoint(r/t));return this.autoClose&&n.push(n[0]),n},getPoints:function(t){void 0===t&&(t=12);for(var n,r=[],i=0,o=this.curves;i<o.length;i++)for(var a=o[i],s=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,l=a.getPoints(s),c=0;c<l.length;c++){var u=l[c];n&&n.equals(u)||(r.push(u),n=u)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){o2.prototype.copy.call(this,t),this.curves=[];for(var n=0,r=t.curves.length;n<r;n++){var i=t.curves[n];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=o2.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var n=0,r=this.curves.length;n<r;n++){var i=this.curves[n];t.curves.push(i.toJSON())}return t},fromJSON:function(t){o2.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var n=0,r=t.curves.length;n<r;n++){var i=t.curves[n];this.curves.push(new ah[i.type]().fromJSON(i))}return this}}),ap.prototype=Object.assign(Object.create(ad.prototype),{constructor:ap,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var n=1,r=t.length;n<r;n++)this.lineTo(t[n].x,t[n].y);return this},moveTo:function(t,n){return this.currentPoint.set(t,n),this},lineTo:function(t,n){var r=new aa(this.currentPoint.clone(),new w(t,n));return this.curves.push(r),this.currentPoint.set(t,n),this},quadraticCurveTo:function(t,n,r,i){var o=new al(this.currentPoint.clone(),new w(t,n),new w(r,i));return this.curves.push(o),this.currentPoint.set(r,i),this},bezierCurveTo:function(t,n,r,i,o,a){var s=new ai(this.currentPoint.clone(),new w(t,n),new w(r,i),new w(o,a));return this.curves.push(s),this.currentPoint.set(o,a),this},splineThru:function(t){var n=new au([this.currentPoint.clone()].concat(t));return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,n,r,i,o,a){var s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+s,n+l,r,i,o,a),this},absarc:function(t,n,r,i,o,a){return this.absellipse(t,n,r,r,i,o,a),this},ellipse:function(t,n,r,i,o,a,s,l){var c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+c,n+u,r,i,o,a,s,l),this},absellipse:function(t,n,r,i,o,a,s,l){var c=new o3(t,n,r,i,o,a,s,l);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var h=c.getPoint(1);return this.currentPoint.copy(h),this},copy:function(t){return ad.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=ad.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return ad.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),af.prototype=Object.assign(Object.create(ap.prototype),{constructor:af,getPointsHoles:function(t){for(var n=[],r=0,i=this.holes.length;r<i;r++)n[r]=this.holes[r].getPoints(t);return n},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ap.prototype.copy.call(this,t),this.holes=[];for(var n=0,r=t.holes.length;n<r;n++){var i=t.holes[n];this.holes.push(i.clone())}return this},toJSON:function(){var t=ap.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var n=0,r=this.holes.length;n<r;n++){var i=this.holes[n];t.holes.push(i.toJSON())}return t},fromJSON:function(t){ap.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var n=0,r=t.holes.length;n<r;n++){var i=t.holes[n];this.holes.push(new ap().fromJSON(i))}return this}}),am.prototype=Object.assign(Object.create(eP.prototype),{constructor:am,isLight:!0,copy:function(t){return eP.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var n=eP.prototype.toJSON.call(this,t);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n}}),av.prototype=Object.assign(Object.create(am.prototype),{constructor:av,isHemisphereLight:!0,copy:function(t){return am.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(ag.prototype,{_projScreenMatrix:new ea,_lightPositionWorld:new D,_lookTarget:new D,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var n=this.camera,r=this.matrix,i=this._projScreenMatrix,o=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),n.position.copy(a),o.setFromMatrixPosition(t.target.matrixWorld),n.lookAt(o),n.updateMatrixWorld(),i.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(n.projectionMatrix),r.multiply(n.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ay.prototype=Object.assign(Object.create(ag.prototype),{constructor:ay,isSpotLightShadow:!0,updateMatrices:function(t){var n=this.camera,r=2*x.RAD2DEG*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=t.distance||n.far;(r!==n.fov||i!==n.aspect||o!==n.far)&&(n.fov=r,n.aspect=i,n.far=o,n.updateProjectionMatrix()),ag.prototype.updateMatrices.call(this,t)}}),ab.prototype=Object.assign(Object.create(am.prototype),{constructor:ab,isSpotLight:!0,copy:function(t){return am.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),aA.prototype=Object.assign(Object.create(ag.prototype),{constructor:aA,isPointLightShadow:!0,updateMatrices:function(t,n){void 0===n&&(n=0);var r=this.camera,i=this.matrix,o=this._lightPositionWorld,a=this._lookTarget,s=this._projScreenMatrix;o.setFromMatrixPosition(t.matrixWorld),r.position.copy(o),a.copy(r.position),a.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(a),r.updateMatrixWorld(),i.makeTranslation(-o.x,-o.y,-o.z),s.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s)}}),ax.prototype=Object.assign(Object.create(am.prototype),{constructor:ax,isPointLight:!0,copy:function(t){return am.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),aw.prototype=Object.assign(Object.create(tz.prototype),{constructor:aw,isOrthographicCamera:!0,copy:function(t,n){return tz.prototype.copy.call(this,t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,n,r,i,o,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,o=r-t,a=r+t,s=i+n,l=i-n;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,a=o+c*this.view.width,s-=u*this.view.offsetY,l=s-u*this.view.height}this.projectionMatrix.makeOrthographic(o,a,s,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){var n=eP.prototype.toJSON.call(this,t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=Object.assign({},this.view)),n}}),aE.prototype=Object.assign(Object.create(ag.prototype),{constructor:aE,isDirectionalLightShadow:!0,updateMatrices:function(t){ag.prototype.updateMatrices.call(this,t)}}),aM.prototype=Object.assign(Object.create(am.prototype),{constructor:aM,isDirectionalLight:!0,copy:function(t){return am.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),a_.prototype=Object.assign(Object.create(am.prototype),{constructor:a_,isAmbientLight:!0}),aT.prototype=Object.assign(Object.create(am.prototype),{constructor:aT,isRectAreaLight:!0,copy:function(t){return am.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var n=am.prototype.toJSON.call(this,t);return n.object.width=this.width,n.object.height=this.height,n}});var aS=function(){function t(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new D)}var n=t.prototype;return n.set=function(t){for(var n=0;n<9;n++)this.coefficients[n].copy(t[n]);return this},n.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},n.getAt=function(t,n){var r=t.x,i=t.y,o=t.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*i),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*r),n.addScaledVector(a[4],r*i*1.092548),n.addScaledVector(a[5],i*o*1.092548),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],r*o*1.092548),n.addScaledVector(a[8],.546274*(r*r-i*i)),n},n.getIrradianceAt=function(t,n){var r=t.x,i=t.y,o=t.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],1.023328*i),n.addScaledVector(a[2],1.023328*o),n.addScaledVector(a[3],1.023328*r),n.addScaledVector(a[4],.858086*r*i),n.addScaledVector(a[5],.858086*i*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],.858086*r*o),n.addScaledVector(a[8],.429043*(r*r-i*i)),n},n.add=function(t){for(var n=0;n<9;n++)this.coefficients[n].add(t.coefficients[n]);return this},n.addScaledSH=function(t,n){for(var r=0;r<9;r++)this.coefficients[r].addScaledVector(t.coefficients[r],n);return this},n.scale=function(t){for(var n=0;n<9;n++)this.coefficients[n].multiplyScalar(t);return this},n.lerp=function(t,n){for(var r=0;r<9;r++)this.coefficients[r].lerp(t.coefficients[r],n);return this},n.equals=function(t){for(var n=0;n<9;n++)if(!this.coefficients[n].equals(t.coefficients[n]))return!1;return!0},n.copy=function(t){return this.set(t.coefficients)},n.clone=function(){return new this.constructor().copy(this)},n.fromArray=function(t,n){void 0===n&&(n=0);for(var r=this.coefficients,i=0;i<9;i++)r[i].fromArray(t,n+3*i);return this},n.toArray=function(t,n){void 0===t&&(t=[]),void 0===n&&(n=0);for(var r=this.coefficients,i=0;i<9;i++)r[i].toArray(t,n+3*i);return t},t.getBasisAt=function(t,n){var r=t.x,i=t.y,o=t.z;n[0]=.282095,n[1]=.488603*i,n[2]=.488603*o,n[3]=.488603*r,n[4]=1.092548*r*i,n[5]=1.092548*i*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*r*o,n[8]=.546274*(r*r-i*i)},t}();function aC(t,n){am.call(this,void 0,n),this.type="LightProbe",this.sh=void 0!==t?t:new aS}function aL(t){oX.call(this,t),this.textures={}}aC.prototype=Object.assign(Object.create(am.prototype),{constructor:aC,isLightProbe:!0,copy:function(t){return am.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){var n=am.prototype.toJSON.call(this,t);return n.object.sh=this.sh.toArray(),n}}),aL.prototype=Object.assign(Object.create(oX.prototype),{constructor:aL,load:function(t,n,r,i){var o=this,a=new oQ(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,function(r){try{n(o.parse(JSON.parse(r)))}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)},parse:function(t){var n=this.textures;function r(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var i=new oL[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&void 0!==i.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=new e$().setHex(t.sheen)),void 0!==t.emissive&&void 0!==i.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==i.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),1!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(i.morphNormals=t.morphNormals),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.vertexTangents&&(i.vertexTangents=t.vertexTangents),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var o in t.uniforms){var a=t.uniforms[o];switch(i.uniforms[o]={},a.type){case"t":i.uniforms[o].value=r(a.value);break;case"c":i.uniforms[o].value=new e$().setHex(a.value);break;case"v2":i.uniforms[o].value=new w().fromArray(a.value);break;case"v3":i.uniforms[o].value=new D().fromArray(a.value);break;case"v4":i.uniforms[o].value=new C().fromArray(a.value);break;case"m3":i.uniforms[o].value=new E().fromArray(a.value);break;case"m4":i.uniforms[o].value=new ea().fromArray(a.value);break;default:i.uniforms[o].value=a.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var s in t.extensions)i.extensions[s]=t.extensions[s];if(void 0!==t.shading&&(i.flatShading=1===t.shading),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=r(t.map)),void 0!==t.matcap&&(i.matcap=r(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=r(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=r(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=r(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale){var l=t.normalScale;!1===Array.isArray(l)&&(l=[l,l]),i.normalScale=new w().fromArray(l)}return void 0!==t.displacementMap&&(i.displacementMap=r(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=r(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=r(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=r(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=r(t.specularMap)),void 0!==t.envMap&&(i.envMap=r(t.envMap)),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=r(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=r(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=r(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=r(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=r(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=new w().fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(i.transmission=t.transmission),void 0!==t.transmissionMap&&(i.transmissionMap=r(t.transmissionMap)),i},setTextures:function(t){return this.textures=t,this}});var aR={decodeText:function(t){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(t);for(var n="",r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(n))}catch(t){return n}},extractUrlBase:function(t){var n=t.lastIndexOf("/");return -1===n?"./":t.substr(0,n+1)}};function aP(){tg.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function aD(t,n,r,i){"number"==typeof r&&(i=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),e6.call(this,t,n,r),this.meshPerAttribute=i||1}function aO(t){oX.call(this,t)}aP.prototype=Object.assign(Object.create(tg.prototype),{constructor:aP,isInstancedBufferGeometry:!0,copy:function(t){return tg.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=tg.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),aD.prototype=Object.assign(Object.create(e6.prototype),{constructor:aD,isInstancedBufferAttribute:!0,copy:function(t){return e6.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=e6.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),aO.prototype=Object.assign(Object.create(oX.prototype),{constructor:aO,load:function(t,n,r,i){var o=this,a=new oQ(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,function(r){try{n(o.parse(JSON.parse(r)))}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)},parse:function(t){var n={},r={};function i(t,i){if(void 0!==n[i])return n[i];var o=t.interleavedBuffers[i],a=function(t,n){if(void 0!==r[n])return r[n];var i=new Uint32Array(t.arrayBuffers[n]).buffer;return r[n]=i,i}(t,o.buffer),s=new rz(tc(o.type,a),o.stride);return s.uuid=o.uuid,n[i]=s,s}var o=t.isInstancedBufferGeometry?new aP:new tg,a=t.data.index;if(void 0!==a){var s=tc(a.type,a.array);o.setIndex(new e6(s,1))}var l=t.data.attributes;for(var c in l){var u=l[c],h=void 0;if(u.isInterleavedBufferAttribute)h=new rV(i(t.data,u.data),u.itemSize,u.offset,u.normalized);else{var d=tc(u.type,u.array);h=new(u.isInstancedBufferAttribute?aD:e6)(d,u.itemSize,u.normalized)}void 0!==u.name&&(h.name=u.name),o.setAttribute(c,h)}var p=t.data.morphAttributes;if(p)for(var f in p){for(var m=p[f],v=[],g=0,y=m.length;g<y;g++){var b=m[g],A=void 0;A=b.isInterleavedBufferAttribute?new rV(i(t.data,b.data),b.itemSize,b.offset,b.normalized):new e6(tc(b.type,b.array),b.itemSize,b.normalized),void 0!==b.name&&(A.name=b.name),v.push(A)}o.morphAttributes[f]=v}t.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);var x=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==x)for(var w=0,E=x.length;w!==E;++w){var M=x[w];o.addGroup(M.start,M.count,M.materialIndex)}var _=t.data.boundingSphere;if(void 0!==_){var T=new D;void 0!==_.center&&T.fromArray(_.center),o.boundingSphere=new K(T,_.radius)}return t.name&&(o.name=t.name),t.userData&&(o.userData=t.userData),o}});var aI=function(t){function n(n){return t.call(this,n)||this}f(n,t);var r=n.prototype;return r.load=function(t,n,r,i){var o=this,a=""===this.path?aR.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;var s=new oQ(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(r){var a=null;try{a=JSON.parse(r)}catch(n){void 0!==i&&i(n),console.error("THREE:ObjectLoader: Can't parse "+t+".",n.message);return}var s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase()){console.error("THREE.ObjectLoader: Can't load "+t);return}o.parse(a,n)},r,i)},r.parse=function(t,n){var r=this.parseAnimations(t.animations),i=this.parseShapes(t.shapes),o=this.parseGeometries(t.geometries,i),a=this.parseImages(t.images,function(){void 0!==n&&n(c)}),s=this.parseTextures(t.textures,a),l=this.parseMaterials(t.materials,s),c=this.parseObject(t.object,o,l,r),u=this.parseSkeletons(t.skeletons,c);if(this.bindSkeletons(c,u),void 0!==n){var h=!1;for(var d in a)if(a[d]instanceof HTMLImageElement){h=!0;break}!1===h&&n(c)}return c},r.parseShapes=function(t){var n={};if(void 0!==t)for(var r=0,i=t.length;r<i;r++){var o=new af().fromJSON(t[r]);n[o.uuid]=o}return n},r.parseSkeletons=function(t,n){var r={},i={};if(n.traverse(function(t){t.isBone&&(i[t.uuid]=t)}),void 0!==t)for(var o=0,a=t.length;o<a;o++){var s=new ic().fromJSON(t[o],i);r[s.uuid]=s}return r},r.parseGeometries=function(t,n){var r,i={};if(void 0!==t)for(var o=new aO,a=0,s=t.length;a<s;a++){var l=void 0,c=t[a];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":l=new oy[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":l=new oy[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":l=new oy[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":l=new oy[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":l=new oy[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":l=new oy[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":l=new oy[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":l=new oy[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":l=new oy[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":l=new oy[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"TubeGeometry":case"TubeBufferGeometry":l=new oy[c.type](new ah[c.path.type]().fromJSON(c.path),c.tubularSegments,c.radius,c.radialSegments,c.closed);break;case"LatheGeometry":case"LatheBufferGeometry":l=new oy[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":l=new oy[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":r=[];for(var u=0,h=c.shapes.length;u<h;u++){var d=n[c.shapes[u]];r.push(d)}l=new oy[c.type](r,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":r=[];for(var p=0,f=c.shapes.length;p<f;p++){var m=n[c.shapes[p]];r.push(m)}var v=c.options.extrudePath;void 0!==v&&(c.options.extrudePath=new ah[v.type]().fromJSON(v)),l=new oy[c.type](r,c.options);break;case"BufferGeometry":case"InstancedBufferGeometry":l=o.parse(c);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?l=new THREE.LegacyJSONLoader().parse(c,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}l.uuid=c.uuid,void 0!==c.name&&(l.name=c.name),!0===l.isBufferGeometry&&void 0!==c.userData&&(l.userData=c.userData),i[c.uuid]=l}return i},r.parseMaterials=function(t,n){var r={},i={};if(void 0!==t){var o=new aL;o.setTextures(n);for(var a=0,s=t.length;a<s;a++){var l=t[a];if("MultiMaterial"===l.type){for(var c=[],u=0;u<l.materials.length;u++){var h=l.materials[u];void 0===r[h.uuid]&&(r[h.uuid]=o.parse(h)),c.push(r[h.uuid])}i[l.uuid]=c}else void 0===r[l.uuid]&&(r[l.uuid]=o.parse(l)),i[l.uuid]=r[l.uuid]}}return i},r.parseAnimations=function(t){var n={};if(void 0!==t)for(var r=0;r<t.length;r++){var i=t[r],o=oj.parse(i);n[o.uuid]=o}return n},r.parseImages=function(t,n){var r,i=this,o={};function a(t){if("string"==typeof t){var n;return n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:i.resourcePath+t,i.manager.itemStart(n),r.load(n,function(){i.manager.itemEnd(n)},void 0,function(){i.manager.itemError(n),i.manager.itemEnd(n)})}return t.data?{data:tc(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){(r=new oJ(new oW(n))).setCrossOrigin(this.crossOrigin);for(var s=0,l=t.length;s<l;s++){var c=t[s],u=c.url;if(Array.isArray(u)){o[c.uuid]=[];for(var h=0,d=u.length;h<d;h++){var p=a(u[h]);null!==p&&(p instanceof HTMLImageElement?o[c.uuid].push(p):o[c.uuid].push(new tX(p.data,p.width,p.height)))}}else{var f=a(c.url);null!==f&&(o[c.uuid]=f)}}}return o},r.parseTextures=function(t,n){function r(t,n){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),n[t])}var i={};if(void 0!==t)for(var o=0,a=t.length;o<a;o++){var s=t[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===n[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var l=void 0,c=n[s.image];Array.isArray(c)?(l=new tW(c),6===c.length&&(l.needsUpdate=!0)):(l=c&&c.data?new tX(c.data,c.width,c.height):new T(c),c&&(l.needsUpdate=!0)),l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=r(s.mapping,aB)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=r(s.wrap[0],aF),l.wrapT=r(s.wrap[1],aF)),void 0!==s.format&&(l.format=s.format),void 0!==s.type&&(l.type=s.type),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=r(s.minFilter,ak)),void 0!==s.magFilter&&(l.magFilter=r(s.magFilter,ak)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),i[s.uuid]=l}return i},r.parseObject=function(t,n,r,i){function o(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var n=[],i=0,o=t.length;i<o;i++){var a=t[i];void 0===r[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),n.push(r[a])}return n}return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}}switch(t.type){case"Scene":s=new rG,void 0!==t.background&&Number.isInteger(t.background)&&(s.background=new e$(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?s.fog=new rH(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(s.fog=new rU(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":s=new tj(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(s.focus=t.focus),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.filmGauge&&(s.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(s.filmOffset=t.filmOffset),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"OrthographicCamera":s=new aw(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"AmbientLight":s=new a_(t.color,t.intensity);break;case"DirectionalLight":s=new aM(t.color,t.intensity);break;case"PointLight":s=new ax(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":s=new aT(t.color,t.intensity,t.width,t.height);break;case"SpotLight":s=new ab(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":s=new av(t.color,t.groundColor,t.intensity);break;case"LightProbe":s=new aC().fromJSON(t);break;case"SkinnedMesh":s=new io(l=o(t.geometry),c=a(t.material)),void 0!==t.bindMode&&(s.bindMode=t.bindMode),void 0!==t.bindMatrix&&s.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(s.skeleton=t.skeleton);break;case"Mesh":s=new tB(l=o(t.geometry),c=a(t.material));break;case"InstancedMesh":l=o(t.geometry),c=a(t.material);var s,l,c,u=t.count,h=t.instanceMatrix;(s=new im(l,c,u)).instanceMatrix=new e6(new Float32Array(h.array),16);break;case"LOD":s=new r8;break;case"Line":s=new iw(o(t.geometry),a(t.material));break;case"LineLoop":s=new iT(o(t.geometry),a(t.material));break;case"LineSegments":s=new i_(o(t.geometry),a(t.material));break;case"PointCloud":case"Points":s=new iD(o(t.geometry),a(t.material));break;case"Sprite":s=new r4(a(t.material));break;case"Group":s=new rL;break;case"Bone":s=new ia;break;default:s=new eP}if(s.uuid=t.uuid,void 0!==t.name&&(s.name=t.name),void 0!==t.matrix?(s.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(s.matrixAutoUpdate=t.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==t.position&&s.position.fromArray(t.position),void 0!==t.rotation&&s.rotation.fromArray(t.rotation),void 0!==t.quaternion&&s.quaternion.fromArray(t.quaternion),void 0!==t.scale&&s.scale.fromArray(t.scale)),void 0!==t.castShadow&&(s.castShadow=t.castShadow),void 0!==t.receiveShadow&&(s.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(s.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(s.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(s.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&s.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(s.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(s.visible=t.visible),void 0!==t.frustumCulled&&(s.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(s.renderOrder=t.renderOrder),void 0!==t.userData&&(s.userData=t.userData),void 0!==t.layers&&(s.layers.mask=t.layers),void 0!==t.children)for(var d=t.children,p=0;p<d.length;p++)s.add(this.parseObject(d[p],n,r,i));if(void 0!==t.animations)for(var f=t.animations,m=0;m<f.length;m++){var v=f[m];s.animations.push(i[v])}if("LOD"===t.type){void 0!==t.autoUpdate&&(s.autoUpdate=t.autoUpdate);for(var g=t.levels,y=0;y<g.length;y++){var b=g[y],A=s.getObjectByProperty("uuid",b.object);void 0!==A&&s.addLevel(A,b.distance)}}return s},r.bindSkeletons=function(t,n){0!==Object.keys(n).length&&t.traverse(function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){var r=n[t.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(r,t.bindMatrix)}})},r.setTexturePath=function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)},n}(oX),aB={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},aF={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},ak={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function aN(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),oX.call(this,t),this.options={premultiplyAlpha:"none"}}function aU(){this.type="ShapePath",this.color=new e$,this.subPaths=[],this.currentPath=null}aN.prototype=Object.assign(Object.create(oX.prototype),{constructor:aN,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,n,r,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var o=this,a=oV.get(t);if(void 0!==a)return o.manager.itemStart(t),setTimeout(function(){n&&n(a),o.manager.itemEnd(t)},0),a;var s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(t,s).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,o.options)}).then(function(r){oV.add(t,r),n&&n(r),o.manager.itemEnd(t)}).catch(function(n){i&&i(n),o.manager.itemError(t),o.manager.itemEnd(t)}),o.manager.itemStart(t)}}),Object.assign(aU.prototype,{moveTo:function(t,n){return this.currentPath=new ap,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,n),this},lineTo:function(t,n){return this.currentPath.lineTo(t,n),this},quadraticCurveTo:function(t,n,r,i){return this.currentPath.quadraticCurveTo(t,n,r,i),this},bezierCurveTo:function(t,n,r,i,o,a){return this.currentPath.bezierCurveTo(t,n,r,i,o,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,n){function r(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r],a=new af;a.curves=o.curves,n.push(a)}return n}var i,o,a,s,l,c=oe.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===n)return r(u);var h=[];if(1===u.length)return o=u[0],(a=new af).curves=o.curves,h.push(a),h;var d=!c(u[0].getPoints());d=t?!d:d;var p=[],f=[],m=[],v=0;f[0]=void 0,m[v]=[];for(var g=0,y=u.length;g<y;g++)i=c(s=(o=u[g]).getPoints()),(i=t?!i:i)?(!d&&f[v]&&v++,f[v]={s:new af,p:s},f[v].s.curves=o.curves,d&&v++,m[v]=[]):m[v].push({h:o,p:s[0]});if(!f[0])return r(u);if(f.length>1){for(var b=!1,A=[],x=0,w=f.length;x<w;x++)p[x]=[];for(var E=0,M=f.length;E<M;E++)for(var _=m[E],T=0;T<_.length;T++){for(var S=_[T],C=!0,L=0;L<f.length;L++)(function(t,n){for(var r=n.length,i=!1,o=r-1,a=0;a<r;o=a++){var s=n[o],l=n[a],c=l.x-s.x,u=l.y-s.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(s=n[a],c=-c,l=n[o],u=-u),t.y<s.y||t.y>l.y)continue;if(t.y===s.y){if(t.x===s.x)return!0}else{var h=u*(t.x-s.x)-c*(t.y-s.y);if(0===h)return!0;if(h<0)continue;i=!i}}else{if(t.y!==s.y)continue;if(l.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=l.x)return!0}}return i})(S.p,f[L].p)&&(E!==L&&A.push({froms:E,tos:L,hole:T}),C?(C=!1,p[L].push(S)):b=!0);C&&p[E].push(S)}A.length>0&&!b&&(m=p)}for(var R=0,P=f.length;R<P;R++){a=f[R].s,h.push(a),l=m[R];for(var D=0,O=l.length;D<O;D++)a.holes.push(l[D].h)}return h}});var aH=function(){function t(t){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=t}return t.prototype.generateShapes=function(t,n){void 0===n&&(n=100);for(var r=[],i=function(t,n,r){for(var i=Array.from?Array.from(t):String(t).split(""),o=n/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=[],l=0,c=0,u=0;u<i.length;u++){var h=i[u];if("\n"===h)l=0,c-=a;else{var d=function(t,n,r,i,o){var a,s,l,c,u,h,d,p,f=o.glyphs[t]||o.glyphs["?"];if(!f){console.error('THREE.Font: character "'+t+'" does not exists in font family '+o.familyName+".");return}var m=new aU;if(f.o)for(var v=f._cachedOutline||(f._cachedOutline=f.o.split(" ")),g=0,y=v.length;g<y;)switch(v[g++]){case"m":a=v[g++]*n+r,s=v[g++]*n+i,m.moveTo(a,s);break;case"l":a=v[g++]*n+r,s=v[g++]*n+i,m.lineTo(a,s);break;case"q":l=v[g++]*n+r,c=v[g++]*n+i,u=v[g++]*n+r,h=v[g++]*n+i,m.quadraticCurveTo(u,h,l,c);break;case"b":l=v[g++]*n+r,c=v[g++]*n+i,u=v[g++]*n+r,h=v[g++]*n+i,d=v[g++]*n+r,p=v[g++]*n+i,m.bezierCurveTo(u,h,d,p,l,c)}return{offsetX:f.ha*n,path:m}}(h,o,l,c,r);l+=d.offsetX,s.push(d.path)}}return s}(t,n,this.data),o=0,a=i.length;o<a;o++)Array.prototype.push.apply(r,i[o].toShapes());return r},t}();function aG(t){oX.call(this,t)}aG.prototype=Object.assign(Object.create(oX.prototype),{constructor:aG,load:function(t,n,r,i){var o=this,a=new oQ(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,function(t){try{r=JSON.parse(t)}catch(n){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(t.substring(65,t.length-2))}var r,i=o.parse(r);n&&n(i)},r,i)},parse:function(t){return new aH(t)}});var az={getContext:function(){return void 0===o&&(o=new(window.AudioContext||window.webkitAudioContext)),o},setContext:function(t){o=t}};function aj(t){oX.call(this,t)}function aV(t,n,r){aC.call(this,void 0,r);var i=new e$().set(t),o=new e$().set(n),a=new D(i.r,i.g,i.b),s=new D(o.r,o.g,o.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(s).multiplyScalar(l),this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(c)}function aW(t,n){aC.call(this,void 0,n);var r=new e$().set(t);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}aj.prototype=Object.assign(Object.create(oX.prototype),{constructor:aj,load:function(t,n,r,i){var o=this,a=new oQ(o.manager);a.setResponseType("arraybuffer"),a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(t,function(r){try{var a=r.slice(0);az.getContext().decodeAudioData(a,function(t){n(t)})}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)}}),aV.prototype=Object.assign(Object.create(aC.prototype),{constructor:aV,isHemisphereLightProbe:!0,copy:function(t){return aC.prototype.copy.call(this,t),this},toJSON:function(t){return aC.prototype.toJSON.call(this,t)}}),aW.prototype=Object.assign(Object.create(aC.prototype),{constructor:aW,isAmbientLightProbe:!0,copy:function(t){return aC.prototype.copy.call(this,t),this},toJSON:function(t){return aC.prototype.toJSON.call(this,t)}});var aq=new ea,aX=new ea;function aY(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new tj,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new tj,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(aY.prototype,{update:function(t){var n=this._cache;if(n.focus!==t.focus||n.fov!==t.fov||n.aspect!==t.aspect*this.aspect||n.near!==t.near||n.far!==t.far||n.zoom!==t.zoom||n.eyeSep!==this.eyeSep){n.focus=t.focus,n.fov=t.fov,n.aspect=t.aspect*this.aspect,n.near=t.near,n.far=t.far,n.zoom=t.zoom,n.eyeSep=this.eyeSep;var r,i,o=t.projectionMatrix.clone(),a=n.eyeSep/2,s=a*n.near/n.focus,l=n.near*Math.tan(x.DEG2RAD*n.fov*.5)/n.zoom;aX.elements[12]=-a,aq.elements[12]=a,r=-l*n.aspect+s,i=l*n.aspect+s,o.elements[0]=2*n.near/(i-r),o.elements[8]=(i+r)/(i-r),this.cameraL.projectionMatrix.copy(o),r=-l*n.aspect-s,i=l*n.aspect-s,o.elements[0]=2*n.near/(i-r),o.elements[8]=(i+r)/(i-r),this.cameraR.projectionMatrix.copy(o)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(aX),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(aq)}});var aQ=function(){function t(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var n=t.prototype;return n.start=function(){this.startTime=aZ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},n.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},n.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},n.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=aZ();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t},t}();function aZ(){return("undefined"==typeof performance?Date:performance).now()}var aK=new D,aJ=new P,a$=new D,a0=new D,a1=function(t){function n(){var n;return(n=t.call(this)||this).type="AudioListener",n.context=az.getContext(),n.gain=n.context.createGain(),n.gain.connect(n.context.destination),n.filter=null,n.timeDelta=0,n._clock=new aQ,n}f(n,t);var r=n.prototype;return r.getInput=function(){return this.gain},r.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},r.getFilter=function(){return this.filter},r.setFilter=function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},r.getMasterVolume=function(){return this.gain.gain.value},r.setMasterVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},r.updateMatrixWorld=function(n){t.prototype.updateMatrixWorld.call(this,n);var r=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(aK,aJ,a$),a0.set(0,0,-1).applyQuaternion(aJ),r.positionX){var o=this.context.currentTime+this.timeDelta;r.positionX.linearRampToValueAtTime(aK.x,o),r.positionY.linearRampToValueAtTime(aK.y,o),r.positionZ.linearRampToValueAtTime(aK.z,o),r.forwardX.linearRampToValueAtTime(a0.x,o),r.forwardY.linearRampToValueAtTime(a0.y,o),r.forwardZ.linearRampToValueAtTime(a0.z,o),r.upX.linearRampToValueAtTime(i.x,o),r.upY.linearRampToValueAtTime(i.y,o),r.upZ.linearRampToValueAtTime(i.z,o)}else r.setPosition(aK.x,aK.y,aK.z),r.setOrientation(a0.x,a0.y,a0.z,i.x,i.y,i.z)},n}(eP),a2=function(t){function n(n){var r;return(r=t.call(this)||this).type="Audio",r.listener=n,r.context=n.context,r.gain=r.context.createGain(),r.gain.connect(n.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}f(n,t);var r=n.prototype;return r.getOutput=function(){return this.gain},r.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},r.setMediaElementSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},r.setMediaStreamSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},r.setBuffer=function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},r.play=function(t){if(void 0===t&&(t=0),!0===this.isPlaying){console.warn("THREE.Audio: Audio is already playing.");return}if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;var n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},r.pause=function(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},r.stop=function(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},r.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,n=this.filters.length;t<n;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},r.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,n=this.filters.length;t<n;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},r.getFilters=function(){return this.filters},r.setFilters=function(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this},r.setDetune=function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},r.getDetune=function(){return this.detune},r.getFilter=function(){return this.getFilters()[0]},r.setFilter=function(t){return this.setFilters(t?[t]:[])},r.setPlaybackRate=function(t){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},r.getPlaybackRate=function(){return this.playbackRate},r.onEnded=function(){this.isPlaying=!1},r.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},r.setLoop=function(t){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this},r.setLoopStart=function(t){return this.loopStart=t,this},r.setLoopEnd=function(t){return this.loopEnd=t,this},r.getVolume=function(){return this.gain.gain.value},r.setVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},n}(eP),a3=new D,a4=new P,a5=new D,a6=new D,a7=function(t){function n(n){var r;return(r=t.call(this,n)||this).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}f(n,t);var r=n.prototype;return r.getOutput=function(){return this.panner},r.getRefDistance=function(){return this.panner.refDistance},r.setRefDistance=function(t){return this.panner.refDistance=t,this},r.getRolloffFactor=function(){return this.panner.rolloffFactor},r.setRolloffFactor=function(t){return this.panner.rolloffFactor=t,this},r.getDistanceModel=function(){return this.panner.distanceModel},r.setDistanceModel=function(t){return this.panner.distanceModel=t,this},r.getMaxDistance=function(){return this.panner.maxDistance},r.setMaxDistance=function(t){return this.panner.maxDistance=t,this},r.setDirectionalCone=function(t,n,r){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=r,this},r.updateMatrixWorld=function(n){if(t.prototype.updateMatrixWorld.call(this,n),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(a3,a4,a5),a6.set(0,0,1).applyQuaternion(a4);var r=this.panner;if(r.positionX){var i=this.context.currentTime+this.listener.timeDelta;r.positionX.linearRampToValueAtTime(a3.x,i),r.positionY.linearRampToValueAtTime(a3.y,i),r.positionZ.linearRampToValueAtTime(a3.z,i),r.orientationX.linearRampToValueAtTime(a6.x,i),r.orientationY.linearRampToValueAtTime(a6.y,i),r.orientationZ.linearRampToValueAtTime(a6.z,i)}else r.setPosition(a3.x,a3.y,a3.z),r.setOrientation(a6.x,a6.y,a6.z)}},n}(a2),a8=function(){function t(t,n){void 0===n&&(n=2048),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var n=t.prototype;return n.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},n.getAverageFrequency=function(){for(var t=0,n=this.getFrequencyData(),r=0;r<n.length;r++)t+=n[r];return t/n.length},t}();function a9(t,n,r){var i,o,a;switch(this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:i=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(a9.prototype,{accumulate:function(t,n){var r=this.buffer,i=this.valueSize,o=t*i+i,a=this.cumulativeWeight;if(0===a){for(var s=0;s!==i;++s)r[o+s]=r[s];a=n}else{a+=n;var l=n/a;this._mixBufferRegion(r,o,0,l,i)}this.cumulativeWeight=a},accumulateAdditive:function(t){var n=this.buffer,r=this.valueSize,i=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(n,i,0,t,r),this.cumulativeWeightAdditive+=t},apply:function(t){var n=this.valueSize,r=this.buffer,i=t*n+n,o=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var l=n*this._origIndex;this._mixBufferRegion(r,i,l,1-o,n)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*n,1,n);for(var c=n,u=n+n;c!==u;++c)if(r[c]!==r[c+n]){s.setValue(r,i);break}},saveOriginalState:function(){var t=this.binding,n=this.buffer,r=this.valueSize,i=r*this._origIndex;t.getValue(n,i);for(var o=r;o!==i;++o)n[o]=n[i+o%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,n=t+this.valueSize,r=t;r<n;r++)this.buffer[r]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize,r=0;r<this.valueSize;r++)this.buffer[n+r]=this.buffer[t+r]},_select:function(t,n,r,i,o){if(i>=.5)for(var a=0;a!==o;++a)t[n+a]=t[r+a]},_slerp:function(t,n,r,i){P.slerpFlat(t,n,t,n,t,r,i)},_slerpAdditive:function(t,n,r,i,o){var a=this._workIndex*o;P.multiplyQuaternionsFlat(t,a,t,n,t,r),P.slerpFlat(t,n,t,n,t,a,i)},_lerp:function(t,n,r,i,o){for(var a=1-i,s=0;s!==o;++s){var l=n+s;t[l]=t[l]*a+t[r+s]*i}},_lerpAdditive:function(t,n,r,i,o){for(var a=0;a!==o;++a){var s=n+a;t[s]=t[s]+t[r+a]*i}}});var se="\\[\\]\\.:\\/",st=RegExp("["+se+"]","g"),sn="[^"+se+"]",sr="[^"+se.replace("\\.","")+"]",si=RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",sn)+/(WCOD+)?/.source.replace("WCOD",sr)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sn)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sn)+"$"),so=["material","materials","bones"];function sa(t,n,r){var i=r||ss.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}function ss(t,n,r){this.path=n,this.parsedPath=r||ss.parseTrackName(n),this.node=ss.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function sl(){this.uuid=x.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(sa.prototype,{getValue:function(t,n){this.bind();var r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(t,n)},setValue:function(t,n){for(var r=this._bindings,i=this._targetGroup.nCachedObjects_,o=r.length;i!==o;++i)r[i].setValue(t,n)},bind:function(){for(var t=this._bindings,n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)t[n].bind()},unbind:function(){for(var t=this._bindings,n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)t[n].unbind()}}),Object.assign(ss,{Composite:sa,create:function(t,n,r){return t&&t.isAnimationObjectGroup?new ss.Composite(t,n,r):new ss(t,n,r)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(st,"")},parseTrackName:function(t){var n=si.exec(t);if(!n)throw Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var o=r.nodeName.substring(i+1);-1!==so.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,n){if(!n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){var r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){var i=function t(r){for(var i=0;i<r.length;i++){var o=r[i];if(o.name===n||o.uuid===n)return o;var a=t(o.children);if(a)return a}return null}(t.children);if(i)return i}return null}}),Object.assign(ss.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,n){t[n]=this.node[this.propertyName]},function(t,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)t[n++]=r[i]},function(t,n){t[n]=this.resolvedProperty[this.propertyIndex]},function(t,n){this.resolvedProperty.toArray(t,n)}],SetterByBindingTypeAndVersioning:[[function(t,n){this.targetObject[this.propertyName]=t[n]},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=t[n++]},function(t,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=t[n++];this.targetObject.needsUpdate=!0},function(t,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty[this.propertyIndex]=t[n]},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty.fromArray(t,n)},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,n){this.bind(),this.getValue(t,n)},setValue:function(t,n){this.bind(),this.setValue(t,n)},bind:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,o=n.propertyIndex;if(t||(t=ss.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){var a=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===a){a=s;break}break;default:if(void 0===t[r]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(void 0!==a){if(void 0===t[a]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[a]}}var l=t[i];if(void 0===l){console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+i+" but it wasn't found.",t);return}var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===i){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}u=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else void 0!==l.fromArray&&void 0!==l.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(u=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(ss.prototype,{_getValue_unbound:ss.prototype.getValue,_setValue_unbound:ss.prototype.setValue}),Object.assign(sl.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,n=this._indicesByUUID,r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length,s=void 0,l=t.length,c=this.nCachedObjects_,u=0,h=arguments.length;u!==h;++u){var d=arguments[u],p=d.uuid,f=n[p];if(void 0===f){f=l++,n[p]=f,t.push(d);for(var m=0;m!==a;++m)o[m].push(new ss(d,r[m],i[m]))}else if(f<c){s=t[f];var v=--c,g=t[v];n[g.uuid]=f,t[f]=g,n[p]=v,t[v]=d;for(var y=0;y!==a;++y){var b=o[y],A=b[v],x=b[f];b[f]=A,void 0===x&&(x=new ss(d,r[y],i[y])),b[v]=x}}else t[f]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},remove:function(){for(var t=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length,o=this.nCachedObjects_,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],c=l.uuid,u=n[c];if(void 0!==u&&u>=o){var h=o++,d=t[h];n[d.uuid]=u,t[u]=d,n[c]=h,t[h]=l;for(var p=0;p!==i;++p){var f=r[p],m=f[h],v=f[u];f[u]=m,f[h]=v}}}this.nCachedObjects_=o},uncache:function(){for(var t=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length,o=this.nCachedObjects_,a=t.length,s=0,l=arguments.length;s!==l;++s){var c=arguments[s],u=c.uuid,h=n[u];if(void 0!==h){if(delete n[u],h<o){var d=--o,p=t[d],f=--a,m=t[f];n[p.uuid]=h,t[h]=p,n[m.uuid]=d,t[d]=m,t.pop();for(var v=0;v!==i;++v){var g=r[v],y=g[d],b=g[f];g[h]=y,g[d]=b,g.pop()}}else{var A=--a,x=t[A];A>0&&(n[x.uuid]=h),t[h]=x,t.pop();for(var w=0;w!==i;++w){var E=r[w];E[h]=E[A],E.pop()}}}}this.nCachedObjects_=o},subscribe_:function(t,n){var r=this._bindingsIndicesByPath,i=r[t],o=this._bindings;if(void 0!==i)return o[i];var a=this._paths,s=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=Array(c);i=o.length,r[t]=i,a.push(t),s.push(n),o.push(h);for(var d=u,p=l.length;d!==p;++d){var f=l[d];h[d]=new ss(f,t,n)}return h},unsubscribe_:function(t){var n=this._bindingsIndicesByPath,r=n[t];if(void 0!==r){var i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length-1,l=a[s];n[t[s]]=r,a[r]=l,a.pop(),o[r]=o[s],o.pop(),i[r]=i[s],i.pop()}}});var sc=function(){function t(t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=n.blendMode),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var o=n.tracks,a=o.length,s=Array(a),l={endingStart:2400,endingEnd:2400},c=0;c!==a;++c){var u=o[c].createInterpolant(null);s[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var n=t.prototype;return n.play=function(){return this._mixer._activateAction(this),this},n.stop=function(){return this._mixer._deactivateAction(this),this.reset()},n.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},n.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},n.isScheduled=function(){return this._mixer._isActiveAction(this)},n.startAt=function(t){return this._startTime=t,this},n.setLoop=function(t,n){return this.loop=t,this.repetitions=n,this},n.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},n.getEffectiveWeight=function(){return this._effectiveWeight},n.fadeIn=function(t){return this._scheduleFading(t,0,1)},n.fadeOut=function(t){return this._scheduleFading(t,1,0)},n.crossFadeFrom=function(t,n,r){if(t.fadeOut(n),this.fadeIn(n),r){var i=this._clip.duration,o=t._clip.duration;t.warp(1,o/i,n),this.warp(i/o,1,n)}return this},n.crossFadeTo=function(t,n,r){return t.crossFadeFrom(this,n,r)},n.stopFading=function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},n.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},n.getEffectiveTimeScale=function(){return this._effectiveTimeScale},n.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},n.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},n.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},n.warp=function(t,n,r){var i=this._mixer,o=i.time,a=this.timeScale,s=this._timeScaleInterpolant;null===s&&(s=i._lendControlInterpolant(),this._timeScaleInterpolant=s);var l=s.parameterPositions,c=s.sampleValues;return l[0]=o,l[1]=o+r,c[0]=t/a,c[1]=n/a,this},n.stopWarping=function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},n.getMixer=function(){return this._mixer},n.getClip=function(){return this._clip},n.getRoot=function(){return this._localRoot||this._mixer._root},n._update=function(t,n,r,i){if(!this.enabled){this._updateWeight(t);return}var o=this._startTime;if(null!==o){var a=(t-o)*r;if(a<0||0===r)return;this._startTime=null,n=r*a}n*=this._updateTimeScale(t);var s=this._updateTime(n),l=this._updateWeight(t);if(l>0){var c=this._interpolants,u=this._propertyBindings;if(2501===this.blendMode)for(var h=0,d=c.length;h!==d;++h)c[h].evaluate(s),u[h].accumulateAdditive(l);else for(var p=0,f=c.length;p!==f;++p)c[p].evaluate(s),u[p].accumulate(i,l)}},n._updateWeight=function(t){var n=0;if(this.enabled){n=this.weight;var r=this._weightInterpolant;if(null!==r){var i=r.evaluate(t)[0];n*=i,t>r.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=n,n},n._updateTimeScale=function(t){var n=0;if(!this.paused){n=this.timeScale;var r=this._timeScaleInterpolant;null!==r&&(n*=r.evaluate(t)[0],t>r.parameterPositions[1]&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n},n._updateTime=function(t){var n=this._clip.duration,r=this.loop,i=this.time+t,o=this._loopCount,a=2202===r;if(0===t)return -1===o?i:a&&(1&o)==1?n-i:i;if(2200===r){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));i:{if(i>=n)i=n;else if(i<0)i=0;else{this.time=i;break i}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===o&&(t>=0?(o=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),i>=n||i<0){var s=Math.floor(i/n);i-=n*s,o+=Math.abs(s);var l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?n:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===l){var c=t<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=i;if(a&&(1&o)==1)return n-i}return i},n._setEndings=function(t,n,r){var i=this._interpolantSettings;r?(i.endingStart=2401,i.endingEnd=2401):(t?i.endingStart=this.zeroSlopeAtStart?2401:2400:i.endingStart=2402,n?i.endingEnd=this.zeroSlopeAtEnd?2401:2400:i.endingEnd=2402)},n._scheduleFading=function(t,n,r){var i=this._mixer,o=i.time,a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=o,l[0]=n,s[1]=o+t,l[1]=r,this},t}();function su(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}su.prototype=Object.assign(Object.create(g.prototype),{constructor:su,_bindAction:function(t,n){var r=t._localRoot||this._root,i=t._clip.tracks,o=i.length,a=t._propertyBindings,s=t._interpolants,l=r.uuid,c=this._bindingsByRootAndName,u=c[l];void 0===u&&(u={},c[l]=u);for(var h=0;h!==o;++h){var d=i[h],p=d.name,f=u[p];if(void 0!==f)a[h]=f;else{if(void 0!==(f=a[h])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,l,p));continue}var m=n&&n._propertyBindings[h].binding.parsedPath;f=new a9(ss.create(r,p,m),d.ValueTypeName,d.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,l,p),a[h]=f}s[h].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var n=(t._localRoot||this._root).uuid,r=t._clip.uuid,i=this._actionsByClip[r];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,r,n)}for(var o=t._propertyBindings,a=0,s=o.length;a!==s;++a){var l=o[a];0==l.useCount++&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var n=t._propertyBindings,r=0,i=n.length;r!==i;++r){var o=n[r];0==--o.useCount&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var n=t._cacheIndex;return null!==n&&n<this._nActiveActions},_addInactiveAction:function(t,n,r){var i=this._actions,o=this._actionsByClip,a=o[n];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,o[n]=a;else{var s=a.knownActions;t._byClipCacheIndex=s.length,s.push(t)}t._cacheIndex=i.length,i.push(t),a.actionByRoot[r]=t},_removeInactiveAction:function(t){var n=this._actions,r=n[n.length-1],i=t._cacheIndex;r._cacheIndex=i,n[i]=r,n.pop(),t._cacheIndex=null;var o=t._clip.uuid,a=this._actionsByClip,s=a[o],l=s.knownActions,c=l[l.length-1],u=t._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),t._byClipCacheIndex=null;var h=s.actionByRoot,d=(t._localRoot||this._root).uuid;delete h[d],0===l.length&&delete a[o],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var n=t._propertyBindings,r=0,i=n.length;r!==i;++r){var o=n[r];0==--o.referenceCount&&this._removeInactiveBinding(o)}},_lendAction:function(t){var n=this._actions,r=t._cacheIndex,i=this._nActiveActions++,o=n[i];t._cacheIndex=i,n[i]=t,o._cacheIndex=r,n[r]=o},_takeBackAction:function(t){var n=this._actions,r=t._cacheIndex,i=--this._nActiveActions,o=n[i];t._cacheIndex=i,n[i]=t,o._cacheIndex=r,n[r]=o},_addInactiveBinding:function(t,n,r){var i=this._bindingsByRootAndName,o=this._bindings,a=i[n];void 0===a&&(a={},i[n]=a),a[r]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var n=this._bindings,r=t.binding,i=r.rootNode.uuid,o=r.path,a=this._bindingsByRootAndName,s=a[i],l=n[n.length-1],c=t._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete s[o],0===Object.keys(s).length&&delete a[i]},_lendBinding:function(t){var n=this._bindings,r=t._cacheIndex,i=this._nActiveBindings++,o=n[i];t._cacheIndex=i,n[i]=t,o._cacheIndex=r,n[r]=o},_takeBackBinding:function(t){var n=this._bindings,r=t._cacheIndex,i=--this._nActiveBindings,o=n[i];t._cacheIndex=i,n[i]=t,o._cacheIndex=r,n[r]=o},_lendControlInterpolant:function(){var t=this._controlInterpolants,n=this._nActiveControlInterpolants++,r=t[n];return void 0===r&&((r=new oO(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=n,t[n]=r),r},_takeBackControlInterpolant:function(t){var n=this._controlInterpolants,r=t.__cacheIndex,i=--this._nActiveControlInterpolants,o=n[i];t.__cacheIndex=i,n[i]=t,o.__cacheIndex=r,n[r]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,n,r){var i=n||this._root,o=i.uuid,a="string"==typeof t?oj.findByName(i,t):t,s=null!==a?a.uuid:t,l=this._actionsByClip[s],c=null;if(void 0===r&&(r=null!==a?a.blendMode:2500),void 0!==l){var u=l.actionByRoot[o];if(void 0!==u&&u.blendMode===r)return u;c=l.knownActions[0],null===a&&(a=c._clip)}if(null===a)return null;var h=new sc(this,a,n,r);return this._bindAction(h,c),this._addInactiveAction(h,s,o),h},existingAction:function(t,n){var r=n||this._root,i=r.uuid,o="string"==typeof t?oj.findByName(r,t):t,a=o?o.uuid:t,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[i]||null},stopAllAction:function(){for(var t=this._actions,n=this._nActiveActions,r=n-1;r>=0;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var n=this._actions,r=this._nActiveActions,i=this.time+=t,o=Math.sign(t),a=this._accuIndex^=1,s=0;s!==r;++s)n[s]._update(i,t,o,a);for(var l=this._bindings,c=this._nActiveBindings,u=0;u!==c;++u)l[u].apply(a);return this},setTime:function(t){this.time=0;for(var n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var n=this._actions,r=t.uuid,i=this._actionsByClip,o=i[r];if(void 0!==o){for(var a=o.knownActions,s=0,l=a.length;s!==l;++s){var c=a[s];this._deactivateAction(c);var u=c._cacheIndex,h=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,n[u]=h,n.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}},uncacheRoot:function(t){var n=t.uuid,r=this._actionsByClip;for(var i in r){var o=r[i].actionByRoot[n];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName[n];if(void 0!==a)for(var s in a){var l=a[s];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,n){var r=this.existingAction(t,n);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}});var sh=function(){function t(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return t.prototype.clone=function(){return new t(void 0===this.value.clone?this.value:this.value.clone())},t}();function sd(t,n,r){rz.call(this,t,n),this.meshPerAttribute=r||1}function sp(t,n,r,i,o){this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=o,this.version=0}function sf(t,n,r,i){this.ray=new eo(t,n),this.near=r||0,this.far=i||1/0,this.camera=null,this.layers=new eg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function sm(t,n){return t.distance-n.distance}function sv(t,n,r,i){if(t.layers.test(n.layers)&&t.raycast(n,r),!0===i)for(var o=t.children,a=0,s=o.length;a<s;a++)sv(o[a],n,r,!0)}sd.prototype=Object.assign(Object.create(rz.prototype),{constructor:sd,isInstancedInterleavedBuffer:!0,copy:function(t){return rz.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){var n=rz.prototype.clone.call(this,t);return n.meshPerAttribute=this.meshPerAttribute,n},toJSON:function(t){var n=rz.prototype.toJSON.call(this,t);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}),Object.defineProperty(sp.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(sp.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,n){return this.type=t,this.elementSize=n,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(sf.prototype,{set:function(t,n){this.ray.set(t,n)},setFromCamera:function(t,n){n&&n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n&&n.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)},intersectObject:function(t,n,r){var i=r||[];return sv(t,this,i,n),i.sort(sm),i},intersectObjects:function(t,n,r){var i=r||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var o=0,a=t.length;o<a;o++)sv(t[o],this,i,n);return i.sort(sm),i}});var sg=function(){function t(t,n,r){return void 0===t&&(t=1),void 0===n&&(n=0),void 0===r&&(r=0),this.radius=t,this.phi=n,this.theta=r,this}var n=t.prototype;return n.set=function(t,n,r){return this.radius=t,this.phi=n,this.theta=r,this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},n.makeSafe=function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},n.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},n.setFromCartesianCoords=function(t,n,r){return this.radius=Math.sqrt(t*t+n*n+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,r),this.phi=Math.acos(x.clamp(n/this.radius,-1,1))),this},t}(),sy=function(){function t(t,n,r){return this.radius=void 0!==t?t:1,this.theta=void 0!==n?n:0,this.y=void 0!==r?r:0,this}var n=t.prototype;return n.set=function(t,n,r){return this.radius=t,this.theta=n,this.y=r,this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},n.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},n.setFromCartesianCoords=function(t,n,r){return this.radius=Math.sqrt(t*t+r*r),this.theta=Math.atan2(t,r),this.y=n,this},t}(),sb=new w,sA=function(){function t(t,n){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==t?t:new w(Infinity,Infinity),this.max=void 0!==n?n:new w(-1/0,-1/0)}var n=t.prototype;return n.set=function(t,n){return this.min.copy(t),this.max.copy(n),this},n.setFromPoints=function(t){this.makeEmpty();for(var n=0,r=t.length;n<r;n++)this.expandByPoint(t[n]);return this},n.setFromCenterAndSize=function(t,n){var r=sb.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},n.makeEmpty=function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-1/0,this},n.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},n.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new w),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},n.getSize=function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new w),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},n.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},n.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},n.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},n.containsPoint=function(t){return!(t.x<this.min.x)&&!(t.x>this.max.x)&&!(t.y<this.min.y)&&!(t.y>this.max.y)},n.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},n.getParameter=function(t,n){return void 0===n&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new w),n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},n.intersectsBox=function(t){return!(t.max.x<this.min.x)&&!(t.min.x>this.max.x)&&!(t.max.y<this.min.y)&&!(t.min.y>this.max.y)},n.clampPoint=function(t,n){return void 0===n&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new w),n.copy(t).clamp(this.min,this.max)},n.distanceToPoint=function(t){return sb.copy(t).clamp(this.min,this.max).sub(t).length()},n.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},n.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},n.translate=function(t){return this.min.add(t),this.max.add(t),this},n.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t}(),sx=new D,sw=new D,sE=function(){function t(t,n){this.start=void 0!==t?t:new D,this.end=void 0!==n?n:new D}var n=t.prototype;return n.set=function(t,n){return this.start.copy(t),this.end.copy(n),this},n.clone=function(){return new this.constructor().copy(this)},n.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},n.getCenter=function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new D),t.addVectors(this.start,this.end).multiplyScalar(.5)},n.delta=function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new D),t.subVectors(this.end,this.start)},n.distanceSq=function(){return this.start.distanceToSquared(this.end)},n.distance=function(){return this.start.distanceTo(this.end)},n.at=function(t,n){return void 0===n&&(console.warn("THREE.Line3: .at() target is now required"),n=new D),this.delta(n).multiplyScalar(t).add(this.start)},n.closestPointToPointParameter=function(t,n){sx.subVectors(t,this.start),sw.subVectors(this.end,this.start);var r=sw.dot(sw),i=sw.dot(sx)/r;return n&&(i=x.clamp(i,0,1)),i},n.closestPointToPoint=function(t,n,r){var i=this.closestPointToPointParameter(t,n);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new D),this.delta(r).multiplyScalar(i).add(this.start)},n.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},n.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},t}();function sM(t){eP.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}sM.prototype=Object.create(eP.prototype),sM.prototype.constructor=sM,sM.prototype.isImmediateRenderObject=!0;var s_=new D,sT=function(t){function n(n,r){(i=t.call(this)||this).light=n,i.light.updateMatrixWorld(),i.matrix=n.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;for(var i,o=new tg,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,l=1;s<32;s++,l++){var c=s/32*Math.PI*2,u=l/32*Math.PI*2;a.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}o.setAttribute("position",new to(a,3));var h=new iv({fog:!1,toneMapped:!1});return i.cone=new i_(o,h),i.add(i.cone),i.update(),i}f(n,t);var r=n.prototype;return r.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},r.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),s_.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(s_),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},n}(eP),sS=new D,sC=new ea,sL=new ea,sR=function(t){function n(n){for(var r,i=function t(n){var r=[];n&&n.isBone&&r.push(n);for(var i=0;i<n.children.length;i++)r.push.apply(r,t(n.children[i]));return r}(n),o=new tg,a=[],s=[],l=new e$(0,0,1),c=new e$(0,1,0),u=0;u<i.length;u++){var h=i[u];h.parent&&h.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),s.push(l.r,l.g,l.b),s.push(c.r,c.g,c.b))}o.setAttribute("position",new to(a,3)),o.setAttribute("color",new to(s,3));var d=new iv({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,o,d)||this).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=n,r.bones=i,r.matrix=n.matrixWorld,r.matrixAutoUpdate=!1,r}return f(n,t),n.prototype.updateMatrixWorld=function(n){var r=this.bones,i=this.geometry,o=i.getAttribute("position");sL.copy(this.root.matrixWorld).invert();for(var a=0,s=0;a<r.length;a++){var l=r[a];l.parent&&l.parent.isBone&&(sC.multiplyMatrices(sL,l.matrixWorld),sS.setFromMatrixPosition(sC),o.setXYZ(s,sS.x,sS.y,sS.z),sC.multiplyMatrices(sL,l.parent.matrixWorld),sS.setFromMatrixPosition(sC),o.setXYZ(s+1,sS.x,sS.y,sS.z),s+=2)}i.getAttribute("position").needsUpdate=!0,t.prototype.updateMatrixWorld.call(this,n)},n}(i_),sP=function(t){function n(n,r,i){var o,a=new oh(r,4,2),s=new e3({wireframe:!0,fog:!1,toneMapped:!1});return(o=t.call(this,a,s)||this).light=n,o.light.updateMatrixWorld(),o.color=i,o.type="PointLightHelper",o.matrix=o.light.matrixWorld,o.matrixAutoUpdate=!1,o.update(),o}f(n,t);var r=n.prototype;return r.dispose=function(){this.geometry.dispose(),this.material.dispose()},r.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},n}(tB),sD=new D,sO=new e$,sI=new e$,sB=function(t){function n(n,r,i){(o=t.call(this)||this).light=n,o.light.updateMatrixWorld(),o.matrix=n.matrixWorld,o.matrixAutoUpdate=!1,o.color=i;var o,a=new os(r);a.rotateY(.5*Math.PI),o.material=new e3({wireframe:!0,fog:!1,toneMapped:!1}),void 0===o.color&&(o.material.vertexColors=!0);var s=new Float32Array(3*a.getAttribute("position").count);return a.setAttribute("color",new e6(s,3)),o.add(new tB(a,o.material)),o.update(),o}f(n,t);var r=n.prototype;return r.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},r.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var n=t.geometry.getAttribute("color");sO.copy(this.light.color),sI.copy(this.light.groundColor);for(var r=0,i=n.count;r<i;r++){var o=r<i/2?sO:sI;n.setXYZ(r,o.r,o.g,o.b)}n.needsUpdate=!0}t.lookAt(sD.setFromMatrixPosition(this.light.matrixWorld).negate())},n}(eP),sF=function(t){function n(n,r,i,o){void 0===n&&(n=10),void 0===r&&(r=10),void 0===i&&(i=4473924),void 0===o&&(o=8947848),i=new e$(i),o=new e$(o);for(var a,s=r/2,l=n/r,c=n/2,u=[],h=[],d=0,p=0,f=-c;d<=r;d++,f+=l){u.push(-c,0,f,c,0,f),u.push(f,0,-c,f,0,c);var m=d===s?i:o;m.toArray(h,p),p+=3,m.toArray(h,p),p+=3,m.toArray(h,p),p+=3,m.toArray(h,p),p+=3}var v=new tg;v.setAttribute("position",new to(u,3)),v.setAttribute("color",new to(h,3));var g=new iv({vertexColors:!0,toneMapped:!1});return(a=t.call(this,v,g)||this).type="GridHelper",a}return f(n,t),n}(i_),sk=function(t){function n(n,r,i,o,a,s){void 0===n&&(n=10),void 0===r&&(r=16),void 0===i&&(i=8),void 0===o&&(o=64),void 0===a&&(a=4473924),void 0===s&&(s=8947848),a=new e$(a),s=new e$(s);for(var l,c=[],u=[],h=0;h<=r;h++){var d=h/r*(2*Math.PI),p=Math.sin(d)*n,f=Math.cos(d)*n;c.push(0,0,0),c.push(p,0,f);var m=1&h?a:s;u.push(m.r,m.g,m.b),u.push(m.r,m.g,m.b)}for(var v=0;v<=i;v++)for(var g=1&v?a:s,y=n-n/i*v,b=0;b<o;b++){var A=b/o*(2*Math.PI),x=Math.sin(A)*y,w=Math.cos(A)*y;c.push(x,0,w),u.push(g.r,g.g,g.b),x=Math.sin(A=(b+1)/o*(2*Math.PI))*y,w=Math.cos(A)*y,c.push(x,0,w),u.push(g.r,g.g,g.b)}var E=new tg;E.setAttribute("position",new to(c,3)),E.setAttribute("color",new to(u,3));var M=new iv({vertexColors:!0,toneMapped:!1});return(l=t.call(this,E,M)||this).type="PolarGridHelper",l}return f(n,t),n}(i_),sN=new D,sU=new D,sH=new D,sG=function(t){function n(n,r,i){(o=t.call(this)||this).light=n,o.light.updateMatrixWorld(),o.matrix=n.matrixWorld,o.matrixAutoUpdate=!1,o.color=i,void 0===r&&(r=1);var o,a=new tg;a.setAttribute("position",new to([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new iv({fog:!1,toneMapped:!1});return o.lightPlane=new iw(a,s),o.add(o.lightPlane),(a=new tg).setAttribute("position",new to([0,0,0,0,0,1],3)),o.targetLine=new iw(a,s),o.add(o.targetLine),o.update(),o}f(n,t);var r=n.prototype;return r.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},r.update=function(){sN.setFromMatrixPosition(this.light.matrixWorld),sU.setFromMatrixPosition(this.light.target.matrixWorld),sH.subVectors(sU,sN),this.lightPlane.lookAt(sU),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(sU),this.targetLine.scale.z=sH.length()},n}(eP),sz=new D,sj=new tz,sV=function(t){function n(n){var r,i=new tg,o=new iv({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],s=[],l={},c=new e$(16755200),u=new e$(16711680),h=new e$(43775),d=new e$(16777215),p=new e$(3355443);function f(t,n,r){m(t,r),m(n,r)}function m(t,n){a.push(0,0,0),s.push(n.r,n.g,n.b),void 0===l[t]&&(l[t]=[]),l[t].push(a.length/3-1)}return f("n1","n2",c),f("n2","n4",c),f("n4","n3",c),f("n3","n1",c),f("f1","f2",c),f("f2","f4",c),f("f4","f3",c),f("f3","f1",c),f("n1","f1",c),f("n2","f2",c),f("n3","f3",c),f("n4","f4",c),f("p","n1",u),f("p","n2",u),f("p","n3",u),f("p","n4",u),f("u1","u2",h),f("u2","u3",h),f("u3","u1",h),f("c","t",d),f("p","c",p),f("cn1","cn2",p),f("cn3","cn4",p),f("cf1","cf2",p),f("cf3","cf4",p),i.setAttribute("position",new to(a,3)),i.setAttribute("color",new to(s,3)),(r=t.call(this,i,o)||this).type="CameraHelper",r.camera=n,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=n.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=l,r.update(),r}return f(n,t),n.prototype.update=function(){var t=this.geometry,n=this.pointMap;sj.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),sW("c",n,t,sj,0,0,-1),sW("t",n,t,sj,0,0,1),sW("n1",n,t,sj,-1,-1,-1),sW("n2",n,t,sj,1,-1,-1),sW("n3",n,t,sj,-1,1,-1),sW("n4",n,t,sj,1,1,-1),sW("f1",n,t,sj,-1,-1,1),sW("f2",n,t,sj,1,-1,1),sW("f3",n,t,sj,-1,1,1),sW("f4",n,t,sj,1,1,1),sW("u1",n,t,sj,.7,1.1,-1),sW("u2",n,t,sj,-.7,1.1,-1),sW("u3",n,t,sj,0,2,-1),sW("cf1",n,t,sj,-1,0,1),sW("cf2",n,t,sj,1,0,1),sW("cf3",n,t,sj,0,-1,1),sW("cf4",n,t,sj,0,1,1),sW("cn1",n,t,sj,-1,0,-1),sW("cn2",n,t,sj,1,0,-1),sW("cn3",n,t,sj,0,-1,-1),sW("cn4",n,t,sj,0,1,-1),t.getAttribute("position").needsUpdate=!0},n}(i_);function sW(t,n,r,i,o,a,s){sz.set(o,a,s).unproject(i);var l=n[t];if(void 0!==l)for(var c=r.getAttribute("position"),u=0,h=l.length;u<h;u++)c.setXYZ(l[u],sz.x,sz.y,sz.z)}var sq=new B,sX=function(t){function n(n,r){void 0===r&&(r=16776960);var i,o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(24),s=new tg;return s.setIndex(new e6(o,1)),s.setAttribute("position",new e6(a,3)),(i=t.call(this,s,new iv({color:r,toneMapped:!1}))||this).object=n,i.type="BoxHelper",i.matrixAutoUpdate=!1,i.update(),i}f(n,t);var r=n.prototype;return r.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&sq.setFromObject(this.object),!sq.isEmpty()){var n=sq.min,r=sq.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},r.setFromObject=function(t){return this.object=t,this.update(),this},r.copy=function(t){return i_.prototype.copy.call(this,t),this.object=t.object,this},n}(i_),sY=function(t){function n(n,r){void 0===r&&(r=16776960);var i,o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new tg;return a.setIndex(new e6(o,1)),a.setAttribute("position",new to([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(i=t.call(this,a,new iv({color:r,toneMapped:!1}))||this).box=n,i.type="Box3Helper",i.geometry.computeBoundingSphere(),i}return f(n,t),n.prototype.updateMatrixWorld=function(n){var r=this.box;r.isEmpty()||(r.getCenter(this.position),r.getSize(this.scale),this.scale.multiplyScalar(.5),t.prototype.updateMatrixWorld.call(this,n))},n}(i_),sQ=function(t){function n(n,r,i){void 0===r&&(r=1),void 0===i&&(i=16776960);var o,a=i,s=new tg;s.setAttribute("position",new to([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),s.computeBoundingSphere(),(o=t.call(this,s,new iv({color:a,toneMapped:!1}))||this).type="PlaneHelper",o.plane=n,o.size=r;var l=new tg;return l.setAttribute("position",new to([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),l.computeBoundingSphere(),o.add(new tB(l,new e3({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),o}return f(n,t),n.prototype.updateMatrixWorld=function(n){var r=-this.plane.constant;1e-8>Math.abs(r)&&(r=1e-8),this.scale.set(.5*this.size,.5*this.size,r),this.children[0].material.side=r<0?1:0,this.lookAt(this.plane.normal),t.prototype.updateMatrixWorld.call(this,n)},n}(iw),sZ=new D,sK=function(t){function n(n,r,i,o,l,c){var u;return(u=t.call(this)||this).type="ArrowHelper",void 0===n&&(n=new D(0,0,1)),void 0===r&&(r=new D(0,0,0)),void 0===i&&(i=1),void 0===o&&(o=16776960),void 0===l&&(l=.2*i),void 0===c&&(c=.2*l),void 0===a&&((a=new tg).setAttribute("position",new to([0,0,0,0,1,0],3)),(s=new iU(0,.5,1,5,1)).translate(0,-.5,0)),u.position.copy(r),u.line=new iw(a,new iv({color:o,toneMapped:!1})),u.line.matrixAutoUpdate=!1,u.add(u.line),u.cone=new tB(s,new e3({color:o,toneMapped:!1})),u.cone.matrixAutoUpdate=!1,u.add(u.cone),u.setDirection(n),u.setLength(i,l,c),u}f(n,t);var r=n.prototype;return r.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{sZ.set(t.z,0,-t.x).normalize();var n=Math.acos(t.y);this.quaternion.setFromAxisAngle(sZ,n)}},r.setLength=function(t,n,r){void 0===n&&(n=.2*t),void 0===r&&(r=.2*n),this.line.scale.set(1,Math.max(1e-4,t-n),1),this.line.updateMatrix(),this.cone.scale.set(r,n,r),this.cone.position.y=t,this.cone.updateMatrix()},r.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},r.copy=function(n){return t.prototype.copy.call(this,n,!1),this.line.copy(n.line),this.cone.copy(n.cone),this},n}(eP),sJ=function(t){function n(n){void 0===n&&(n=1);var r,i=[0,0,0,n,0,0,0,0,0,0,n,0,0,0,0,0,0,n],o=new tg;o.setAttribute("position",new to(i,3)),o.setAttribute("color",new to([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var a=new iv({vertexColors:!0,toneMapped:!1});return(r=t.call(this,o,a)||this).type="AxesHelper",r}return f(n,t),n}(i_),s$=new Float32Array(1),s0=new Int32Array(s$.buffer),s1=[.125,.215,.35,.446,.526,.582],s2=5+s1.length,s3=((l={})[3e3]=0,l[3001]=1,l[3002]=2,l[3004]=3,l[3005]=4,l[3006]=5,l[3007]=6,l),s4=new e3({side:1,depthWrite:!1,depthTest:!1}),s5=new tB(new tk,s4),s6=new aw,s7=function(){for(var t=[],n=[],r=[],i=8,o=0;o<s2;o++){var a=Math.pow(2,i);n.push(a);var s=1/a;o>4?s=s1[o-8+4-1]:0==o&&(s=0),r.push(s);for(var l=1/(a-1),c=-l/2,u=1+l/2,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=new Float32Array(108),p=new Float32Array(72),f=new Float32Array(36),m=0;m<6;m++){var v=m%3*2/3-1,g=m>2?0:-1,y=[v,g,0,v+2/3,g,0,v+2/3,g+1,0,v,g,0,v+2/3,g+1,0,v,g+1,0];d.set(y,18*m),p.set(h,12*m);var b=[m,m,m,m,m,m];f.set(b,6*m)}var A=new tg;A.setAttribute("position",new e6(d,3)),A.setAttribute("uv",new e6(p,2)),A.setAttribute("faceIndex",new e6(f,1)),t.push(A),i>4&&i--}return{_lodPlanes:t,_sizeLods:n,_sigmas:r}}(),s8=s7._lodPlanes,s9=s7._sizeLods,le=s7._sigmas,lt=new e$,ln=null,lr=(1+Math.sqrt(5))/2,li=1/lr,lo=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,lr,li),new D(0,lr,-li),new D(li,0,lr),new D(-li,0,lr),new D(lr,li,0),new D(-lr,li,0)];function la(t){var n=Math.min(Math.max(Math.ceil(Math.log2(Math.max(t.r,t.g,t.b))),-128),127);return t.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var ls=function(){function t(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new oA({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(20)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new D(0,1,0)},inputEncoding:{value:s3[3e3]},outputEncoding:{value:s3[3e3]}},vertexShader:ld(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform int samples;\n			uniform float weights[ n ];\n			uniform bool latitudinal;\n			uniform float dTheta;\n			uniform float mipInt;\n			uniform vec3 poleAxis;\n\n			"+lp()+"\n\n			#define ENVMAP_TYPE_CUBE_UV\n			#include <cube_uv_reflection_fragment>\n\n			vec3 getSample( float theta, vec3 axis ) {\n\n				float cosTheta = cos( theta );\n				// Rodrigues' axis-angle rotation\n				vec3 sampleDirection = vOutputDirection * cosTheta\n					+ cross( axis, vOutputDirection ) * sin( theta )\n					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n				return bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n			}\n\n			void main() {\n\n				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n				}\n\n				axis = normalize( axis );\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n				for ( int i = 1; i < n; i++ ) {\n\n					if ( i >= samples ) {\n\n						break;\n\n					}\n\n					float theta = dTheta * float( i );\n					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n				}\n\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var n=t.prototype;return n.fromScene=function(t,n,r,i){void 0===n&&(n=0),void 0===r&&(r=.1),void 0===i&&(i=100),ln=this._renderer.getRenderTarget();var o=this._allocateTargets();return this._sceneToCubeUV(t,r,i,o),n>0&&this._blur(o,0,0,n),this._applyPMREM(o),this._cleanup(o),o},n.fromEquirectangular=function(t){return this._fromTexture(t)},n.fromCubemap=function(t){return this._fromTexture(t)},n.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=lh(),this._compileMaterial(this._cubemapShader))},n.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=lu(),this._compileMaterial(this._equirectShader))},n.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<s8.length;t++)s8[t].dispose()},n._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(ln),t.scissorTest=!1,lc(t,0,0,t.width,t.height)},n._fromTexture=function(t){ln=this._renderer.getRenderTarget();var n=this._allocateTargets(t);return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n},n._allocateTargets=function(t){var n={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:void 0!==t&&1009===t.type&&(3e3===t.encoding||3001===t.encoding||3007===t.encoding)?t.encoding:3002,depthBuffer:!1},r=ll(n);return r.depthBuffer=!t,this._pingPongRenderTarget=ll(n),r},n._compileMaterial=function(t){var n=new tB(s8[0],t);this._renderer.compile(n,s6)},n._sceneToCubeUV=function(t,n,r,i){var o=new tj(90,1,n,r),a=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.outputEncoding,h=l.toneMapping;l.getClearColor(lt),l.toneMapping=0,l.outputEncoding=3e3,l.autoClear=!1;var d=!1,p=t.background;if(p){if(p.isColor){s4.color.copy(p).convertSRGBToLinear(),t.background=null;var f=la(s4.color);s4.opacity=f,d=!0}}else{s4.color.copy(lt).convertSRGBToLinear();var m=la(s4.color);s4.opacity=m,d=!0}for(var v=0;v<6;v++){var g=v%3;0==g?(o.up.set(0,a[v],0),o.lookAt(s[v],0,0)):1==g?(o.up.set(0,0,a[v]),o.lookAt(0,s[v],0)):(o.up.set(0,a[v],0),o.lookAt(0,0,s[v])),lc(i,256*g,v>2?256:0,256,256),l.setRenderTarget(i),d&&l.render(s5,o),l.render(t,o)}l.toneMapping=h,l.outputEncoding=u,l.autoClear=c},n._textureToCubeUV=function(t,n){var r=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=lh()):null==this._equirectShader&&(this._equirectShader=lu());var i=t.isCubeTexture?this._cubemapShader:this._equirectShader,o=new tB(s8[0],i),a=i.uniforms;a.envMap.value=t,t.isCubeTexture||a.texelSize.value.set(1/t.image.width,1/t.image.height),a.inputEncoding.value=s3[t.encoding],a.outputEncoding.value=s3[n.texture.encoding],lc(n,0,0,768,512),r.setRenderTarget(n),r.render(o,s6)},n._applyPMREM=function(t){var n=this._renderer,r=n.autoClear;n.autoClear=!1;for(var i=1;i<s2;i++){var o=Math.sqrt(le[i]*le[i]-le[i-1]*le[i-1]),a=lo[(i-1)%lo.length];this._blur(t,i-1,i,o,a)}n.autoClear=r},n._blur=function(t,n,r,i,o){var a=this._pingPongRenderTarget;this._halfBlur(t,a,n,r,i,"latitudinal",o),this._halfBlur(a,t,r,r,i,"longitudinal",o)},n._halfBlur=function(t,n,r,i,o,a,s){var l=this._renderer,c=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new tB(s8[i],c),h=c.uniforms,d=s9[r]-1,p=isFinite(o)?Math.PI/(2*d):2*Math.PI/39,f=o/p,m=isFinite(o)?1+Math.floor(3*f):20;m>20&&console.warn("sigmaRadians, "+o+", is too large and will clip, as it requested "+m+" samples when the maximum is set to 20");for(var v=[],g=0,y=0;y<20;++y){var b=y/f,A=Math.exp(-b*b/2);v.push(A),0==y?g+=A:y<m&&(g+=2*A)}for(var x=0;x<v.length;x++)v[x]=v[x]/g;h.envMap.value=t.texture,h.samples.value=m,h.weights.value=v,h.latitudinal.value="latitudinal"===a,s&&(h.poleAxis.value=s),h.dTheta.value=p,h.mipInt.value=8-r,h.inputEncoding.value=s3[t.texture.encoding],h.outputEncoding.value=s3[t.texture.encoding];var w=s9[i];lc(n,3*Math.max(0,256-2*w),(0===i?0:512)+2*w*(i>4?i-8+4:0),3*w,2*w),l.setRenderTarget(n),l.render(u,s6)},t}();function ll(t){var n=new L(768,768,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function lc(t,n,r,i,o){t.viewport.set(n,r,i,o),t.scissor.set(n,r,i,o)}function lu(){return new oA({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new w(1,1)},inputEncoding:{value:s3[3e3]},outputEncoding:{value:s3[3e3]}},vertexShader:ld(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform vec2 texelSize;\n\n			"+lp()+"\n\n			#include <common>\n\n			void main() {\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n				vec3 outputDirection = normalize( vOutputDirection );\n				vec2 uv = equirectUv( outputDirection );\n\n				vec2 f = fract( uv / texelSize - 0.5 );\n				uv -= f * texelSize;\n				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.x += texelSize.x;\n				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.y += texelSize.y;\n				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.x -= texelSize.x;\n				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n				vec3 tm = mix( tl, tr, f.x );\n				vec3 bm = mix( bl, br, f.x );\n				gl_FragColor.rgb = mix( tm, bm, f.y );\n\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function lh(){return new oA({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:s3[3e3]},outputEncoding:{value:s3[3e3]}},vertexShader:ld(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform samplerCube envMap;\n\n			"+lp()+"\n\n			void main() {\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function ld(){return"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute vec3 position;\n		attribute vec2 uv;\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	"}function lp(){return"\n\n		uniform int inputEncoding;\n		uniform int outputEncoding;\n\n		#include <encodings_pars_fragment>\n\n		vec4 inputTexelToLinear( vec4 value ) {\n\n			if ( inputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( inputEncoding == 1 ) {\n\n				return sRGBToLinear( value );\n\n			} else if ( inputEncoding == 2 ) {\n\n				return RGBEToLinear( value );\n\n			} else if ( inputEncoding == 3 ) {\n\n				return RGBMToLinear( value, 7.0 );\n\n			} else if ( inputEncoding == 4 ) {\n\n				return RGBMToLinear( value, 16.0 );\n\n			} else if ( inputEncoding == 5 ) {\n\n				return RGBDToLinear( value, 256.0 );\n\n			} else {\n\n				return GammaToLinear( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 linearToOutputTexel( vec4 value ) {\n\n			if ( outputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( outputEncoding == 1 ) {\n\n				return LinearTosRGB( value );\n\n			} else if ( outputEncoding == 2 ) {\n\n				return LinearToRGBE( value );\n\n			} else if ( outputEncoding == 3 ) {\n\n				return LinearToRGBM( value, 7.0 );\n\n			} else if ( outputEncoding == 4 ) {\n\n				return LinearToRGBM( value, 16.0 );\n\n			} else if ( outputEncoding == 5 ) {\n\n				return LinearToRGBD( value, 256.0 );\n\n			} else {\n\n				return LinearToGamma( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 envMapTexelToLinear( vec4 color ) {\n\n			return inputTexelToLinear( color );\n\n		}\n	"}function lf(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ae.call(this,t),this.type="catmullrom",this.closed=!0}function lm(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ae.call(this,t),this.type="catmullrom"}function lv(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ae.call(this,t),this.type="catmullrom"}o2.create=function(t,n){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(o2.prototype),t.prototype.constructor=t,t.prototype.getPoint=n,t},Object.assign(ap.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),lf.prototype=Object.create(ae.prototype),lm.prototype=Object.create(ae.prototype),lv.prototype=Object.create(ae.prototype),Object.assign(lv.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),sF.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},sR.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(oX.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),aR.extractUrlBase(t)}}),oX.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(sA.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(B.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(K.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),tZ.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},sE.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(x,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),x.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),x.ceilPowerOfTwo(t)}}),Object.assign(E.prototype,{flattenToArrayOffset:function(t,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,n)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Object.assign(ea.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,n)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new D().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,n,r,i,o,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,n,i,r,o,a)},getInverse:function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),eB.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Object.assign(P.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(eo.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(eq.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,n)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(eq,{barycoordFromPoint:function(t,n,r,i,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),eq.getBarycoord(t,n,r,i,o)},normal:function(t,n,r,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),eq.getNormal(t,n,r,i)}}),Object.assign(af.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new or(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ou(this,t)}}),Object.assign(w.prototype,{fromAttribute:function(t,n,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(D.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,n,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(C.prototype,{fromAttribute:function(t,n,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(eP.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(eP.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(tB.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(tB.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(r8.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ic.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),io.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(o2.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),tj.prototype.setLens=function(t,n){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==n&&(this.filmGauge=n),this.setFocalLength(t)},Object.defineProperties(am.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(e6.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(e6.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(tg.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,n){return(console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),n&&n.isBufferAttribute||n&&n.isInterleavedBufferAttribute)?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(n),this):this.setAttribute(t,n):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new e6(arguments[1],arguments[2])))},addDrawCall:function(t,n,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,n)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(tg.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(aP.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(sf.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(rz.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(rz.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(or.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(rG.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(sh.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(e2.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new e$}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(oE.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ow.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(tG.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(rk.prototype,{clearTarget:function(t,n,r,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(n,r,i)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(rk.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(r_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(L.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(a2.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var n=this;return new aj().load(t,function(t){n.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),a8.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},tV.prototype.updateCubeMap=function(t,n){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,n)},tV.prototype.clear=function(t,n,r,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,n,r,i)},M.crossOrigin=void 0,M.loadTexture=function(t,n,r,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var o=new o1;o.setCrossOrigin(this.crossOrigin);var a=o.load(t,r,void 0,i);return n&&(a.mapping=n),a},M.loadTextureCube=function(t,n,r,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var o=new o$;o.setCrossOrigin(this.crossOrigin);var a=o.load(t,r,void 0,i);return n&&(a.mapping=n),a},M.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},M.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"125"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="125"),t.ACESFilmicToneMapping=4,t.AddEquation=100,t.AddOperation=2,t.AdditiveAnimationBlendMode=2501,t.AdditiveBlending=2,t.AlphaFormat=1021,t.AlwaysDepth=1,t.AlwaysStencilFunc=519,t.AmbientLight=a_,t.AmbientLightProbe=aW,t.AnimationClip=oj,t.AnimationLoader=oZ,t.AnimationMixer=su,t.AnimationObjectGroup=sl,t.AnimationUtils=oR,t.ArcCurve=o4,t.ArrayCamera=rR,t.ArrowHelper=sK,t.Audio=a2,t.AudioAnalyser=a8,t.AudioContext=az,t.AudioListener=a1,t.AudioLoader=aj,t.AxesHelper=sJ,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new sJ(t)},t.BackSide=1,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new o0(t)},t.Bone=ia,t.BooleanKeyframeTrack=oF,t.BoundingBoxHelper=function(t,n){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new sX(t,n)},t.Box2=sA,t.Box3=B,t.Box3Helper=sY,t.BoxBufferGeometry=tk,t.BoxGeometry=tk,t.BoxHelper=sX,t.BufferAttribute=e6,t.BufferGeometry=tg,t.BufferGeometryLoader=aO,t.ByteType=1010,t.Cache=oV,t.Camera=tz,t.CameraHelper=sV,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=iF,t.CatmullRomCurve3=ae,t.CineonToneMapping=3,t.CircleBufferGeometry=iN,t.CircleGeometry=iN,t.ClampToEdgeWrapping=1001,t.Clock=aQ,t.ClosedSplineCurve3=lf,t.Color=e$,t.ColorKeyframeTrack=ok,t.CompressedTexture=iB,t.CompressedTextureLoader=oK,t.ConeBufferGeometry=iH,t.ConeGeometry=iH,t.CubeCamera=tV,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.CubeTexture=tW,t.CubeTextureLoader=o$,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.CubicBezierCurve=ai,t.CubicBezierCurve3=ao,t.CubicInterpolant=oD,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.CullFaceNone=0,t.Curve=o2,t.CurvePath=ad,t.CustomBlending=5,t.CustomToneMapping=5,t.CylinderBufferGeometry=iU,t.CylinderGeometry=iU,t.Cylindrical=sy,t.DataTexture=tX,t.DataTexture2DArray=ns,t.DataTexture3D=nl,t.DataTextureLoader=o0,t.DataUtils={toHalfFloat:function(t){s$[0]=t;var n=s0[0],r=n>>16&32768,i=n>>12&2047,o=n>>23&255;return o<103?r:o>142?(r|=31744,r|=(255==o?0:1)&&8388607&n):o<113?(i|=2048,r|=(i>>114-o)+(i>>113-o&1)):(r|=o-112<<10|i>>1,r+=1&i)}},t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=oq,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.DepthTexture=ik,t.DirectionalLight=aM,t.DirectionalLightHelper=sG,t.DiscreteInterpolant=oI,t.DodecahedronBufferGeometry=iz,t.DodecahedronGeometry=iz,t.DoubleSide=2,t.DstAlphaFactor=206,t.DstColorFactor=208,t.DynamicBufferAttribute=function(t,n){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new e6(t,n).setUsage(35048)},t.DynamicCopyUsage=35050,t.DynamicDrawUsage=35048,t.DynamicReadUsage=35049,t.EdgesGeometry=iX,t.EdgesHelper=function(t,n){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new i_(new iX(t.geometry),new iv({color:void 0!==n?n:16777215}))},t.EllipseCurve=o3,t.EqualDepth=4,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.Euler=ef,t.EventDispatcher=g,t.ExtrudeBufferGeometry=or,t.ExtrudeGeometry=or,t.Face3=e0,t.Face4=function(t,n,r,i,o,a,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new e0(t,n,r,o,a,s)},t.FaceColors=1,t.FileLoader=oQ,t.FlatShading=1,t.Float16BufferAttribute=ti,t.Float32Attribute=function(t,n){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new to(t,n)},t.Float32BufferAttribute=to,t.Float64Attribute=function(t,n){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ta(t,n)},t.Float64BufferAttribute=ta,t.FloatType=1015,t.Fog=rH,t.FogExp2=rU,t.Font=aH,t.FontLoader=aG,t.FrontSide=0,t.Frustum=tZ,t.GLBufferAttribute=sp,t.GLSL1="100",t.GLSL3=u,t.GammaEncoding=3007,t.GeometryUtils={merge:function(t,n,r){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),n.isMesh&&(n.matrixAutoUpdate&&n.updateMatrix(),i=n.matrix,n=n.geometry),t.merge(n,i,r)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.GreaterDepth=6,t.GreaterEqualDepth=5,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=sF,t.Group=rL,t.HalfFloatType=1016,t.HemisphereLight=av,t.HemisphereLightHelper=sB,t.HemisphereLightProbe=aV,t.IcosahedronBufferGeometry=oo,t.IcosahedronGeometry=oo,t.ImageBitmapLoader=aN,t.ImageLoader=oJ,t.ImageUtils=M,t.ImmediateRenderObject=sM,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=aD,t.InstancedBufferGeometry=aP,t.InstancedInterleavedBuffer=sd,t.InstancedMesh=im,t.Int16Attribute=function(t,n){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new te(t,n)},t.Int16BufferAttribute=te,t.Int32Attribute=function(t,n){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new tn(t,n)},t.Int32BufferAttribute=tn,t.Int8Attribute=function(t,n){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new e7(t,n)},t.Int8BufferAttribute=e7,t.IntType=1013,t.InterleavedBuffer=rz,t.InterleavedBufferAttribute=rV,t.Interpolant=oP,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.InvertStencilOp=5386,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeepStencilOp=7680,t.KeyframeTrack=oB,t.LOD=r8,t.LatheBufferGeometry=oa,t.LatheGeometry=oa,t.Layers=eg,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},t.LessDepth=2,t.LessEqualDepth=3,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=am,t.LightProbe=aC,t.Line=iw,t.Line3=sE,t.LineBasicMaterial=iv,t.LineCurve=aa,t.LineCurve3=as,t.LineDashedMaterial=oC,t.LineLoop=iT,t.LinePieces=1,t.LineSegments=i_,t.LineStrip=0,t.LinearEncoding=3e3,t.LinearFilter=1006,t.LinearInterpolant=oO,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=1008,t.LinearMipmapNearestFilter=1007,t.LinearToneMapping=1,t.Loader=oX,t.LoaderUtils=aR,t.LoadingManager=oW,t.LogLuvEncoding=3003,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=1025,t.LuminanceFormat=1024,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=e2,t.MaterialLoader=aL,t.Math=x,t.MathUtils=x,t.Matrix3=E,t.Matrix4=ea,t.MaxEquation=104,t.Mesh=tB,t.MeshBasicMaterial=e3,t.MeshDepthMaterial=rE,t.MeshDistanceMaterial=rM,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=oT,t.MeshMatcapMaterial=oS,t.MeshNormalMaterial=o_,t.MeshPhongMaterial=oE,t.MeshPhysicalMaterial=ow,t.MeshStandardMaterial=ox,t.MeshToonMaterial=oM,t.MinEquation=103,t.MirroredRepeatWrapping=1002,t.MixOperation=1,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.MultiplyBlending=4,t.MultiplyOperation=0,t.NearestFilter=1003,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=1005,t.NearestMipmapNearestFilter=1004,t.NeverDepth=0,t.NeverStencilFunc=512,t.NoBlending=0,t.NoColors=0,t.NoToneMapping=0,t.NormalAnimationBlendMode=2500,t.NormalBlending=1,t.NotEqualDepth=7,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=oN,t.Object3D=eP,t.ObjectLoader=aI,t.ObjectSpaceNormalMap=1,t.OctahedronBufferGeometry=os,t.OctahedronGeometry=os,t.OneFactor=201,t.OneMinusDstAlphaFactor=207,t.OneMinusDstColorFactor=209,t.OneMinusSrcAlphaFactor=205,t.OneMinusSrcColorFactor=203,t.OrthographicCamera=aw,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.PMREMGenerator=ls,t.ParametricBufferGeometry=ol,t.ParametricGeometry=ol,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new r4(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new iS(t)},t.ParticleSystem=function(t,n){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new iD(t,n)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new iS(t)},t.Path=ap,t.PerspectiveCamera=tj,t.Plane=eB,t.PlaneBufferGeometry=t$,t.PlaneGeometry=t$,t.PlaneHelper=sQ,t.PointCloud=function(t,n){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new iD(t,n)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new iS(t)},t.PointLight=ax,t.PointLightHelper=sP,t.Points=iD,t.PointsMaterial=iS,t.PolarGridHelper=sk,t.PolyhedronBufferGeometry=iG,t.PolyhedronGeometry=iG,t.PositionalAudio=a7,t.PropertyBinding=ss,t.PropertyMixer=a9,t.QuadraticBezierCurve=al,t.QuadraticBezierCurve3=ac,t.Quaternion=P,t.QuaternionKeyframeTrack=oH,t.QuaternionLinearInterpolant=oU,t.REVISION="125",t.RGBADepthPacking=3201,t.RGBAFormat=1023,t.RGBAIntegerFormat=1033,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_BPTC_Format=36492,t.RGBA_ETC2_EAC_Format=37496,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGBDEncoding=3006,t.RGBEEncoding=3002,t.RGBEFormat=1023,t.RGBFormat=1022,t.RGBIntegerFormat=1032,t.RGBM16Encoding=3005,t.RGBM7Encoding=3004,t.RGB_ETC1_Format=36196,t.RGB_ETC2_Format=37492,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_S3TC_DXT1_Format=33776,t.RGFormat=1030,t.RGIntegerFormat=1031,t.RawShaderMaterial=oA,t.Ray=eo,t.Raycaster=sf,t.RectAreaLight=aT,t.RedFormat=1028,t.RedIntegerFormat=1029,t.ReinhardToneMapping=2,t.RepeatWrapping=1e3,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=102,t.RingBufferGeometry=oc,t.RingGeometry=oc,t.SRGB8_ALPHA8_ASTC_10x10_Format=37851,t.SRGB8_ALPHA8_ASTC_10x5_Format=37848,t.SRGB8_ALPHA8_ASTC_10x6_Format=37849,t.SRGB8_ALPHA8_ASTC_10x8_Format=37850,t.SRGB8_ALPHA8_ASTC_12x10_Format=37852,t.SRGB8_ALPHA8_ASTC_12x12_Format=37853,t.SRGB8_ALPHA8_ASTC_4x4_Format=37840,t.SRGB8_ALPHA8_ASTC_5x4_Format=37841,t.SRGB8_ALPHA8_ASTC_5x5_Format=37842,t.SRGB8_ALPHA8_ASTC_6x5_Format=37843,t.SRGB8_ALPHA8_ASTC_6x6_Format=37844,t.SRGB8_ALPHA8_ASTC_8x5_Format=37845,t.SRGB8_ALPHA8_ASTC_8x6_Format=37846,t.SRGB8_ALPHA8_ASTC_8x8_Format=37847,t.Scene=rG,t.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},t.ShaderChunk=t0,t.ShaderLib=t2,t.ShaderMaterial=tG,t.ShadowMaterial=ob,t.Shape=af,t.ShapeBufferGeometry=ou,t.ShapeGeometry=ou,t.ShapePath=aU,t.ShapeUtils=oe,t.ShortType=1011,t.Skeleton=ic,t.SkeletonHelper=sR,t.SkinnedMesh=io,t.SmoothShading=2,t.Sphere=K,t.SphereBufferGeometry=oh,t.SphereGeometry=oh,t.Spherical=sg,t.SphericalHarmonics3=aS,t.Spline=lv,t.SplineCurve=au,t.SplineCurve3=lm,t.SpotLight=ab,t.SpotLightHelper=sT,t.Sprite=r4,t.SpriteMaterial=rW,t.SrcAlphaFactor=204,t.SrcAlphaSaturateFactor=210,t.SrcColorFactor=202,t.StaticCopyUsage=35046,t.StaticDrawUsage=35044,t.StaticReadUsage=35045,t.StereoCamera=aY,t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=oG,t.SubtractEquation=101,t.SubtractiveBlending=3,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=0,t.TetrahedronBufferGeometry=od,t.TetrahedronGeometry=od,t.TextBufferGeometry=op,t.TextGeometry=op,t.Texture=T,t.TextureLoader=o1,t.TorusBufferGeometry=of,t.TorusGeometry=of,t.TorusKnotBufferGeometry=om,t.TorusKnotGeometry=om,t.Triangle=eq,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=ov,t.TubeGeometry=ov,t.UVMapping=300,t.Uint16Attribute=function(t,n){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new tt(t,n)},t.Uint16BufferAttribute=tt,t.Uint32Attribute=function(t,n){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new tr(t,n)},t.Uint32BufferAttribute=tr,t.Uint8Attribute=function(t,n){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new e8(t,n)},t.Uint8BufferAttribute=e8,t.Uint8ClampedAttribute=function(t,n){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new e9(t,n)},t.Uint8ClampedBufferAttribute=e9,t.Uniform=sh,t.UniformsLib=t1,t.UniformsUtils=tH,t.UnsignedByteType=1009,t.UnsignedInt248Type=1020,t.UnsignedIntType=1014,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedShortType=1012,t.VSMShadowMap=3,t.Vector2=w,t.Vector3=D,t.Vector4=C,t.VectorKeyframeTrack=oz,t.Vertex=function(t,n,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new D(t,n,r)},t.VertexColors=2,t.VideoTexture=iI,t.WebGL1Renderer=rN,t.WebGLCubeRenderTarget=tq,t.WebGLMultisampleRenderTarget=R,t.WebGLRenderTarget=L,t.WebGLRenderTargetCube=function(t,n,r){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new tq(t,r)},t.WebGLRenderer=rk,t.WebGLUtils=rC,t.WireframeGeometry=og,t.WireframeHelper=function(t,n){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new i_(new og(t.geometry),new iv({color:void 0!==n?n:16777215}))},t.WrapAroundEnding=2402,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new oQ(t)},t.ZeroCurvatureEnding=2400,t.ZeroFactor=200,t.ZeroSlopeEnding=2401,t.ZeroStencilOp=0,t.sRGBEncoding=3001,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof i&&void 0!==r?a(i):"function"==typeof t&&t.amd?t(["exports"],a):a((o="undefined"!=typeof globalThis?globalThis:o||self).THREE={})},{}],58:[function(t,n,r){THREE.DRACOLoader=function(t){THREE.Loader.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(t){return this.decoderPath=t,this},setDecoderConfig:function(t){return this.decoderConfig=t,this},setWorkerLimit:function(t){return this.workerLimit=t,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(t,n,r,i){var o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,t=>{var r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(t,r).then(n).catch(i)},r,i)},decodeDracoFile:function(t,n,r,i){var o={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(t,o).then(n)},decodeGeometry:function(t,n){for(var r in n.attributeTypes){var i,o=n.attributeTypes[r];void 0!==o.BYTES_PER_ELEMENT&&(n.attributeTypes[r]=o.name)}var a=JSON.stringify(n);if(THREE.DRACOLoader.taskCache.has(t)){var s=THREE.DRACOLoader.taskCache.get(t);if(s.key===a)return s.promise;if(0===t.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var l=this.workerNextTaskID++,c=t.byteLength,u=this._getWorker(l,c).then(r=>(i=r,new Promise((r,o)=>{i._callbacks[l]={resolve:r,reject:o},i.postMessage({type:"decode",id:l,taskConfig:n,buffer:t},[t])}))).then(t=>this._createGeometry(t.geometry));return u.catch(()=>!0).then(()=>{i&&l&&this._releaseTask(i,l)}),THREE.DRACOLoader.taskCache.set(t,{key:a,promise:u}),u},_createGeometry:function(t){var n=new THREE.BufferGeometry;t.index&&n.setIndex(new THREE.BufferAttribute(t.index.array,1));for(var r=0;r<t.attributes.length;r++){var i=t.attributes[r],o=i.name,a=i.array,s=i.itemSize;n.setAttribute(o,new THREE.BufferAttribute(a,s))}return n},_loadLibrary:function(t,n){var r=new THREE.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(n),r.setWithCredentials(this.withCredentials),new Promise((n,i)=>{r.load(t,n,void 0,i)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var t="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(n=>{var r=n[0];t||(this.decoderConfig.wasmBinary=n[1]);var i=THREE.DRACOLoader.DRACOWorker.toString(),o=["/* draco decoder */",r,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending},_getWorker:function(t,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){var r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(t){var n=t.data;switch(n.type){case"decode":r._callbacks[n.id].resolve(n);break;case"error":r._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(t,n){return t._taskLoad>n._taskLoad?-1:1});var r=this.workerPool[this.workerPool.length-1];return r._taskCosts[t]=n,r._taskLoad+=n,r})},_releaseTask:function(t,n){t._taskLoad-=t._taskCosts[n],delete t._callbacks[n],delete t._taskCosts[n]},debug:function(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))},dispose:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}),THREE.DRACOLoader.DRACOWorker=function(){var t,n;onmessage=function(r){var i=r.data;switch(i.type){case"init":t=i.decoderConfig,n=new Promise(function(n){t.onModuleLoaded=function(t){n({draco:t})},DracoDecoderModule(t)});break;case"decode":var o=i.buffer,a=i.taskConfig;n.then(t=>{var n=t.draco,r=new n.Decoder,s=new n.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var l=function(t,n,r,i){var o=i.attributeIDs,a=i.attributeTypes,s=n.GetEncodedGeometryType(r);if(s===t.TRIANGULAR_MESH)u=new t.Mesh,h=n.DecodeBufferToMesh(r,u);else if(s===t.POINT_CLOUD)u=new t.PointCloud,h=n.DecodeBufferToPointCloud(r,u);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!h.ok()||0===u.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+h.error_msg());var l={index:null,attributes:[]};for(var c in o){var u,h,d,p,f=self[a[c]];if(i.useUniqueIDs)p=o[c],d=n.GetAttributeByUniqueId(u,p);else{if(-1===(p=n.GetAttributeId(u,t[o[c]])))continue;d=n.GetAttribute(u,p)}l.attributes.push(function(t,n,r,i,o,a){var s=a.num_components(),l=r.num_points()*s,c=l*o.BYTES_PER_ELEMENT,u=function(t,n){switch(n){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,o),h=t._malloc(c);n.GetAttributeDataArrayForAllPoints(r,a,u,c,h);var d=new o(t.HEAPF32.buffer,h,l).slice();return t._free(h),{name:i,array:d,itemSize:s}}(t,n,u,c,f,d))}return s===t.TRIANGULAR_MESH&&(l.index=function(t,n,r){var i=3*r.num_faces(),o=4*i,a=t._malloc(o);n.GetTrianglesUInt32Array(r,o,a);var s=new Uint32Array(t.HEAPF32.buffer,a,i).slice();return t._free(a),{array:s,itemSize:1}}(t,n,u)),t.destroy(u),l}(n,r,s,a),c=l.attributes.map(t=>t.array.buffer);l.index&&c.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},c)}catch(t){console.error(t),self.postMessage({type:"error",id:i.id,error:t.message})}finally{n.destroy(s),n.destroy(r)}})}}},THREE.DRACOLoader.taskCache=new WeakMap,THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},{}],59:[function(t,n,r){THREE.GLTFLoader=function(){function t(t){THREE.Loader.call(this,t),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new s(t)}),this.register(function(t){return new c(t)}),this.register(function(t){return new u(t)}),this.register(function(t){return new l(t)}),this.register(function(t){return new o(t)}),this.register(function(t){return new h(t)})}function n(){var t={};return{get:function(n){return t[n]},add:function(n,r){t[n]=r},remove:function(n){delete t[n]},removeAll:function(){t={}}}}t.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:t,load:function(t,n,r,i){var o,a=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(t),this.manager.itemStart(t);var s=function(n){i?i(n):console.error(n),a.manager.itemError(t),a.manager.itemEnd(t)},l=new THREE.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,function(r){try{a.parse(r,o,function(r){n(r),a.manager.itemEnd(t)},s)}catch(t){s(t)}},r,s)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},setKTX2Loader:function(t){return this.ktx2Loader=t,this},setMeshoptDecoder:function(t){return this.meshoptDecoder=t,this},register:function(t){return -1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},unregister:function(t){return -1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},parse:function(t,n,o,s){var l,c={},u={};if("string"==typeof t)l=t;else if(THREE.LoaderUtils.decodeText(new Uint8Array(t,0,4))===d){try{c[r.KHR_BINARY_GLTF]=new f(t)}catch(t){s&&s(t);return}l=c[r.KHR_BINARY_GLTF].content}else l=THREE.LoaderUtils.decodeText(new Uint8Array(t));var h=JSON.parse(l);if(void 0===h.asset||h.asset.version[0]<2){s&&s(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var p=new I(h,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(var g=0;g<this.pluginCallbacks.length;g++){var A=this.pluginCallbacks[g](p);u[A.name]=A,c[A.name]=!0}if(h.extensionsUsed)for(var g=0;g<h.extensionsUsed.length;++g){var x=h.extensionsUsed[g],w=h.extensionsRequired||[];switch(x){case r.KHR_MATERIALS_UNLIT:c[x]=new a;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:c[x]=new y;break;case r.KHR_DRACO_MESH_COMPRESSION:c[x]=new m(h,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:c[x]=new i(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:c[x]=new v;break;case r.KHR_MESH_QUANTIZATION:c[x]=new b;break;default:w.indexOf(x)>=0&&void 0===u[x]&&console.warn('THREE.GLTFLoader: Unknown extension "'+x+'".')}}p.setExtensions(c),p.setPlugins(u),p.parse(o,s)}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function i(t){if(!t)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=t}function o(t){this.parser=t,this.name=r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function a(){this.name=r.KHR_MATERIALS_UNLIT}function s(t){this.parser=t,this.name=r.KHR_MATERIALS_CLEARCOAT}function l(t){this.parser=t,this.name=r.KHR_MATERIALS_TRANSMISSION}function c(t){this.parser=t,this.name=r.KHR_TEXTURE_BASISU}function u(t){this.parser=t,this.name=r.EXT_TEXTURE_WEBP,this.isSupported=null}function h(t){this.name=r.EXT_MESHOPT_COMPRESSION,this.parser=t}o.prototype._markDefs=function(){for(var t=this.parser,n=this.parser.json.nodes||[],r=0,i=n.length;r<i;r++){var o=n[r];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&t._addNodeRef(this.cache,o.extensions[this.name].light)}},o.prototype._loadLight=function(t){var n,r=this.parser,i="light:"+t,o=r.cache.get(i);if(o)return o;var a=r.json,s=((a.extensions&&a.extensions[this.name]||{}).lights||[])[t],l=new THREE.Color(16777215);void 0!==s.color&&l.fromArray(s.color);var c=void 0!==s.range?s.range:0;switch(s.type){case"directional":(n=new THREE.DirectionalLight(l)).target.position.set(0,0,-1),n.add(n.target);break;case"point":(n=new THREE.PointLight(l)).distance=c;break;case"spot":(n=new THREE.SpotLight(l)).distance=c,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,n.angle=s.spot.outerConeAngle,n.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,n.target.position.set(0,0,-1),n.add(n.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return n.position.set(0,0,0),n.decay=2,void 0!==s.intensity&&(n.intensity=s.intensity),n.name=r.createUniqueName(s.name||"light_"+t),o=Promise.resolve(n),r.cache.add(i,o),o},o.prototype.createNodeAttachment=function(t){var n=this,r=this.parser,i=r.json.nodes[t],o=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then(function(t){return r._getNodeRef(n.cache,o,t)})},a.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},a.prototype.extendParams=function(t,n,r){var i=[];t.color=new THREE.Color(1,1,1),t.opacity=1;var o=n.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var a=o.baseColorFactor;t.color.fromArray(a),t.opacity=a[3]}void 0!==o.baseColorTexture&&i.push(r.assignTexture(t,"map",o.baseColorTexture))}return Promise.all(i)},s.prototype.getMaterialType=function(t){var n=this.parser.json.materials[t];return n.extensions&&n.extensions[this.name]?THREE.MeshPhysicalMaterial:null},s.prototype.extendMaterialParams=function(t,n){var r=this.parser,i=r.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var o=[],a=i.extensions[this.name];if(void 0!==a.clearcoatFactor&&(n.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&o.push(r.assignTexture(n,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(n.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&o.push(r.assignTexture(n,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(o.push(r.assignTexture(n,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var s=a.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new THREE.Vector2(s,-s)}return Promise.all(o)},l.prototype.getMaterialType=function(t){var n=this.parser.json.materials[t];return n.extensions&&n.extensions[this.name]?THREE.MeshPhysicalMaterial:null},l.prototype.extendMaterialParams=function(t,n){var r=this.parser,i=r.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var o=[],a=i.extensions[this.name];return void 0!==a.transmissionFactor&&(n.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&o.push(r.assignTexture(n,"transmissionMap",a.transmissionTexture)),Promise.all(o)},c.prototype.loadTexture=function(t){var n=this.parser,r=n.json,i=r.textures[t];if(!i.extensions||!i.extensions[this.name])return null;var o=i.extensions[this.name],a=r.images[o.source],s=n.options.ktx2Loader;if(!s){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return n.loadTextureImage(t,a,s)},u.prototype.loadTexture=function(t){var n=this.name,r=this.parser,i=r.json,o=i.textures[t];if(!o.extensions||!o.extensions[n])return null;var a=o.extensions[n],s=i.images[a.source],l=s.uri?r.options.manager.getHandler(s.uri):r.textureLoader;return this.detectSupport().then(function(o){if(o)return r.loadTextureImage(t,s,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(n)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(t)})},u.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(t){var n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){t(1===n.height)}})),this.isSupported},h.prototype.loadBufferView=function(t){var n=this.parser.json,r=n.bufferViews[t];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],o=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(!(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return Promise.all([o,a.ready]).then(function(t){var n=i.byteOffset||0,r=i.byteLength||0,o=i.count,s=i.byteStride,l=new ArrayBuffer(o*s),c=new Uint8Array(t[0],n,r);return a.decodeGltfBuffer(new Uint8Array(l),o,s,c,i.mode,i.filter),l})};var d="glTF",p={JSON:1313821514,BIN:5130562};function f(t){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==d)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,o=new DataView(t,12),a=0;a<i;){var s=o.getUint32(a,!0);a+=4;var l=o.getUint32(a,!0);if(a+=4,l===p.JSON){var c=new Uint8Array(t,12+a,s);this.content=THREE.LoaderUtils.decodeText(c)}else if(l===p.BIN){var u=12+a;this.body=t.slice(u,u+s)}a+=s}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}function m(t,n){if(!n)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}function v(){this.name=r.KHR_TEXTURE_TRANSFORM}function g(t){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var n={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=n,this.onBeforeCompile=function(t){for(var r in n)t.uniforms[r]=n[r];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n	uniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	texelSpecular = sRGBToLinear( texelSpecular );\n	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n	specularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n	vec4 texelGlossiness = texture2D( glossinessMap, vUv );\n	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n	glossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\nmaterial.specularColor = specularFactor;")},Object.defineProperties(this,{specular:{get:function(){return n.specular.value},set:function(t){n.specular.value=t}},specularMap:{get:function(){return n.specularMap.value},set:function(t){n.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return n.glossiness.value},set:function(t){n.glossiness.value=t}},glossinessMap:{get:function(){return n.glossinessMap.value},set:function(t){n.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function y(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return g},extendParams:function(t,n,r){var i=n.extensions[this.name];t.color=new THREE.Color(1,1,1),t.opacity=1;var o=[];if(Array.isArray(i.diffuseFactor)){var a=i.diffuseFactor;t.color.fromArray(a),t.opacity=a[3]}if(void 0!==i.diffuseTexture&&o.push(r.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new THREE.Color(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new THREE.Color(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var s=i.specularGlossinessTexture;o.push(r.assignTexture(t,"glossinessMap",s)),o.push(r.assignTexture(t,"specularMap",s))}return Promise.all(o)},createMaterial:function(t){var n=new g(t);return n.fog=!0,n.color=t.color,n.map=void 0===t.map?null:t.map,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=void 0===t.aoMap?null:t.aoMap,n.aoMapIntensity=1,n.emissive=t.emissive,n.emissiveIntensity=1,n.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,n.bumpMap=void 0===t.bumpMap?null:t.bumpMap,n.bumpScale=1,n.normalMap=void 0===t.normalMap?null:t.normalMap,n.normalMapType=THREE.TangentSpaceNormalMap,t.normalScale&&(n.normalScale=t.normalScale),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=void 0===t.specularMap?null:t.specularMap,n.specular=t.specular,n.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,n.glossiness=t.glossiness,n.alphaMap=null,n.envMap=void 0===t.envMap?null:t.envMap,n.envMapIntensity=1,n.refractionRatio=.98,n}}}function b(){this.name=r.KHR_MESH_QUANTIZATION}function A(t,n,r,i){THREE.Interpolant.call(this,t,n,r,i)}m.prototype.decodePrimitive=function(t,n){var r=this.json,i=this.dracoLoader,o=t.extensions[this.name].bufferView,a=t.extensions[this.name].attributes,s={},l={},c={};for(var u in a){var h=T[u]||u.toLowerCase();s[h]=a[u]}for(u in t.attributes){var h=T[u]||u.toLowerCase();if(void 0!==a[u]){var d=r.accessors[t.attributes[u]],p=w[d.componentType];c[h]=p,l[h]=!0===d.normalized}}return n.getDependency("bufferView",o).then(function(t){return new Promise(function(n){i.decodeDracoFile(t,function(t){for(var r in t.attributes){var i=t.attributes[r],o=l[r];void 0!==o&&(i.normalized=o)}n(t)},s,c)})})},v.prototype.extendTexture=function(t,n){return t=t.clone(),void 0!==n.offset&&t.offset.fromArray(n.offset),void 0!==n.rotation&&(t.rotation=n.rotation),void 0!==n.scale&&t.repeat.fromArray(n.scale),void 0!==n.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},g.prototype=Object.create(THREE.MeshStandardMaterial.prototype),g.prototype.constructor=g,g.prototype.copy=function(t){return THREE.MeshStandardMaterial.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},A.prototype=Object.create(THREE.Interpolant.prototype),A.prototype.constructor=A,A.prototype.copySampleValue_=function(t){for(var n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,o=t*i*3+i,a=0;a!==i;a++)n[a]=r[o+a];return n},A.prototype.beforeStart_=A.prototype.copySampleValue_,A.prototype.afterEnd_=A.prototype.copySampleValue_,A.prototype.interpolate_=function(t,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=2*s,c=3*s,u=i-n,h=(r-n)/u,d=h*h,p=d*h,f=t*c,m=f-c,v=-2*p+3*d,g=p-d,y=1-v,b=g-d+h,A=0;A!==s;A++){var x=a[m+A+s],w=a[m+A+l]*u,E=a[f+A+s],M=a[f+A]*u;o[A]=y*x+b*w+v*E+g*M}return o};var x={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},w={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},E={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},M={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},T={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},S={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},L={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function R(t,n){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(n)&&/^\//.test(t)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t))?t:n+t}function P(t,n,r){for(var i in r.extensions)void 0===t[i]&&(n.userData.gltfExtensions=n.userData.gltfExtensions||{},n.userData.gltfExtensions[i]=r.extensions[i])}function D(t,n){void 0!==n.extras&&("object"==typeof n.extras?Object.assign(t.userData,n.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+n.extras))}function O(t){for(var n="",r=Object.keys(t).sort(),i=0,o=r.length;i<o;i++)n+=r[i]+":"+t[r[i]]+";";return n}function I(t,r){this.json=t||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new n,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function B(t,n,r){var i=n.attributes,o=[];for(var a in i){var s=T[a]||a.toLowerCase();s in t.attributes||o.push(function(n,i){return r.getDependency("accessor",n).then(function(n){t.setAttribute(i,n)})}(i[a],s))}if(void 0!==n.indices&&!t.index){var l=r.getDependency("accessor",n.indices).then(function(n){t.setIndex(n)});o.push(l)}return D(t,n),function(t,n,r){var i=n.attributes,o=new THREE.Box3;if(void 0!==i.POSITION){var a=r.json.accessors[i.POSITION],s=a.min,l=a.max;if(void 0!==s&&void 0!==l)o.set(new THREE.Vector3(s[0],s[1],s[2]),new THREE.Vector3(l[0],l[1],l[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}var c=n.targets;if(void 0!==c){for(var u=new THREE.Vector3,h=new THREE.Vector3,d=0,p=c.length;d<p;d++){var f=c[d];if(void 0!==f.POSITION){var a=r.json.accessors[f.POSITION],s=a.min,l=a.max;void 0!==s&&void 0!==l?(h.setX(Math.max(Math.abs(s[0]),Math.abs(l[0]))),h.setY(Math.max(Math.abs(s[1]),Math.abs(l[1]))),h.setZ(Math.max(Math.abs(s[2]),Math.abs(l[2]))),u.max(h)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(u)}t.boundingBox=o;var m=new THREE.Sphere;o.getCenter(m.center),m.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=m}}(t,n,r),Promise.all(o).then(function(){return void 0!==n.targets?function(t,n,r){for(var i=!1,o=!1,a=0,s=n.length;a<s;a++){var l=n[a];if(void 0!==l.POSITION&&(i=!0),void 0!==l.NORMAL&&(o=!0),i&&o)break}if(!i&&!o)return Promise.resolve(t);for(var c=[],u=[],a=0,s=n.length;a<s;a++){var l=n[a];if(i){var h=void 0!==l.POSITION?r.getDependency("accessor",l.POSITION):t.attributes.position;c.push(h)}if(o){var h=void 0!==l.NORMAL?r.getDependency("accessor",l.NORMAL):t.attributes.normal;u.push(h)}}return Promise.all([Promise.all(c),Promise.all(u)]).then(function(n){var r=n[0],a=n[1];return i&&(t.morphAttributes.position=r),o&&(t.morphAttributes.normal=a),t.morphTargetsRelative=!0,t})}(t,n.targets,r):t})}function F(t,n){var r=t.getIndex();if(null===r){var i=[],o=t.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var a=0;a<o.count;a++)i.push(a);t.setIndex(i),r=t.getIndex()}var s=r.count-2,l=[];if(n===THREE.TriangleFanDrawMode)for(var a=1;a<=s;a++)l.push(r.getX(0)),l.push(r.getX(a)),l.push(r.getX(a+1));else for(var a=0;a<s;a++)a%2==0?(l.push(r.getX(a)),l.push(r.getX(a+1)),l.push(r.getX(a+2))):(l.push(r.getX(a+2)),l.push(r.getX(a+1)),l.push(r.getX(a)));l.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=t.clone();return c.setIndex(l),c}return I.prototype.setExtensions=function(t){this.extensions=t},I.prototype.setPlugins=function(t){this.plugins=t},I.prototype.parse=function(t,n){var r=this,i=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll(function(t){return t._markDefs&&t._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(n){var a={scene:n[0][i.scene||0],scenes:n[0],animations:n[1],cameras:n[2],asset:i.asset,parser:r,userData:{}};P(o,a,i),D(a,i),t(a)}).catch(n)},I.prototype._markDefs=function(){for(var t=this.json.nodes||[],n=this.json.skins||[],r=this.json.meshes||[],i=0,o=n.length;i<o;i++)for(var a=n[i].joints,s=0,l=a.length;s<l;s++)t[a[s]].isBone=!0;for(var c=0,u=t.length;c<u;c++){var h=t[c];void 0!==h.mesh&&(this._addNodeRef(this.meshCache,h.mesh),void 0!==h.skin&&(r[h.mesh].isSkinnedMesh=!0)),void 0!==h.camera&&this._addNodeRef(this.cameraCache,h.camera)}},I.prototype._addNodeRef=function(t,n){void 0!==n&&(void 0===t.refs[n]&&(t.refs[n]=t.uses[n]=0),t.refs[n]++)},I.prototype._getNodeRef=function(t,n,r){if(t.refs[n]<=1)return r;var i=r.clone();return i.name+="_instance_"+t.uses[n]++,i},I.prototype._invokeOne=function(t){var n=Object.values(this.plugins);n.push(this);for(var r=0;r<n.length;r++){var i=t(n[r]);if(i)return i}},I.prototype._invokeAll=function(t){var n=Object.values(this.plugins);n.unshift(this);for(var r=[],i=0;i<n.length;i++){var o=t(n[i]);o&&r.push(o)}return r},I.prototype.getDependency=function(t,n){var r=t+":"+n,i=this.cache.get(r);if(!i){switch(t){case"scene":i=this.loadScene(n);break;case"node":i=this.loadNode(n);break;case"mesh":i=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(n)});break;case"accessor":i=this.loadAccessor(n);break;case"bufferView":i=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(n)});break;case"buffer":i=this.loadBuffer(n);break;case"material":i=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(n)});break;case"texture":i=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(n)});break;case"skin":i=this.loadSkin(n);break;case"animation":i=this.loadAnimation(n);break;case"camera":i=this.loadCamera(n);break;default:throw Error("Unknown type: "+t)}this.cache.add(r,i)}return i},I.prototype.getDependencies=function(t){var n=this.cache.get(t);if(!n){var r=this;n=Promise.all((this.json[t+("mesh"===t?"es":"s")]||[]).map(function(n,i){return r.getDependency(t,i)})),this.cache.add(t,n)}return n},I.prototype.loadBuffer=function(t){var n=this.json.buffers[t],i=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===t)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise(function(t,r){i.load(R(n.uri,o.path),t,void 0,function(){r(Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})},I.prototype.loadBufferView=function(t){var n=this.json.bufferViews[t];return this.getDependency("buffer",n.buffer).then(function(t){var r=n.byteLength||0,i=n.byteOffset||0;return t.slice(i,i+r)})},I.prototype.loadAccessor=function(t){var n=this,r=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var o=[];return void 0!==i.bufferView?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),void 0!==i.sparse&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then(function(t){var o,a,s=t[0],l=_[i.type],c=w[i.componentType],u=c.BYTES_PER_ELEMENT,h=u*l,d=i.byteOffset||0,p=void 0!==i.bufferView?r.bufferViews[i.bufferView].byteStride:void 0,f=!0===i.normalized;if(p&&p!==h){var m=Math.floor(d/p),v="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+m+":"+i.count,g=n.cache.get(v);g||(o=new c(s,m*p,i.count*p/u),g=new THREE.InterleavedBuffer(o,p/u),n.cache.add(v,g)),a=new THREE.InterleavedBufferAttribute(g,l,d%p/u,f)}else o=null===s?new c(i.count*l):new c(s,d,i.count*l),a=new THREE.BufferAttribute(o,l,f);if(void 0!==i.sparse){var y=_.SCALAR,b=w[i.sparse.indices.componentType],A=i.sparse.indices.byteOffset||0,x=i.sparse.values.byteOffset||0,E=new b(t[1],A,i.sparse.count*y),M=new c(t[2],x,i.sparse.count*l);null!==s&&(a=new THREE.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var T=0,S=E.length;T<S;T++){var C=E[T];if(a.setX(C,M[T*l]),l>=2&&a.setY(C,M[T*l+1]),l>=3&&a.setZ(C,M[T*l+2]),l>=4&&a.setW(C,M[T*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})},I.prototype.loadTexture=function(t){var n,i,o=this.json,a=this.options,s=o.textures[t],l=s.extensions||{};return(n=l[r.MSFT_TEXTURE_DDS]?o.images[l[r.MSFT_TEXTURE_DDS].source]:o.images[s.source]).uri&&(i=a.manager.getHandler(n.uri)),i||(i=l[r.MSFT_TEXTURE_DDS]?this.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(t,n,i)},I.prototype.loadTextureImage=function(t,n,r){var i=this,o=this.json,a=this.options,s=o.textures[t],l=self.URL||self.webkitURL,c=n.uri,u=!1,h=!0;return"image/jpeg"===n.mimeType&&(h=!1),void 0!==n.bufferView&&(c=i.getDependency("bufferView",n.bufferView).then(function(t){if("image/png"===n.mimeType){var r=new DataView(t,25,1).getUint8(0,!1);h=6===r||4===r||3===r}u=!0;var i=new Blob([t],{type:n.mimeType});return c=l.createObjectURL(i)})),Promise.resolve(c).then(function(t){return new Promise(function(n,i){var o=n;!0===r.isImageBitmapLoader&&(o=function(t){n(new THREE.CanvasTexture(t))}),r.load(R(t,a.path),o,void 0,i)})}).then(function(n){!0===u&&l.revokeObjectURL(c),n.flipY=!1,s.name&&(n.name=s.name),h||(n.format=THREE.RGBFormat);var r=(o.samplers||{})[s.sampler]||{};return n.magFilter=E[r.magFilter]||THREE.LinearFilter,n.minFilter=E[r.minFilter]||THREE.LinearMipmapLinearFilter,n.wrapS=M[r.wrapS]||THREE.RepeatWrapping,n.wrapT=M[r.wrapT]||THREE.RepeatWrapping,i.associations.set(n,{type:"textures",index:t}),n})},I.prototype.assignTexture=function(t,n,i){var o=this;return this.getDependency("texture",i.index).then(function(a){if(void 0===i.texCoord||0==i.texCoord||"aoMap"===n&&1==i.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+n+" not yet supported."),o.extensions[r.KHR_TEXTURE_TRANSFORM]){var s=void 0!==i.extensions?i.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(s){var l=o.associations.get(a);a=o.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(a,s),o.associations.set(a,l)}}t[n]=a})},I.prototype.assignFinalMaterial=function(t){var n=t.geometry,r=t.material,i=void 0!==n.attributes.tangent,o=void 0!==n.attributes.color,a=void 0===n.attributes.normal,s=!0===t.isSkinnedMesh,l=Object.keys(n.morphAttributes).length>0,c=l&&void 0!==n.morphAttributes.normal;if(t.isPoints){var u="PointsMaterial:"+r.uuid,h=this.cache.get(u);h||(h=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(h,r),h.color.copy(r.color),h.map=r.map,h.sizeAttenuation=!1,this.cache.add(u,h)),r=h}else if(t.isLine){var u="LineBasicMaterial:"+r.uuid,d=this.cache.get(u);d||(d=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(d,r),d.color.copy(r.color),this.cache.add(u,d)),r=d}if(i||o||a||s||l){var u="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),s&&(u+="skinning:"),i&&(u+="vertex-tangents:"),o&&(u+="vertex-colors:"),a&&(u+="flat-shading:"),l&&(u+="morph-targets:"),c&&(u+="morph-normals:");var p=this.cache.get(u);p||(p=r.clone(),s&&(p.skinning=!0),o&&(p.vertexColors=!0),a&&(p.flatShading=!0),l&&(p.morphTargets=!0),c&&(p.morphNormals=!0),i&&(p.vertexTangents=!0,r.normalScale&&(r.normalScale.y*=-1),r.clearcoatNormalScale&&(r.clearcoatNormalScale.y*=-1)),this.cache.add(u,p),this.associations.set(p,this.associations.get(r))),r=p}r.aoMap&&void 0===n.attributes.uv2&&void 0!==n.attributes.uv&&n.setAttribute("uv2",n.attributes.uv),t.material=r},I.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial},I.prototype.loadMaterial=function(t){var n,i=this,o=this.json,a=this.extensions,s=o.materials[t],l={},c=s.extensions||{},u=[];if(c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=h.getMaterialType(),u.push(h.extendParams(l,s,i))}else if(c[r.KHR_MATERIALS_UNLIT]){var d=a[r.KHR_MATERIALS_UNLIT];n=d.getMaterialType(),u.push(d.extendParams(l,s,i))}else{var p=s.pbrMetallicRoughness||{};if(l.color=new THREE.Color(1,1,1),l.opacity=1,Array.isArray(p.baseColorFactor)){var f=p.baseColorFactor;l.color.fromArray(f),l.opacity=f[3]}void 0!==p.baseColorTexture&&u.push(i.assignTexture(l,"map",p.baseColorTexture)),l.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,l.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(u.push(i.assignTexture(l,"metalnessMap",p.metallicRoughnessTexture)),u.push(i.assignTexture(l,"roughnessMap",p.metallicRoughnessTexture))),n=this._invokeOne(function(n){return n.getMaterialType&&n.getMaterialType(t)}),u.push(Promise.all(this._invokeAll(function(n){return n.extendMaterialParams&&n.extendMaterialParams(t,l)})))}!0===s.doubleSided&&(l.side=THREE.DoubleSide);var m=s.alphaMode||L.OPAQUE;return m===L.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,m===L.MASK&&(l.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&n!==THREE.MeshBasicMaterial&&(u.push(i.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new THREE.Vector2(1,-1),void 0!==s.normalTexture.scale&&l.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&n!==THREE.MeshBasicMaterial&&(u.push(i.assignTexture(l,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(l.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&n!==THREE.MeshBasicMaterial&&(l.emissive=new THREE.Color().fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&n!==THREE.MeshBasicMaterial&&u.push(i.assignTexture(l,"emissiveMap",s.emissiveTexture)),Promise.all(u).then(function(){var o;return o=n===g?a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):new n(l),s.name&&(o.name=s.name),o.map&&(o.map.encoding=THREE.sRGBEncoding),o.emissiveMap&&(o.emissiveMap.encoding=THREE.sRGBEncoding),D(o,s),i.associations.set(o,{type:"materials",index:t}),s.extensions&&P(a,o,s),o})},I.prototype.createUniqueName=function(t){for(var n=THREE.PropertyBinding.sanitizeNodeName(t||""),r=n,i=1;this.nodeNamesUsed[r];++i)r=n+"_"+i;return this.nodeNamesUsed[r]=!0,r},I.prototype.loadGeometries=function(t){for(var n=this,i=this.extensions,o=this.primitiveCache,a=[],s=0,l=t.length;s<l;s++){var c,u=t[s],h=function(t){var n=t.extensions&&t.extensions[r.KHR_DRACO_MESH_COMPRESSION];return n?"draco:"+n.bufferView+":"+n.indices+":"+O(n.attributes):t.indices+":"+O(t.attributes)+":"+t.mode}(u),d=o[h];d?a.push(d.promise):(c=u.extensions&&u.extensions[r.KHR_DRACO_MESH_COMPRESSION]?function(t){return i[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,n).then(function(r){return B(r,t,n)})}(u):B(new THREE.BufferGeometry,u,n),o[h]={primitive:u,promise:c},a.push(c))}return Promise.all(a)},I.prototype.loadMesh=function(t){for(var n=this,r=this.json,i=this.extensions,o=r.meshes[t],a=o.primitives,s=[],l=0,c=a.length;l<c;l++){var u,h=void 0===a[l].material?(void 0===(u=this.cache).DefaultMaterial&&(u.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),u.DefaultMaterial):this.getDependency("material",a[l].material);s.push(h)}return s.push(n.loadGeometries(a)),Promise.all(s).then(function(r){for(var s=r.slice(0,r.length-1),l=r[r.length-1],c=[],u=0,h=l.length;u<h;u++){var d,p=l[u],f=a[u],m=s[u];if(f.mode===x.TRIANGLES||f.mode===x.TRIANGLE_STRIP||f.mode===x.TRIANGLE_FAN||void 0===f.mode)d=!0===o.isSkinnedMesh?new THREE.SkinnedMesh(p,m):new THREE.Mesh(p,m),!0===m.isMeshStandardMaterial&&m.side===THREE.DoubleSide&&null!==p.getIndex()&&!0===p.hasAttribute("position")&&!0===p.hasAttribute("normal")&&!0===p.hasAttribute("uv")&&!1===p.hasAttribute("tangent")&&(p.computeTangents(),m.vertexTangents=!0),!0!==d.isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),f.mode===x.TRIANGLE_STRIP?d.geometry=F(d.geometry,THREE.TriangleStripDrawMode):f.mode===x.TRIANGLE_FAN&&(d.geometry=F(d.geometry,THREE.TriangleFanDrawMode));else if(f.mode===x.LINES)d=new THREE.LineSegments(p,m);else if(f.mode===x.LINE_STRIP)d=new THREE.Line(p,m);else if(f.mode===x.LINE_LOOP)d=new THREE.LineLoop(p,m);else if(f.mode===x.POINTS)d=new THREE.Points(p,m);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(d.geometry.morphAttributes).length>0&&function(t,n){if(t.updateMorphTargets(),void 0!==n.weights)for(var r=0,i=n.weights.length;r<i;r++)t.morphTargetInfluences[r]=n.weights[r];if(n.extras&&Array.isArray(n.extras.targetNames)){var o=n.extras.targetNames;if(t.morphTargetInfluences.length===o.length){t.morphTargetDictionary={};for(var r=0,i=o.length;r<i;r++)t.morphTargetDictionary[o[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(d,o),d.name=n.createUniqueName(o.name||"mesh_"+t),D(d,o),f.extensions&&P(i,d,f),n.assignFinalMaterial(d),c.push(d)}if(1===c.length)return c[0];for(var v=new THREE.Group,u=0,h=c.length;u<h;u++)v.add(c[u]);return v})},I.prototype.loadCamera=function(t){var n,r=this.json.cameras[t],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?n=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===r.type&&(n=new THREE.OrthographicCamera(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),D(n,r),Promise.resolve(n)},I.prototype.loadSkin=function(t){var n=this.json.skins[t],r={joints:n.joints};return void 0===n.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",n.inverseBindMatrices).then(function(t){return r.inverseBindMatrices=t,r})},I.prototype.loadAnimation=function(t){for(var n=this.json.animations[t],r=[],i=[],o=[],a=[],s=[],l=0,c=n.channels.length;l<c;l++){var u=n.channels[l],h=n.samplers[u.sampler],d=u.target,p=void 0!==d.node?d.node:d.id,f=void 0!==n.parameters?n.parameters[h.input]:h.input,m=void 0!==n.parameters?n.parameters[h.output]:h.output;r.push(this.getDependency("node",p)),i.push(this.getDependency("accessor",f)),o.push(this.getDependency("accessor",m)),a.push(h),s.push(d)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(o),Promise.all(a),Promise.all(s)]).then(function(r){for(var i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=[],u=0,h=i.length;u<h;u++){var d=i[u],p=o[u],f=a[u],m=s[u],v=l[u];if(void 0!==d){switch(d.updateMatrix(),d.matrixAutoUpdate=!0,S[v.path]){case S.weights:w=THREE.NumberKeyframeTrack;break;case S.rotation:w=THREE.QuaternionKeyframeTrack;break;case S.position:case S.scale:default:w=THREE.VectorKeyframeTrack}var g=d.name?d.name:d.uuid,y=void 0!==m.interpolation?C[m.interpolation]:THREE.InterpolateLinear,b=[];S[v.path]===S.weights?d.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&b.push(t.name?t.name:t.uuid)}):b.push(g);var x=f.array;if(f.normalized){if(x.constructor===Int8Array)E=1/127;else if(x.constructor===Uint8Array)E=1/255;else if(x.constructor==Int16Array)E=1/32767;else if(x.constructor===Uint16Array)E=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var w,E,M=new Float32Array(x.length),_=0,T=x.length;_<T;_++)M[_]=x[_]*E;x=M}for(var _=0,T=b.length;_<T;_++){var L=new w(b[_]+"."+S[v.path],p.array,x,y);"CUBICSPLINE"===m.interpolation&&(L.createInterpolant=function(t){return new A(this.times,this.values,this.getValueSize()/3,t)},L.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(L)}}}var R=n.name?n.name:"animation_"+t;return new THREE.AnimationClip(R,void 0,c)})},I.prototype.loadNode=function(t){var n,r=this.json,i=this.extensions,o=this,a=r.nodes[t],s=a.name?o.createUniqueName(a.name):"";return(n=[],void 0!==a.mesh&&n.push(o.getDependency("mesh",a.mesh).then(function(t){var n=o._getNodeRef(o.meshCache,a.mesh,t);return void 0!==a.weights&&n.traverse(function(t){if(t.isMesh)for(var n=0,r=a.weights.length;n<r;n++)t.morphTargetInfluences[n]=a.weights[n]}),n})),void 0!==a.camera&&n.push(o.getDependency("camera",a.camera).then(function(t){return o._getNodeRef(o.cameraCache,a.camera,t)})),o._invokeAll(function(n){return n.createNodeAttachment&&n.createNodeAttachment(t)}).forEach(function(t){n.push(t)}),Promise.all(n)).then(function(n){var r;if((r=!0===a.isBone?new THREE.Bone:n.length>1?new THREE.Group:1===n.length?n[0]:new THREE.Object3D)!==n[0])for(var l=0,c=n.length;l<c;l++)r.add(n[l]);if(a.name&&(r.userData.name=a.name,r.name=s),D(r,a),a.extensions&&P(i,r,a),void 0!==a.matrix){var u=new THREE.Matrix4;u.fromArray(a.matrix),r.applyMatrix4(u)}else void 0!==a.translation&&r.position.fromArray(a.translation),void 0!==a.rotation&&r.quaternion.fromArray(a.rotation),void 0!==a.scale&&r.scale.fromArray(a.scale);return o.associations.set(r,{type:"nodes",index:t}),r})},I.prototype.loadScene=function(t){var n=this.json,r=this.extensions,i=this.json.scenes[t],o=new THREE.Group;i.name&&(o.name=this.createUniqueName(i.name)),D(o,i),i.extensions&&P(r,o,i);for(var a=i.nodes||[],s=[],l=0,c=a.length;l<c;l++)s.push(function t(n,r,i,o){var a=i.nodes[n];return o.getDependency("node",n).then(function(t){var n;return void 0===a.skin?t:o.getDependency("skin",a.skin).then(function(t){n=t;for(var r=[],i=0,a=n.joints.length;i<a;i++)r.push(o.getDependency("node",n.joints[i]));return Promise.all(r)}).then(function(r){return t.traverse(function(t){if(t.isMesh){for(var i=[],o=[],a=0,s=r.length;a<s;a++){var l=r[a];if(l){i.push(l);var c=new THREE.Matrix4;void 0!==n.inverseBindMatrices&&c.fromArray(n.inverseBindMatrices.array,16*a),o.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[a])}t.bind(new THREE.Skeleton(i,o),t.matrixWorld)}}),t})}).then(function(n){r.add(n);var s=[];if(a.children)for(var l=a.children,c=0,u=l.length;c<u;c++){var h=l[c];s.push(t(h,n,i,o))}return Promise.all(s)})}(a[l],o,n,this));return Promise.all(s).then(function(){return o})},t}()},{}],60:[function(t,n,r){THREE.MTLLoader=function(t){THREE.Loader.call(this,t)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(t,n,r,i){var o=this,a=""===this.path?THREE.LoaderUtils.extractUrlBase(t):this.path,s=new THREE.FileLoader(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(r){try{n(o.parse(r,a))}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,n){for(var r=t.split("\n"),i={},o=/\s+/,a={},s=0;s<r.length;s++){var l=r[s];if(0!==(l=l.trim()).length&&"#"!==l.charAt(0)){var c=l.indexOf(" "),u=c>=0?l.substring(0,c):l;u=u.toLowerCase();var h=c>=0?l.substring(c+1):"";if(h=h.trim(),"newmtl"===u)i={name:h},a[h]=i;else if("ka"===u||"kd"===u||"ks"===u||"ke"===u){var d=h.split(o,3);i[u]=[parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2])]}else i[u]=h}}var p=new THREE.MTLLoader.MaterialCreator(this.resourcePath||n,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(a),p}}),THREE.MTLLoader.MaterialCreator=function(t,n){this.baseUrl=t||"",this.options=n,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var n={};for(var r in t){var i=t[r],o={};for(var a in n[r]=o,i){var s=!0,l=i[a],c=a.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(l=[l[0]/255,l[1]/255,l[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===l[0]&&0===l[1]&&0===l[2]&&(s=!1)}s&&(o[c]=l)}}return n},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0;for(var n in this.materialsInfo)this.materialsArray[t]=this.create(n),this.nameLookup[n]=t,t++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){var n=this,r=this.materialsInfo[t],i={name:t,side:this.side};function o(t,r){if(!i[t]){var o,a,s=n.getTextureParams(r,i),l=n.loadTexture((o=n.baseUrl,"string"!=typeof(a=s.url)||""===a?"":/^https?:\/\//i.test(a)?a:o+a));l.repeat.copy(s.scale),l.offset.copy(s.offset),l.wrapS=n.wrap,l.wrapT=n.wrap,i[t]=l}}for(var a in r){var s,l=r[a];if(""!==l)switch(a.toLowerCase()){case"kd":i.color=new THREE.Color().fromArray(l);break;case"ks":i.specular=new THREE.Color().fromArray(l);break;case"ke":i.emissive=new THREE.Color().fromArray(l);break;case"map_kd":o("map",l);break;case"map_ks":o("specularMap",l);break;case"map_ke":o("emissiveMap",l);break;case"norm":o("normalMap",l);break;case"map_bump":case"bump":o("bumpMap",l);break;case"map_d":o("alphaMap",l),i.transparent=!0;break;case"ns":i.shininess=parseFloat(l);break;case"d":(s=parseFloat(l))<1&&(i.opacity=s,i.transparent=!0);break;case"tr":s=parseFloat(l),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(i.opacity=1-s,i.transparent=!0)}}return this.materials[t]=new THREE.MeshPhongMaterial(i),this.materials[t]},getTextureParams:function(t,n){var r,i={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},o=t.split(/\s+/);return(r=o.indexOf("-bm"))>=0&&(n.bumpScale=parseFloat(o[r+1]),o.splice(r,2)),(r=o.indexOf("-s"))>=0&&(i.scale.set(parseFloat(o[r+1]),parseFloat(o[r+2])),o.splice(r,4)),(r=o.indexOf("-o"))>=0&&(i.offset.set(parseFloat(o[r+1]),parseFloat(o[r+2])),o.splice(r,4)),i.url=o.join(" ").trim(),i},loadTexture:function(t,n,r,i,o){var a,s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager,l=s.getHandler(t);return null===l&&(l=new THREE.TextureLoader(s)),l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin),a=l.load(t,r,i,o),void 0!==n&&(a.mapping=n),a}}},{}],61:[function(t,n,r){THREE.OBJLoader=function(){var t=/^[og]\s*(.+)?/,n=/^mtllib /,r=/^usemtl /,i=/^usemap /,o=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3;function u(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,n){if(this.object&&!1===this.object.fromDeclaration){this.object.name=t,this.object.fromDeclaration=!1!==n;return}var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==n,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,n){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var i={index:this.materials.length,name:t||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var n={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return n.clone=this.clone.bind(n),n}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var n=this.currentMaterial();if(n&&-1===n.groupEnd&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),t&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),n}},r&&r.name&&"function"==typeof r.clone){var i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,n){var r=parseInt(t,10);return(r>=0?r-1:r+n/3)*3},parseNormalIndex:function(t,n){var r=parseInt(t,10);return(r>=0?r-1:r+n/3)*3},parseUVIndex:function(t,n){var r=parseInt(t,10);return(r>=0?r-1:r+n/2)*2},addVertex:function(t,n,r){var i=this.vertices,o=this.object.geometry.vertices;o.push(i[t+0],i[t+1],i[t+2]),o.push(i[n+0],i[n+1],i[n+2]),o.push(i[r+0],i[r+1],i[r+2])},addVertexPoint:function(t){var n=this.vertices;this.object.geometry.vertices.push(n[t+0],n[t+1],n[t+2])},addVertexLine:function(t){var n=this.vertices;this.object.geometry.vertices.push(n[t+0],n[t+1],n[t+2])},addNormal:function(t,n,r){var i=this.normals,o=this.object.geometry.normals;o.push(i[t+0],i[t+1],i[t+2]),o.push(i[n+0],i[n+1],i[n+2]),o.push(i[r+0],i[r+1],i[r+2])},addFaceNormal:function(t,n,r){var i=this.vertices,u=this.object.geometry.normals;o.fromArray(i,t),a.fromArray(i,n),s.fromArray(i,r),c.subVectors(s,a),l.subVectors(o,a),c.cross(l),c.normalize(),u.push(c.x,c.y,c.z),u.push(c.x,c.y,c.z),u.push(c.x,c.y,c.z)},addColor:function(t,n,r){var i=this.colors,o=this.object.geometry.colors;void 0!==i[t]&&o.push(i[t+0],i[t+1],i[t+2]),void 0!==i[n]&&o.push(i[n+0],i[n+1],i[n+2]),void 0!==i[r]&&o.push(i[r+0],i[r+1],i[r+2])},addUV:function(t,n,r){var i=this.uvs,o=this.object.geometry.uvs;o.push(i[t+0],i[t+1]),o.push(i[n+0],i[n+1]),o.push(i[r+0],i[r+1])},addDefaultUV:function(){var t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){var n=this.uvs;this.object.geometry.uvs.push(n[t+0],n[t+1])},addFace:function(t,n,r,i,o,a,s,l,c){var u=this.vertices.length,h=this.parseVertexIndex(t,u),d=this.parseVertexIndex(n,u),p=this.parseVertexIndex(r,u);if(this.addVertex(h,d,p),this.addColor(h,d,p),void 0!==s&&""!==s){var f=this.normals.length;h=this.parseNormalIndex(s,f),d=this.parseNormalIndex(l,f),p=this.parseNormalIndex(c,f),this.addNormal(h,d,p)}else this.addFaceNormal(h,d,p);if(void 0!==i&&""!==i){var m=this.uvs.length;h=this.parseUVIndex(i,m),d=this.parseUVIndex(o,m),p=this.parseUVIndex(a,m),this.addUV(h,d,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";for(var n=this.vertices.length,r=0,i=t.length;r<i;r++){var o=this.parseVertexIndex(t[r],n);this.addVertexPoint(o),this.addColor(o)}},addLineGeometry:function(t,n){this.object.geometry.type="Line";for(var r=this.vertices.length,i=this.uvs.length,o=0,a=t.length;o<a;o++)this.addVertexLine(this.parseVertexIndex(t[o],r));for(var s=0,a=n.length;s<a;s++)this.addUVLine(this.parseUVIndex(n[s],i))}};return t.startObject("",!1),t}function h(t){THREE.Loader.call(this,t),this.materials=null}return h.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:h,load:function(t,n,r,i){var o=this,a=new THREE.FileLoader(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(r){try{n(o.parse(r))}catch(n){i?i(n):console.error(n),o.manager.itemError(t)}},r,i)},setMaterials:function(t){return this.materials=t,this},parse:function(o){var a=new u;-1!==o.indexOf("\r\n")&&(o=o.replace(/\r\n/g,"\n")),-1!==o.indexOf("\\\n")&&(o=o.replace(/\\\n/g,""));for(var s=o.split("\n"),l="",c="",h=[],d="function"==typeof"".trimLeft,p=0,f=s.length;p<f;p++)if(l=s[p],0!==(l=d?l.trimLeft():l.trim()).length&&"#"!==(c=l.charAt(0))){if("v"===c){var m=l.split(/\s+/);switch(m[0]){case"v":a.vertices.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m.length>=7?a.colors.push(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])):a.colors.push(void 0,void 0,void 0);break;case"vn":a.normals.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]));break;case"vt":a.uvs.push(parseFloat(m[1]),parseFloat(m[2]))}}else if("f"===c){for(var v=l.substr(1).trim(),g=v.split(/\s+/),y=[],b=0,A=g.length;b<A;b++){var x=g[b];if(x.length>0){var w=x.split("/");y.push(w)}}for(var E=y[0],b=1,A=y.length-1;b<A;b++){var M=y[b],_=y[b+1];a.addFace(E[0],M[0],_[0],E[1],M[1],_[1],E[2],M[2],_[2])}}else if("l"===c){var T=l.substring(1).trim().split(" "),S=[],C=[];if(-1===l.indexOf("/"))S=T;else for(var L=0,R=T.length;L<R;L++){var P=T[L].split("/");""!==P[0]&&S.push(P[0]),""!==P[1]&&C.push(P[1])}a.addLineGeometry(S,C)}else if("p"===c){var v=l.substr(1).trim(),D=v.split(" ");a.addPointGeometry(D)}else if(null!==(h=t.exec(l))){var O=(" "+h[0].substr(1).trim()).substr(1);a.startObject(O)}else if(r.test(l))a.object.startMaterial(l.substring(7).trim(),a.materialLibraries);else if(n.test(l))a.materialLibraries.push(l.substring(7).trim());else if(i.test(l))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===c){if((h=l.split(" ")).length>1){var I=h[1].trim().toLowerCase();a.object.smooth="0"!==I&&"off"!==I}else a.object.smooth=!0;var B=a.object.currentMaterial();B&&(B.smooth=a.object.smooth)}else{if("\0"===l)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+l+'"')}}a.finalize();var F=new THREE.Group;if(F.materialLibraries=[].concat(a.materialLibraries),!0==!(1===a.objects.length&&0===a.objects[0].geometry.vertices.length))for(var p=0,f=a.objects.length;p<f;p++){var k,N=a.objects[p],U=N.geometry,H=N.materials,G="Line"===U.type,z="Points"===U.type,j=!1;if(0!==U.vertices.length){var V=new THREE.BufferGeometry;V.setAttribute("position",new THREE.Float32BufferAttribute(U.vertices,3)),U.normals.length>0&&V.setAttribute("normal",new THREE.Float32BufferAttribute(U.normals,3)),U.colors.length>0&&(j=!0,V.setAttribute("color",new THREE.Float32BufferAttribute(U.colors,3))),!0===U.hasUVIndices&&V.setAttribute("uv",new THREE.Float32BufferAttribute(U.uvs,2));for(var W=[],q=0,X=H.length;q<X;q++){var Y=H[q],Q=Y.name+"_"+Y.smooth+"_"+j,B=a.materials[Q];if(null!==this.materials){if(B=this.materials.create(Y.name),!G||!B||B instanceof THREE.LineBasicMaterial){if(z&&B&&!(B instanceof THREE.PointsMaterial)){var Z=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(Z,B),Z.color.copy(B.color),Z.map=B.map,B=Z}}else{var K=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(K,B),K.color.copy(B.color),B=K}}void 0===B&&((B=G?new THREE.LineBasicMaterial:z?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=Y.name,B.flatShading=!Y.smooth,B.vertexColors=j,a.materials[Q]=B),W.push(B)}if(W.length>1){for(var q=0,X=H.length;q<X;q++){var Y=H[q];V.addGroup(Y.groupStart,Y.groupCount,q)}k=G?new THREE.LineSegments(V,W):z?new THREE.Points(V,W):new THREE.Mesh(V,W)}else k=G?new THREE.LineSegments(V,W[0]):z?new THREE.Points(V,W[0]):new THREE.Mesh(V,W[0]);k.name=N.name,F.add(k)}}else if(a.vertices.length>0){var B=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),V=new THREE.BufferGeometry;V.setAttribute("position",new THREE.Float32BufferAttribute(a.vertices,3)),a.colors.length>0&&void 0!==a.colors[0]&&(V.setAttribute("color",new THREE.Float32BufferAttribute(a.colors,3)),B.vertexColors=!0);var J=new THREE.Points(V,B);F.add(J)}return F}}),h}()},{}],62:[function(t,n,r){THREE.BufferGeometryUtils={computeTangents:function(t){t.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(t,n){for(var r=null!==t[0].index,i=new Set(Object.keys(t[0].attributes)),o=new Set(Object.keys(t[0].morphAttributes)),a={},s={},l=t[0].morphTargetsRelative,c=new THREE.BufferGeometry,u=0,h=0;h<t.length;++h){var d,p=t[h],f=0;if(r!==(null!==p.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var m in p.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[m]&&(a[m]=[]),a[m].push(p.attributes[m]),f++}if(f!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(l!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var m in p.morphAttributes){if(!o.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===s[m]&&(s[m]=[]),s[m].push(p.morphAttributes[m])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(p.userData),n){if(r)d=p.index.count;else{if(void 0===p.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;d=p.attributes.position.count}c.addGroup(u,d,h),u+=d}}if(r){for(var v=0,g=[],h=0;h<t.length;++h){for(var y=t[h].index,b=0;b<y.count;++b)g.push(y.getX(b)+v);v+=t[h].attributes.position.count}c.setIndex(g)}for(var m in a){var A=this.mergeBufferAttributes(a[m]);if(!A)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+m+" attribute."),null;c.setAttribute(m,A)}for(var m in s){var x=s[m][0].length;if(0===x)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[m]=[];for(var h=0;h<x;++h){for(var w=[],b=0;b<s[m].length;++b)w.push(s[m][b][h]);var E=this.mergeBufferAttributes(w);if(!E)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+m+" morphAttribute."),null;c.morphAttributes[m].push(E)}}return c},mergeBufferAttributes:function(t){for(var n,r,i,o=0,a=0;a<t.length;++a){var s=t[a];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===n&&(n=s.array.constructor),n!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=s.itemSize),r!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=s.normalized),i!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;o+=s.array.length}for(var l=new n(o),c=0,a=0;a<t.length;++a)l.set(t[a].array,c),c+=t[a].array.length;return new THREE.BufferAttribute(l,r,i)},interleaveAttributes:function(t){for(var n,r=0,i=0,o=0,a=t.length;o<a;++o){var s=t[o];if(void 0===n&&(n=s.array.constructor),n!==s.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;r+=s.array.length,i+=s.itemSize}for(var l=new THREE.InterleavedBuffer(new n(r),i),c=0,u=[],h=["getX","getY","getZ","getW"],d=["setX","setY","setZ","setW"],p=0,a=t.length;p<a;p++){var s=t[p],f=s.itemSize,m=s.count,v=new THREE.InterleavedBufferAttribute(l,f,c,s.normalized);u.push(v),c+=f;for(var g=0;g<m;g++)for(var y=0;y<f;y++)v[d[y]](g,s[h[y]](g))}return u},estimateBytesUsed:function(t){var n=0;for(var r in t.attributes){var i=t.getAttribute(r);n+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}var o=t.getIndex();return n+(o?o.count*o.itemSize*o.array.BYTES_PER_ELEMENT:0)},mergeVertices:function(t,n=1e-4){n=Math.max(n,Number.EPSILON);for(var r={},i=t.getIndex(),o=t.getAttribute("position"),a=i?i.count:o.count,s=0,l=Object.keys(t.attributes),c={},u={},h=[],d=["getX","getY","getZ","getW"],p=0,f=l.length;p<f;p++){var m=l[p];c[m]=[];var v=t.morphAttributes[m];v&&(u[m]=Array(v.length).fill().map(()=>[]))}for(var g=Math.pow(10,Math.log10(1/n)),p=0;p<a;p++){for(var y=i?i.getX(p):p,b="",A=0,f=l.length;A<f;A++)for(var m=l[A],x=t.getAttribute(m),w=x.itemSize,E=0;E<w;E++)b+=`${~~(x[d[E]](y)*g)},`;if(b in r)h.push(r[b]);else{for(var A=0,f=l.length;A<f;A++)for(var m=l[A],x=t.getAttribute(m),v=t.morphAttributes[m],w=x.itemSize,M=c[m],_=u[m],E=0;E<w;E++){var T=d[E];if(M.push(x[T](y)),v)for(var S=0,C=v.length;S<C;S++)_[S].push(v[S][T](y))}r[b]=s,h.push(s),s++}}let L=t.clone();for(var p=0,f=l.length;p<f;p++){var m=l[p],R=t.getAttribute(m),P=new R.array.constructor(c[m]),x=new THREE.BufferAttribute(P,R.itemSize,R.normalized);if(L.setAttribute(m,x),m in u)for(var A=0;A<u[m].length;A++){var D=t.morphAttributes[m][A],P=new D.array.constructor(u[m][A]),O=new THREE.BufferAttribute(P,D.itemSize,D.normalized);L.morphAttributes[m][A]=O}}return L.setIndex(h),L},toTrianglesDrawMode:function(t,n){if(n===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(n!==THREE.TriangleFanDrawMode&&n!==THREE.TriangleStripDrawMode)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",n),t;var r=t.getIndex();if(null===r){var i=[],o=t.getAttribute("position");if(void 0===o)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var a=0;a<o.count;a++)i.push(a);t.setIndex(i),r=t.getIndex()}var s=r.count-2,l=[];if(n===THREE.TriangleFanDrawMode)for(var a=1;a<=s;a++)l.push(r.getX(0)),l.push(r.getX(a)),l.push(r.getX(a+1));else for(var a=0;a<s;a++)a%2==0?(l.push(r.getX(a)),l.push(r.getX(a+1)),l.push(r.getX(a+2))):(l.push(r.getX(a+2)),l.push(r.getX(a+1)),l.push(r.getX(a)));l.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=t.clone();return c.setIndex(l),c.clearGroups(),c},computeMorphedAttributes:function(t){if(!0!==t.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var n,r,i,o,a,s,l,c,u,h,d,p=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,v=new THREE.Vector3,g=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector3,A=new THREE.Vector3,x=new THREE.Vector3;function w(t,n,r,i,o,a,s,l,c){p.fromBufferAttribute(r,a),f.fromBufferAttribute(r,s),m.fromBufferAttribute(r,l);var u=t.morphTargetInfluences;if(n.morphTargets&&i&&u){b.set(0,0,0),A.set(0,0,0),x.set(0,0,0);for(var h=0,d=i.length;h<d;h++){var w=u[h],i=i[h];0!==w&&(v.fromBufferAttribute(i,a),g.fromBufferAttribute(i,s),y.fromBufferAttribute(i,l),o?(b.addScaledVector(v,w),A.addScaledVector(g,w),x.addScaledVector(y,w)):(b.addScaledVector(v.sub(p),w),A.addScaledVector(g.sub(f),w),x.addScaledVector(y.sub(m),w)))}p.add(b),f.add(A),m.add(x)}t.isSkinnedMesh&&(t.boneTransform(a,p),t.boneTransform(s,f),t.boneTransform(l,m)),c[3*a+0]=p.x,c[3*a+1]=p.y,c[3*a+2]=p.z,c[3*s+0]=f.x,c[3*s+1]=f.y,c[3*s+2]=f.z,c[3*l+0]=m.x,c[3*l+1]=m.y,c[3*l+2]=m.z}var E=t.geometry,M=t.material,_=E.index,T=E.attributes.position,S=E.morphAttributes.position,C=E.morphTargetsRelative,L=E.attributes.normal,R=E.morphAttributes.position,P=E.groups,D=E.drawRange,O=new Float32Array(T.count*T.itemSize),I=new Float32Array(L.count*L.itemSize);if(null!==_){if(Array.isArray(M))for(o=0,s=P.length;o<s;o++)for(u=M[(c=P[o]).materialIndex],h=Math.max(c.start,D.start),d=Math.min(c.start+c.count,D.start+D.count),a=h,l=d;a<l;a+=3)w(t,u,T,S,C,n=_.getX(a),r=_.getX(a+1),i=_.getX(a+2),O),w(t,u,L,R,C,n,r,i,I);else for(h=Math.max(0,D.start),d=Math.min(_.count,D.start+D.count),o=h,s=d;o<s;o+=3)w(t,M,T,S,C,n=_.getX(o),r=_.getX(o+1),i=_.getX(o+2),O),w(t,M,L,R,C,n,r,i,I)}else if(void 0!==T){if(Array.isArray(M))for(o=0,s=P.length;o<s;o++)for(u=M[(c=P[o]).materialIndex],h=Math.max(c.start,D.start),d=Math.min(c.start+c.count,D.start+D.count),a=h,l=d;a<l;a+=3)w(t,u,T,S,C,n=a,r=a+1,i=a+2,O),w(t,u,L,R,C,n,r,i,I);else for(h=Math.max(0,D.start),d=Math.min(T.count,D.start+D.count),o=h,s=d;o<s;o+=3)w(t,M,T,S,C,n=o,r=o+1,i=o+2,O),w(t,M,L,R,C,n,r,i,I)}return{positionAttribute:T,normalAttribute:L,morphedPositionAttribute:new THREE.Float32BufferAttribute(O,3),morphedNormalAttribute:new THREE.Float32BufferAttribute(I,3)}}}},{}],63:[function(t,n,r){var i=t("layout-bmfont-text"),o=t("inherits"),a=t("quad-indices"),s=t("three-buffer-vertex-data"),l=t("object-assign"),c=t("./lib/vertices"),u=t("./lib/utils"),h=THREE.BufferGeometry;function d(t){h.call(this),"string"==typeof t&&(t={text:t}),this._opt=l({},t),t&&this.update(t)}n.exports=function(t){return new d(t)},o(d,h),d.prototype.update=function(t){if("string"==typeof t&&(t={text:t}),!(t=l({},this._opt,t)).font)throw TypeError("must specify a { font } in options");this.layout=i(t);var n=!1!==t.flipY,r=t.font,o=r.common.scaleW,u=r.common.scaleH,h=this.layout.glyphs.filter(function(t){var n=t.data;return n.width*n.height>0});this.visibleGlyphs=h;var d=c.positions(h),p=c.uvs(h,o,u,n),f=a({clockwise:!0,type:"uint16",count:h.length});if(s.index(this,f,1,"uint16"),s.attr(this,"position",d,2),s.attr(this,"uv",p,2),!t.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(t.multipage){var m=c.pages(h);s.attr(this,"page",m,1)}},d.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var t=this.attributes.position.array,n=this.attributes.position.itemSize;if(!t||!n||t.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}u.computeSphere(t,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},d.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.boundingBox,n=this.attributes.position.array,r=this.attributes.position.itemSize;if(!n||!r||n.length<2){t.makeEmpty();return}u.computeBox(n,t)}},{"./lib/utils":64,"./lib/vertices":65,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":66}],64:[function(t,n,r){var i={min:[0,0],max:[0,0]};function o(t){var n=t.length/2;i.min[0]=t[0],i.min[1]=t[1],i.max[0]=t[0],i.max[1]=t[1];for(var r=0;r<n;r++){var o=t[2*r+0],a=t[2*r+1];i.min[0]=Math.min(o,i.min[0]),i.min[1]=Math.min(a,i.min[1]),i.max[0]=Math.max(o,i.max[0]),i.max[1]=Math.max(a,i.max[1])}}n.exports.computeBox=function(t,n){o(t),n.min.set(i.min[0],i.min[1],0),n.max.set(i.max[0],i.max[1],0)},n.exports.computeSphere=function(t,n){o(t);var r=i.min[0],a=i.min[1],s=i.max[0],l=i.max[1],c=s-r,u=l-a,h=Math.sqrt(c*c+u*u);n.center.set(r+c/2,a+u/2,0),n.radius=h/2}},{}],65:[function(t,n,r){n.exports.pages=function(t){var n=new Float32Array(4*t.length),r=0;return t.forEach(function(t){var i=t.data.page||0;n[r++]=i,n[r++]=i,n[r++]=i,n[r++]=i}),n},n.exports.uvs=function(t,n,r,i){var o=new Float32Array(8*t.length),a=0;return t.forEach(function(t){var s=t.data,l=s.x+s.width,c=s.y+s.height,u=s.x/n,h=s.y/r,d=l/n,p=c/r;i&&(h=(r-s.y)/r,p=(r-c)/r),o[a++]=u,o[a++]=h,o[a++]=u,o[a++]=p,o[a++]=d,o[a++]=p,o[a++]=d,o[a++]=h}),o},n.exports.positions=function(t){var n=new Float32Array(8*t.length),r=0;return t.forEach(function(t){var i=t.data,o=t.position[0]+i.xoffset,a=t.position[1]+i.yoffset,s=i.width,l=i.height;n[r++]=o,n[r++]=a,n[r++]=o,n[r++]=a+l,n[r++]=o+s,n[r++]=a+l,n[r++]=o+s,n[r++]=a}),n}},{}],66:[function(t,n,r){var i=t("flatten-vertex-data");function o(t,n,r,o){return n=i(n=n||[],o),(t=new THREE.BufferAttribute(n,r)).itemSize=r,t.needsUpdate=!0,t}n.exports.attr=function(t,n,r,i,a){if("number"!=typeof i&&(i=3),"string"!=typeof a&&(a="float32"),Array.isArray(r)&&Array.isArray(r[0])&&r[0].length!==i)throw Error("Nested vertex array has unexpected size; expected "+i+" but found "+r[0].length);var s=o(t.getAttribute(n),r,i,a);t.setAttribute(n,s)},n.exports.index=function(t,n,r,i){"number"!=typeof r&&(r=1),"string"!=typeof i&&(i="uint16");var a=!t.index&&"function"!=typeof t.setIndex,s=o(a?t.getAttribute("index"):t.index,n,r,i);s&&(a?t.addAttribute("index",s):t.index=s)}},{"flatten-vertex-data":23}],67:[function(t,n,r){(function(n,i){var o=t("process/browser.js").nextTick,a=Function.prototype.apply,s=Array.prototype.slice,l={},c=0;function u(t,n){this._id=t,this._clearFn=n}r.setTimeout=function(){return new u(a.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new u(a.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},r.setImmediate="function"==typeof n?n:function(t){var n=c++,i=!(arguments.length<2)&&s.call(arguments,1);return l[n]=!0,o(function(){l[n]&&(i?t.apply(null,i):t.call(null),r.clearImmediate(n))}),n},r.clearImmediate="function"==typeof i?i:function(t){delete l[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":49,timers:67}],68:[function(n,i,o){(function(n){var r;r=function(){"use strict";var t,r,i,o,a,s="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},l=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},c=function(t,n){for(var r=0,i=t.length;r<i;r++)n[r]=t[r]},u=function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t},h=(t=o={exports:{}},r=o.exports,i=function(){var t,n,r,i,o,a,l,c,u,h,d,p,f,m,v,g,y=function(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")},b=function(){function t(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,r,i){return r&&t(n.prototype,r),i&&t(n,i),n}}(),A=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var r=[],i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done)&&(r.push(s.value),!n||r.length!==n);i=!0);}catch(t){o=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return r}(t,n);throw TypeError("Invalid attempt to destructure non-iterable instance")},x=function(t,n,r){return t+(n-t)*r},w=(i=/iPad|iPhone|iPod/.test(navigator.platform),function(){return i}),E=(o=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome"),function(){return o}),M=(a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){return a}),_=(l=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android"),function(){return l}),T=(u=(c=navigator.userAgent.match(/.*Chrome\/([0-9]+)/))?parseInt(c[1],10):null,function(){return u}),S=(h=!1,h=w()&&M()&&-1!==navigator.userAgent.indexOf("13_4"),function(){return h}),C=function(){var t=!1;if(65===T()){var n=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(n){var r=A(n[1].split("."),4),i=(r[0],r[1],r[2]),o=r[3];t=3325===parseInt(i,10)&&148>parseInt(o,10)}}return function(){return t}}(),L=(d=-1!==navigator.userAgent.indexOf("R7 Build"),function(){return d}),R=function(){var t=90==window.orientation||-90==window.orientation;return L()?!t:t},P=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},D=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},O=function(t){if(E())return!1;if(t.requestFullscreen)t.requestFullscreen();else if(t.webkitRequestFullscreen)t.webkitRequestFullscreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else{if(!t.msRequestFullscreen)return!1;t.msRequestFullscreen()}return!0},I=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},B=function(t,n,r,i){var o=t.createShader(t.VERTEX_SHADER);t.shaderSource(o,n),t.compileShader(o);var a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,r),t.compileShader(a);var s=t.createProgram();for(var l in t.attachShader(s,o),t.attachShader(s,a),i)t.bindAttribLocation(s,i[l],l);return t.linkProgram(s),t.deleteShader(o),t.deleteShader(a),s},F=function(t,n){for(var r={},i=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),o="",a=0;a<i;a++)r[o=t.getActiveUniform(n,a).name.replace("[0]","")]=t.getUniformLocation(n,o);return r},k=function(t,n,r,i,o,a,s){var l=1/(n-r),c=1/(i-o),u=1/(a-s);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(n+r)*l,t[13]=(o+i)*c,t[14]=(s+a)*u,t[15]=1,t},N=function(){var t,n=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0),n},U=function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return t},H=function(t){if(w()){var n=t.style.width,r=t.style.height;t.style.width=parseInt(n)+1+"px",t.style.height=parseInt(r)+"px",setTimeout(function(){t.style.width=n,t.style.height=r},100)}window.canvas=t},G=function(){var t=Math.PI/180,n=.25*Math.PI,r=new Float32Array([0,0,0,1]),i=new Float32Array([0,0,0]);function o(o,a,s,l,c,u){h=l||null,d=u.depthNear,p=u.depthFar,f=Math.tan(h?h.upDegrees*t:n),m=Math.tan(h?h.downDegrees*t:n),y=2/((v=Math.tan(h?h.leftDegrees*t:n))+(g=Math.tan(h?h.rightDegrees*t:n))),b=2/(f+m),o[0]=y,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=b,o[6]=0,o[7]=0,o[8]=-((v-g)*y*.5),o[9]=(f-m)*b*.5,o[10]=p/(d-p),o[11]=-1,o[12]=0,o[13]=0,o[14]=p*d/(d-p),o[15]=0;var h,d,p,f,m,v,g,y,b,A,x,w,E,M,_,T,S,C,L,R,P,D,O,I,B,F,k,N,U,H,G,z,j,V,W,q,X,Y,Q,Z,K,J,$,ee,et,en,er,ei,eo,ea,es,el,ec,eu,eh,ed,ep,ef,em,ev,eg,ey,eb,eA,ex,ew,eE,eM,e_,eT=s.orientation||r,eS=s.position||i;A=eT[0],x=eT[1],w=eT[2],E=eT[3],M=A+A,_=x+x,T=w+w,S=A*M,C=A*_,L=A*T,R=x*_,P=x*T,D=w*T,O=E*M,I=E*_,B=E*T,a[0]=1-(R+D),a[1]=C+B,a[2]=L-I,a[3]=0,a[4]=C-B,a[5]=1-(S+D),a[6]=P+O,a[7]=0,a[8]=L+I,a[9]=P-O,a[10]=1-(S+R),a[11]=0,a[12]=eS[0],a[13]=eS[1],a[14]=eS[2],a[15]=1,c&&(Y=c[0],Q=c[1],Z=c[2],a==a?(a[12]=a[0]*Y+a[4]*Q+a[8]*Z+a[12],a[13]=a[1]*Y+a[5]*Q+a[9]*Z+a[13],a[14]=a[2]*Y+a[6]*Q+a[10]*Z+a[14],a[15]=a[3]*Y+a[7]*Q+a[11]*Z+a[15]):(F=a[0],k=a[1],N=a[2],U=a[3],H=a[4],G=a[5],z=a[6],j=a[7],V=a[8],W=a[9],q=a[10],X=a[11],a[0]=F,a[1]=k,a[2]=N,a[3]=U,a[4]=H,a[5]=G,a[6]=z,a[7]=j,a[8]=V,a[9]=W,a[10]=q,a[11]=X,a[12]=F*Y+H*Q+V*Z+a[12],a[13]=k*Y+G*Q+W*Z+a[13],a[14]=N*Y+z*Q+q*Z+a[14],a[15]=U*Y+j*Q+X*Z+a[15])),K=a[0],J=a[1],$=a[2],ee=a[3],et=a[4],en=a[5],er=a[6],ei=a[7],eo=a[8],ea=a[9],es=a[10],el=a[11],ec=a[12],eu=a[13],eh=a[14],ed=a[15],ep=K*en-J*et,ef=K*er-$*et,em=K*ei-ee*et,ev=J*er-$*en,eg=J*ei-ee*en,ey=$*ei-ee*er,eb=eo*eu-ea*ec,eA=eo*eh-es*ec,ex=eo*ed-el*ec,ew=ea*eh-es*eu,eE=ea*ed-el*eu,(e_=ep*(eM=es*ed-el*eh)-ef*eE+em*ew+ev*ex-eg*eA+ey*eb)&&(e_=1/e_,a[0]=(en*eM-er*eE+ei*ew)*e_,a[1]=($*eE-J*eM-ee*ew)*e_,a[2]=(eu*ey-eh*eg+ed*ev)*e_,a[3]=(es*eg-ea*ey-el*ev)*e_,a[4]=(er*ex-et*eM-ei*eA)*e_,a[5]=(K*eM-$*ex+ee*eA)*e_,a[6]=(eh*em-ec*ey-ed*ef)*e_,a[7]=(eo*ey-es*em+el*ef)*e_,a[8]=(et*eE-en*ex+ei*eb)*e_,a[9]=(J*ex-K*eE-ee*eb)*e_,a[10]=(ec*eg-eu*em+ed*ep)*e_,a[11]=(ea*em-eo*eg-el*ep)*e_,a[12]=(en*eA-et*ew-er*eb)*e_,a[13]=(K*ew-J*eA+$*eb)*e_,a[14]=(eu*ef-ec*ev-eh*ep)*e_,a[15]=(eo*ev-ea*ef+es*ep)*e_)}return function(t,n,r){return!!t&&!!n&&(t.pose=n,t.timestamp=n.timestamp,o(t.leftProjectionMatrix,t.leftViewMatrix,n,r._getFieldOfView("left"),r._getEyeOffset("left"),r),o(t.rightProjectionMatrix,t.rightViewMatrix,n,r._getFieldOfView("right"),r._getEyeOffset("right"),r),!0)}}(),z=function(){var t=window.self!==window.top,n=j(document.referrer),r=j(window.location.href);return t&&n!==r},j=function(t){var n,r=t.indexOf("://");n=-1!==r?r+3:0;var i=t.indexOf("/",n);return -1===i&&(i=t.length),t.substring(0,i)},V=(p={},function(t,n){void 0===p[t]&&(console.warn("webvr-polyfill: "+n),p[t]=!0)}),W=function(t,n){V(t,t+" has been deprecated. This may not work on native WebVR displays. "+(n?"Please use "+n+" instead.":""))},q=function(t,n,r){if(!n){r(t);return}for(var i=[],o=null,a=0;a<n.length;++a){var s=n[a];switch(s){case t.TEXTURE_BINDING_2D:case t.TEXTURE_BINDING_CUBE_MAP:var l=n[++a];if(l<t.TEXTURE0||l>t.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),i.push(null,null);break}o||(o=t.getParameter(t.ACTIVE_TEXTURE)),t.activeTexture(l),i.push(t.getParameter(s),null);break;case t.ACTIVE_TEXTURE:o=t.getParameter(t.ACTIVE_TEXTURE),i.push(null);break;default:i.push(t.getParameter(s))}}r(t);for(var a=0;a<n.length;++a){var s=n[a],c=i[a];switch(s){case t.ACTIVE_TEXTURE:break;case t.ARRAY_BUFFER_BINDING:t.bindBuffer(t.ARRAY_BUFFER,c);break;case t.COLOR_CLEAR_VALUE:t.clearColor(c[0],c[1],c[2],c[3]);break;case t.COLOR_WRITEMASK:t.colorMask(c[0],c[1],c[2],c[3]);break;case t.CURRENT_PROGRAM:t.useProgram(c);break;case t.ELEMENT_ARRAY_BUFFER_BINDING:t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c);break;case t.FRAMEBUFFER_BINDING:t.bindFramebuffer(t.FRAMEBUFFER,c);break;case t.RENDERBUFFER_BINDING:t.bindRenderbuffer(t.RENDERBUFFER,c);break;case t.TEXTURE_BINDING_2D:var l=n[++a];if(l<t.TEXTURE0||l>t.TEXTURE31)break;t.activeTexture(l),t.bindTexture(t.TEXTURE_2D,c);break;case t.TEXTURE_BINDING_CUBE_MAP:var l=n[++a];if(l<t.TEXTURE0||l>t.TEXTURE31)break;t.activeTexture(l),t.bindTexture(t.TEXTURE_CUBE_MAP,c);break;case t.VIEWPORT:t.viewport(c[0],c[1],c[2],c[3]);break;case t.BLEND:case t.CULL_FACE:case t.DEPTH_TEST:case t.SCISSOR_TEST:case t.STENCIL_TEST:c?t.enable(s):t.disable(s);break;default:console.log("No GL restore behavior for 0x"+s.toString(16))}o&&t.activeTexture(o)}};function X(t,n,r,i){this.gl=t,this.cardboardUI=n,this.bufferScale=r,this.dirtySubmitFrameBindings=i,this.ctxAttribs=t.getContextAttributes(),this.instanceExt=t.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=t.drawingBufferWidth,this.bufferHeight=t.drawingBufferHeight,this.realBindFramebuffer=t.bindFramebuffer,this.realEnable=t.enable,this.realDisable=t.disable,this.realColorMask=t.colorMask,this.realClearColor=t.clearColor,this.realViewport=t.viewport,w()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(t.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(t.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=B(t,"attribute vec2 position;\nattribute vec3 texCoord;\nvarying vec2 vTexCoord;\nuniform vec4 viewportOffsetScale[2];\nvoid main() {\n  vec4 viewport = viewportOffsetScale[int(texCoord.z)];\n  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;\n  gl_Position = vec4( position, 1.0, 1.0 );\n}","precision mediump float;\nuniform sampler2D diffuse;\nvarying vec2 vTexCoord;\nvoid main() {\n  gl_FragColor = texture2D(diffuse, vTexCoord);\n}",this.attribs),this.uniforms=F(t,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.indexCount=0,this.renderTarget=t.createTexture(),this.framebuffer=t.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=t.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=t.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=t.createRenderbuffer()),this.patch(),this.onResize()}X.prototype.destroy=function(){var t=this.gl;this.unpatch(),t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer),t.deleteTexture(this.renderTarget),t.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&t.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&t.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&t.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},X.prototype.onResize=function(){var t=this.gl,n=this,r=[t.RENDERBUFFER_BINDING,t.TEXTURE_BINDING_2D,t.TEXTURE0];q(t,r,function(t){n.realBindFramebuffer.call(t,t.FRAMEBUFFER,null),n.scissorTest&&n.realDisable.call(t,t.SCISSOR_TEST),n.realColorMask.call(t,!0,!0,!0,!0),n.realViewport.call(t,0,0,t.drawingBufferWidth,t.drawingBufferHeight),n.realClearColor.call(t,0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),n.realBindFramebuffer.call(t,t.FRAMEBUFFER,n.framebuffer),t.bindTexture(t.TEXTURE_2D,n.renderTarget),t.texImage2D(t.TEXTURE_2D,0,n.ctxAttribs.alpha?t.RGBA:t.RGB,n.bufferWidth,n.bufferHeight,0,n.ctxAttribs.alpha?t.RGBA:t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.renderTarget,0),n.ctxAttribs.depth&&n.ctxAttribs.stencil?(t.bindRenderbuffer(t.RENDERBUFFER,n.depthStencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.bufferWidth,n.bufferHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,n.depthStencilBuffer)):n.ctxAttribs.depth?(t.bindRenderbuffer(t.RENDERBUFFER,n.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.bufferWidth,n.bufferHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n.depthBuffer)):n.ctxAttribs.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,n.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.STENCIL_INDEX8,n.bufferWidth,n.bufferHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,n.stencilBuffer)),!t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),n.realBindFramebuffer.call(t,t.FRAMEBUFFER,n.lastBoundFramebuffer),n.scissorTest&&n.realEnable.call(t,t.SCISSOR_TEST),n.realColorMask.apply(t,n.colorMask),n.realViewport.apply(t,n.viewport),n.realClearColor.apply(t,n.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},X.prototype.patch=function(){if(!this.isPatched){var t=this,n=this.gl.canvas,r=this.gl;w()||(n.width=P()*this.bufferScale,n.height=D()*this.bufferScale,Object.defineProperty(n,"width",{configurable:!0,enumerable:!0,get:function(){return t.bufferWidth},set:function(r){t.bufferWidth=r,t.realCanvasWidth.set.call(n,r),t.onResize()}}),Object.defineProperty(n,"height",{configurable:!0,enumerable:!0,get:function(){return t.bufferHeight},set:function(r){t.bufferHeight=r,t.realCanvasHeight.set.call(n,r),t.onResize()}})),this.lastBoundFramebuffer=r.getParameter(r.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(n,i){t.lastBoundFramebuffer=i||t.framebuffer,t.realBindFramebuffer.call(r,n,t.lastBoundFramebuffer)},this.cullFace=r.getParameter(r.CULL_FACE),this.depthTest=r.getParameter(r.DEPTH_TEST),this.blend=r.getParameter(r.BLEND),this.scissorTest=r.getParameter(r.SCISSOR_TEST),this.stencilTest=r.getParameter(r.STENCIL_TEST),r.enable=function(n){switch(n){case r.CULL_FACE:t.cullFace=!0;break;case r.DEPTH_TEST:t.depthTest=!0;break;case r.BLEND:t.blend=!0;break;case r.SCISSOR_TEST:t.scissorTest=!0;break;case r.STENCIL_TEST:t.stencilTest=!0}t.realEnable.call(r,n)},r.disable=function(n){switch(n){case r.CULL_FACE:t.cullFace=!1;break;case r.DEPTH_TEST:t.depthTest=!1;break;case r.BLEND:t.blend=!1;break;case r.SCISSOR_TEST:t.scissorTest=!1;break;case r.STENCIL_TEST:t.stencilTest=!1}t.realDisable.call(r,n)},this.colorMask=r.getParameter(r.COLOR_WRITEMASK),r.colorMask=function(n,i,o,a){t.colorMask[0]=n,t.colorMask[1]=i,t.colorMask[2]=o,t.colorMask[3]=a,t.realColorMask.call(r,n,i,o,a)},this.clearColor=r.getParameter(r.COLOR_CLEAR_VALUE),r.clearColor=function(n,i,o,a){t.clearColor[0]=n,t.clearColor[1]=i,t.clearColor[2]=o,t.clearColor[3]=a,t.realClearColor.call(r,n,i,o,a)},this.viewport=r.getParameter(r.VIEWPORT),r.viewport=function(n,i,o,a){t.viewport[0]=n,t.viewport[1]=i,t.viewport[2]=o,t.viewport[3]=a,t.realViewport.call(r,n,i,o,a)},this.isPatched=!0,H(n)}},X.prototype.unpatch=function(){if(this.isPatched){var t=this.gl,n=this.gl.canvas;w()||(Object.defineProperty(n,"width",this.realCanvasWidth),Object.defineProperty(n,"height",this.realCanvasHeight)),n.width=this.bufferWidth,n.height=this.bufferHeight,t.bindFramebuffer=this.realBindFramebuffer,t.enable=this.realEnable,t.disable=this.realDisable,t.colorMask=this.realColorMask,t.clearColor=this.realClearColor,t.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&t.bindFramebuffer(t.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){H(n)},1)}},X.prototype.setTextureBounds=function(t,n){t||(t=[0,0,.5,1]),n||(n=[.5,0,.5,1]),this.viewportOffsetScale[0]=t[0],this.viewportOffsetScale[1]=t[1],this.viewportOffsetScale[2]=t[2],this.viewportOffsetScale[3]=t[3],this.viewportOffsetScale[4]=n[0],this.viewportOffsetScale[5]=n[1],this.viewportOffsetScale[6]=n[2],this.viewportOffsetScale[7]=n[3]},X.prototype.submitFrame=function(){var t=this.gl,n=this,r=[];if(this.dirtySubmitFrameBindings||r.push(t.CURRENT_PROGRAM,t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING,t.TEXTURE_BINDING_2D,t.TEXTURE0),q(t,r,function(t){n.realBindFramebuffer.call(t,t.FRAMEBUFFER,null);var r=0,i=0;n.instanceExt&&(r=t.getVertexAttrib(n.attribs.position,n.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),i=t.getVertexAttrib(n.attribs.texCoord,n.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),n.cullFace&&n.realDisable.call(t,t.CULL_FACE),n.depthTest&&n.realDisable.call(t,t.DEPTH_TEST),n.blend&&n.realDisable.call(t,t.BLEND),n.scissorTest&&n.realDisable.call(t,t.SCISSOR_TEST),n.stencilTest&&n.realDisable.call(t,t.STENCIL_TEST),n.realColorMask.call(t,!0,!0,!0,!0),n.realViewport.call(t,0,0,t.drawingBufferWidth,t.drawingBufferHeight),(n.ctxAttribs.alpha||w())&&(n.realClearColor.call(t,0,0,0,1),t.clear(t.COLOR_BUFFER_BIT)),t.useProgram(n.program),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer),t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.enableVertexAttribArray(n.attribs.position),t.enableVertexAttribArray(n.attribs.texCoord),t.vertexAttribPointer(n.attribs.position,2,t.FLOAT,!1,20,0),t.vertexAttribPointer(n.attribs.texCoord,3,t.FLOAT,!1,20,8),n.instanceExt&&(0!=r&&n.instanceExt.vertexAttribDivisorANGLE(n.attribs.position,0),0!=i&&n.instanceExt.vertexAttribDivisorANGLE(n.attribs.texCoord,0)),t.activeTexture(t.TEXTURE0),t.uniform1i(n.uniforms.diffuse,0),t.bindTexture(t.TEXTURE_2D,n.renderTarget),t.uniform4fv(n.uniforms.viewportOffsetScale,n.viewportOffsetScale),t.drawElements(t.TRIANGLES,n.indexCount,t.UNSIGNED_SHORT,0),n.cardboardUI&&n.cardboardUI.renderNoState(),n.realBindFramebuffer.call(n.gl,t.FRAMEBUFFER,n.framebuffer),n.ctxAttribs.preserveDrawingBuffer||(n.realClearColor.call(t,0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)),n.dirtySubmitFrameBindings||n.realBindFramebuffer.call(t,t.FRAMEBUFFER,n.lastBoundFramebuffer),n.cullFace&&n.realEnable.call(t,t.CULL_FACE),n.depthTest&&n.realEnable.call(t,t.DEPTH_TEST),n.blend&&n.realEnable.call(t,t.BLEND),n.scissorTest&&n.realEnable.call(t,t.SCISSOR_TEST),n.stencilTest&&n.realEnable.call(t,t.STENCIL_TEST),n.realColorMask.apply(t,n.colorMask),n.realViewport.apply(t,n.viewport),(n.ctxAttribs.alpha||!n.ctxAttribs.preserveDrawingBuffer)&&n.realClearColor.apply(t,n.clearColor),n.instanceExt&&(0!=r&&n.instanceExt.vertexAttribDivisorANGLE(n.attribs.position,r),0!=i&&n.instanceExt.vertexAttribDivisorANGLE(n.attribs.texCoord,i))}),w()){var i=t.canvas;(i.width!=n.bufferWidth||i.height!=n.bufferHeight)&&(n.bufferWidth=i.width,n.bufferHeight=i.height,n.onResize())}},X.prototype.updateDeviceInfo=function(t){var n=this.gl,r=this,i=[n.ARRAY_BUFFER_BINDING,n.ELEMENT_ARRAY_BUFFER_BINDING];q(n,i,function(n){var i=r.computeMeshVertices_(r.meshWidth,r.meshHeight,t);if(n.bindBuffer(n.ARRAY_BUFFER,r.vertexBuffer),n.bufferData(n.ARRAY_BUFFER,i,n.STATIC_DRAW),!r.indexCount){var o=r.computeMeshIndices_(r.meshWidth,r.meshHeight);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,o,n.STATIC_DRAW),r.indexCount=o.length}})},X.prototype.computeMeshVertices_=function(t,n,r){for(var i=new Float32Array(2*t*n*5),o=r.getLeftEyeVisibleTanAngles(),a=r.getLeftEyeNoLensTanAngles(),s=r.getLeftEyeVisibleScreenRect(a),l=0,c=0;c<2;c++){for(var u=0;u<n;u++)for(var h=0;h<t;h++,l++){var d=h/(t-1),p=u/(n-1),f=d,m=p,v=x(o[0],o[2],d),g=x(o[3],o[1],p),y=Math.sqrt(v*v+g*g),b=r.distortion.distortInverse(y),A=v*b/y,w=g*b/y;d=(A-a[0])/(a[2]-a[0]),p=(w-a[3])/(a[1]-a[3]),d=(s.x+d*s.width-.5)*2,p=(s.y+p*s.height-.5)*2,i[5*l+0]=d,i[5*l+1]=p,i[5*l+2]=f,i[5*l+3]=m,i[5*l+4]=c}var E=o[2]-o[0];o[0]=-(E+o[0]),o[2]=E-o[2],E=a[2]-a[0],a[0]=-(E+a[0]),a[2]=E-a[2],s.x=1-(s.x+s.width)}return i},X.prototype.computeMeshIndices_=function(t,n){for(var r=new Uint16Array(2*(t-1)*(n-1)*6),i=t/2,o=n/2,a=0,s=0,l=0;l<2;l++)for(var c=0;c<n;c++)for(var u=0;u<t;u++,a++)0!=u&&0!=c&&(u<=i==c<=o?(r[s++]=a,r[s++]=a-t-1,r[s++]=a-t,r[s++]=a-t-1,r[s++]=a,r[s++]=a-1):(r[s++]=a-1,r[s++]=a-t,r[s++]=a,r[s++]=a-t,r[s++]=a-1,r[s++]=a-t-1));return r},X.prototype.getOwnPropertyDescriptor_=function(t,n){var r=Object.getOwnPropertyDescriptor(t,n);return(void 0===r.get||void 0===r.set)&&(r.configurable=!0,r.enumerable=!0,r.get=function(){return this.getAttribute(n)},r.set=function(t){this.setAttribute(n,t)}),r};var Y=Math.PI/180;function Q(t){this.gl=t,this.attribs={position:0},this.program=B(t,"attribute vec2 position;\nuniform mat4 projectionMat;\nvoid main() {\n  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );\n}","precision mediump float;\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}",this.attribs),this.uniforms=F(t,this.program),this.vertexBuffer=t.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function Z(t){this.coefficients=t}Q.prototype.destroy=function(){var t=this.gl;this.listener&&t.canvas.removeEventListener("click",this.listener,!1),t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer)},Q.prototype.listen=function(t,n){var r=this.gl.canvas;this.listener=function(i){var o=r.clientWidth/2;i.clientX>o-42&&i.clientX<o+42&&i.clientY>r.clientHeight-42?t(i):i.clientX<42&&i.clientY<42&&n(i)},r.addEventListener("click",this.listener,!1)},Q.prototype.onResize=function(){var t=this.gl,n=this,r=[t.ARRAY_BUFFER_BINDING];q(t,r,function(t){var r=[],i=t.drawingBufferWidth/2,o=Math.max(screen.width,screen.height)*window.devicePixelRatio,a=t.drawingBufferWidth/o*window.devicePixelRatio,s=4*a/2,l=42*a,c=28*a/2,u=14*a;function h(t,n){var o=(90-t)*Y,a=Math.cos(o),s=Math.sin(o);r.push(.3125*a*c+i,.3125*s*c+c),r.push(n*a*c+i,n*s*c+c)}r.push(i-s,l),r.push(i-s,t.drawingBufferHeight),r.push(i+s,l),r.push(i+s,t.drawingBufferHeight),n.gearOffset=r.length/2;for(var d=0;d<=6;d++){var p=60*d;h(p,1),h(p+12,1),h(p+20,.75),h(p+40,.75),h(p+48,1)}function f(n,i){r.push(u+n,t.drawingBufferHeight-u-i)}n.gearVertexCount=r.length/2-n.gearOffset,n.arrowOffset=r.length/2;var m=s/Math.sin(45*Y);f(0,c),f(c,0),f(c+m,m),f(m,c+m),f(m,c-m),f(0,c),f(c,2*c),f(c+m,2*c-m),f(m,c-m),f(0,c),f(m,c-s),f(28*a,c-s),f(m,c+s),f(28*a,c+s),n.arrowVertexCount=r.length/2-n.arrowOffset,t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW)})},Q.prototype.render=function(){var t=this.gl,n=this,r=[t.CULL_FACE,t.DEPTH_TEST,t.BLEND,t.SCISSOR_TEST,t.STENCIL_TEST,t.COLOR_WRITEMASK,t.VIEWPORT,t.CURRENT_PROGRAM,t.ARRAY_BUFFER_BINDING];q(t,r,function(t){t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.BLEND),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.colorMask(!0,!0,!0,!0),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),n.renderNoState()})},Q.prototype.renderNoState=function(){var t=this.gl;t.useProgram(this.program),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.enableVertexAttribArray(this.attribs.position),t.vertexAttribPointer(this.attribs.position,2,t.FLOAT,!1,8,0),t.uniform4f(this.uniforms.color,1,1,1,1),k(this.projMat,0,t.drawingBufferWidth,0,t.drawingBufferHeight,.1,1024),t.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.drawArrays(t.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),t.drawArrays(t.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},Z.prototype.distortInverse=function(t){for(var n=0,r=1,i=t-this.distort(n);Math.abs(r-n)>1e-4;){var o=t-this.distort(r),a=r-(r-n)/(o-i)*o;n=r,r=a,i=o}return r},Z.prototype.distort=function(t){for(var n=t*t,r=0,i=0;i<this.coefficients.length;i++)r=n*(r+this.coefficients[i]);return(r+1)*t};var K=Math.PI/180,J=180/Math.PI,$=function(t,n,r){this.x=t||0,this.y=n||0,this.z=r||0};$.prototype={constructor:$,set:function(t,n,r){return this.x=t,this.y=n,this.z=r,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var t=this.length();return 0!==t?this.multiplyScalar(1/t):(this.x=0,this.y=0,this.z=0),this},multiplyScalar:function(t){this.x*=t,this.y*=t,this.z*=t},applyQuaternion:function(t){var n=this.x,r=this.y,i=this.z,o=t.x,a=t.y,s=t.z,l=t.w,c=l*n+a*i-s*r,u=l*r+s*n-o*i,h=l*i+o*r-a*n,d=-o*n-a*r-s*i;return this.x=c*l+-(d*o)+-(u*s)- -(h*a),this.y=u*l+-(d*a)+-(h*o)- -(c*s),this.z=h*l+-(d*s)+-(c*a)- -(u*o),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},crossVectors:function(t,n){var r=t.x,i=t.y,o=t.z,a=n.x,s=n.y,l=n.z;return this.x=i*l-o*s,this.y=o*a-r*l,this.z=r*s-i*a,this}};var ee=function(t,n,r,i){this.x=t||0,this.y=n||0,this.z=r||0,this.w=void 0!==i?i:1};function et(t){this.width=t.width||P(),this.height=t.height||D(),this.widthMeters=t.widthMeters,this.heightMeters=t.heightMeters,this.bevelMeters=t.bevelMeters}ee.prototype={constructor:ee,set:function(t,n,r,i){return this.x=t,this.y=n,this.z=r,this.w=i,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEulerXYZ:function(t,n,r){var i=Math.cos(t/2),o=Math.cos(n/2),a=Math.cos(r/2),s=Math.sin(t/2),l=Math.sin(n/2),c=Math.sin(r/2);return this.x=s*o*a+i*l*c,this.y=i*l*a-s*o*c,this.z=i*o*c+s*l*a,this.w=i*o*a-s*l*c,this},setFromEulerYXZ:function(t,n,r){var i=Math.cos(t/2),o=Math.cos(n/2),a=Math.cos(r/2),s=Math.sin(t/2),l=Math.sin(n/2),c=Math.sin(r/2);return this.x=s*o*a+i*l*c,this.y=i*l*a-s*o*c,this.z=i*o*c-s*l*a,this.w=i*o*a+s*l*c,this},setFromAxisAngle:function(t,n){var r=n/2,i=Math.sin(r);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Math.cos(r),this},multiply:function(t){return this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,n){var r=t.x,i=t.y,o=t.z,a=t.w,s=n.x,l=n.y,c=n.z,u=n.w;return this.x=r*u+a*s+i*c-o*l,this.y=i*u+a*l+o*s-r*c,this.z=o*u+a*c+r*l-i*s,this.w=a*u-r*s-i*l-o*c,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},slerp:function(t,n){if(0===n)return this;if(1===n)return this.copy(t);var r=this.x,i=this.y,o=this.z,a=this.w,s=a*t.w+r*t.x+i*t.y+o*t.z;if(s<0?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,s=-s):this.copy(t),s>=1)return this.w=a,this.x=r,this.y=i,this.z=o,this;var l=Math.acos(s),c=Math.sqrt(1-s*s);if(.001>Math.abs(c))return this.w=.5*(a+this.w),this.x=.5*(r+this.x),this.y=.5*(i+this.y),this.z=.5*(o+this.z),this;var u=Math.sin((1-n)*l)/c,h=Math.sin(n*l)/c;return this.w=a*u+this.w*h,this.x=r*u+this.x*h,this.y=i*u+this.y*h,this.z=o*u+this.z*h,this},setFromUnitVectors:function(t,n){return void 0===f&&(f=new $),(m=t.dot(n)+1)<1e-6?(m=0,Math.abs(t.x)>Math.abs(t.z)?f.set(-t.y,t.x,0):f.set(0,-t.z,t.y)):f.crossVectors(t,n),this.x=f.x,this.y=f.y,this.z=f.z,this.w=m,this.normalize(),this}};var en=new et({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),er=new et({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),ei={CardboardV1:new ea({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new ea({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-.0000016981803]})};function eo(t,n){this.viewer=ei.CardboardV2,this.updateDeviceParams(t),this.distortion=new Z(this.viewer.distortionCoefficients);for(var r=0;r<n.length;r++){var i=n[r];ei[i.id]=new ea(i)}}function ea(t){this.id=t.id,this.label=t.label,this.fov=t.fov,this.interLensDistance=t.interLensDistance,this.baselineLensDistance=t.baselineLensDistance,this.screenLensDistance=t.screenLensDistance,this.distortionCoefficients=t.distortionCoefficients,this.inverseCoefficients=t.inverseCoefficients}eo.prototype.updateDeviceParams=function(t){this.device=this.determineDevice_(t)||this.device},eo.prototype.getDevice=function(){return this.device},eo.prototype.setViewer=function(t){this.viewer=t,this.distortion=new Z(this.viewer.distortionCoefficients)},eo.prototype.determineDevice_=function(t){if(!t)return w()?(console.warn("Using fallback iOS device measurements."),er):(console.warn("Using fallback Android device measurements."),en);var n=.0254/t.xdpi,r=.0254/t.ydpi;return new et({widthMeters:n*P(),heightMeters:r*D(),bevelMeters:.001*t.bevelMm})},eo.prototype.getDistortedFieldOfViewLeftEye=function(){var t=this.viewer,n=this.device,r=this.distortion,i=t.screenLensDistance,o=(n.widthMeters-t.interLensDistance)/2,a=t.interLensDistance/2,s=t.baselineLensDistance-n.bevelMeters,l=n.heightMeters-s,c=J*Math.atan(r.distort(o/i)),u=J*Math.atan(r.distort(a/i)),h=J*Math.atan(r.distort(s/i)),d=J*Math.atan(r.distort(l/i));return{leftDegrees:Math.min(c,t.fov),rightDegrees:Math.min(u,t.fov),downDegrees:Math.min(h,t.fov),upDegrees:Math.min(d,t.fov)}},eo.prototype.getLeftEyeVisibleTanAngles=function(){var t=this.viewer,n=this.device,r=this.distortion,i=Math.tan(-K*t.fov),o=Math.tan(K*t.fov),a=Math.tan(K*t.fov),s=Math.tan(-K*t.fov),l=n.widthMeters/4,c=n.heightMeters/2,u=t.baselineLensDistance-n.bevelMeters-c,h=t.interLensDistance/2-l,d=-u,p=t.screenLensDistance,f=r.distort((h-l)/p),m=r.distort((d+c)/p),v=r.distort((h+l)/p),g=r.distort((d-c)/p),y=new Float32Array(4);return y[0]=Math.max(i,f),y[1]=Math.min(o,m),y[2]=Math.min(a,v),y[3]=Math.max(s,g),y},eo.prototype.getLeftEyeNoLensTanAngles=function(){var t=this.viewer,n=this.device,r=this.distortion,i=new Float32Array(4),o=r.distortInverse(Math.tan(-K*t.fov)),a=r.distortInverse(Math.tan(K*t.fov)),s=r.distortInverse(Math.tan(K*t.fov)),l=r.distortInverse(Math.tan(-K*t.fov)),c=n.widthMeters/4,u=n.heightMeters/2,h=t.baselineLensDistance-n.bevelMeters-u,d=t.interLensDistance/2-c,p=-h,f=t.screenLensDistance;return i[0]=Math.max(o,(d-c)/f),i[1]=Math.min(a,(p+u)/f),i[2]=Math.min(s,(d+c)/f),i[3]=Math.max(l,(p-u)/f),i},eo.prototype.getLeftEyeVisibleScreenRect=function(t){var n=this.viewer,r=this.device,i=n.screenLensDistance,o=(r.widthMeters-n.interLensDistance)/2,a=n.baselineLensDistance-r.bevelMeters,s=(t[0]*i+o)/r.widthMeters,l=(t[1]*i+a)/r.heightMeters,c=(t[2]*i+o)/r.widthMeters,u=(t[3]*i+a)/r.heightMeters;return{x:s,y:u,width:c-s,height:l-u}},eo.prototype.getFieldOfViewLeftEye=function(t){return t?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},eo.prototype.getFieldOfViewRightEye=function(t){var n=this.getFieldOfViewLeftEye(t);return{leftDegrees:n.rightDegrees,rightDegrees:n.leftDegrees,upDegrees:n.upDegrees,downDegrees:n.downDegrees}},eo.prototype.getUndistortedFieldOfViewLeftEye=function(){var t=this.getUndistortedParams_();return{leftDegrees:J*Math.atan(t.outerDist),rightDegrees:J*Math.atan(t.innerDist),downDegrees:J*Math.atan(t.bottomDist),upDegrees:J*Math.atan(t.topDist)}},eo.prototype.getUndistortedViewportLeftEye=function(){var t=this.getUndistortedParams_(),n=this.viewer,r=this.device,i=n.screenLensDistance,o=r.widthMeters/i,a=r.heightMeters/i,s=r.width/o,l=r.height/a,c=Math.round((t.eyePosX-t.outerDist)*s),u=Math.round((t.eyePosY-t.bottomDist)*l);return{x:c,y:u,width:Math.round((t.eyePosX+t.innerDist)*s)-c,height:Math.round((t.eyePosY+t.topDist)*l)-u}},eo.prototype.getUndistortedParams_=function(){var t=this.viewer,n=this.device,r=this.distortion,i=t.screenLensDistance,o=t.interLensDistance/2/i,a=n.widthMeters/i,s=n.heightMeters/i,l=a/2-o,c=(t.baselineLensDistance-n.bevelMeters)/i,u=t.fov,h=r.distortInverse(Math.tan(K*u)),d=Math.min(l,h),p=Math.min(o,h),f=Math.min(c,h);return{outerDist:d,innerDist:p,topDist:Math.min(s-c,h),bottomDist:f,eyePosX:l,eyePosY:c}},eo.Viewers=ei;var es={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};function el(t,n){if(this.dpdb=es,this.recalculateDeviceParams_(),t){this.onDeviceParamsUpdated=n;var r=new XMLHttpRequest,i=this;r.open("GET",t,!0),r.addEventListener("load",function(){i.loading=!1,r.status>=200&&r.status<=299?(i.dpdb=JSON.parse(r.response),i.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),r.send()}}function ec(t){this.xdpi=t.xdpi,this.ydpi=t.ydpi,this.bevelMm=t.bevelMm}function eu(t,n){this.set(t,n)}function eh(t,n){this.kFilter=t,this.isDebug=n,this.currentAccelMeasurement=new eu,this.currentGyroMeasurement=new eu,this.previousGyroMeasurement=new eu,w()?this.filterQ=new ee(-1,0,0,1):this.filterQ=new ee(1,0,0,1),this.previousFilterQ=new ee,this.previousFilterQ.copy(this.filterQ),this.accelQ=new ee,this.isOrientationInitialized=!1,this.estimatedGravity=new $,this.measuredGravity=new $,this.gyroIntegralQ=new ee}function ed(t,n){this.predictionTimeS=t,this.isDebug=n,this.previousQ=new ee,this.previousTimestampS=null,this.deltaQ=new ee,this.outQ=new ee}function ep(t,n,r,i){this.yawOnly=r,this.accelerometer=new $,this.gyroscope=new $,this.filter=new eh(t,i),this.posePredictor=new ed(n,i),this.isFirefoxAndroid=_(),this.isIOS=w();var o=T();this.isDeviceMotionInRadians=!this.isIOS&&o&&o<66,this.isWithoutDeviceMotion=C()||S(),this.filterToWorldQ=new ee,w()?this.filterToWorldQ.setFromAxisAngle(new $(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new $(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new ee,this.worldToScreenQ=new ee,this.originalPoseAdjustQ=new ee,this.originalPoseAdjustQ.setFromAxisAngle(new $(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),R()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new ee,this.orientationOut_=new Float32Array(4),this.start()}el.prototype.getDeviceParams=function(){return this.deviceParams},el.prototype.recalculateDeviceParams_=function(){var t=this.calcDeviceParams_();t?(this.deviceParams=t,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},el.prototype.calcDeviceParams_=function(){var t=this.dpdb;if(!t)return console.error("DPDB not available."),null;if(1!=t.format)return console.error("DPDB has unexpected format version."),null;if(!t.devices||!t.devices.length)return console.error("DPDB does not have a devices section."),null;var n=navigator.userAgent||navigator.vendor||window.opera,r=P(),i=D();if(!t.devices)return console.error("DPDB has no devices section."),null;for(var o=0;o<t.devices.length;o++){var a=t.devices[o];if(!a.rules){console.warn("Device["+o+"] has no rules section.");continue}if("ios"!=a.type&&"android"!=a.type){console.warn("Device["+o+"] has invalid type.");continue}if(w()==("ios"==a.type)){for(var s=!1,l=0;l<a.rules.length;l++){var c=a.rules[l];if(this.ruleMatches_(c,n,r,i)){s=!0;break}}if(s)return new ec({xdpi:a.dpi[0]||a.dpi,ydpi:a.dpi[1]||a.dpi,bevelMm:a.bw})}}return console.warn("No DPDB device match."),null},el.prototype.ruleMatches_=function(t,n,r,i){if(!t.ua&&!t.res||(t.ua&&"SM"===t.ua.substring(0,2)&&(t.ua=t.ua.substring(0,7)),t.ua&&0>n.indexOf(t.ua)))return!1;if(t.res){if(!t.res[0]||!t.res[1])return!1;var o=t.res[0],a=t.res[1];if(Math.min(r,i)!=Math.min(o,a)||Math.max(r,i)!=Math.max(o,a))return!1}return!0},eu.prototype.set=function(t,n){this.sample=t,this.timestampS=n},eu.prototype.copy=function(t){this.set(t.sample,t.timestampS)},eh.prototype.addAccelMeasurement=function(t,n){this.currentAccelMeasurement.set(t,n)},eh.prototype.addGyroMeasurement=function(t,n){var r;this.currentGyroMeasurement.set(t,n),isNaN(r=n-this.previousGyroMeasurement.timestampS)||r<=.001||r>1||this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},eh.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var t=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,n=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,t);this.gyroIntegralQ.multiply(n),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(n);var r=new ee;r.copy(this.filterQ),r.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(r),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i=new ee;i.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),i.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",J*(i.w>1?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(i.w)),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var o=new ee;o.copy(this.filterQ),o.multiply(i),this.filterQ.slerp(o,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},eh.prototype.getOrientation=function(){return this.filterQ},eh.prototype.accelToQuaternion_=function(t){var n=new $;n.copy(t),n.normalize();var r=new ee;return r.setFromUnitVectors(new $(0,0,-1),n),r.inverse(),r},eh.prototype.gyroToQuaternionDelta_=function(t,n){var r=new ee,i=new $;return i.copy(t),i.normalize(),r.setFromAxisAngle(i,t.length()*n),r},ed.prototype.getPrediction=function(t,n,r){if(!this.previousTimestampS)return this.previousQ.copy(t),this.previousTimestampS=r,t;var i=new $;i.copy(n),i.normalize();var o=n.length();if(o<20*K)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(J*o).toFixed(1)),this.outQ.copy(t),this.previousQ.copy(t),this.outQ;var a=o*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(i,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(t),this.previousTimestampS=r,this.outQ},ep.prototype.getPosition=function(){return null},ep.prototype.getOrientation=function(){var t=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||(n=new ee().setFromAxisAngle(new $(0,0,-1),0),r=new ee,-90===window.orientation?r.setFromAxisAngle(new $(0,1,0),-(Math.PI/2)):r.setFromAxisAngle(new $(0,1,0),Math.PI/2),n.multiply(r)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||((i=new ee).setFromAxisAngle(new $(1,0,0),-Math.PI/2),i),t=this._deviceOrientationQ;var n,r,i,o=new ee;return o.copy(t),o.multiply(this.deviceOrientationFilterToWorldQ),o.multiply(this.resetQ),o.multiply(this.worldToScreenQ),o.multiplyQuaternions(this.deviceOrientationFixQ,o),this.yawOnly&&(o.x=0,o.z=0,o.normalize()),this.orientationOut_[0]=o.x,this.orientationOut_[1]=o.y,this.orientationOut_[2]=o.z,this.orientationOut_[3]=o.w,this.orientationOut_}var a=this.filter.getOrientation();t=this.posePredictor.getPrediction(a,this.gyroscope,this.previousTimestampS);var o=new ee;return o.copy(this.filterToWorldQ),o.multiply(this.resetQ),o.multiply(t),o.multiply(this.worldToScreenQ),this.yawOnly&&(o.x=0,o.z=0,o.normalize()),this.orientationOut_[0]=o.x,this.orientationOut_[1]=o.y,this.orientationOut_[2]=o.z,this.orientationOut_[3]=o.w,this.orientationOut_},ep.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),R()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ep.prototype.onDeviceOrientation_=function(t){this._deviceOrientationQ=this._deviceOrientationQ||new ee;var n=t.alpha,r=t.beta,i=t.gamma;n=(n||0)*Math.PI/180,r=(r||0)*Math.PI/180,i=(i||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(r,n,-i)},ep.prototype.onDeviceMotion_=function(t){this.updateDeviceMotion_(t)},ep.prototype.updateDeviceMotion_=function(t){var n=t.accelerationIncludingGravity,r=t.rotationRate,i=t.timeStamp/1e3,o=i-this.previousTimestampS;if(o<0){V("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=i;return}if(o<=.001||o>1){V("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=i;return}this.accelerometer.set(-n.x,-n.y,-n.z),r&&(L()?this.gyroscope.set(-r.beta,r.alpha,r.gamma):this.gyroscope.set(r.alpha,r.beta,r.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,i)),this.filter.addAccelMeasurement(this.accelerometer,i),this.previousTimestampS=i},ep.prototype.onOrientationChange_=function(t){this.setScreenTransform_()},ep.prototype.onMessage_=function(t){var n=t.data;n&&n.type&&"devicemotion"===n.type.toLowerCase()&&this.updateDeviceMotion_(n.deviceMotionEvent)},ep.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new $(0,0,1),-Math.PI/2);break;case -90:this.worldToScreenQ.setFromAxisAngle(new $(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ep.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),w()&&z()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ep.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var ef=new $(1,0,0),em=new $(0,0,1),ev=new ee;ev.setFromAxisAngle(ef,-Math.PI/2),ev.multiply(new ee().setFromAxisAngle(em,Math.PI/2));var eg=function(){function t(n){y(this,t),this.config=n,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new ee,this._outQ=new ee,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return b(t,[{key:"init",value:function(){var t=null;try{(t=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(t){this.errors.push(t),"SecurityError"===t.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===t.name?this.useDeviceMotion():console.error(t)}t&&(this.api="sensor",this.sensor=t,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ep(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var t=this.sensor.quaternion;this._sensorQ.set(t[0],t[1],t[2],t[3]);var n=this._outQ;return n.copy(ev),n.multiply(this._sensorQ),this.config.YAW_ONLY&&(n.x=n.z=0,n.normalize()),this._out[0]=n.x,this._out[1]=n.y,this._out[2]=n.z,this._out[3]=n.w,this._out}},{key:"_onSensorError",value:function(t){this.errors.push(t.error),"NotAllowedError"===t.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===t.error.name?console.error("Sensor could not be read"):console.error(t.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),t}();function ey(){this.loadIcon_();var t=document.createElement("div"),n=t.style;n.position="fixed",n.top=0,n.right=0,n.bottom=0,n.left=0,n.backgroundColor="gray",n.fontFamily="sans-serif",n.zIndex=1e6;var r=document.createElement("img");r.src=this.icon;var n=r.style;n.marginLeft="25%",n.marginTop="25%",n.width="50%",t.appendChild(r);var i=document.createElement("div"),n=i.style;n.textAlign="center",n.fontSize="16px",n.lineHeight="24px",n.margin="24px 25%",n.width="50%",i.innerHTML="Place your phone into your Cardboard viewer.",t.appendChild(i);var o=document.createElement("div"),n=o.style;n.backgroundColor="#CFD8DC",n.position="fixed",n.bottom=0,n.width="100%",n.height="48px",n.padding="14px 24px",n.boxSizing="border-box",n.color="#656A6B",t.appendChild(o);var a=document.createElement("div");a.style.float="left",a.innerHTML="No Cardboard viewer?";var s=document.createElement("a");s.href="https://www.google.com/get/cardboard/get-cardboard/",s.innerHTML="get one",s.target="_blank";var n=s.style;n.float="right",n.fontWeight=600,n.textTransform="uppercase",n.borderLeft="1px solid gray",n.paddingLeft="24px",n.textDecoration="none",n.color="#656A6B",o.appendChild(a),o.appendChild(s),this.overlay=t,this.text=i,this.hide()}ey.prototype.show=function(t){t||this.overlay.parentElement?t&&(this.overlay.parentElement&&this.overlay.parentElement!=t&&this.overlay.parentElement.removeChild(this.overlay),t.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var n=this.overlay.querySelector("img").style;R()?(n.width="20%",n.marginLeft="40%",n.marginTop="3%"):(n.width="50%",n.marginLeft="25%",n.marginTop="25%")},ey.prototype.hide=function(){this.overlay.style.display="none"},ey.prototype.showTemporarily=function(t,n){this.show(n),this.timer=setTimeout(this.hide.bind(this),t)},ey.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},ey.prototype.update=function(){this.disableShowTemporarily(),!R()&&N()?this.show():this.hide()},ey.prototype.loadIcon_=function(){this.icon="data:image/svg+xml,"+encodeURIComponent("<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>")};var eb="WEBVR_CARDBOARD_VIEWER";function eA(t){try{this.selectedKey=localStorage.getItem(eb)}catch(t){console.error("Failed to load viewer profile: %s",t)}this.selectedKey||(this.selectedKey=t||"CardboardV1"),this.dialog=this.createDialog_(eo.Viewers),this.root=null,this.onChangeCallbacks_=[]}eA.prototype.show=function(t){this.root=t,t.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},eA.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},eA.prototype.getCurrentViewer=function(){return eo.Viewers[this.selectedKey]},eA.prototype.getSelectedKey_=function(){var t=this.dialog.querySelector("input[name=field]:checked");return t?t.id:null},eA.prototype.onChange=function(t){this.onChangeCallbacks_.push(t)},eA.prototype.fireOnChange_=function(t){for(var n=0;n<this.onChangeCallbacks_.length;n++)this.onChangeCallbacks_[n](t)},eA.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!eo.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(eo.Viewers[this.selectedKey]);try{localStorage.setItem(eb,this.selectedKey)}catch(t){console.error("Failed to save viewer profile: %s",t)}this.hide()},eA.prototype.createDialog_=function(t){var n=document.createElement("div");n.classList.add("webvr-polyfill-viewer-selector"),n.style.display="none";var r=document.createElement("div"),i=r.style;i.position="fixed",i.left=0,i.top=0,i.width="100%",i.height="100%",i.background="rgba(0, 0, 0, 0.3)",r.addEventListener("click",this.hide.bind(this));var o=document.createElement("div"),i=o.style;for(var a in i.boxSizing="border-box",i.position="fixed",i.top="24px",i.left="50%",i.marginLeft="-140px",i.width="280px",i.padding="24px",i.overflow="hidden",i.background="#fafafa",i.fontFamily="'Roboto', sans-serif",i.boxShadow="0px 5px 20px #666",o.appendChild(this.createH1_("Select your viewer")),t)o.appendChild(this.createChoice_(a,t[a].label));return o.appendChild(this.createButton_("Save",this.onSave_.bind(this))),n.appendChild(r),n.appendChild(o),n},eA.prototype.createH1_=function(t){var n=document.createElement("h1"),r=n.style;return r.color="black",r.fontSize="20px",r.fontWeight="bold",r.marginTop=0,r.marginBottom="24px",n.innerHTML=t,n},eA.prototype.createChoice_=function(t,n){var r=document.createElement("div");r.style.marginTop="8px",r.style.color="black";var i=document.createElement("input");i.style.fontSize="30px",i.setAttribute("id",t),i.setAttribute("type","radio"),i.setAttribute("value",t),i.setAttribute("name","field");var o=document.createElement("label");return o.style.marginLeft="4px",o.setAttribute("for",t),o.innerHTML=n,r.appendChild(i),r.appendChild(o),r},eA.prototype.createButton_=function(t,n){var r=document.createElement("button");r.innerHTML=t;var i=r.style;return i.float="right",i.textTransform="uppercase",i.color="#1094f7",i.fontSize="14px",i.letterSpacing=0,i.border=0,i.background="none",i.marginTop="16px",r.addEventListener("click",n),r},"undefined"!=typeof window?window:void 0!==s||"undefined"!=typeof self&&self;var ex=(t=v={exports:{}},n=v.exports,r=function(){return function(t){var n={};function r(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,i){r.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){var i=function(){function t(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,r,i){return r&&t(n.prototype,r),i&&t(n,i),n}}(),o=r(1),a="undefined"!=typeof navigator&&10>parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))&&!window.MSStream,s=function(){function t(){(function(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,t),a?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",o),this.noSleepVideo.addEventListener("timeupdate",(function(t){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return i(t,[{key:"enable",value:function(){a?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){a?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),t}();t.exports=s},function(t,n,r){t.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])},t.exports=r(),(g=v.exports)&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default"))?g.default:g,ew=1e3,eE=[0,0,.5,1],eM=[.5,0,.5,1],e_=window.requestAnimationFrame,eT=window.cancelAnimationFrame;function eS(t){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:t.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:t.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:t.canPresent},maxLayers:{writable:!1,enumerable:!0,value:t.maxLayers},hasOrientation:{enumerable:!0,get:function(){return W("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),t.hasOrientation}}})}function eC(t){var n=!("wakelock"in(t=t||{}))||t.wakelock;this.isPolyfilled=!0,this.displayId=ew++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return W("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new eS({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,n&&N()&&(this.wakelock_=new ex)}eC.prototype.getFrameData=function(t){return G(t,this._getPose(),this)},eC.prototype.getPose=function(){return W("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},eC.prototype.resetPose=function(){return W("VRDisplay.prototype.resetPose"),this._resetPose()},eC.prototype.getImmediatePose=function(){return W("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},eC.prototype.requestAnimationFrame=function(t){return e_(t)},eC.prototype.cancelAnimationFrame=function(t){return eT(t)},eC.prototype.wrapForFullscreen=function(t){if(w())return t;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var n=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",n.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==t)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=t,this.originalParent_=t.parentElement,this.originalParent_||document.body.appendChild(t),!this.fullscreenWrapper_.parentElement){var r=this.fullscreenElement_.parentElement;r.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),r.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var i=this;return function(){if(i.fullscreenElement_){var t=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];i.fullscreenElement_.setAttribute("style",t.join("; ")+";")}}(),this.fullscreenWrapper_},eC.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var t=this.fullscreenElement_;this.fullscreenElementCachedStyle_?t.setAttribute("style",this.fullscreenElementCachedStyle_):t.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var n=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(t),this.originalParent_===n?n.insertBefore(t,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(t),n.removeChild(this.fullscreenWrapper_),t}},eC.prototype.requestPresent=function(t){var n=this.isPresenting,r=this;return t instanceof Array||(W("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),t=[t]),new Promise(function(i,o){if(!r.capabilities.canPresent){o(Error("VRDisplay is not capable of presenting."));return}if(0==t.length||t.length>r.capabilities.maxLayers){o(Error("Invalid number of layers."));return}var a=t[0];if(!a.source){i();return}var s=a.leftBounds||eE,l=a.rightBounds||eM;if(n){var c=r.layer_;c.source!==a.source&&(c.source=a.source);for(var u=0;u<4;u++)c.leftBounds[u]=s[u],c.rightBounds[u]=l[u];r.wrapForFullscreen(r.layer_.source),r.updatePresent_(),i();return}if(r.layer_={predistorted:a.predistorted,source:a.source,leftBounds:s.slice(0),rightBounds:l.slice(0)},r.waitingForPresent_=!1,r.layer_&&r.layer_.source){var h=r.wrapForFullscreen(r.layer_.source);r.addFullscreenListeners_(h,function(){var t=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;r.isPresenting=h===t,r.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(t){console.error("screen.orientation.lock() failed due to",t.message)}),r.waitingForPresent_=!1,r.beginPresent_(),i()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),r.removeFullscreenWrapper(),r.disableWakeLock(),r.endPresent_(),r.removeFullscreenListeners_()),r.fireVRDisplayPresentChange_()},function(){r.waitingForPresent_&&(r.removeFullscreenWrapper(),r.removeFullscreenListeners_(),r.disableWakeLock(),r.waitingForPresent_=!1,r.isPresenting=!1,o(Error("Unable to present.")))}),O(h)?(r.enableWakeLock(),r.waitingForPresent_=!0):(w()||E())&&(r.enableWakeLock(),r.isPresenting=!0,r.beginPresent_(),r.fireVRDisplayPresentChange_(),i())}r.waitingForPresent_||w()||(I(),o(Error("Unable to present.")))})},eC.prototype.exitPresent=function(){var t=this.isPresenting,n=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(r,i){t?(!I()&&w()&&(n.endPresent_(),n.fireVRDisplayPresentChange_()),E()&&(n.removeFullscreenWrapper(),n.removeFullscreenListeners_(),n.endPresent_(),n.fireVRDisplayPresentChange_()),r()):i(Error("Was not presenting to VRDisplay."))})},eC.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},eC.prototype.fireVRDisplayPresentChange_=function(){var t=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(t)},eC.prototype.fireVRDisplayConnect_=function(){var t=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(t)},eC.prototype.addFullscreenListeners_=function(t,n,r){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=t,this.fullscreenChangeHandler_=n,this.fullscreenErrorHandler_=r,n&&(document.fullscreenEnabled?t.addEventListener("fullscreenchange",n,!1):document.webkitFullscreenEnabled?t.addEventListener("webkitfullscreenchange",n,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",n,!1):document.msFullscreenEnabled&&t.addEventListener("msfullscreenchange",n,!1)),r&&(document.fullscreenEnabled?t.addEventListener("fullscreenerror",r,!1):document.webkitFullscreenEnabled?t.addEventListener("webkitfullscreenerror",r,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",r,!1):document.msFullscreenEnabled&&t.addEventListener("msfullscreenerror",r,!1))},eC.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var t=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var n=this.fullscreenChangeHandler_;t.removeEventListener("fullscreenchange",n,!1),t.removeEventListener("webkitfullscreenchange",n,!1),document.removeEventListener("mozfullscreenchange",n,!1),t.removeEventListener("msfullscreenchange",n,!1)}if(this.fullscreenErrorHandler_){var r=this.fullscreenErrorHandler_;t.removeEventListener("fullscreenerror",r,!1),t.removeEventListener("webkitfullscreenerror",r,!1),document.removeEventListener("mozfullscreenerror",r,!1),t.removeEventListener("msfullscreenerror",r,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},eC.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},eC.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},eC.prototype.beginPresent_=function(){},eC.prototype.endPresent_=function(){},eC.prototype.submitFrame=function(t){},eC.prototype.getEyeParameters=function(t){return null};var eL={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},eR={LEFT:"left",RIGHT:"right"};function eP(t){var n=U({},eL);t=U(n,t||{}),eC.call(this,{wakelock:t.MOBILE_WAKE_LOCK}),this.config=t,this.displayName="Cardboard VRDisplay",this.capabilities=new eS({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new eg(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new el(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new eo(this.dpdb_.getDeviceParams(),t.ADDITIONAL_VIEWERS),this.viewerSelector_=new eA(t.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new ey),w()&&window.addEventListener("resize",this.onResize_.bind(this))}return eP.prototype=Object.create(eC.prototype),eP.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},eP.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},eP.prototype._getFieldOfView=function(t){var n;if(t==eR.LEFT)n=this.deviceInfo_.getFieldOfViewLeftEye();else{if(t!=eR.RIGHT)return console.error("Invalid eye provided: %s",t),null;n=this.deviceInfo_.getFieldOfViewRightEye()}return n},eP.prototype._getEyeOffset=function(t){var n;if(t==eR.LEFT)n=[-(.5*this.deviceInfo_.viewer.interLensDistance),0,0];else{if(t!=eR.RIGHT)return console.error("Invalid eye provided: %s",t),null;n=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return n},eP.prototype.getEyeParameters=function(t){var n=this._getEyeOffset(t),r=this._getFieldOfView(t),i={offset:n,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(i,"fieldOfView",{enumerable:!0,get:function(){return W("VRFieldOfView","VRFrameData's projection matrices"),r}}),i},eP.prototype.onDeviceParamsUpdated_=function(t){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(t),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},eP.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},eP.prototype.beginPresent_=function(){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2")),t&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(t.canvas.width=P()*this.bufferScale_,t.canvas.height=D()*this.bufferScale_,this.cardboardUI_=new Q(t)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Q(t)),this.distorter_=new X(t,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(t){this.viewerSelector_.show(this.layer_.source.parentElement),t.stopPropagation(),t.preventDefault()}).bind(this),(function(t){this.exitPresent(),t.stopPropagation(),t.preventDefault()}).bind(this)),this.rotateInstructions_&&(R()&&N()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},eP.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},eP.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},eP.prototype.submitFrame=function(t){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var n=this.layer_.source.getContext("webgl");n||(n=this.layer_.source.getContext("experimental-webgl")),n||(n=this.layer_.source.getContext("webgl2"));var r=n.canvas;(r.width!=this.lastWidth||r.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=r.width,this.lastHeight=r.height,this.cardboardUI_.render()}},eP.prototype.onOrientationChange_=function(t){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},eP.prototype.onResize_=function(t){if(this.layer_){var n=this.layer_.source.getContext("webgl");n||(n=this.layer_.source.getContext("experimental-webgl")),n||(n=this.layer_.source.getContext("webgl2")),n.canvas.setAttribute("style","position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; border: 0; margin: 0; padding: 0px; box-sizing: content-box;"),H(n.canvas)}},eP.prototype.onViewerChanged_=function(t){this.deviceInfo_.setViewer(t),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},eP.prototype.fireVRDisplayDeviceParamsChange_=function(){var t=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(t)},eP.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},eP.VRDisplay=eC,eP},t.exports=i(),(a=o.exports)&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default"))?a.default:a,d={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function p(t){this.config=u(u({},d),t),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&l())&&(this.enable(),this.getVRDisplays().then(function(t){t&&t[0]&&t[0].fireVRDisplayConnect_&&t[0].fireVRDisplayConnect_()}))}p.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(l()){var t=new h({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(t)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},p.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var t=this.native.VRFrameData,n=new this.native.VRFrameData,r=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(i){if(i instanceof t){r.call(this,i);return}r.call(this,n),i.pose=n.pose,c(n.leftProjectionMatrix,i.leftProjectionMatrix),c(n.rightProjectionMatrix,i.rightProjectionMatrix),c(n.leftViewMatrix,i.leftViewMatrix),c(n.rightViewMatrix,i.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=h.VRDisplay,window.VRFrameData=h.VRFrameData},p.prototype.getVRDisplays=function(){var t=this;return(this.config,this.hasNative)?this.native.getVRDisplays.call(navigator).then(function(n){return n.length>0?n:t.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},p.version="0.10.12",p.VRFrameData=h.VRFrameData,p.VRDisplay=h.VRDisplay;var f=Object.freeze({default:p}),m=f&&p||f;return void 0!==s&&s.window&&(s.document||(s.document=s.window.document),s.navigator||(s.navigator=s.window.navigator)),m},"object"==typeof o&&void 0!==i?i.exports=r():"function"==typeof t&&t.amd?t(r):this.WebVRPolyfill=r()}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],69:[function(t,n,r){var i=/\n/,o=/\s/;function a(t){return o.test(t)}function s(t,n,r,i){var o=Math.min(i,r-n);return{start:n,end:n+o}}n.exports=function(t,r){return n.exports.lines(t,r).map(function(n){return t.substring(n.start,n.end)}).join("\n")},n.exports.lines=function(t,n){if(0===(n=n||{}).width&&"nowrap"!==n.mode)return[];t=t||"";var r="number"==typeof n.width?n.width:Number.MAX_VALUE,o=Math.max(0,n.start||0),l="number"==typeof n.end?n.end:t.length,c=n.mode,u=n.measure||s;return"pre"===c?function(t,n,r,o,a){for(var s=[],l=r,c=r;c<o&&c<n.length;c++){var u=n.charAt(c),h=i.test(u);if(h||c===o-1){var d=t(n,l,h?c:c+1,a);s.push(d),l=c+1}}return s}(u,t,o,l,r):function(t,n,r,i,o,s){var l=[],c=o;for("nowrap"===s&&(c=Number.MAX_VALUE);r<i&&r<n.length;){for(var u=function(t,n,r,i){var o=t.indexOf("\n",r);return -1===o||o>i?i:o}(n,0,r,i);r<u&&a(n.charAt(r));)r++;var h=t(n,r,u,c),d=r+(h.end-h.start),p=d+1;if(d<u){for(;d>r&&!a(n.charAt(d));)d--;if(d===r)p>r+1&&p--,d=p;else for(p=d;d>r&&a(n.charAt(d-1));)d--}if(d>=r){var f=t(n,r,d,c);l.push(f)}r=p}return l}(u,t,o,l,r,c)}},{}],70:[function(t,n,r){"use strict";var i=t("global/window"),o=t("is-function"),a=t("parse-headers"),s=t("xtend");function l(t,n,r){var i=t;return o(n)?(r=n,"string"==typeof t&&(i={uri:t})):i=s(n,{uri:t}),i.callback=r,i}function c(t,n,r){return u(n=l(t,n,r))}function u(t){if(void 0===t.callback)throw Error("callback argument missing");var n,r,i,o=!1,s=function(n,r,i){o||(o=!0,t.callback(n,r,i))};function l(t){return clearTimeout(i),t instanceof Error||(t=Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,s(t,y)}function u(){if(!r){clearTimeout(i);var n,o=y,l=null;return 0!==(n=t.useXDR&&void 0===h.status?200:1223===h.status?204:h.status)?(o={body:function(){var t=void 0;if(t=h.response?h.response:h.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;var n=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!n)return t.responseXML}catch(t){}return null}(h),g)try{t=JSON.parse(t)}catch(t){}return t}(),statusCode:n,method:p,headers:{},url:d,rawRequest:h},h.getAllResponseHeaders&&(o.headers=a(h.getAllResponseHeaders()))):l=Error("Internal XMLHttpRequest Error"),s(l,o,o.body)}}var h=t.xhr||null;h||(h=t.cors||t.useXDR?new c.XDomainRequest:new c.XMLHttpRequest);var d=h.url=t.uri||t.url,p=h.method=t.method||"GET",f=t.body||t.data,m=h.headers=t.headers||{},v=!!t.sync,g=!1,y={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:h};if("json"in t&&!1!==t.json&&(g=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),h.onreadystatechange=function(){4===h.readyState&&setTimeout(u,0)},h.onload=u,h.onerror=l,h.onprogress=function(){},h.onabort=function(){r=!0},h.ontimeout=l,h.open(p,d,!v,t.username,t.password),v||(h.withCredentials=!!t.withCredentials),!v&&t.timeout>0&&(i=setTimeout(function(){if(!r){r=!0,h.abort("timeout");var t=Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",l(t)}},t.timeout)),h.setRequestHeader)for(n in m)m.hasOwnProperty(n)&&h.setRequestHeader(n,m[n]);else if(t.headers&&!function(t){for(var n in t)if(t.hasOwnProperty(n))return!1;return!0}(t.headers))throw Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(h),h.send(f||null),h}n.exports=c,n.exports.default=c,c.XMLHttpRequest=i.XMLHttpRequest||function(){},c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:i.XDomainRequest,function(t,n){for(var r=0;r<t.length;r++)n(t[r])}(["get","put","post","patch","head","delete"],function(t){c["delete"===t?"del":t]=function(n,r,i){return(r=l(n,r,i)).method=t.toUpperCase(),u(r)}})},{"global/window":27,"is-function":33,"parse-headers":47,xtend:72}],71:[function(t,n,r){n.exports=void 0!==self.DOMParser?function(t){return new self.DOMParser().parseFromString(t,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(t){var n=new self.ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(t),n}:function(t){var n=document.createElement("div");return n.innerHTML=t,n}},{}],72:[function(t,n,r){n.exports=function(){for(var t={},n=0;n<arguments.length;n++){var r=arguments[n];for(var o in r)i.call(r,o)&&(t[o]=r[o])}return t};var i=Object.prototype.hasOwnProperty},{}],73:[function(t,n,r){n.exports={name:"aframe",version:"1.2.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.0.4 1.1.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.125.1","three-bmfont-text":"dmarcos/three-bmfont-text#1babdf8507c731a18f8af3b807292e2b9740955e","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],74:[function(t,n,r){var i=t("super-animejs"),o=t("../core/component").components,a=t("../core/component").registerComponent,s=t("../lib/three"),l=t("../utils"),c=new s.Color,u=new s.Color,h=l.entity.getComponentProperty,d=l.entity.setComponentProperty,p={},f="color",m="rotation",v="scale",g="components";function y(t){t.x=s.Math.degToRad(t.x),t.y=s.Math.degToRad(t.y),t.z=s.Math.degToRad(t.z)}function b(t,n,r){var i;for(i=0;i<n.length;i++)t.addEventListener(n[i],r)}function A(t,n,r){var i;for(i=0;i<n.length;i++)t.removeEventListener(n[i],r)}function x(t,n){var r,i,o;for(r=0,i=E(n),o=t;r<i.length;r++)o=o[i[r]];if(void 0===o)throw console.log(t),Error("[animation] property ("+n+") could not be found");return o}function w(t,n,r,i){var o,a,l,c;for(n.startsWith("object3D.rotation")&&(r=s.Math.degToRad(r)),a=E(n),c=t,o=0;o<a.length-1;o++)c=c[a[o]];if(l=a[a.length-1],i===f){"r"in c[l]?(c[l].r=r.r,c[l].g=r.g,c[l].b=r.b):(c[l].x=r.r,c[l].y=r.g,c[l].z=r.b);return}c[l]=r}function E(t){return t in p||(p[t]=t.split(".")),p[t]}function M(t){return t.isRawProperty||t.property.startsWith(g)||t.property.startsWith("object3D")}n.exports.Component=a("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(t){return!0===t||"true"===t||!1!==t&&"false"!==t&&parseInt(t,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var t=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){t.animationIsPlaying=!1,t.el.emit("animationcomplete",t.eventDetail,!1),t.id&&t.el.emit("animationcomplete__"+t.id,t.eventDetail,!1)}}},update:function(t){var n=this.config,r=this.data;this.animationIsPlaying=!1,this.data.enabled&&r.property&&(n.autoplay=!1,n.direction=r.dir,n.duration=r.dur,n.easing=r.easing,n.elasticity=r.elasticity,n.loop=r.loop,n.round=r.round,this.createAndStartAnimation())},tick:function(t,n){this.animationIsPlaying&&(this.time+=n,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var t=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=i(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),t.autoplay&&(!t.startEvents||!t.startEvents.length)){if(t.delay){setTimeout(this.beginAnimation,t.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=i(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var t,n,r,i,o=this.config,a=this.data,s=this.el;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(r in n=""===a.from?x(s,a.property):a.from,i=a.to,this.setColorConfig(n,i),n=this.fromColor,i=this.toColor,this.targetsArray.length=0,this.targetsArray.push(n),o.targets=this.targetsArray,i)o[r]=i[r];o.update=(t={},function(n){var r;((r=n.animatables[0].target).r!==t.r||r.g!==t.g||r.b!==t.b)&&w(s,a.property,r,a.type)})}},updateConfigForDefault:function(){var t,n,r,i,o=this.config,a=this.data,s=this.el;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(n=""===a.from?M(a)?x(s,a.property):h(s,a.property):a.from,i=a.to,isNaN(n||i)?(n=n?n.toString():n,i=i?i.toString():i):(n=parseFloat(n),i=parseFloat(i)),(r="true"===a.to||"false"===a.to||!0===a.to||!1===a.to)&&(n="true"===a.from||!0===a.from?1:0,i="true"===a.to||!0===a.to?1:0),this.targets.aframeProperty=n,o.targets=this.targets,o.aframeProperty=i,o.update=function(n){var i;(i=n.animatables[0].target.aframeProperty)!==t&&(t=i,r&&(i=i>=1),M(a)?w(s,a.property,i,a.type):d(s,a.property,i))})},updateConfigForVector:function(){var t,n,r,i,o,a=this.config,s=this.data,c=this.el;for(r in i=""!==s.from?l.coordinates.parse(s.from):h(c,s.property),o=l.coordinates.parse(s.to),s.property===m&&(y(i),y(o)),this.targetsArray.length=0,this.targetsArray.push(i),a.targets=this.targetsArray,o)a[r]=o[r];if("position"===s.property||s.property===m||s.property===v){a.update=(t={},function(n){var r=n.animatables[0].target;s.property===v&&(r.x=Math.max(1e-4,r.x),r.y=Math.max(1e-4,r.y),r.z=Math.max(1e-4,r.z)),(r.x!==t.x||r.y!==t.y||r.z!==t.z)&&(t.x=r.x,t.y=r.y,t.z=r.z,c.object3D[s.property].set(r.x,r.y,r.z))});return}a.update=(n={},function(t){var r=t.animatables[0].target;(r.x!==n.x||r.y!==n.y||r.z!==n.z)&&(n.x=r.x,n.y=r.y,n.z=r.z,d(c,s.property,r))})},updateConfig:function(){var t,n,r,i,a,s;n=this.el,i=(a=this.data.property.split("."))[0],s=a[1],t=(r=n.components[i]||o[i])&&(!s||r.schema[s])?s?r.schema[s].type:r.schema.type:null,M(this.data)&&this.data.type===f?this.updateConfigForRawColor():"vec2"===t||"vec3"===t||"vec4"===t?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(t){var n,r=this.data,o=this.el,a=this;return!!(""===r.from&&r.property.startsWith(g))&&(n=E(r.property)[1],!o.components[n]&&(o.addEventListener("componentinitialized",function r(s){s.detail.name===n&&(t(),a.animation=i(a.config),o.removeEventListener("componentinitialized",r))}),!0))},stopRelatedAnimations:function(){var t,n;for(n in this.el.components)t=this.el.components[n],n!==this.attrName&&"animation"===t.name&&t.animationIsPlaying&&t.data.property===this.data.property&&(t.animationIsPlaying=!1)},addEventListeners:function(){var t=this.data,n=this.el;b(n,t.startEvents,this.onStartEvent),b(n,t.pauseEvents,this.pauseAnimation),b(n,t.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var t=this.data,n=this.el;A(n,t.startEvents,this.onStartEvent),A(n,t.pauseEvents,this.pauseAnimation),A(n,t.resumeEvents,this.resumeAnimation)},setColorConfig:function(t,n){c.set(t),u.set(n),t=this.fromColor,n=this.toColor,t.r=c.r,t.g=c.g,t.b=c.b,n.r=u.r,n.g=u.g,n.b=u.b}})},{"../core/component":131,"../lib/three":179,"../utils":205,"super-animejs":56}],75:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../lib/three");n.exports.Component=i("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var t,n=this.el;t=this.camera=new o.PerspectiveCamera,n.setObject3D("camera",t)},update:function(t){var n=this.data,r=this.camera;r.aspect=n.aspect||window.innerWidth/window.innerHeight,r.far=n.far,r.fov=n.fov,r.near=n.near,r.zoom=n.zoom,r.updateProjectionMatrix(),this.updateActiveCamera(t),this.updateSpectatorCamera(t)},updateActiveCamera:function(t){var n=this.data,r=this.el,i=this.system;t&&t.active===n.active||n.spectator||(n.active&&i.activeCameraEl!==r?i.setActiveCamera(r):n.active||i.activeCameraEl!==r||i.disableActiveCamera())},updateSpectatorCamera:function(t){var n=this.data,r=this.el,i=this.system;(!t||t.spectator!==n.spectator)&&(n.spectator&&i.spectatorCameraEl!==r?i.setSpectatorCamera(r):n.spectator||i.spectatorCameraEl!==r||i.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":131,"../lib/three":179}],76:[function(t,n,r){var i,o,a,s,l=t("../core/component").registerComponent,c=t("../utils/"),u=c.bind,h={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},d={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},p={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},f=["selectstart"],m=["selectend"],v="a-mouse-cursor-hover";n.exports.Component=l("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:c.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var t=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=c.debounce(function(){t.canvasBounds=t.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=u(this.onCursorDown,this),this.onCursorUp=u(this.onCursorUp,this),this.onIntersection=u(this.onIntersection,this),this.onIntersectionCleared=u(this.onIntersectionCleared,this),this.onMouseMove=u(this.onMouseMove,this),this.onEnterVR=u(this.onEnterVR,this)},update:function(t){this.data.rayOrigin!==t.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var t=this.el;t.removeState(d.HOVERING),t.removeState(d.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(d.HOVERED),this.removeEventListeners()},addEventListeners:function(){var t,n=this.data,r=this.el,i=this;function o(){t=r.sceneEl.canvas,n.downEvents.length||n.upEvents.length||(p.DOWN.forEach(function(n){t.addEventListener(n,i.onCursorDown)}),p.UP.forEach(function(n){t.addEventListener(n,i.onCursorUp)}))}(t=r.sceneEl.canvas)?o():r.sceneEl.addEventListener("render-target-loaded",o),n.downEvents.forEach(function(t){r.addEventListener(t,i.onCursorDown)}),n.upEvents.forEach(function(t){r.addEventListener(t,i.onCursorUp)}),r.addEventListener("raycaster-intersection",this.onIntersection),r.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),r.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),r.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var t,n=this.data,r=this.el,i=this;(t=r.sceneEl.canvas)&&!n.downEvents.length&&!n.upEvents.length&&(p.DOWN.forEach(function(n){t.removeEventListener(n,i.onCursorDown)}),p.UP.forEach(function(n){t.removeEventListener(n,i.onCursorUp)})),n.downEvents.forEach(function(t){r.removeEventListener(t,i.onCursorDown)}),n.upEvents.forEach(function(t){r.removeEventListener(t,i.onCursorUp)}),r.removeEventListener("raycaster-intersection",this.onIntersection),r.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("touchstart",this.onMouseMove),t.removeEventListener("touchmove",this.onMouseMove),r.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),r.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var t,n=this.el;(t=n.sceneEl.canvas).removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("touchmove",this.onMouseMove),n.setAttribute("raycaster","useWorldCoordinates",!1),"mouse"===this.data.rayOrigin&&(t.addEventListener("mousemove",this.onMouseMove,!1),t.addEventListener("touchmove",this.onMouseMove,!1),n.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:(i=new THREE.Vector3,o=new THREE.Vector2,s={origin:a=new THREE.Vector3,direction:i},function(t){var n,r,l,c=this.canvasBounds,u=this.el.sceneEl.camera;u.parent.updateMatrixWorld(),n=(r="touchmove"===t.type||"touchstart"===t.type?t.touches.item(0):t).clientX-c.left,l=r.clientY-c.top,o.x=n/c.width*2-1,o.y=-(l/c.height*2)+1,a.setFromMatrixPosition(u.matrixWorld),i.set(o.x,o.y,.5).unproject(u).sub(a).normalize(),this.el.setAttribute("raycaster",s),"touchmove"===t.type&&t.preventDefault()}),onCursorDown:function(t){this.isCursorDown=!0,"mouse"===this.data.rayOrigin&&"touchstart"===t.type&&(this.onMouseMove(t),this.el.components.raycaster.checkIntersections(),t.preventDefault()),this.twoWayEmit(h.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(t){if(this.isCursorDown){this.isCursorDown=!1;var n=this.data;this.twoWayEmit(h.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(h.MOUSEUP,this.intersectedEventDetail)),(!n.fuse||"mouse"===n.rayOrigin)&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(h.CLICK),this.cursorDownEl=null,"touchend"===t.type&&t.preventDefault()}},onIntersection:function(t){var n,r,i,o,a=this.el;r=t.detail.els[0]===a?1:0,o=t.detail.intersections[r],!(i=t.detail.els[r])||this.intersectedEl===i||this.intersectedEl&&(n=this.el.components.raycaster.getIntersection(this.intersectedEl))&&n.distance<=o.distance||(this.clearCurrentIntersection(!0),this.setIntersection(i,o))},onIntersectionCleared:function(t){-1!==t.detail.clearedEls.indexOf(this.intersectedEl)&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var t=this.el.sceneEl.xrSession,n=this;t&&"mouse"!==this.data.rayOrigin&&(f.forEach(function(r){t.addEventListener(r,n.onCursorDown)}),m.forEach(function(r){t.addEventListener(r,n.onCursorUp)}))},setIntersection:function(t,n){var r=this.el,i=this.data,o=this;this.intersectedEl!==t&&(this.intersectedEl=t,r.addState(d.HOVERING),t.addState(d.HOVERED),this.twoWayEmit(h.MOUSEENTER),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.add(v),0!==i.fuseTimeout&&i.fuse&&(r.addState(d.FUSING),this.twoWayEmit(h.FUSING),this.fuseTimeout=setTimeout(function(){r.removeState(d.FUSING),o.twoWayEmit(h.CLICK)},i.fuseTimeout)))},clearCurrentIntersection:function(t){var n,r,i,o=this.el;this.intersectedEl&&(this.intersectedEl.removeState(d.HOVERED),o.removeState(d.HOVERING),o.removeState(d.FUSING),this.twoWayEmit(h.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.remove(v),this.intersectedEl=null,clearTimeout(this.fuseTimeout),!0!==t&&0!==(i=this.el.components.raycaster.intersections).length)&&(n=i[0].object.el===o?1:0,(r=i[n])&&this.setIntersection(r.object.el,r))},twoWayEmit:function(t){var n,r=this.el,i=this.intersectedEl;n=this.el.components.raycaster.getIntersection(i),this.eventDetail.intersectedEl=i,this.eventDetail.intersection=n,r.emit(t,this.eventDetail),i&&(this.intersectedEventDetail.intersection=n,i.emit(t,this.intersectedEventDetail))}})},{"../core/component":131,"../utils/":205}],77:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u="https://cdn.aframe.io/controllers/google/",h=u+"vr_controller_daydream.obj",d=u+"vr_controller_daydream.mtl",p=t("../utils/").device.isWebXRAvailable,f=p?"google-daydream":"Daydream Controller";n.exports.Component=i("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:p?{axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]}:{axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){s(this,f,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{armModel:n.armModel,hand:n.hand,idPrefix:f,id:f,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:h,mtl:d})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(t){var n,r=t.detail.model;this.data.model&&((n=this.buttonMeshes={}).menu=r.getObjectByName("AppButton_AppButton_Cylinder.004"),n.system=r.getObjectByName("HomeButton_HomeButton_Cylinder.005"),n.trackpad=r.getObjectByName("TouchPad_TouchPad_Cylinder.003"),n.touchpad=r.getObjectByName("TouchPad_TouchPad_Cylinder.003"),r.position.set(0,0,-.04))},onAxisMoved:function(t){l(this,this.mapping.axes,t)},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&this.el.emit(n+"changed",t.detail.state)},updateModel:function(t,n){this.data.model&&this.updateButtonModel(t,n)},updateButtonModel:function(t,n){var r,i=this.buttonMeshes;if(i&&i[t]){switch(n){case"down":r=this.data.buttonHighlightColor;break;case"touchstart":r=this.data.buttonTouchedColor;break;default:r=this.data.buttonColor}i[t].material.color.set(r)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],78:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u=t("../utils/").device.isWebXRAvailable,h="https://cdn.aframe.io/controllers/samsung/",d=h+"gear_vr_controller.obj",p=h+"gear_vr_controller.mtl",f=u?"samsung-gearvr":"Gear VR";n.exports.Component=i("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:u?{axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]}:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){s(this,f,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{armModel:n.armModel,hand:n.hand,idPrefix:f,id:f,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:d,mtl:p})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(t){var n,r=t.detail.model;this.data.model&&((n=this.buttonMeshes={}).trigger=r.children[2],n.trackpad=r.children[1],n.touchpad=r.children[1])},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&this.el.emit(n+"changed",t.detail.state)},onAxisMoved:function(t){l(this,this.mapping.axes,t)},updateModel:function(t,n){this.data.model&&this.updateButtonModel(t,n)},updateButtonModel:function(t,n){var r,i=this.buttonMeshes;if(i&&i[t]){switch(n){case"down":r=this.data.buttonHighlightColor;break;case"touchstart":r=this.data.buttonTouchedColor;break;default:r=this.data.buttonColor}i[t].material.color.set(r)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],79:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u="generic";n.exports.Component=i("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:{axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]},bindMethods:function(){this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(n){n.detail.name!==t.name&&(t.wasControllerConnected=!0,t.removeEventListeners(),t.removeControllersUpdateListener())})},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var t=this.data;s(this,u,{hand:t.hand?t.hand:void 0,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}t.setAttribute("tracked-controls",{hand:n.hand,idPrefix:u,orientationOffset:n.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&this.el.emit(n+"changed",t.detail.state)},onAxisMoved:function(t){l(this,this.mapping.axes,t)},initDefaultModel:function(){var t=this.modelEl=document.createElement("a-entity");t.setAttribute("geometry",{primitive:"sphere",radius:.03}),t.setAttribute("material",{color:this.data.color}),this.el.appendChild(t)}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],80:[function(t,n,r){var i=t("../core/geometry").geometries,o=t("../core/geometry").geometryNames,a=t("../core/component").registerComponent,s=t("../lib/three"),l=new s.BufferGeometry;n.exports.Component=a("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:o,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(t){var n,r=this.data,i=this.el,o=this.system;this.geometry&&(o.unuseGeometry(t),this.geometry=null),this.geometry=o.getOrCreateGeometry(r),(n=i.getObject3D("mesh"))?n.geometry=this.geometry:((n=new s.Mesh).geometry=this.geometry,this.el.getAttribute("material")||(n.material=new s.MeshStandardMaterial({color:16777215*Math.random(),metalness:0,roughness:.5})),i.setObject3D("mesh",n))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=l,this.geometry=null},updateSchema:function(t){var n=this.oldData&&this.oldData.primitive,r=t.primitive,o=i[r]&&i[r].schema;if(!o)throw Error("Unknown geometry schema `"+r+"`");n&&n===r||this.extendSchema(o)}})},{"../core/component":131,"../core/geometry":132,"../lib/three":179}],81:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../lib/three"),a=t("../utils/").debug("components:gltf-model:warn");n.exports.Component=i("gltf-model",{schema:{type:"model"},init:function(){var t=this.system.getDRACOLoader();this.model=null,this.loader=new o.GLTFLoader,t&&this.loader.setDRACOLoader(t)},update:function(){var t=this,n=this.el,r=this.data;r&&(this.remove(),this.loader.load(r,function(r){t.model=r.scene||r.scenes[0],t.model.animations=r.animations,n.setObject3D("mesh",t.model),n.emit("model-loaded",{format:"gltf",model:t.model})},void 0,function(t){a(t&&t.message?t.message:"Failed to load glTF model"),n.emit("model-error",{format:"gltf",src:r})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],82:[function(t,n,r){var i=t("../core/component").registerComponent,o={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},a={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},s={};function l(t,n){var r;return t?"grip"===(r=s[t])?r+(n?"close":"open"):"point"===r?r+(n?"up":"down"):"pointing"===r||"pistol"===r?r+(n?"start":"end"):void 0:void 0}s[a.fist]="grip",s[a.thumbUp]="pistol",s[a.point]="pointing",n.exports.Component=i("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var t=this,n=this.el;this.gesture=a.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){t.handleButton("grip","down")},this.onGripUp=function(){t.handleButton("grip","up")},this.onTrackpadDown=function(){t.handleButton("trackpad","down")},this.onTrackpadUp=function(){t.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){t.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){t.handleButton("trackpad","touchend")},this.onTriggerDown=function(){t.handleButton("trigger","down")},this.onTriggerUp=function(){t.handleButton("trigger","up")},this.onTriggerTouchStart=function(){t.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){t.handleButton("trigger","touchend")},this.onGripTouchStart=function(){t.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){t.handleButton("grip","touchend")},this.onThumbstickDown=function(){t.handleButton("thumbstick","down")},this.onThumbstickUp=function(){t.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){t.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){t.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){t.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){t.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){t.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){t.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),n.addEventListener("controllerconnected",this.onControllerConnected),n.addEventListener("controllerdisconnected",this.onControllerDisconnected),n.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(t,n){var r=this.el.getObject3D("mesh");r&&r.mixer&&r.mixer.update(n/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var t=this.el;t.addEventListener("gripdown",this.onGripDown),t.addEventListener("gripup",this.onGripUp),t.addEventListener("trackpaddown",this.onTrackpadDown),t.addEventListener("trackpadup",this.onTrackpadUp),t.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),t.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),t.addEventListener("triggerdown",this.onTriggerDown),t.addEventListener("triggerup",this.onTriggerUp),t.addEventListener("triggertouchstart",this.onTriggerTouchStart),t.addEventListener("triggertouchend",this.onTriggerTouchEnd),t.addEventListener("griptouchstart",this.onGripTouchStart),t.addEventListener("griptouchend",this.onGripTouchEnd),t.addEventListener("thumbstickdown",this.onThumbstickDown),t.addEventListener("thumbstickup",this.onThumbstickUp),t.addEventListener("abuttontouchstart",this.onAorXTouchStart),t.addEventListener("abuttontouchend",this.onAorXTouchEnd),t.addEventListener("bbuttontouchstart",this.onBorYTouchStart),t.addEventListener("bbuttontouchend",this.onBorYTouchEnd),t.addEventListener("xbuttontouchstart",this.onAorXTouchStart),t.addEventListener("xbuttontouchend",this.onAorXTouchEnd),t.addEventListener("ybuttontouchstart",this.onBorYTouchStart),t.addEventListener("ybuttontouchend",this.onBorYTouchEnd),t.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),t.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var t=this.el;t.removeEventListener("gripdown",this.onGripDown),t.removeEventListener("gripup",this.onGripUp),t.removeEventListener("trackpaddown",this.onTrackpadDown),t.removeEventListener("trackpadup",this.onTrackpadUp),t.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),t.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),t.removeEventListener("triggerdown",this.onTriggerDown),t.removeEventListener("triggerup",this.onTriggerUp),t.removeEventListener("triggertouchstart",this.onTriggerTouchStart),t.removeEventListener("triggertouchend",this.onTriggerTouchEnd),t.removeEventListener("griptouchstart",this.onGripTouchStart),t.removeEventListener("griptouchend",this.onGripTouchEnd),t.removeEventListener("thumbstickdown",this.onThumbstickDown),t.removeEventListener("thumbstickup",this.onThumbstickUp),t.removeEventListener("abuttontouchstart",this.onAorXTouchStart),t.removeEventListener("abuttontouchend",this.onAorXTouchEnd),t.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),t.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),t.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),t.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),t.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),t.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),t.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),t.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(t){var n,r=this.el,i=this.data.hand,a=this.data.handModelStyle,s=this.data.color,l=this;if(n={hand:i,model:!1},i!==t){var c=o[a+i.charAt(0).toUpperCase()+i.slice(1)];this.loader.load(c,function(t){var o=t.scene.children[0],a="left"===i?Math.PI/2:-Math.PI/2;o.mixer=new THREE.AnimationMixer(o),l.clips=t.animations,r.setObject3D("mesh",o),o.children[1].material.color=new THREE.Color(s),o.position.set(0,0,0),o.rotation.set(0,0,a),r.setAttribute("magicleap-controls",n),r.setAttribute("vive-controls",n),r.setAttribute("oculus-touch-controls",n),r.setAttribute("windows-motion-controls",n)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(t,n){var r,i="down"===n,o="touchstart"===n;if(0===n.indexOf("touch")){if(o===this.touchedButtons[t])return;this.touchedButtons[t]=o}else{if(i===this.pressedButtons[t])return;this.pressedButtons[t]=i}r=this.gesture,this.gesture=this.determineGesture(),this.gesture!==r&&(this.animateGesture(this.gesture,r),this.emitGestureEvents(this.gesture,r))},determineGesture:function(){var t,n,r,i=this.pressedButtons.grip,o=this.pressedButtons.surface||this.touchedButtons.surface,s=this.pressedButtons.trackpad||this.touchedButtons.trackpad,l=this.pressedButtons.trigger||this.touchedButtons.trigger,c=this.touchedButtons.AorX||this.touchedButtons.BorY;return(n=(t=this.el.components["tracked-controls"])&&t.controller)&&(n.id&&0===n.id.indexOf("OpenVR ")||n.profiles&&n.profiles[0]&&"htc-vive-controller-mv"===n.profiles[0])?i||l?r=a.fist:s&&(r=a.point):i?r=o||c||s?l?a.fist:a.point:l?a.thumbUp:a.pointThumb:l&&(r=a.hold),r},getClip:function(t){var n,r;for(r=0;r<this.clips.length;r++)if((n=this.clips[r]).name===t)return n},animateGesture:function(t,n){if(t){this.playAnimation(t||a.open,n,!1);return}this.playAnimation(n,n,!0)},emitGestureEvents:function(t,n){var r,i=this.el;n!==t&&((r=l(n,!1))&&i.emit(r),(r=l(t,!0))&&i.emit(r))},playAnimation:function(t,n,r){var i,o,a,s=this.el.getObject3D("mesh");if(s){if(s.mixer.stopAllAction(),i=this.getClip(t),(a=s.mixer.clipAction(i)).clampWhenFinished=!0,a.loop=THREE.LoopRepeat,a.repetitions=0,a.timeScale=r?-1:1,a.time=r?i.duration:0,a.weight=1,!n||t===n){s.mixer.stopAllAction(),a.play();return}i=this.getClip(n),(o=s.mixer.clipAction(i)).weight=.15,o.play(),a.play(),o.crossFadeTo(a,.15,!0)}}})},{"../core/component":131}],83:[function(t,n,r){var i,o=t("../core/component").registerComponent,a=t("../utils/bind"),s=t("../utils/tracked-controls").checkControllerPresentAndSetup,l={left:"b_l_",right:"b_r_"},c=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],u={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"};n.exports.Component=o("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=a(this.onControllersUpdate,this),this.checkIfControllerPresent=a(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=a(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var t=0;t<this.jointEls.length;++t)this.jointEls[t].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var t=0;t<this.jointEls.length;++t)this.jointEls[t].object3D.visible=!1},init:function(){var t=this.el.sceneEl,n=t.getAttribute("webxr").optionalFeatures;n.push("hand-tracking"),t.setAttribute("webxr",{optionalFeatures:n}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var t=this,n=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,n){var r=t.el.sceneEl.systems.webxr.sessionReferenceSpaceType;n.requestReferenceSpace(r).then(function(n){t.referenceSpace=n.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(n){throw t.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(r,"tracked-controls-webxr uses reference space "+r),n})}},checkIfControllerPresent:function(){var t=this.data;s(this,"",{hand:t.hand?t.hand:void 0,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var t=this.el.sceneEl,n=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,r=t.frame,i=this.el.components["tracked-controls-webxr"];n&&r&&i&&n.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),r.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){"dots"===this.data.modelStyle&&this.updateHandDotsModel(),"mesh"===this.data.modelStyle&&this.updateHandMeshModel()},getBone:function(t){for(var n=this.bones,r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},updateHandMeshModel:function(){var t,n,r,i=this.el.sceneEl.frame,o=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,a=this.referenceSpace;if(o&&this.mesh&&a)for(var s of(this.mesh.visible=!1,o.hand.values()))n=i.getJointPose(s,a),u[s.jointName]&&null!=(t=this.getBone(l[this.data.hand]+u[s.jointName]))&&n&&(r=n.transform,this.mesh.visible=!0,t.position.copy(r.position).multiplyScalar(100),t.quaternion.set(r.orientation.x,r.orientation.y,r.orientation.z,r.orientation.w))},updateHandDotsModel:function(){var t,n,r,i=this.el.sceneEl.frame,o=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,a=this.el.components["tracked-controls-webxr"].system.referenceSpace,s=0;for(var l of o.hand.values())n=(t=this.jointEls[s++]).object3D,r=i.getJointPose(l,a),t.object3D.visible=!!r,r&&(n.matrix.elements=r.transform.matrix,n.matrix.decompose(n.position,n.rotation,n.scale),t.setAttribute("scale",{x:r.radius,y:r.radius,z:r.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:(i=new THREE.Vector3,function(){var t=this.el.sceneEl.frame,n=this.indexTipPosition,r=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,o=this.el.components["tracked-controls-webxr"],a=this.referenceSpace||o.system.referenceSpace,s=r.hand.get("index-finger-tip"),l=r.hand.get("thumb-tip");if(s&&l){var c=t.getJointPose(s,a),u=t.getJointPose(l,a);if(c&&u){i.copy(u.transform.position),n.copy(c.transform.position);var h=n.distanceTo(i);h<.015&&!1===this.isPinched&&(this.isPinched=!0,this.pinchEventDetail.position.copy(n).lerp(i,.5),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),h>.03&&!0===this.isPinched&&(this.isPinched=!1,this.pinchEventDetail.position.copy(n).lerp(i,.5),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(n).lerp(i,.5),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),n.y+=1.5}}}),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{hand:n.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var t;this.checkIfControllerPresent(),t=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,this.el.getObject3D("mesh")&&(t&&t.hand&&t.hand[0]||(this.el.getObject3D("mesh").visible=!1))},initDefaultModel:function(){this.el.getObject3D("mesh")||("dots"===this.data.modelStyle&&this.initDotsModel(),"mesh"===this.data.modelStyle&&this.initMeshHandModel())},initDotsModel:function(){if(0===this.jointEls.length)for(var t=0;t<c.length;++t){var n=this.jointEl=document.createElement("a-entity");n.setAttribute("geometry",{primitive:"sphere",radius:1}),n.setAttribute("material",{color:this.data.modelColor}),n.object3D.visible=!1,this.el.appendChild(n),this.jointEls.push(n)}},initMeshHandModel:function(){var t="left"===this.data.hand?"https://cdn.aframe.io/controllers/oculus-hands/unity/left.glb":"https://cdn.aframe.io/controllers/oculus-hands/unity/right.glb";this.el.setAttribute("gltf-model",t)},onModelLoaded:function(){var t=this.mesh=this.el.getObject3D("mesh").children[0],n=this.skinnedMesh=t.children[24];this.skinnedMesh&&(this.bones=n.skeleton.bones,this.el.removeObject3D("mesh"),t.position.set(0,1.5,0),t.rotation.set(0,0,0),n.frustumCulled=!1,n.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",t))}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],84:[function(t,n,r){t("./animation"),t("./camera"),t("./cursor"),t("./daydream-controls"),t("./gearvr-controls"),t("./geometry"),t("./generic-tracked-controller-controls"),t("./gltf-model"),t("./hand-tracking-controls"),t("./hand-controls"),t("./layer"),t("./laser-controls"),t("./light"),t("./line"),t("./link"),t("./look-controls"),t("./magicleap-controls"),t("./material"),t("./obj-model"),t("./oculus-go-controls"),t("./oculus-touch-controls"),t("./position"),t("./raycaster"),t("./rotation"),t("./scale"),t("./shadow"),t("./sound"),t("./text"),t("./tracked-controls"),t("./tracked-controls-webvr"),t("./tracked-controls-webxr"),t("./visible"),t("./valve-index-controls"),t("./vive-controls"),t("./vive-focus-controls"),t("./wasd-controls"),t("./windows-motion-controls"),t("./scene/background"),t("./scene/debug"),t("./scene/device-orientation-permission-ui"),t("./scene/embedded"),t("./scene/inspector"),t("./scene/fog"),t("./scene/keyboard-shortcuts"),t("./scene/pool"),t("./scene/screenshot"),t("./scene/stats"),t("./scene/vr-mode-ui")},{"./animation":74,"./camera":75,"./cursor":76,"./daydream-controls":77,"./gearvr-controls":78,"./generic-tracked-controller-controls":79,"./geometry":80,"./gltf-model":81,"./hand-controls":82,"./hand-tracking-controls":83,"./laser-controls":85,"./layer":86,"./light":87,"./line":88,"./link":89,"./look-controls":90,"./magicleap-controls":91,"./material":92,"./obj-model":93,"./oculus-go-controls":94,"./oculus-touch-controls":95,"./position":96,"./raycaster":97,"./rotation":98,"./scale":99,"./scene/background":100,"./scene/debug":101,"./scene/device-orientation-permission-ui":102,"./scene/embedded":103,"./scene/fog":104,"./scene/inspector":105,"./scene/keyboard-shortcuts":106,"./scene/pool":107,"./scene/screenshot":108,"./scene/stats":109,"./scene/vr-mode-ui":110,"./shadow":111,"./sound":112,"./text":113,"./tracked-controls":116,"./tracked-controls-webvr":114,"./tracked-controls-webxr":115,"./valve-index-controls":117,"./visible":118,"./vive-controls":119,"./vive-focus-controls":120,"./wasd-controls":121,"./windows-motion-controls":122}],85:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/");i("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var t=this.config,n=this.data,r=this.el,i=this,a={hand:n.hand,model:n.model};function s(n){var a=t[n.detail.name];if(a){var s=o.extend({showLine:!0},a.raycaster||{});n.detail.rayOrigin&&(s.origin=n.detail.rayOrigin.origin,s.direction=n.detail.rayOrigin.direction,s.showLine=!0),n.detail.rayOrigin||!i.modelReady?r.setAttribute("raycaster",s):r.setAttribute("raycaster","showLine",!0),r.setAttribute("cursor",o.extend({fuse:!1},a.cursor))}}r.setAttribute("daydream-controls",a),r.setAttribute("gearvr-controls",a),r.setAttribute("magicleap-controls",a),r.setAttribute("oculus-go-controls",a),r.setAttribute("oculus-touch-controls",a),r.setAttribute("valve-index-controls",a),r.setAttribute("vive-controls",a),r.setAttribute("vive-focus-controls",a),r.setAttribute("windows-motion-controls",a),r.setAttribute("generic-tracked-controller-controls",a),r.addEventListener("controllerconnected",s),r.addEventListener("controllerdisconnected",function(){r.setAttribute("raycaster","showLine",!1)}),r.addEventListener("controllermodelready",function(t){s(t),i.modelReady=!0})},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":131,"../utils/":205}],86:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/").debug("components:layer:warn");n.exports.Component=i("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var t=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=t.createFramebuffer();var n=this.el.sceneEl.getAttribute("webxr").requiredFeatures;n.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",n),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(t){this.data.src!==t.src&&this.updateSrc()},updateSrc:function(){var t=this.data.type;if(this.texture=void 0,"quad"===t){this.loadQuadImage();return}if("monocubemap"===t||"stereocubemap"===t){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var t,n=this.data.type,r=this.xrGLFactory,i=this.el.sceneEl.frame,o=this.data.src;this.visibilityChanged=!1,this.layer&&(o.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,"monocubemap"===n?(t=r.getSubImage(this.layer,i),this.loadCubeMapImage(t.colorTexture,o,0)):(t=r.getSubImage(this.layer,i,"left"),this.loadCubeMapImage(t.colorTexture,o,0),t=r.getSubImage(this.layer,i,"right"),this.loadCubeMapImage(t.colorTexture,o,6)))},loadQuadImage:function(){var t=this.data.src,n=this;this.el.sceneEl.systems.material.loadTexture(t,{src:t},function(r){n.el.sceneEl.renderer.initTexture(r),n.texture=r,"VIDEO"===t.tagName&&setTimeout(function(){n.textureIsVideo=!0},1e3),n.layer&&(n.layer.height=n.data.height/2||n.texture.image.height/1e3,n.layer.width=n.data.width/2||n.texture.image.width/1e3,n.needsRedraw=!0),n.updateQuadPanel()})},preGenerateCubeMapTextures:function(t,n){"monocubemap"===this.data.type?this.generateCubeMapTextures(t,0,n):(this.generateCubeMapTextures(t,0,n),this.generateCubeMapTextures(t,6,n))},generateCubeMapTextures:function(t,n,r){for(var i,o,a=this.data,s=this.cubeFaceSize,l=Math.min(t.width,t.height),c=[],u=0;u<6;u++){var h=document.createElement("CANVAS");h.width=h.height=s;var d=h.getContext("2d");a.rotateCubemap&&(2===u||3===u)&&(d.save(),d.translate(s,s),d.rotate(Math.PI)),d.drawImage(t,(u+n)*l,0,l,l,0,0,s,s),d.restore(),r&&r(),c.push(h)}return a.rotateCubemap&&(i=c[0],o=c[1],c[0]=o,c[1]=i,i=c[4],o=c[5],c[4]=o,c[5]=i),r&&r(),c},loadCubeMapImage:function(t,n,r){var i=this.el.sceneEl.renderer.getContext();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.bindTexture(i.TEXTURE_CUBE_MAP,t);var o=0;(!n.complete||this.loadingScreen?this.loadingScreenImages:this.generateCubeMapTextures(n,r)).forEach(function(t,n){i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,0,0,i.RGBA,i.UNSIGNED_BYTE,t),o=i.getError()}),0!==o&&console.log("renderingError, WebGL Error Code: "+o),i.bindTexture(i.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),(this.needsRedraw||this.layer.needsRedraw||this.textureIsVideo)&&("quad"===this.data.type&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var t=this,n=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(n){t.visibilityChanged="hidden"!==n.session.visibilityState},"quad"===n){this.initQuadLayer();return}if("monocubemap"===n||"stereocubemap"===n){this.initCubeMapLayer();return}},initQuadLayer:function(){var t=this.el.sceneEl,n=t.renderer.getContext(),r=this.xrGLFactory=new XRWebGLBinding(t.xrSession,n);this.texture&&(this.layer=r.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),t.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var t=this.data.src,n=this.el.sceneEl,r=n.renderer.getContext(),i=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),o=this.cubeFaceSize=Math.min(i,Math.min(t.width,t.height)),a=this.xrGLFactory=new XRWebGLBinding(n.xrSession,r);this.layer=a.createCubeLayer({space:this.referenceSpace,viewPixelWidth:o,viewPixelHeight:o,layout:"monocubemap"===this.data.type?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),n.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var t=this.cubeFaceSize,n=this.loadingScreenImages=[],r=0;r<6;r++){var i=document.createElement("CANVAS");i.width=i.height=t;var o=i.getContext("2d");i.width=i.height=t,o.fillStyle="black",o.fillRect(0,0,t,t),2!==r&&3!==r&&(o.translate(t,0),o.scale(-1,1),o.fillStyle="white",o.font="30px Arial",o.fillText("Loading",t/2,t/2)),n.push(i)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(t){this.layerEnabled=t,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var t=this.quadPanelEl;this.quadPanelEl||(t=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(t)),t.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),t.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){let t,n,r,i;var o,a,s=this.el.sceneEl,l=this.el.sceneEl.renderer.getContext(),c=this.xrGLFactory.getSubImage(this.layer,s.frame),u=s.renderer.properties.get(this.texture).__webglTexture,h=l.getParameter(l.FRAMEBUFFER_BINDING);l.viewport(c.viewport.x,c.viewport.y,c.viewport.width,c.viewport.height),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,c.colorTexture,0),o=this.data.src,a=l.createFramebuffer(),t=c.viewport.x,n=c.viewport.y,r=c.viewport.x+c.viewport.width,i=c.viewport.y+c.viewport.height,"VIDEO"===o.tagName&&(l.bindTexture(l.TEXTURE_2D,u),l.texSubImage2D(l.TEXTURE_2D,0,0,0,o.width,o.height,l.RGB,l.UNSIGNED_BYTE,o)),l.bindFramebuffer(l.READ_FRAMEBUFFER,a),l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,u,0),l.readBuffer(l.COLOR_ATTACHMENT0),l.blitFramebuffer(0,0,o.width,o.height,t,n,r,i,l.COLOR_BUFFER_BIT,l.NEAREST),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.deleteFramebuffer(a),l.bindFramebuffer(l.FRAMEBUFFER,h)},updateTransform:function(){var t=this.el,n=this.position,r=this.quaternion;t.object3D.updateMatrixWorld(),n.setFromMatrixPosition(t.object3D.matrixWorld),r.setFromRotationMatrix(t.object3D.matrixWorld),this.layerEnabled||n.set(0,0,1e8),this.layer.transform=new XRRigidTransform(n,r)},onEnterVR:function(){var t=this.el.sceneEl,n=t.xrSession;if(!t.hasWebXR||!XRWebGLBinding||!n){o("The layer component requires WebXR and the layers API enabled");return}n.requestReferenceSpace("local").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(t){this.referenceSpace=t}})},{"../core/component":131,"../utils/":205}],87:[function(t,n,r){var i=t("../utils/bind"),o=t("../utils").diff,a=t("../utils/debug"),s=t("../core/component").registerComponent,l=t("../lib/three"),c=l.Math.degToRad,u=a("components:light:warn");n.exports.Component=s("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var t=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(t)},update:function(t){var n=this.data,r=o(n,t),a=this.light,s=this.rendererSystem,l=this;if(a&&!("type"in r)){var u=!1;Object.keys(r).forEach(function(t){var r=n[t];switch(t){case"color":a.color.set(r),s.applyColorCorrection(a.color);break;case"groundColor":a.groundColor.set(r),s.applyColorCorrection(a.groundColor);break;case"angle":a.angle=c(r);break;case"target":null===r?("spot"===n.type||"directional"===n.type)&&(a.target=l.defaultTarget):r.hasLoaded?l.onSetTarget(r,a):r.addEventListener("loaded",i(l.onSetTarget,l,r,a));break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":u||(l.updateShadow(),u=!0);break;default:a[t]=r}});return}this.setLight(this.data),this.updateShadow()},setLight:function(t){var n=this.el,r=this.getLight(t);r&&(this.light&&n.removeObject3D("light"),this.light=r,this.light.el=n,n.setObject3D("light",this.light),("spot"===t.type||"directional"===t.type||"hemisphere"===t.type)&&n.getObject3D("light").translateY(-1),"spot"===t.type&&(n.setObject3D("light-target",this.defaultTarget),n.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var t=this.el,n=this.data,r=this.light;r.castShadow=n.castShadow;var i=t.getObject3D("cameraHelper");if(n.shadowCameraVisible&&!i?t.setObject3D("cameraHelper",new l.CameraHelper(r.shadow.camera)):!n.shadowCameraVisible&&i&&t.removeObject3D("cameraHelper"),!n.castShadow)return r;r.shadow.bias=n.shadowBias,r.shadow.radius=n.shadowRadius,r.shadow.mapSize.height=n.shadowMapHeight,r.shadow.mapSize.width=n.shadowMapWidth,r.shadow.camera.near=n.shadowCameraNear,r.shadow.camera.far=n.shadowCameraFar,r.shadow.camera instanceof l.OrthographicCamera?(r.shadow.camera.top=n.shadowCameraTop,r.shadow.camera.right=n.shadowCameraRight,r.shadow.camera.bottom=n.shadowCameraBottom,r.shadow.camera.left=n.shadowCameraLeft):r.shadow.camera.fov=n.shadowCameraFov,r.shadow.camera.updateProjectionMatrix(),i&&i.update()},getLight:function(t){var n=t.angle,r=new l.Color(t.color);this.rendererSystem.applyColorCorrection(r),r=r.getHex();var o=t.decay,a=t.distance,s=new l.Color(t.groundColor);this.rendererSystem.applyColorCorrection(s),s=s.getHex();var h=t.intensity,d=t.type,p=t.target,f=null;switch(d.toLowerCase()){case"ambient":return new l.AmbientLight(r,h);case"directional":return f=new l.DirectionalLight(r,h),this.defaultTarget=f.target,p&&(p.hasLoaded?this.onSetTarget(p,f):p.addEventListener("loaded",i(this.onSetTarget,this,p,f))),f;case"hemisphere":return new l.HemisphereLight(r,s,h);case"point":return new l.PointLight(r,h,a,o);case"spot":return f=new l.SpotLight(r,h,a,c(n),t.penumbra,o),this.defaultTarget=f.target,p&&(p.hasLoaded?this.onSetTarget(p,f):p.addEventListener("loaded",i(this.onSetTarget,this,p,f))),f;default:u("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",d)}},onSetTarget:function(t,n){n.target=t.object3D},remove:function(){var t=this.el;t.removeObject3D("light"),t.getObject3D("cameraHelper")&&t.removeObject3D("cameraHelper")}})},{"../core/component":131,"../lib/three":179,"../utils":205,"../utils/bind":199,"../utils/debug":201}],88:[function(t,n,r){var i=t("../core/component").registerComponent;function o(t,n){return!!t&&!!n&&t.x===n.x&&t.y===n.y&&t.z===n.z}n.exports.Component=i("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var t,n,r=this.data;this.rendererSystem=this.el.sceneEl.systems.renderer,n=this.material=new THREE.LineBasicMaterial({color:r.color,opacity:r.opacity,transparent:r.opacity<1,visible:r.visible}),(t=this.geometry=new THREE.BufferGeometry).setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.rendererSystem.applyColorCorrection(n.color),this.line=new THREE.Line(t,n),this.el.setObject3D(this.attrName,this.line)},update:function(t){var n=this.data,r=this.geometry,i=!1,a=this.material,s=r.attributes.position.array;o(n.start,t.start)||(s[0]=n.start.x,s[1]=n.start.y,s[2]=n.start.z,i=!0),o(n.end,t.end)||(s[3]=n.end.x,s[4]=n.end.y,s[5]=n.end.z,i=!0),i&&(r.attributes.position.needsUpdate=!0,r.computeBoundingSphere()),a.color.setStyle(n.color),this.rendererSystem.applyColorCorrection(a.color),a.opacity=n.opacity,a.transparent=n.opacity<1,a.visible=n.visible},remove:function(){this.el.removeObject3D("line",this.line)}})},{"../core/component":131}],89:[function(t,n,r){var i,o,a,s,l,c,u,h,d=t("../core/component").registerComponent,p=t("../core/shader").registerShader,f=t("../lib/three");n.exports.Component=d("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new f.Quaternion,this.hiddenEls=[]},update:function(t){var n,r,i=this.data,o=this.el;i.visualAspectEnabled&&(this.initVisualAspect(),n=i.highlighted?i.highlightedColor:i.backgroundColor,r=i.highlighted?i.highlightedColor:i.borderColor,o.setAttribute("material","backgroundColor",n),o.setAttribute("material","strokeColor",r),i.on!==t.on&&this.updateEventListener(),void 0!==t.peekMode&&i.peekMode!==t.peekMode&&this.updatePeekMode(),i.image&&t.image!==i.image&&o.setAttribute("material","pano","string"==typeof i.image?i.image:i.image.src))},updatePeekMode:function(){var t=this.el,n=this.sphereEl;this.data.peekMode?(this.hideAll(),t.getObject3D("mesh").visible=!1,n.setAttribute("visible",!0)):(this.showAll(),t.getObject3D("mesh").visible=!0,n.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var t=this.el;t.isPlaying&&(this.removeEventListener(),t.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var t=this.data.on;t&&this.el.removeEventListener(t,this.navigate)},initVisualAspect:function(){var t,n,r,i=this.el;this.data.visualAspectEnabled&&!this.visualAspectInitialized&&(r=this.textEl=this.textEl||document.createElement("a-entity"),n=this.sphereEl=this.sphereEl||document.createElement("a-entity"),t=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),i.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),i.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),r.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),r.setAttribute("position","0 1.5 0"),i.appendChild(r),t.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),t.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),t.setAttribute("rotation","0 180 0"),t.setAttribute("position","0 0 0"),t.setAttribute("visible",!1),i.appendChild(t),n.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),n.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),n.setAttribute("visible",!1),i.appendChild(n),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:(i=new f.Vector3,o=new f.Vector3,a=new f.Quaternion,s=new f.Vector3,function(){var t,n,r=this.el,l=r.object3D,c=r.sceneEl.camera,u=this.textEl;if(this.data.visualAspectEnabled){if(l.updateMatrixWorld(),c.parent.updateMatrixWorld(),c.updateMatrixWorld(),l.matrix.decompose(o,a,s),o.setFromMatrixPosition(l.matrixWorld),i.setFromMatrixPosition(c.matrixWorld),(n=o.distanceTo(i))>20)this.previousQuaternion||(this.quaternionClone.copy(a),this.previousQuaternion=this.quaternionClone),l.lookAt(i);else{if(t=this.calculateCameraPortalOrientation(),n<.5){if(!0===this.semiSphereEl.getAttribute("visible"))return;u.setAttribute("text","width",1.5),t<=0?(u.setAttribute("position","0 0 0.75"),u.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(u.setAttribute("position","0 0 -0.75"),u.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),r.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=t}else t<=0?u.setAttribute("rotation","0 180 0"):u.setAttribute("rotation","0 0 0"),u.setAttribute("text","width",5),u.setAttribute("position","0 1.5 0"),r.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(l.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}),hideAll:function(){var t=this.el,n=this.hiddenEls,r=this;n.length>0||t.sceneEl.object3D.traverse(function(i){!(i&&i.el&&i.el.hasAttribute("link-controls"))&&i.el&&i!==t.sceneEl.object3D&&i.el!==t&&i.el!==r.sphereEl&&i.el!==t.sceneEl.cameraEl&&!1!==i.el.getAttribute("visible")&&i.el!==r.textEl&&i.el!==r.semiSphereEl&&(i.el.setAttribute("visible",!1),n.push(i.el))})},showAll:function(){this.hiddenEls.forEach(function(t){t.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:(l=new f.Matrix4,c=new f.Vector3,u=new f.Vector3(0,0,1),h=new f.Vector3(0,0,0),function(){var t=this.el,n=t.sceneEl.camera;return c.set(0,0,0),u.set(0,0,1),h.set(0,0,0),t.object3D.matrixWorld.extractRotation(l),u.applyMatrix4(l),t.object3D.updateMatrixWorld(),t.object3D.localToWorld(h),n.parent.parent.updateMatrixWorld(),n.parent.updateMatrixWorld(),n.updateMatrixWorld(),n.localToWorld(c),c.sub(h).normalize(),u.normalize(),Math.sign(u.dot(c))}),remove:function(){this.removeEventListener()}}),p("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:"vec3 portalPosition;\nvarying vec3 vWorldPosition;\nvarying float vDistanceToCenter;\nvarying float vDistance;\nvoid main() {\nvDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);\nportalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;\nvDistance = length(portalPosition - cameraPosition);\nvWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#define RECIPROCAL_PI2 0.15915494\nuniform sampler2D pano;\nuniform vec3 strokeColor;\nuniform vec3 backgroundColor;\nuniform float borderEnabled;\nvarying float vDistanceToCenter;\nvarying float vDistance;\nvarying vec3 vWorldPosition;\nvoid main() {\nvec3 direction = normalize(vWorldPosition - cameraPosition);\nvec2 sampleUV;\nfloat borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);\nsampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);\nsampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;\nif (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {\ngl_FragColor = vec4(strokeColor, 1.0);\n} else {\ngl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));\n}\n}"})},{"../core/component":131,"../core/shader":141,"../lib/three":179}],90:[function(t,n,r){var i,o=t("../core/component").registerComponent,a=t("../lib/three"),s=t("../utils/"),l=s.bind,c=Math.PI/2;n.exports.Component=o("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new a.Vector3,this.hmdQuaternion=new a.Quaternion,this.magicWindowAbsoluteEuler=new a.Euler,this.magicWindowDeltaEuler=new a.Euler,this.position=new a.Vector3,this.magicWindowObject=new a.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new a.Vector3,rotation:new a.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},setupMagicWindowControls:function(){var t,n=this.data;s.device.isMobile()&&(t=this.magicWindowControls=new a.DeviceOrientationControls(this.magicWindowObject),"undefined"!=typeof DeviceOrientationEvent&&DeviceOrientationEvent.requestPermission&&(t.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?t.enabled=n.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){t.enabled=n.magicWindowTrackingEnabled})))},update:function(t){var n=this.data;n.enabled!==t.enabled&&this.updateGrabCursor(n.enabled),t&&!n.magicWindowTrackingEnabled&&t.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=n.magicWindowTrackingEnabled),t&&!n.pointerLockEnabled!==t.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(t){this.data.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=l(this.onMouseDown,this),this.onMouseMove=l(this.onMouseMove,this),this.onMouseUp=l(this.onMouseUp,this),this.onTouchStart=l(this.onTouchStart,this),this.onTouchMove=l(this.onTouchMove,this),this.onTouchEnd=l(this.onTouchEnd,this),this.onEnterVR=l(this.onEnterVR,this),this.onExitVR=l(this.onExitVR,this),this.onPointerLockChange=l(this.onPointerLockChange,this),this.onPointerLockError=l(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new a.Object3D,this.yawObject=new a.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var t=this.el.sceneEl,n=t.canvas;if(!n){t.addEventListener("render-target-loaded",l(this.addEventListeners,this));return}n.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),n.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),t.addEventListener("enter-vr",this.onEnterVR),t.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var t=this.el.sceneEl,n=t&&t.canvas;n&&(n.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),n.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("enter-vr",this.onEnterVR),t.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:(i=new a.Matrix4,function(){var t,n=this.el.object3D,r=this.pitchObject,o=this.yawObject,a=this.el.sceneEl;if(a.is("vr-mode")&&a.checkHeadsetConnected()){a.hasWebXR&&(t=a.renderer.xr.getCameraPose())&&(i.elements=t.transform.matrix,i.decompose(n.position,n.rotation,n.scale));return}this.updateMagicWindowOrientation(),n.rotation.x=this.magicWindowDeltaEuler.x+r.rotation.x,n.rotation.y=this.magicWindowDeltaEuler.y+o.rotation.y,n.rotation.z=this.magicWindowDeltaEuler.z}),updateMagicWindowOrientation:function(){var t=this.magicWindowAbsoluteEuler,n=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),t.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),this.previousMagicWindowYaw||0===t.y||(this.previousMagicWindowYaw=t.y),this.previousMagicWindowYaw&&(n.x=t.x,n.y+=t.y-this.previousMagicWindowYaw,n.z=t.z,this.previousMagicWindowYaw=t.y))},onMouseMove:function(t){var n,r,i,o=this.pitchObject,a=this.previousMouseEvent,s=this.yawObject;this.data.enabled&&(this.mouseDown||this.pointerLocked)&&(this.pointerLocked?(r=t.movementX||t.mozMovementX||0,i=t.movementY||t.mozMovementY||0):(r=t.screenX-a.screenX,i=t.screenY-a.screenY),this.previousMouseEvent.screenX=t.screenX,this.previousMouseEvent.screenY=t.screenY,n=this.data.reverseMouseDrag?1:-1,s.rotation.y+=.002*r*n,o.rotation.x+=.002*i*n,o.rotation.x=Math.max(-c,Math.min(c,o.rotation.x)))},onMouseDown:function(t){var n=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||n.is("vr-mode")&&n.checkHeadsetConnected())&&0===t.button){var r=n&&n.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=t.screenX,this.previousMouseEvent.screenY=t.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(r.requestPointerLock?r.requestPointerLock():r.mozRequestPointerLock&&r.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(t){1!==t.touches.length||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||(this.touchStart={x:t.touches[0].pageX,y:t.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(t){var n,r,i=this.el.sceneEl.canvas,o=this.yawObject;this.touchStarted&&this.data.touchEnabled&&(r=2*Math.PI*(t.touches[0].pageX-this.touchStart.x)/i.clientWidth,n=this.data.reverseTouchDrag?1:-1,o.rotation.y-=.5*r*n,this.touchStart={x:t.touches[0].pageX,y:t.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var t=this.el.sceneEl;t.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),t.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(t){var n=this.el.sceneEl;function r(){n.canvas.classList.add("a-grab-cursor")}function i(){n.canvas.classList.remove("a-grab-cursor")}if(!n.canvas){t?n.addEventListener("render-target-loaded",r):n.addEventListener("render-target-loaded",i);return}if(t){r();return}i()},saveCameraPose:function(){var t=this.el;this.savedPose.position.copy(t.object3D.position),this.savedPose.rotation.copy(t.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var t=this.el,n=this.savedPose;this.hasSavedPose&&(t.object3D.position.copy(n.position),t.object3D.rotation.copy(n.rotation),this.hasSavedPose=!1)}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],91:[function(t,n,r){var i=t("../utils/bind"),o=t("../core/component").registerComponent,a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u="magicleap-one";n.exports.Component=o("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]},init:function(){var t=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=i(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var t=this.data;this.controllerIndex="right"===t.hand?0:"left"===t.hand?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=i(this.onModelLoaded,this),this.onControllersUpdate=i(this.onControllersUpdate,this),this.checkIfControllerPresent=i(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=i(this.removeControllersUpdateListener,this),this.onAxisMoved=i(this.onAxisMoved,this)},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("axismove",this.onAxisMoved),t.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("axismove",this.onAxisMoved),t.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var t=this.data;s(this,u,{index:this.controllerIndex,hand:t.hand})},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{idPrefix:u,hand:n.hand,controller:this.controllerIndex,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&("trigger"===n&&console.log("analog value of trigger press: "+t.detail.state.value),this.el.emit(n+"changed",t.detail.state))},onModelLoaded:function(t){t.detail.model.scale.set(.01,.01,.01)},onAxisMoved:function(t){l(this,this.mapping.axes,t)},updateModel:function(t,n){},setButtonColor:function(t,n){}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],92:[function(t,n,r){var i=t("../utils/"),o=t("../core/component"),a=t("../lib/three"),s=t("../core/shader"),l=i.debug("components:material:error"),c=o.registerComponent,u=s.shaders,h=s.shaderNames;function d(t,n){t.dispose(),n.unregisterMaterial(t)}n.exports.Component=c("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:h,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(t){var n=this.data;this.shader&&n.shader===t.shader||this.updateShader(n.shader),this.shader.update(this.data),this.updateMaterial(t)},updateSchema:function(t){var n,r,i,o;r=t&&t.shader,n=this.oldData&&this.oldData.shader,(i=u[o=r||n]&&u[o].schema)||l("Unknown shader schema "+o),n&&r===n||(this.extendSchema(i),this.updateBehavior())},updateBehavior:function(){var t,n,r=this.el.sceneEl,i=this.schema,o=this;function a(t,r){var i;for(i in n)n[i]=t;o.shader.update(n)}for(t in this.tick=void 0,n={},i)"time"===i[t].type&&(this.tick=a,n[t]=!0);r&&(this.tick?r.addBehavior(this):r.removeBehavior(this))},updateShader:function(t){var n,r=this.data,i=u[t]&&u[t].Shader;if(!i)throw Error("Unknown shader "+t);(n=this.shader=new i).el=this.el,n.init(r),this.setMaterial(n.material),this.updateSchema(r)},updateMaterial:function(t){var n,r=this.data,i=this.material;for(n in i.alphaTest=r.alphaTest,i.depthTest=!1!==r.depthTest,i.depthWrite=!1!==r.depthWrite,i.opacity=r.opacity,i.flatShading=r.flatShading,i.side=function(t){switch(t){case"back":return a.BackSide;case"double":return a.DoubleSide;default:return a.FrontSide}}(r.side),i.transparent=!1!==r.transparent||r.opacity<1,i.vertexColors=function(t){switch(t){case"face":return a.FaceColors;case"vertex":return a.VertexColors;default:return a.NoColors}}(r.vertexColors),i.visible=r.visible,i.blending=function(t){switch(t){case"none":return a.NoBlending;case"additive":return a.AdditiveBlending;case"subtractive":return a.SubtractiveBlending;case"multiply":return a.MultiplyBlending;default:return a.NormalBlending}}(r.blending),i.dithering=r.dithering,t)break;n&&(t.alphaTest!==r.alphaTest||t.side!==r.side||t.vertexColors!==r.vertexColors)&&(i.needsUpdate=!0)},remove:function(){var t=new a.MeshBasicMaterial,n=this.material,r=this.el.getObject3D("mesh");r&&(r.material=t),d(n,this.system)},setMaterial:function(t){var n,r=this.el,i=this.system;this.material&&d(this.material,i),this.material=t,i.registerMaterial(t),(n=r.getObject3D("mesh"))?n.material=t:r.addEventListener("object3dset",function n(i){"mesh"===i.detail.type&&i.target===r&&(r.getObject3D("mesh").material=t,r.removeEventListener("object3dset",n))})}})},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205}],93:[function(t,n,r){var i=t("../utils/debug"),o=t("../core/component").registerComponent,a=t("../lib/three"),s=i("components:obj-model:warn");n.exports.Component=o("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var t=this;this.model=null,this.objLoader=new a.OBJLoader,this.mtlLoader=new a.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(n){t.model&&"material"===n.detail.name&&t.applyMaterial()})},update:function(){var t=this.data;t.obj&&(this.resetMesh(),this.loadObj(t.obj,t.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(t,n){var r=this,i=this.el,o=this.mtlLoader,a=this.objLoader,l=this.el.sceneEl.systems.renderer,c=n.substr(0,n.lastIndexOf("/")+1);if(n){i.hasAttribute("material")&&s("Material component properties are ignored when a .MTL is provided"),o.setResourcePath(c),o.load(n,function(n){n.preload(),a.setMaterials(n),a.load(t,function(t){r.model=t,r.model.traverse(function(t){if(t.isMesh){var n=t.material;n.color&&l.applyColorCorrection(n.color),n.map&&l.applyColorCorrection(n.map),n.emissive&&l.applyColorCorrection(n.emissive),n.emissiveMap&&l.applyColorCorrection(n.emissiveMap)}}),i.setObject3D("mesh",t),i.emit("model-loaded",{format:"obj",model:t})})});return}a.load(t,function(t){r.model=t,r.applyMaterial(),i.setObject3D("mesh",t),i.emit("model-loaded",{format:"obj",model:t})})},applyMaterial:function(){var t=this.el.components.material;t&&this.model.traverse(function(n){n instanceof a.Mesh&&(n.material=t.material)})}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],94:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u=t("../utils/").device.isWebXRAvailable,h=u?"oculus-go":"Oculus Go";n.exports.Component=i("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:u?{axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]}:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){s(this,h,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{armModel:n.armModel,hand:n.hand,idPrefix:h,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(t){var n,r=t.detail.model;this.data.model&&((n=this.buttonMeshes={}).trigger=r.getObjectByName("oculus_go_button_trigger"),n.trackpad=r.getObjectByName("oculus_go_touchpad"),n.touchpad=r.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&this.el.emit(n+"changed",t.detail.state)},onAxisMoved:function(t){l(this,this.mapping.axes,t)},updateModel:function(t,n){this.data.model&&this.updateButtonModel(t,n)},updateButtonModel:function(t,n){var r,i,o=this.buttonMeshes;if(o&&o[t]){switch(n){case"down":r=this.data.buttonHighlightColor;break;case"touchstart":r=this.data.buttonTouchedColor;break;default:r=this.data.buttonColor}(i=o[t]).material.color.set(r),this.rendererSystem.applyColorCorrection(i.material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],95:[function(t,n,r){var i=t("../utils/bind"),o=t("../core/component").registerComponent,a=t("../lib/three"),s=t("../utils/tracked-controls"),l=s.checkControllerPresentAndSetup,c=s.emitIfAxesChanged,u=s.onButtonEvent,h=t("../utils/").device.isWebXRAvailable,d="oculus-touch",p=h?d:"Oculus Touch",f="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",m={left:{modelUrl:f+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new a.Vector3(-.005,.003,-.055),modelPivotRotation:new a.Euler(0,0,0)},right:{modelUrl:f+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new a.Vector3(.005,.003,-.055),modelPivotRotation:new a.Euler(0,0,0)}},v={left:{modelUrl:f+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new a.Vector3(-.005,.036,-.037),modelPivotRotation:new a.Euler(Math.PI/4.5,0,0)},right:{modelUrl:f+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new a.Vector3(.005,.036,-.037),modelPivotRotation:new a.Euler(Math.PI/4.5,0,0)}},g="oculus-touch",y={"oculus-touch":h?v:m,"oculus-touch-v2":{left:{modelUrl:f+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new a.Vector3(0,0,0),modelPivotRotation:new a.Euler(0,0,0)},right:{modelUrl:f+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new a.Vector3(0,0,0),modelPivotRotation:new a.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:f+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new a.Vector3(.01,-.01,.05),modelPivotRotation:new a.Euler(Math.PI/4,0,0)},right:{modelUrl:f+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new a.Vector3(-.01,-.01,.05),modelPivotRotation:new a.Euler(Math.PI/4,0,0)}}};n.exports.Component=o("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:h?{left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}}:{left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},bindMethods:function(){this.onModelLoaded=i(this.onModelLoaded,this),this.onControllersUpdate=i(this.onControllersUpdate,this),this.checkIfControllerPresent=i(this.checkIfControllerPresent,this),this.onAxisMoved=i(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=i(this.onButtonChanged,this),this.onButtonDown=function(n){u(n.detail.id,"down",t,t.data.hand)},this.onButtonUp=function(n){u(n.detail.id,"up",t,t.data.hand)},this.onButtonTouchStart=function(n){u(n.detail.id,"touchstart",t,t.data.hand)},this.onButtonTouchEnd=function(n){u(n.detail.id,"touchend",t,t.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("axismove",this.onAxisMoved),t.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("axismove",this.onAxisMoved),t.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){l(this,p,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(t){var n,r=this.data;if(r.model){if(this.displayModel=y[r.controllerType]||y[g],"auto"===r.controllerType){var i=this.el.sceneEl.systems["tracked-controls-webvr"];if(i&&i.vrDisplay){var o=i.vrDisplay.displayName;/^Oculus Quest$/.test(o)&&(this.displayModel=y["oculus-touch-v2"])}else n=g,n=-1!==t.profiles.indexOf("oculus-touch-v2")?"oculus-touch-v2":n,n=-1!==t.profiles.indexOf("oculus-touch-v3")?"oculus-touch-v3":n,this.displayModel=y[n]}var a=this.displayModel[r.hand].modelUrl;this.el.setAttribute("gltf-model",a)}},injectTrackedControls:function(t){var n=this.data,r="right"===n.hand?"Oculus Touch (Right)":"Oculus Touch (Left)";this.el.setAttribute("tracked-controls",{id:h?d:r,hand:n.hand,orientationOffset:n.orientationOffset,handTrackingEnabled:!1}),this.loadModel(t)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var n,r=this.mapping[this.data.hand].buttons[t.detail.id],i=this.buttonMeshes;r&&(("trigger"===r||"grip"===r)&&(n=t.detail.state.value),i&&("trigger"===r&&i.trigger&&(i.trigger.rotation.x=this.originalXRotationTrigger-Math.PI/26*n),"grip"===r&&i.grip&&(i.grip.position.x=this.originalXPositionGrip+("left"===this.data.hand?-1:1)*n*.004)),this.el.emit(r+"changed",t.detail.state))},onModelLoaded:function(t){var n,r=this.controllerObject3D=t.detail.model;this.data.model&&((n=this.buttonMeshes={}).grip=r.getObjectByName("buttonHand"),this.originalXPositionGrip=n.grip&&n.grip.position.x,n.thumbstick=r.getObjectByName("stick"),n.trigger=r.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=n.trigger&&n.trigger.rotation.x,n.xbutton=r.getObjectByName("buttonX"),n.abutton=r.getObjectByName("buttonA"),n.ybutton=r.getObjectByName("buttonY"),n.bbutton=r.getObjectByName("buttonB"),r.position.copy(this.displayModel[this.data.hand].modelPivotOffset),r.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(t){c(this,this.mapping[this.data.hand].axes,t)},updateModel:function(t,n){this.data.model&&this.updateButtonModel(t,n)},updateButtonModel:function(t,n){var r,i="up"===n||"touchend"===n?this.data.buttonColor:"touchstart"===n?this.data.buttonTouchColor:this.data.buttonHighlightColor,o=this.buttonMeshes;this.data.model&&o&&o[t]&&((r=o[t]).material.color.set(i),this.rendererSystem.applyColorCorrection(r.material.color))}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],96:[function(t,n,r){var i=t("../core/component").registerComponent;n.exports.Component=i("position",{schema:{type:"vec3"},update:function(){var t=this.el.object3D,n=this.data;t.position.set(n.x,n.y,n.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":131}],97:[function(t,n,r){var i,o,a=t("../core/component").registerComponent,s=t("../lib/three"),l=t("../utils/").debug("components:raycaster:warn"),c=/^[\w\s-.,[\]#]*$/,u={childList:!0,attributes:!0,subtree:!0},h={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared"};function d(t,n){var r;for(r=0,t.length=n.length;r<n.length;r++)t[r]=n[r]}n.exports.Component=a("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new s.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new s.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new s.Vector3,this.otherLineEndVec3=new s.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(t){var n=this.data,r=this.el,i=this.raycaster;i.far=n.far,i.near=n.near,n.showLine&&(n.far!==t.far||n.origin!==t.origin||n.direction!==t.direction||!t.showLine)&&(this.unitLineEndVec3.copy(n.origin).add(n.direction).normalize(),this.drawLine()),!n.showLine&&t.showLine&&r.removeAttribute("line"),n.objects===t.objects||c.test(n.objects)||l('[raycaster] Selector "'+n.objects+'" may not update automatically with DOM changes.'),n.objects||l('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),n.autoRefresh!==t.autoRefresh&&r.isPlaying&&(n.autoRefresh?this.addEventListeners():this.removeEventListeners()),t.enabled&&!n.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,u),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var t,n=this.data;t=n.objects?this.el.sceneEl.querySelectorAll(n.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(t),this.dirty=!1},tock:function(t){var n=this.data,r=this.prevCheckTime;!n.enabled||r&&t-r<n.interval||(this.prevCheckTime=t,this.checkIntersections())},checkIntersections:function(){var t,n,r=this.clearedIntersectedEls,i=this.el,o=this.data,a=this.intersectedEls,s=this.intersections,l=this.newIntersectedEls,c=this.newIntersections,u=this.prevIntersectedEls,p=this.rawIntersections;for(this.dirty&&this.refreshObjects(),d(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),p.length=0,this.raycaster.intersectObjects(this.objects,!0,p),s.length=0,a.length=0,t=0;t<p.length;t++)n=p[t],(!o.showLine||n.object!==i.getObject3D("line"))&&n.object.el&&(s.push(n),a.push(n.object.el));for(t=0,c.length=0,l.length=0;t<s.length;t++)-1===u.indexOf(s[t].object.el)&&(c.push(s[t]),l.push(s[t].object.el));for(t=0,r.length=0;t<u.length;t++)-1===a.indexOf(u[t])&&(u[t].emit(h.INTERSECT_CLEAR,this.intersectedClearedDetail),r.push(u[t]));for(r.length&&i.emit(h.INTERSECTION_CLEAR,this.intersectionClearedDetail),t=0;t<l.length;t++)l[t].emit(h.INTERSECT,this.intersectedDetail);c.length&&(this.intersectionDetail.els=l,this.intersectionDetail.intersections=c,i.emit(h.INTERSECTION,this.intersectionDetail)),o.showLine&&setTimeout(this.updateLine)},updateLine:function(){var t,n=this.el,r=this.intersections;r.length&&(t=r[0].object.el===n&&r[1]?r[1].distance:r[0].distance),this.drawLine(t)},getIntersection:function(t){var n,r;for(n=0;n<this.intersections.length;n++)if((r=this.intersections[n]).object.el===t)return r;return null},updateOriginDirection:(i=new s.Vector3,o=new s.Vector3,function(){var t=this.el,n=this.data;if(n.useWorldCoordinates){this.raycaster.set(n.origin,n.direction);return}t.object3D.updateMatrixWorld(),o.setFromMatrixPosition(t.object3D.matrixWorld),(0!==n.origin.x||0!==n.origin.y||0!==n.origin.z)&&(o=t.object3D.localToWorld(o.copy(n.origin))),i.copy(n.direction).transformDirection(t.object3D.matrixWorld).normalize(),this.raycaster.set(o,i)}),drawLine:function(t){var n,r=this.data,i=this.el;n=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,void 0===t&&(t=r.far===1/0?1e3:r.far),this.lineData.start=r.origin,this.lineData.end=n.copy(this.unitLineEndVec3).multiplyScalar(t),this.lineData.color=r.lineColor,this.lineData.opacity=r.lineOpacity,i.setAttribute("line",this.lineData)},flattenObject3DMaps:function(t){var n,r,i=this.objects;for(r=0,i.length=0;r<t.length;r++)if(t[r].isEntity&&t[r].object3D)for(n in t[r].object3DMap)i.push(t[r].getObject3D(n));return i},clearAllIntersections:function(){var t;for(t=0;t<this.intersectedEls.length;t++)this.intersectedEls[t].emit(h.INTERSECT_CLEAR,this.intersectedClearedDetail);d(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(h.INTERSECTION_CLEAR,this.intersectionClearedDetail)}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],98:[function(t,n,r){var i=t("../lib/three").Math.degToRad,o=t("../core/component").registerComponent;n.exports.Component=o("rotation",{schema:{type:"vec3"},update:function(){var t=this.data,n=this.el.object3D;n.rotation.set(i(t.x),i(t.y),i(t.z)),n.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":131,"../lib/three":179}],99:[function(t,n,r){var i=t("../core/component").registerComponent;n.exports.Component=i("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var t=this.data,n=this.el.object3D,r=0===t.x?1e-5:t.x,i=0===t.y?1e-5:t.y,o=0===t.z?1e-5:t.z;n.scale.set(r,i,o)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":131}],100:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../core/component").components;n.exports.Component=i("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var t=this.data,n=this.el.object3D;if(t.transparent){n.background=null;return}n.background=new THREE.Color(t.color)},remove:function(){var t=this.data,n=this.el.object3D;if(t.transparent){n.background=null;return}n.background=o[this.name].schema.color.default}})},{"../../core/component":131}],101:[function(t,n,r){var i=t("../../core/component").registerComponent;n.exports.Component=i("debug",{schema:{default:!0}})},{"../../core/component":131}],102:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../utils/"),a=o.bind,s=t("../../constants/"),l="a-dialog-buttons-container",c="a-dialog-button";function u(t,n,r){var i,o;return(i=document.createElement("div")).classList.add(l),(o=document.createElement("button")).classList.add(c,"a-dialog-ok-button"),o.setAttribute(s.AFRAME_INJECTED,""),o.innerHTML=t,i.appendChild(o),o.addEventListener("click",function(t){t.stopPropagation(),r()}),h(n,i)}function h(t,n){var r,i,o,a;return(r=document.createElement("div")).classList.add("a-modal"),r.setAttribute(s.AFRAME_INJECTED,""),(i=document.createElement("div")).className="a-dialog",i.setAttribute(s.AFRAME_INJECTED,""),r.appendChild(i),(o=document.createElement("div")).classList.add("a-dialog-text-container"),i.appendChild(o),(a=document.createElement("div")).classList.add("a-dialog-text"),a.innerHTML=t,o.appendChild(a),i.appendChild(n),r}n.exports.Component=i("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},mobileDesktopMessage:{default:"Set your browser to request the mobile version of the site and reload the page to enjoy immersive mode."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var t=this;if(this.data.enabled){if("localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"http:"===location.protocol&&this.showHTTPAlert(),o.device.isMobileDeviceRequestingDesktopSite()){this.showMobileDesktopModeAlert();return}if("undefined"==typeof DeviceOrientationEvent||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=a(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=a(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){var n,r,i,o,a,u,d,p;t.devicePermissionDialogEl=(n=t.data.denyButtonText,r=t.data.allowButtonText,i=t.data.deviceMotionMessage,o=t.onDeviceMotionDialogAllowClicked,a=t.onDeviceMotionDialogDenyClicked,(u=document.createElement("div")).classList.add(l),(d=document.createElement("button")).classList.add(c,"a-dialog-deny-button"),d.setAttribute(s.AFRAME_INJECTED,""),d.innerHTML=n,u.appendChild(d),(p=document.createElement("button")).classList.add(c,"a-dialog-allow-button"),p.setAttribute(s.AFRAME_INJECTED,""),p.innerHTML=r,u.appendChild(p),p.addEventListener("click",function(t){t.stopPropagation(),o()}),d.addEventListener("click",function(t){t.stopPropagation(),a()}),h(i,u)),t.el.appendChild(t.devicePermissionDialogEl)}).then(function(){t.el.emit("deviceorientationpermissiongranted"),t.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showMobileDesktopModeAlert:function(){var t=this,n=u(t.data.cancelButtonText,t.data.mobileDesktopMessage,function(){t.el.removeChild(n)});this.el.appendChild(n)},showHTTPAlert:function(){var t=this,n=u(t.data.cancelButtonText,t.data.httpsMessage,function(){t.el.removeChild(n)});this.el.appendChild(n)},onDeviceMotionDialogAllowClicked:function(){var t=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(n){"granted"===n?(t.el.emit("deviceorientationpermissiongranted"),t.permissionGranted=!0):t.el.emit("deviceorientationpermissionrejected"),t.remove()}).catch(console.error)}})},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],103:[function(t,n,r){var i=t("../../core/component").registerComponent;n.exports.Component=i("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var t=this.el,n=t.querySelector(".a-enter-vr");!0===this.data?(n&&n.classList.add("embedded"),t.removeFullScreenStyles()):(n&&n.classList.remove("embedded"),t.addFullScreenStyles())}})},{"../../core/component":131}],104:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../lib/three"),a=t("../../utils/debug")("components:fog:warn");n.exports.Component=i("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var t,n=this.data,r=this.el,i=this.el.object3D.fog;if(!r.isScene){a("Fog component can only be applied to <a-scene>");return}if(!i||n.type!==i.name){r.object3D.fog=((t="exponential"===n.type?new o.FogExp2(n.color,n.density):new o.Fog(n.color,n.near,n.far)).name=n.type,t),r.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(t){var r=n[t];"color"===t&&(r=new o.Color(r)),i[t]=r})},remove:function(){var t=this.el.object3D.fog;t&&(t.far=0,t.near=.1)}})},{"../../core/component":131,"../../lib/three":179,"../../utils/debug":201}],105:[function(t,n,r){(function(r){var i,o=t("../../constants").AFRAME_INJECTED,a=t("../../../package"),s=t("../../core/component").registerComponent,l=t("../../utils/"),c="https://unpkg.com/aframe-inspector@"+((i=a.version.split("."))[2]="x",i.join("."))+"/dist/aframe-inspector.min.js",u="dev"===r.env.INSPECTOR_VERSION?"https://aframe.io/aframe-inspector/dist/aframe-inspector.js":c;n.exports.Component=s("inspector",{schema:{url:{default:u}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var t;this.firstPlay&&"false"!==(t=l.getUrlParameter("inspector"))&&t&&(this.openInspector(),this.firstPlay=!1)},initOverlay:function(){this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML='Loading Inspector<span class="dots"><span>.</span><span>.</span><span>.</span></span>'},remove:function(){this.removeEventListeners()},onKeydown:function(t){73===t.keyCode&&(t.ctrlKey&&t.altKey||t.getModifierState("AltGraph"))&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(t){"INJECT_AFRAME_INSPECTOR"===t.data&&this.openInspector()},openInspector:function(t){var n,r=this;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(t);return}this.showLoader(),(n=document.createElement("script")).src=this.data.url,n.setAttribute("data-name","aframe-inspector"),n.setAttribute(o,""),n.onload=function(){AFRAME.INSPECTOR.open(t),r.hideLoader(),r.removeEventListeners()},n.onerror=function(){r.loadingMessageEl.innerHTML="Error loading Inspector"},document.head.appendChild(n),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,t("_process"))},{"../../../package":73,"../../constants":123,"../../core/component":131,"../../utils/":205,_process:49}],106:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../utils/").shouldCaptureKeyEvent;n.exports.Component=i("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(t){var n=this.data;this.enterVREnabled=n.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(t){var n=this.el;o(t)&&(this.enterVREnabled&&70===t.keyCode&&n.enterVR(),this.enterVREnabled&&27===t.keyCode&&n.exitVR())}})},{"../../core/component":131,"../../utils/":205}],107:[function(t,n,r){var i=t("../../utils/debug"),o=t("../../core/component").registerComponent,a=i("components:pool:warn");n.exports.Component=o("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var t;for(this.availableEls=[],this.usedEls=[],this.data.mixin||a("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||a("Container "+this.data.container+" not found.")),this.container=this.container||this.el,t=0;t<this.data.size;++t)this.createEntity()},update:function(t){var n=this.data;(t.mixin!==n.mixin||t.size!==n.size)&&this.initPool()},createEntity:function(){var t;(t=document.createElement("a-entity")).play=this.wrapPlay(t.play),t.setAttribute("mixin",this.data.mixin),t.object3D.visible=!1,t.pause(),this.container.appendChild(t),this.availableEls.push(t)},wrapPlay:function(t){var n=this.usedEls;return function(){-1!==n.indexOf(this)&&t.call(this)}},requestEntity:function(){var t;if(0===this.availableEls.length){if(!1===this.data.dynamic){a("Requested entity from empty pool: "+this.attrName);return}a("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName),this.createEntity()}return t=this.availableEls.shift(),this.usedEls.push(t),t.object3D.visible=!0,t},returnEntity:function(t){var n=this.usedEls.indexOf(t);if(-1===n){a("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(n,1),this.availableEls.push(t),t.object3D.visible=!1,t.pause(),t}})},{"../../core/component":131,"../../utils/debug":201}],108:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../lib/three");n.exports.Component=i("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var t=this.el,n=this;function r(){var r=t.renderer.getContext();r&&(n.cubeMapSize=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),n.material=new o.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:"attribute vec3 position;\nattribute vec2 uv;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nvarying vec2 vUv;\nvoid main()  {\n  vUv = vec2( 1.- uv.x, uv.y );\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform samplerCube map;\nvarying vec2 vUv;\n#define M_PI 3.141592653589793238462643383279\nvoid main() {\n  vec2 uv = vUv;\n  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;\n  float latitude = uv.y * M_PI;\n  vec3 dir = vec3(\n    - sin( longitude ) * sin( latitude ),\n    cos( latitude ),\n    - cos( longitude ) * sin( latitude )\n  );\n  normalize( dir );\n  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );\n}",side:o.DoubleSide}),n.quad=new o.Mesh(new o.PlaneBufferGeometry(1,1),n.material),n.quad.visible=!1,n.camera=new o.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),n.canvas=document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),t.object3D.add(n.quad),n.onKeyDown=n.onKeyDown.bind(n))}t.renderer?r():t.addEventListener("render-target-loaded",r)},getRenderTarget:function(t,n){return new o.WebGLRenderTarget(t,n,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,wrapS:o.ClampToEdgeWrapping,wrapT:o.ClampToEdgeWrapping,format:o.RGBAFormat,type:o.UnsignedByteType})},resize:function(t,n){this.quad.scale.set(t,n,1),this.camera.left=-1*t/2,this.camera.right=t/2,this.camera.top=n/2,this.camera.bottom=-1*n/2,this.camera.updateProjectionMatrix(),this.canvas.width=t,this.canvas.height=n},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(t){var n=83===t.keyCode&&t.ctrlKey&&t.altKey;if(this.data&&n){var r=t.shiftKey?"equirectangular":"perspective";this.capture(r)}},setCapture:function(t){var n,r,i,a,s=this.el;return"perspective"===t?(this.quad.visible=!1,r=this.data.camera&&this.data.camera.components.camera.camera||s.camera,n={width:this.data.width,height:this.data.height}):(r=this.camera,a=new o.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:o.RGBFormat,generateMipmaps:!0,minFilter:o.LinearMipmapLinearFilter,encoding:o.sRGBEncoding}),i=new o.CubeCamera(s.camera.near,s.camera.far,a),s.camera.getWorldPosition(i.position),s.camera.getWorldQuaternion(i.quaternion),i.update(s.renderer,s.object3D),this.quad.material.uniforms.map.value=i.renderTarget.texture,n={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:r,size:n,projection:t}},capture:function(t){var n,r=this.el.renderer.xr.enabled,i=this.el.renderer;i.xr.enabled=!1,n=this.setCapture(t),this.renderCapture(n.camera,n.size,n.projection),this.saveCapture(),i.xr.enabled=r},getCanvas:function(t){var n=this.el.renderer.xr.enabled,r=this.el.renderer,i=this.setCapture(t);return r.xr.enabled=!1,this.renderCapture(i.camera,i.size,i.projection),r.xr.enabled=n,this.canvas},renderCapture:function(t,n,r){var i,o,a,s=this.el.renderer.autoClear,l=this.el,c=l.renderer;o=this.getRenderTarget(n.width,n.height),a=new Uint8Array(4*n.width*n.height),this.resize(n.width,n.height),c.autoClear=!0,c.clear(),c.setRenderTarget(o),c.render(l.object3D,t),c.autoClear=s,c.readRenderTargetPixels(o,0,0,n.width,n.height,a),c.setRenderTarget(null),"perspective"===r&&(a=this.flipPixelsVertically(a,n.width,n.height)),i=new ImageData(new Uint8ClampedArray(a),n.width,n.height),this.quad.visible=!1,this.ctx.putImageData(i,0,0)},flipPixelsVertically:function(t,n,r){for(var i=t.slice(0),o=0;o<n;++o)for(var a=0;a<r;++a)i[4*o+a*n*4]=t[4*o+(r-a)*n*4],i[4*o+1+a*n*4]=t[4*o+1+(r-a)*n*4],i[4*o+2+a*n*4]=t[4*o+2+(r-a)*n*4],i[4*o+3+a*n*4]=t[4*o+3+(r-a)*n*4];return i},saveCapture:function(){this.canvas.toBlob(function(t){var n="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",r=document.createElement("a"),i=URL.createObjectURL(t);r.href=i,r.setAttribute("download",n),r.innerHTML="downloading...",r.style.display="none",document.body.appendChild(r),setTimeout(function(){r.click(),document.body.removeChild(r)},1)},"image/png")}})},{"../../core/component":131,"../../lib/three":179}],109:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../../vendor/rStats"),a=t("../../utils");t("../../../vendor/rStats.extras"),t("../../lib/rStatsAframe");var s=window.aframeStats,l=a.bind,c="a-hidden",u=window.threeStats;n.exports.Component=i("stats",{schema:{default:!0},init:function(){var t,n,r=this.el;"false"!==a.getUrlParameter("stats")&&(this.stats=(t=new u(r.renderer),n=new s(r),new o({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:r.isMobile?[]:[t,n]})),this.statsEl=document.querySelector(".rs-base"),this.hideBound=l(this.hide,this),this.showBound=l(this.show,this),r.addEventListener("enter-vr",this.hideBound),r.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var t=this.stats;t&&(t("rAF").tick(),t("FPS").frame(),t().update())},hide:function(){this.statsEl.classList.add(c)},show:function(){this.statsEl.classList.remove(c)}})},{"../../../vendor/rStats":217,"../../../vendor/rStats.extras":216,"../../core/component":131,"../../lib/rStatsAframe":178,"../../utils":205}],110:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../constants/"),a=t("../../utils/"),s=a.bind,l="a-hidden";function c(t){t.addEventListener("touchstart",function(){t.classList.remove("resethover")}),t.addEventListener("touchend",function(){t.classList.add("resethover")})}n.exports.Component=i("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var t=this,n=this.el;"false"!==a.getUrlParameter("ui")&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),n.addEventListener("enter-vr",this.updateEnterInterfaces),n.addEventListener("exit-vr",this.updateEnterInterfaces),n.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(n){"loaderReady"===n.data.type&&(t.insideLoader=!0,t.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=s(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=s(this.onEnterARButtonClick,this),this.onModalClick=s(this.onModalClick,this),this.toggleOrientationModalIfNeeded=s(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=s(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var t,n,r,i,s,u,h,d,p,f=this.data,m=this.el;if(!f.enabled||this.insideLoader||"false"===a.getUrlParameter("ui"))return this.remove();!this.enterVREl&&!this.enterAREl&&!this.orientationModalEl&&(f.enterVRButton?(this.enterVREl=document.querySelector(f.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=(t=this.onEnterVRButtonClick,(r=document.createElement("div")).classList.add("a-enter-vr"),r.setAttribute(o.AFRAME_INJECTED,""),(n=document.createElement("button")).className="a-enter-vr-button",n.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),n.setAttribute(o.AFRAME_INJECTED,""),a.device.isMobile()&&c(n),r.appendChild(n),n.addEventListener("click",function(n){t(),n.stopPropagation()}),r),m.appendChild(this.enterVREl)),f.enterARButton?(this.enterAREl=document.querySelector(f.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=(i=this.onEnterARButtonClick,(u=document.createElement("div")).classList.add("a-enter-ar"),u.setAttribute(o.AFRAME_INJECTED,""),(s=document.createElement("button")).className="a-enter-ar-button",s.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),s.setAttribute(o.AFRAME_INJECTED,""),a.device.isMobile()&&c(s),u.appendChild(s),s.addEventListener("click",function(t){i(),t.stopPropagation()}),u),m.appendChild(this.enterAREl)),this.orientationModalEl=(h=this.onModalClick,(d=document.createElement("div")).className="a-orientation-modal",d.classList.add(l),d.setAttribute(o.AFRAME_INJECTED,""),(p=document.createElement("button")).setAttribute(o.AFRAME_INJECTED,""),p.innerHTML="Exit VR",p.addEventListener("click",h),d.appendChild(p),d),m.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var t=this.el;this.enterVREl&&(t.is("vr-mode")?this.enterVREl.classList.add(l):this.enterVREl.classList.remove(l))},toggleEnterARButtonIfNeeded:function(){var t=this.el;this.enterAREl&&(t.is("vr-mode")||!a.device.checkARSupport()?this.enterAREl.classList.add(l):this.enterAREl.classList.remove(l))},toggleOrientationModalIfNeeded:function(){var t=this.el,n=this.orientationModalEl;n&&t.isMobile&&(!a.device.isLandscape()&&t.is("vr-mode")?n.classList.remove(l):n.classList.add(l))}})},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],111:[function(t,n,r){var i=t("../core/component"),o=t("../lib/three"),a=t("../utils/bind"),s=i.registerComponent;n.exports.Component=s("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=a(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var t=this.data;this.updateDescendants(t.cast,t.receive)},remove:function(){this.el.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(t,n){var r=this.el.sceneEl;this.el.object3D.traverse(function(i){if(i instanceof o.Mesh&&(i.castShadow=t,i.receiveShadow=n,r.hasLoaded&&i.material))for(var a=Array.isArray(i.material)?i.material:[i.material],s=0;s<a.length;s++)a[s].needsUpdate=!0})}})},{"../core/component":131,"../lib/three":179,"../utils/bind":199}],112:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/debug"),a=t("../lib/three"),s=o("components:sound:warn");n.exports.Component=i("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var t=this;this.listener=null,this.audioLoader=new a.AudioLoader,this.pool=new a.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){t.playSound()}},update:function(t){var n,r,i=this.data,o=i.src!==t.src;if(o){if(!i.src)return;this.setupSound()}for(n=0;n<this.pool.children.length;n++)r=this.pool.children[n],i.positional&&(r.setDistanceModel(i.distanceModel),r.setMaxDistance(i.maxDistance),r.setRefDistance(i.refDistance),r.setRolloffFactor(i.rolloffFactor)),r.setLoop(i.loop),r.setVolume(i.volume),r.isPaused=!1;if(i.on!==t.on&&this.updateEventListener(t.on),o){var s=this;this.loaded=!1,this.audioLoader.load(i.src,function(t){for(n=0;n<s.pool.children.length;n++)(r=s.pool.children[n]).setBuffer(t);s.loaded=!0,a.Cache.remove(i.src),(s.data.autoplay||s.mustPlay)&&s.playSound(),s.el.emit("sound-loaded",s.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var t;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(t=0;t<this.pool.children.length;t++)this.pool.children[t].disconnect()}catch(t){s("Audio source not properly disconnected")}},updateEventListener:function(t){var n=this.el;t&&n.removeEventListener(t,this.playSoundBound),n.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var t,n,r=this.el,i=r.sceneEl,o=this;this.pool.children.length>0&&(this.stopSound(),r.removeObject3D("sound"));var s=this.listener=i.audioListener||new a.AudioListener;for(i.audioListener=s,i.camera&&i.camera.add(s),i.addEventListener("camera-set-active",function(t){t.detail.cameraEl.getObject3D("camera").add(s)}),this.pool=new a.Group,t=0;t<this.data.poolSize;t++)n=this.data.positional?new a.PositionalAudio(s):new a.Audio(s),this.pool.add(n);for(r.setObject3D(this.attrName,this.pool),t=0;t<this.pool.children.length;t++)(n=this.pool.children[t]).onEnded=function(){this.isPlaying=!1,o.el.emit("sound-ended",o.evtDetail,!1)}},pauseSound:function(){var t,n;for(t=0,this.isPlaying=!1;t<this.pool.children.length;t++)(n=this.pool.children[t]).source&&n.source.buffer&&n.isPlaying&&!n.isPaused&&(n.isPaused=!0,n.pause())},playSound:function(t){var n,r,i;if(!this.loaded){s("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(r=0,n=!1,this.isPlaying=!0;r<this.pool.children.length;r++)if(!(i=this.pool.children[r]).isPlaying&&i.buffer&&!n){t&&t(i),i.play(),i.isPaused=!1,n=!0;continue}if(!n){s("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var t,n;for(t=0,this.isPlaying=!1;t<this.pool.children.length;t++){if(!(n=this.pool.children[t]).source||!n.source.buffer)return;n.stop()}}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],113:[function(t,n,r){var i,o,a,s,l=t("three-bmfont-text"),c=t("load-bmfont"),u=t("../core/component").registerComponent,h=t("../core/shader"),d=t("../lib/three"),p=t("../utils/"),f=p.debug("components:text:error"),m=h.shaders,v=p.debug("components:text:warn"),g="https://cdn.aframe.io/fonts/",y={aileronsemibold:g+"Aileron-Semibold.fnt",dejavu:g+"DejaVu-sdf.fnt",exo2bold:g+"Exo2Bold.fnt",exo2semibold:g+"Exo2SemiBold.fnt",kelsonsans:g+"KelsonSans.fnt",monoid:g+"Monoid.fnt",mozillavr:g+"mozillavr.fnt",roboto:g+"Roboto-msdf.json",sourcecodepro:g+"SourceCodePro.fnt"},b=["roboto"],A="roboto";n.exports.FONTS=y;var x=new function(){var t=this.cache={};this.get=function(n,r){return n in t||(t[n]=r()),t[n]}},w={},E={},M=/^\w+:/;n.exports.Component=u("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:A},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:m},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=l(),this.createOrUpdateMaterial()},update:function(t){var n=this.data,r=this.currentFont;if(E[n.font]?this.texture=E[n.font]:(this.texture=E[n.font]=new d.Texture,this.texture.anisotropy=16),this.createOrUpdateMaterial(),t.font!==n.font){this.updateFont();return}r&&(this.updateGeometry(this.geometry,r),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var t,n,r,i,o,a,s=this.data,l=this.material,c=this.shaderData;if(a=s.shader,-1!==b.indexOf(s.font)||s.font.indexOf("-msdf.")>=0?a="msdf":s.font in y&&-1===b.indexOf(s.font)&&(a="sdf"),i=(this.shaderObject&&this.shaderObject.name)!==a,c.alphaTest=s.alphaTest,c.color=s.color,c.map=this.texture,c.opacity=s.opacity,c.side=function(t){switch(t){case"back":return d.FrontSide;case"double":return d.DoubleSide;default:return d.BackSide}}(s.side),c.transparent=s.transparent,c.negate=s.negate,!i){this.shaderObject.update(c),l.transparent=c.transparent,l.side=c.side;return}t=this.el,(r=new m[a].Shader).el=t,r.init(c),r.update(c),(n=r.material).transparent=c.transparent,o={material:n,shader:r},this.material=o.material,this.shaderObject=o.shader,this.material.side=c.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var t,n=this.data,r=this.el,i=this.geometry,o=this;n.font||v("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),t=this.lookupFont(n.font||A)||n.font,x.get(t,function(){var r;return r=n.yOffset,new Promise(function(n,i){c(t,function(o,a){if(o){f("Error loading font",t),i(o);return}t.indexOf("/Roboto-msdf.json")>=0&&(r=30),r&&a.chars.map(function(t){t.yoffset+=r}),n(a)})})}).then(function(a){var s,l,c,u;if(1!==a.pages.length)throw Error("Currently only single-page bitmap fonts are supported.");w[t]||(a.widthFactor=w[a]=(l=0,c=0,u=0,a.chars.map(function(t){l+=t.xadvance,t.id>=48&&t.id<=57&&(u++,c+=t.xadvance)}),u?c/u:l/a.chars.length)),o.currentFont=a,s=o.getFontImageSrc(),x.get(s,function(){return new Promise(function(t,n){new d.ImageLoader().load(s,function(n){t(n)},void 0,function(){f("Error loading font image",s),n(null)})})}).then(function(t){var s=o.texture;s.image=t,s.needsUpdate=!0,E[n.font]=s,o.texture=s,o.initMesh(),o.currentFont=a,o.updateGeometry(i,a),o.updateLayout(),o.mesh.visible=!0,r.emit("textfontset",{font:n.font,fontObj:a})}).catch(function(t){f(t.message),f(t.stack)})}).catch(function(t){f(t.message),f(t.stack)})},initMesh:function(){this.mesh||(this.mesh=new d.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var t=this.lookupFont(this.data.font||A)||this.data.font,n=this.currentFont.pages[0];return n.match(M)&&0!==n.indexOf("http")?t.replace(/(\.fnt)|(\.json)/,".png"):d.LoaderUtils.extractUrlBase(t)+n},updateLayout:function(){var t,n,r,i,o,a,s,l,c,u,h,d,p=this.el,f=this.data,m=this.geometry,v=this.mesh;if(v&&m.layout){if(a=p.getAttribute("geometry"),s=(c=(u=f.width||a&&a.width||1)/(t=f.wrapPixels,n=f.wrapCount,r=this.currentFont.widthFactor,t||(.5+n)*r))*((l=m.layout).height+l.descender),a&&"plane"===a.primitive&&(a.width||p.setAttribute("geometry","width",u),a.height||p.setAttribute("geometry","height",s)),"left"===(i="align"===f.anchor?f.align:f.anchor))h=0;else if("right"===i)h=-1*l.width;else if("center"===i)h=-1*l.width/2;else throw TypeError("Invalid text.anchor property value",i);if("bottom"===(o=f.baseline))d=0;else if("top"===o)d=-1*l.height+l.ascender;else if("center"===o)d=-1*l.height/2;else throw TypeError("Invalid text.baseline property value",o);v.position.x=h*c+f.xOffset,v.position.y=d*c,v.position.z=f.zOffset,v.scale.set(c,-1*c,c)}},lookupFont:function(t){return y[t]},updateGeometry:(i={},o={},a=/\\n/g,s=/\\t/g,function(t,n){var r,l,c,u=this.data;o.font=n,o.lineHeight=u.lineHeight&&isFinite(u.lineHeight)?u.lineHeight:n.common.lineHeight,o.text=u.value.toString().replace(a,"\n").replace(s,"	"),o.width=(r=u.wrapPixels,l=u.wrapCount,c=n.widthFactor,r||(.5+l)*c),t.update(p.extend(i,u,o))})})},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205,"load-bmfont":37,"three-bmfont-text":63}],114:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/tracked-controls"),a=t("../constants").DEFAULT_CAMERA_HEIGHT,s=t("../lib/three"),l=t("../constants").DEFAULT_HANDEDNESS,c={touches:[]},u={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};n.exports.Component=i("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new s.Vector3,this.controllerQuaternion=new s.Quaternion,this.controllerEuler=new s.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(t,n){var r=this.el.getObject3D("mesh");r&&r.update&&r.update(n/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return a},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var t=this.data,n=o.findMatchingControllerWebVR(this.system.controllers,t.id,t.idPrefix,t.hand,t.controller);this.controller=n,this.el.components["tracked-controls"].controller=n,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(t){var n,r,i,o,a=this.controller,s=this.controllerEuler,c=this.controllerQuaternion,u=this.deltaControllerPosition;r=this.getHeadElement().object3D,o=this.defaultUserHeight(),i=a.pose,n=(a?a.hand:void 0)||l,t.copy(r.position),u.set(.175*("left"===n?-1:"right"===n?1:0),-.3,-.03),u.multiplyScalar(o),u.applyAxisAngle(r.up,r.rotation.y),t.add(u),u.set(0,0,-.175),u.multiplyScalar(o),i.orientation?c.fromArray(i.orientation):c.copy(r.quaternion),s.setFromQuaternion(c),s.set(s.x,s.y,0),u.applyEuler(s),t.add(u)},updatePose:function(){var t,n,r=this.controller,i=this.data,o=this.el.object3D,a=this.system.vrDisplay;r&&((t=r.pose).position?o.position.fromArray(t.position):i.armModel&&this.applyArmModel(o.position),t.orientation&&o.quaternion.fromArray(t.orientation),a&&t.position&&(n=this.el.sceneEl.renderer.xr.getStandingMatrix(),o.matrix.compose(o.position,o.quaternion,o.scale),o.matrix.multiplyMatrices(n,o.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale)),o.rotateX(this.data.orientationOffset.x*s.Math.DEG2RAD),o.rotateY(this.data.orientationOffset.y*s.Math.DEG2RAD),o.rotateZ(this.data.orientationOffset.z*s.Math.DEG2RAD))},updateButtons:function(){var t,n,r=this.controller;if(r){for(n=0;n<r.buttons.length;++n)this.buttonStates[n]||(this.buttonStates[n]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[n]||(this.buttonEventDetails[n]={id:n,state:this.buttonStates[n]}),t=r.buttons[n],this.handleButton(n,t);this.handleAxes()}},handleButton:function(t,n){return!!(this.handlePress(t,n)|this.handleTouch(t,n)|this.handleValue(t,n))&&(this.el.emit(u.BUTTONCHANGED,this.buttonEventDetails[t],!1),!0)},handleAxes:function(){var t,n=!1,r=this.controller.axes,i=this.axis,o=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),t=0;t<r.length;++t)o.push(i[t]!==r[t]),o[t]&&(n=!0);if(!n)return!1;for(this.axis.splice(0,this.axis.length),t=0;t<r.length;t++)this.axis.push(r[t]);return this.el.emit(u.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(t,n){var r,i=this.buttonStates[t];return n.pressed!==i.pressed&&(r=n.pressed?u.BUTTONDOWN:u.BUTTONUP,this.el.emit(r,this.buttonEventDetails[t],!1),i.pressed=n.pressed,!0)},handleTouch:function(t,n){var r,i=this.buttonStates[t];return n.touched!==i.touched&&(r=n.touched?u.TOUCHSTART:u.TOUCHEND,this.el.emit(r,this.buttonEventDetails[t],!1,c),i.touched=n.touched,!0)},handleValue:function(t,n){var r=this.buttonStates[t];return n.value!==r.value&&(r.value=n.value,!0)}})},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/tracked-controls":214}],115:[function(t,n,r){var i=t("../utils/tracked-controls"),o=t("../core/component").registerComponent,a={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};n.exports.Component=o("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var t=this.el.sceneEl;this.updateController(),t.addEventListener("controllersupdated",this.updateController)},pause:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(t){return!!this.controller&&!this.controller.gamepad&&("none"===t.inputSource.handedness||t.inputSource.handedness===this.data.hand)},updateController:function(){this.controller=i.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var t=this.el.sceneEl,n=this.controller,r=t.frame;n&&t.frame&&this.system.referenceSpace&&(n.hand||(this.pose=r.getPose(n.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons()))},updatePose:function(){var t=this.el.object3D,n=this.pose;n&&(t.matrix.elements=n.transform.matrix,t.matrix.decompose(t.position,t.rotation,t.scale))},updateButtons:function(){var t,n,r,i=this.controller;if(i&&i.gamepad){for(n=0,r=i.gamepad;n<r.buttons.length;++n)this.buttonStates[n]||(this.buttonStates[n]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[n]||(this.buttonEventDetails[n]={id:n,state:this.buttonStates[n]}),t=r.buttons[n],this.handleButton(n,t);this.handleAxes()}},handleButton:function(t,n){return!!(this.handlePress(t,n)|this.handleTouch(t,n)|this.handleValue(t,n))&&(this.el.emit(a.BUTTONCHANGED,this.buttonEventDetails[t],!1),!0)},handleAxes:function(){var t,n=!1,r=this.controller.gamepad.axes,i=this.axis,o=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),t=0;t<r.length;++t)o.push(i[t]!==r[t]),o[t]&&(n=!0);if(!n)return!1;for(this.axis.splice(0,this.axis.length),t=0;t<r.length;t++)this.axis.push(r[t]);return this.el.emit(a.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(t,n){var r,i=this.buttonStates[t];return n.pressed!==i.pressed&&(r=n.pressed?a.BUTTONDOWN:a.BUTTONUP,this.el.emit(r,this.buttonEventDetails[t],!1),i.pressed=n.pressed,!0)},handleTouch:function(t,n){var r,i=this.buttonStates[t];return n.touched!==i.touched&&(r=n.touched?a.TOUCHSTART:a.TOUCHEND,this.el.emit(r,this.buttonEventDetails[t],!1),i.touched=n.touched,!0)},handleValue:function(t,n){var r=this.buttonStates[t];return n.value!==r.value&&(r.value=n.value,!0)}})},{"../core/component":131,"../utils/tracked-controls":214}],116:[function(t,n,r){var i=t("../core/component").registerComponent;n.exports.Component=i("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var t=this.data,n=this.el;n.sceneEl.hasWebXR?n.setAttribute("tracked-controls-webxr",{id:t.id,hand:t.hand,index:t.controller,iterateControllerProfiles:t.iterateControllerProfiles,handTrackingEnabled:t.handTrackingEnabled}):n.setAttribute("tracked-controls-webvr",t)}})},{"../core/component":131}],117:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../lib/three"),s=t("../utils/tracked-controls"),l=s.checkControllerPresentAndSetup,c=s.emitIfAxesChanged,u=s.onButtonEvent,h="https://cdn.aframe.io/controllers/valve/index/valve-index-",d={left:h+"left.glb",right:h+"right.glb"},p="valve",f=t("../utils/").device.isWebXRAvailable,m=f?{left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}}:{left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},v=f?{left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}}:{left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}};n.exports.Component=i("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var t=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){u(n.detail.id,"down",t)},this.onButtonUp=function(n){u(n.detail.id,"up",t)},this.onButtonTouchEnd=function(n){u(n.detail.id,"touchend",t)},this.onButtonTouchStart=function(n){u(n.detail.id,"touchstart",t)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var t=this.data;l(this,p,{index:"right"===t.hand?0:"left"===t.hand?1:2,iterateControllerProfiles:!0,hand:t.hand})},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{idPrefix:p,controller:"right"===n.hand?1:"left"===n.hand?0:2,hand:n.hand,orientationOffset:n.orientationOffset}),this.loadModel()},loadModel:function(){var t=this.data;t.model&&this.el.setAttribute("gltf-model",""+d[t.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var n,r=this.mapping.buttons[t.detail.id],i=this.buttonMeshes;r&&("trigger"===r&&(n=t.detail.state.value,i&&i.trigger&&(i.trigger.rotation.x=this.triggerOriginalRotationX-Math.PI/40*n)),this.el.emit(r+"changed",t.detail.state))},onModelLoaded:function(t){var n,r=t.detail.model,i=this;this.data.model&&((n=this.buttonMeshes={}).grip={left:r.getObjectByName("leftgrip"),right:r.getObjectByName("rightgrip")},n.menu=r.getObjectByName("menubutton"),n.system=r.getObjectByName("systembutton"),n.trackpad=r.getObjectByName("touchpad"),n.trigger=r.getObjectByName("trigger"),this.triggerOriginalRotationX=n.trigger.rotation.x,Object.keys(n).forEach(function(t){i.setButtonColor(t,i.data.buttonColor)}),r.position.copy(v[this.data.hand]),r.rotation.copy(m[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new a.Vector3(0,0,0)}))},onAxisMoved:function(t){c(this,this.mapping.axes,t)},updateModel:function(t,n){var r;this.data.model&&-1===n.indexOf("touch")&&(r="up"===n?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(t,r))},setButtonColor:function(t,n){}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],118:[function(t,n,r){var i=t("../core/component").registerComponent;n.exports.Component=i("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":131}],119:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u=t("../utils/").device.isWebXRAvailable,h=u?"htc-vive-controller-mv":"OpenVR ";n.exports.Component=i("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:u?{axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]}:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},init:function(){var t=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var t=this.data;this.controllerIndex="right"===t.hand?0:"left"===t.hand?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var t=this.data;s(this,h,{index:this.controllerIndex,hand:t.hand})},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{idPrefix:h,hand:n.hand,controller:this.controllerIndex,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",mtl:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var n,r=this.mapping.buttons[t.detail.id],i=this.buttonMeshes;r&&("trigger"===r&&(n=t.detail.state.value,i&&i.trigger&&(i.trigger.rotation.x=-(Math.PI/12*n))),this.el.emit(r+"changed",t.detail.state))},onModelLoaded:function(t){var n,r=t.detail.model,i=this;this.data.model&&((n=this.buttonMeshes={}).grip={left:r.getObjectByName("leftgrip"),right:r.getObjectByName("rightgrip")},n.menu=r.getObjectByName("menubutton"),n.system=r.getObjectByName("systembutton"),n.trackpad=r.getObjectByName("touchpad"),n.trigger=r.getObjectByName("trigger"),Object.keys(n).forEach(function(t){i.setButtonColor(t,i.data.buttonColor)}),r.position.set(0,-.015,.04))},onAxisMoved:function(t){l(this,this.mapping.axes,t)},updateModel:function(t,n){var r;this.data.model&&-1===n.indexOf("touch")&&(r="up"===n?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(t,r))},setButtonColor:function(t,n){var r=this.buttonMeshes,i=this.rendererSystem;if(r){if("grip"===t){r.grip.left.material.color.set(n),r.grip.right.material.color.set(n),i.applyColorCorrection(r.grip.left.material.color),i.applyColorCorrection(r.grip.right.material.color);return}r[t].material.color.set(n),i.applyColorCorrection(r[t].material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],120:[function(t,n,r){var i=t("../core/component").registerComponent,o=t("../utils/bind"),a=t("../utils/tracked-controls"),s=a.checkControllerPresentAndSetup,l=a.emitIfAxesChanged,c=a.onButtonEvent,u="HTC Vive Focus";n.exports.Component=i("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(n){c(n.detail.id,"down",t)},this.onButtonUp=function(n){c(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){c(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){c(n.detail.id,"touchend",t)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){s(this,u,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var t=this.el,n=this.data;t.setAttribute("tracked-controls",{armModel:n.armModel,idPrefix:u,orientationOffset:n.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(t){var n,r=t.detail.model;this.data.model&&((n=this.buttonMeshes={}).trigger=r.getObjectByName("BumperKey"),n.triggerPressed=r.getObjectByName("BumperKey_Press"),n.triggerPressed&&(n.triggerPressed.visible=!1),n.trackpad=r.getObjectByName("TouchPad"),n.trackpadPressed=r.getObjectByName("TouchPad_Press"),n.trackpadPressed&&(n.trackpadPressed.visible=!1))},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&this.el.emit(n+"changed",t.detail.state)},onAxisMoved:function(t){l(this,this.mapping.axes,t)},updateModel:function(t,n){this.data.model&&this.updateButtonModel(t,n)},updateButtonModel:function(t,n){var r,i=this.buttonMeshes,o=t+"Pressed";if(i&&i[t]&&i[o]){switch(n){case"down":r=this.data.buttonHighlightColor;break;case"touchstart":r=this.data.buttonTouchedColor}r&&i[o].material.color.set(r),i[o].visible=!!r,i[t].visible=!r}}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],121:[function(t,n,r){var i,o,a=t("../constants").keyboardevent.KEYCODE_TO_CODE,s=t("../core/component").registerComponent,l=t("../lib/three"),c=t("../utils/"),u=c.bind,h=c.shouldCaptureKeyEvent,d=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];n.exports.Component=s("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new l.Vector3,this.onBlur=u(this.onBlur,this),this.onContextMenu=u(this.onContextMenu,this),this.onFocus=u(this.onFocus,this),this.onKeyDown=u(this.onKeyDown,this),this.onKeyUp=u(this.onKeyUp,this),this.onVisibilityChange=u(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(t,n){var r=this.data,i=this.el,o=this.velocity;!(!o[r.adAxis]&&!o[r.wsAxis]&&function(t){var n;for(n in t)return!1;return!0}(this.keys))&&(n/=1e3,this.updateVelocity(n),(o[r.adAxis]||o[r.wsAxis])&&i.object3D.position.add(this.getMovementVector(n)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(t){var n,r,i,o,a,s=this.data,l=this.keys,c=this.velocity;if(r=s.adAxis,o=s.wsAxis,t>.2){c[r]=0,c[o]=0;return}var u=Math.pow(1/this.easing,60*t);0!==c[r]&&(c[r]=c[r]*u),0!==c[o]&&(c[o]=c[o]*u),1e-5>Math.abs(c[r])&&(c[r]=0),1e-5>Math.abs(c[o])&&(c[o]=0),s.enabled&&(n=s.acceleration,s.adEnabled&&(i=s.adInverted?-1:1,(l.KeyA||l.ArrowLeft)&&(c[r]-=i*n*t),(l.KeyD||l.ArrowRight)&&(c[r]+=i*n*t)),s.wsEnabled&&(a=s.wsInverted?-1:1,(l.KeyW||l.ArrowUp)&&(c[o]-=a*n*t),(l.KeyS||l.ArrowDown)&&(c[o]+=a*n*t)))},getMovementVector:(i=new l.Vector3(0,0,0),o=new l.Euler(0,0,0,"YXZ"),function(t){var n,r=this.el.getAttribute("rotation"),a=this.velocity;return i.copy(a),i.multiplyScalar(t),r&&(n=this.data.fly?r.x:0,o.set(l.Math.degToRad(n),l.Math.degToRad(r.y),0),i.applyEuler(o)),i}),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var t=Object.keys(this.keys),n=0;n<t.length;n++)delete this.keys[t[n]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(t){var n;h(t)&&(n=t.code||a[t.keyCode],-1!==d.indexOf(n)&&(this.keys[n]=!0))},onKeyUp:function(t){var n;n=t.code||a[t.keyCode],delete this.keys[n]}})},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/":205}],122:[function(t,n,r){var i,o,a,s=t("../core/component").registerComponent,l=t("../utils/bind"),c=t("../utils/tracked-controls"),u=c.checkControllerPresentAndSetup,h=c.emitIfAxesChanged,d=c.onButtonEvent,p=t("../utils/"),f=p.debug("components:windows-motion-controls:debug"),m=p.debug("components:windows-motion-controls:warn"),v=t("../constants").DEFAULT_HANDEDNESS,g={left:"left.glb",right:"right.glb",default:"universal.glb"},y=t("../utils/").device.isWebXRAvailable,b=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,A=y?"windows-mixed-reality":"Spatial Controller (Spatial Interaction Source) ";n.exports.Component=s("windows-motion-controls",{schema:{hand:{default:v},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:y?{axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"}:{axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},bindMethods:function(){this.onModelError=l(this.onModelError,this),this.onModelLoaded=l(this.onModelLoaded,this),this.onControllersUpdate=l(this.onControllersUpdate,this),this.checkIfControllerPresent=l(this.checkIfControllerPresent,this),this.onAxisMoved=l(this.onAxisMoved,this)},init:function(){var t=this,n=this.el;this.onButtonChanged=l(this.onButtonChanged,this),this.onButtonDown=function(n){d(n.detail.id,"down",t)},this.onButtonUp=function(n){d(n.detail.id,"up",t)},this.onButtonTouchStart=function(n){d(n.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(n){d(n.detail.id,"touchend",t)},this.onControllerConnected=function(){t.setModelVisibility(!0)},this.onControllerDisconnected=function(){t.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},n.addEventListener("controllerconnected",this.onControllerConnected),n.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("axismove",this.onAxisMoved),t.addEventListener("model-error",this.onModelError),t.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("axismove",this.onAxisMoved),t.removeEventListener("model-error",this.onModelError),t.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){u(this,A,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var t=this.createControllerModelUrl();this.loadModel(t)},createControllerModelUrl:function(t){var n=this.el.components["tracked-controls"],r=n?n.controller:null,i="default",o=this.data.hand;if(r&&!window.hasNativeWebXRImplementation&&(o=r.hand,!t)){var a=r.id.match(b);i=a&&a[0]||i}return"https://cdn.aframe.io/controllers/microsoft/"+i+"/"+(g[o]||g.default)},injectTrackedControls:function(){var t=this.data;this.el.setAttribute("tracked-controls",{idPrefix:A,controller:t.pair,hand:t.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(t){var n=this.createControllerModelUrl(!0);t.detail.src!==n?(m("Failed to load controller model for device, attempting to load default."),this.loadModel(n)):m("Failed to load default controller model.")},loadModel:function(t){this.el.setAttribute("gltf-model","url("+t+")")},onModelLoaded:function(t){var n,r,i,o,a=this.controllerModel=t.detail.model,s=this.loadedMeshInfo;if(f("Processing model"),s.buttonMeshes={},s.axisMeshes={},a){for(n=0;n<this.mapping.buttons.length;n++){if(!(r=this.mapping.buttonMeshNames[this.mapping.buttons[n]])){f("Skipping unknown button at index: "+n+" with mapped name: "+this.mapping.buttons[n]);continue}if(!(i=a.getObjectByName(r))){m("Missing button mesh with name: "+r);continue}(o={index:n,value:l(i,"VALUE"),pressed:l(i,"PRESSED"),unpressed:l(i,"UNPRESSED")}).value&&o.pressed&&o.unpressed?s.buttonMeshes[this.mapping.buttons[n]]=o:m("Missing button submesh under mesh with name: "+r+"(VALUE: "+!!o.value+", PRESSED: "+!!o.pressed+", UNPRESSED:"+!!o.unpressed+")")}for(n=0;n<this.mapping.axisMeshNames.length;n++){if(!(r=this.mapping.axisMeshNames[n])){f("Skipping unknown axis at index: "+n);continue}if(!(i=a.getObjectByName(r))){m("Missing axis mesh with name: "+r);continue}(o={index:n,value:l(i,"VALUE"),min:l(i,"MIN"),max:l(i,"MAX")}).value&&o.min&&o.max?s.axisMeshes[n]=o:m("Missing axis submesh under mesh with name: "+r+"(VALUE: "+!!o.value+", MIN: "+!!o.min+", MAX:"+!!o.max+")")}this.calculateRayOriginFromMesh(a),this.setModelVisibility()}function l(t,n){for(var r=0,i=t.children.length;r<i;r++){var o=t.children[r];if(o&&o.name===n)return o}}f("Model load complete.")},calculateRayOriginFromMesh:(i=new THREE.Quaternion,function(t){var n;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,n=t.getObjectByName(this.mapping.pointingPoseMeshName)){var r=t.parent;r&&(t.parent=null,t.updateMatrixWorld(!0),t.parent=r),n.getWorldPosition(this.rayOrigin.origin),n.getWorldQuaternion(i),this.rayOrigin.direction.applyQuaternion(i),r&&t.updateMatrixWorld(!0)}else f("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}),lerpAxisTransform:(o=new THREE.Quaternion,function(t,n){var r=this.loadedMeshInfo.axisMeshes[t];if(r){var i=r.min,a=r.max,s=r.value,l=.5*n+.5;s.setRotationFromQuaternion(o.copy(i.quaternion).slerp(a.quaternion,l)),s.position.lerpVectors(i.position,a.position,l)}}),lerpButtonTransform:(a=new THREE.Quaternion,function(t,n){var r=this.loadedMeshInfo.buttonMeshes[t];if(r){var i=r.unpressed,o=r.pressed,s=r.value;s.setRotationFromQuaternion(a.copy(i.quaternion).slerp(o.quaternion,n)),s.position.lerpVectors(i.position,o.position,n)}}),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(t){var n=this.mapping.buttons[t.detail.id];n&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(n,t.detail.state.value),this.el.emit(n+"changed",t.detail.state))},onAxisMoved:function(t){var n=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var r=0;r<n;r++)this.lerpAxisTransform(r,t.detail.axis[r]||0);h(this,this.mapping.axes,t)},setModelVisibility:function(t){var n=this.el.getObject3D("mesh");t=void 0!==t?t:this.modelVisible,this.modelVisible=t,n&&(n.visible=t)}})},{"../constants":123,"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],123:[function(t,n,r){n.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:t("./keyboardevent")}},{"./keyboardevent":124}],124:[function(t,n,r){n.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],125:[function(t,n,r){var i=t("./a-node"),o=t("../utils/bind"),a=t("../utils/debug"),s=t("./a-register-element").registerElement,l=t("../lib/three"),c=new l.FileLoader,u=a("core:a-assets:warn");function h(t){var n,r,i,o=t.hasAttribute("crossorigin")||null!==(n=t.getAttribute("src"))&&(-1===n.indexOf("://")||(i=(r=n).indexOf("://")>-1?r.split("/")[2]:r.split("/")[0]).substring(0,i.indexOf(":"))===window.location.host)?t:(u('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',n),t.crossOrigin="anonymous",t.cloneNode(!0));return o.tagName&&"video"===o.tagName.toLowerCase()&&(o.setAttribute("playsinline",""),o.setAttribute("webkit-playsinline","")),o!==t&&(t.parentNode.appendChild(o),t.parentNode.removeChild(t)),o}function d(t){var n=p(t),r=n.lastIndexOf(".");return r>=0&&".glb"===n.slice(r,t.search(/\?|#|$/))?"arraybuffer":"text"}function p(t){var n=document.createElement("a");n.href=t;var r=n.search.replace(/^\?/,""),i=t.replace(r,"").replace("?","");return i.substring(i.lastIndexOf("/")+1)}n.exports=s("a-assets",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=c,this.timeout=null}},attachedCallback:{value:function(){var t,n,r,i,a,s,c=this,d=[];if(!this.parentNode.isScene)throw Error("<a-assets> must be a child of a <a-scene>.");for(t=0,a=this.querySelectorAll("img");t<a.length;t++)i=h(a[t]),d.push(new Promise(function(n,r){l.Cache.files[a[t].getAttribute("src")]=i,i.onload=n,i.onerror=r}));for(t=0,r=this.querySelectorAll("audio, video");t<r.length;t++)(n=h(r[t])).src||n.srcObject||u("Audio/video asset has neither `src` nor `srcObject` attributes."),d.push(function(t){if(t.hasAttribute("autoplay")||"auto"===t.getAttribute("preload"))return new Promise(function(n,r){if(4===t.readyState)return n();if(t.error)return r();function i(){for(var r=0,i=0;i<t.buffered.length;i++)r+=t.buffered.end(i)-t.buffered.start(i);r>=t.duration&&("VIDEO"===t.tagName&&(l.Cache.files[t.getAttribute("src")]=t),n())}t.addEventListener("loadeddata",i,!1),t.addEventListener("progress",i,!1),t.addEventListener("error",r,!1)})}(n));Promise.all(d).then(o(this.load,this)),s=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){c.hasLoaded||(u("Asset loading timed out in ",s,"ms"),c.emit("timeout"),c.load())},s)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){i.prototype.load.call(this,null,function(t){return t.isAssetItem&&t.hasAttribute("src")})}}})}),s("a-asset-item",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var t=this,n=this.getAttribute("src");c.setResponseType(this.getAttribute("response-type")||d(n)),c.load(n,function(n){t.data=n,setTimeout(function(){i.prototype.load.call(t)})},function(n){t.emit("progress",{loadedBytes:n.loaded,totalBytes:n.total,xhr:n})},function(n){t.emit("error",{xhr:n})})}}})}),n.exports.inferResponseType=d,n.exports.getFileNameFromURL=p},{"../lib/three":179,"../utils/bind":199,"../utils/debug":201,"./a-node":129,"./a-register-element":130}],126:[function(t,n,r){var i=t("../utils/debug"),o=t("./a-register-element").registerElement,a=i("core:cubemap:warn");n.exports=o("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var t,n=this.querySelectorAll("[src]"),r=[];if(6===n.length){for(t=0;t<n.length;t++)r.push(n[t].getAttribute("src"));return r}a("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":201,"./a-register-element":130}],127:[function(t,n,r){var i,o,a,s=t("./a-node"),l=t("./component").components,c=t("./a-register-element").registerElement,u=t("../lib/three"),h=t("../utils/"),d=h.debug("core:a-entity:debug"),p=h.debug("core:a-entity:warn"),f=["position","rotation","scale","visible"],m={once:!0};function v(t,n){return!!t.components[n]&&!!t.components[n].attrValue||function(t,n){var r,i=!1;for(r=0;r<n.length&&!(i=n[r].hasAttribute(t));++r);return i}(n,t.mixinEls)}function g(t){return -1!==t.indexOf("__")&&(t=h.split(t,"__")[0]),!!l[t]}a=c("a-entity",{prototype:Object.create(s.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new u.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(t,n,r){var i=this.components[t];if(i&&i.justInitialized&&""===r){delete i.justInitialized;return}(i||null!==r)&&this.setEntityAttribute(t,n,r)}},attachedCallback:{value:function(){var t,n=this.sceneEl,r=this;if(this.addToParent(),!this.isScene){if(!n){this.load();return}if((t=n.querySelector("a-assets"))&&!t.hasLoaded){t.addEventListener("loaded",function(){r.load()});return}this.load()}}},detachedCallback:{value:function(){var t;if(this.parentEl){for(t in this.components)this.removeComponent(t,!1);this.isScene||(this.removeFromParent(),s.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(t){return this.object3DMap[t]}},setObject3D:{value:function(t,n){var r,i=this;if(!(n instanceof u.Object3D))throw Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");(r=this.getObject3D(t))&&this.object3D.remove(r),n.el=this,n.children.length&&n.traverse(function(t){t.el=i}),this.object3D.add(n),this.object3DMap[t]=n,this.emit("object3dset",{object:n,type:t})}},removeObject3D:{value:function(t){var n=this.getObject3D(t);if(!n){p("Tried to remove `Object3D` of type:",t,"which was not defined.");return}this.object3D.remove(n),delete this.object3DMap[t],this.emit("object3dremove",{type:t})}},getOrCreateObject3D:{value:function(t,n){var r=this.getObject3D(t);return!r&&n&&(r=new n,this.setObject3D(t,r)),p("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),r}},add:{value:function(t){if(!t.object3D)throw Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(t.object3D),this.emit("child-attached",{el:t})}},addToParent:{value:function(){var t=this.parentEl=this.parentNode;t&&t.add&&!this.attachedToParent&&(t.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var t=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,t.emit("child-detached",{el:this})}},load:{value:function(){var t=this;!this.hasLoaded&&this.parentEl&&s.prototype.load.call(this,function(){t.parentEl&&(t.updateComponents(),(t.isScene||t.parentEl.isPlaying)&&t.play())})},writable:window.debug},remove:{value:function(t){t?this.object3D.remove(t.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var t=this.children,n=[],r=0;r<t.length;r++){var i=t[r];i instanceof a&&n.push(i)}return n}},initComponent:{value:function(t,n,r){var i,o,a,s;if(s=(a=h.split(t,"__"))[0],o=a.length>2?a.slice(1).join("__"):a[1],l[s]&&(v(this,t)||void 0!==n||r)&&!(t in this.components)){if(this.initComponentDependencies(s),o&&!l[s].multiple)throw Error("Trying to initialize multiple components of type `"+s+"`. There can only be one component of this type per entity.");i=new l[s].Component(this,n,o),this.isPlaying&&i.play(),this.hasAttribute(t)||(i.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,t,"")),d("Component initialized: %s",t)}},writable:window.debug},initComponentDependencies:{value:function(t){var n,r;if(l[t]&&(n=l[t].dependencies))for(r=0;r<n.length;r++)this.initComponent(n[r],window.HTMLElement.prototype.getAttribute.call(this,n[r])||void 0,!0)}},removeComponent:{value:function(t,n){var r;if(r=this.components[t]){if(!r.initialized){this.addEventListener("componentinitialized",function r(i){i.detail.name===t&&(this.removeComponent(t,n),this.removeEventListener("componentinitialized",r))});return}r.pause(),r.remove(),n&&(r.destroy(),delete this.components[t]),this.emit("componentremoved",r.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var t,n,r,i,o,a,s=this.componentsToUpdate;if(this.hasLoaded){for(o=0;o<this.mixinEls.length;o++)for(a in this.mixinEls[o].componentCache)g(a)&&(s[a]=!0);if(this.getExtraComponents)for(a in i=this.getExtraComponents())g(a)&&(s[a]=!0);for(o=0;o<this.attributes.length;++o)a=this.attributes[o].name,-1===f.indexOf(a)&&g(a)&&(s[a]=!0);for(o=0;o<f.length;o++)a=f[o],this.hasAttribute(a)&&this.updateComponent(a,this.getDOMAttribute(a));for(a in s)t=this.getDOMAttribute(a),r=(n=i&&i[a])?n.constructor===Object?h.extend(n,h.styleParser.parse(t||{})):t||n:t,this.updateComponent(a,r),delete s[a]}},writable:window.debug},updateComponent:{value:function(t,n,r){var i=this.components[t];if(i){if(null===n&&!v(this,t)){this.removeComponent(t,!0);return}i.updateProperties(n,r);return}this.initComponent(t,n,!1)}},removeAttribute:{value:function(t,n){var r=this.components[t];if(r&&void 0===n&&this.removeComponent(t,!0),r&&void 0!==n){r.resetProperty(n);return}"mixin"===t&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,t)}},play:{value:function(){var t,n,r;if(!this.isPlaying&&this.hasLoaded){for(r in this.isPlaying=!0,this.components)this.components[r].play();for(n=0,t=this.getChildEntities();n<t.length;n++)t[n].play();this.emit("play")}},writable:!0},pause:{value:function(){var t,n,r;if(this.isPlaying){for(r in this.isPlaying=!1,this.components)this.components[r].pause();for(n=0,t=this.getChildEntities();n<t.length;n++)t[n].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(t,n,r){if(l[t]||this.components[t]){this.updateComponent(t,r);return}if("mixin"===t){if(r===this.computedMixinStr)return;this.mixinUpdate(r,n)}}},mixinUpdate:{value:(i=[],function(t,n){var r,o,a,s,l=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){l.mixinUpdate(t,n)},m);return}for(s=0,n=n||this.getAttribute("mixin"),a=this.updateMixins(t,n),i.length=0;s<this.mixinEls.length;s++)for(r in this.mixinEls[s].componentCache)-1===i.indexOf(r)&&(this.components[r]?this.components[r].handleMixinUpdate():this.initComponent(r,null),i.push(r));for(s=0;s<a.oldMixinIds.length;s++)if(o=document.getElementById(a.oldMixinIds[s]))for(r in o.componentCache)-1===i.indexOf(r)&&this.components[r]&&(this.getDOMAttribute(r)?this.components[r].handleMixinUpdate():this.removeComponent(r,!0))})},setAttribute:{value:(o={},function(t,n,r){var i,a,c,u;if(!l[(c=t.indexOf("__"))>0?t.substring(0,c):t]){"mixin"===t&&this.mixinUpdate(n),s.prototype.setAttribute.call(this,t,n);return}if(!this.components[t]&&this.hasAttribute(t)&&this.updateComponent(t,window.HTMLElement.prototype.getAttribute.call(this,t)),void 0!==r&&"string"==typeof n&&n.length>0&&"string"==typeof h.styleParser.parse(n)){for(u in o)delete o[u];(i=o)[n]=r,a=!1}else i=n,a=!0===r;this.updateComponent(t,i,a),this.sceneEl&&this.sceneEl.getAttribute("debug")&&this.components[t].flushToDOM()}),writable:window.debug},flushToDOM:{value:function(t){var n,r,i,o=this.components,a=this.children;for(i in o)o[i].flushToDOM();if(t)for(r=0;r<a.length;++r)(n=a[r]).flushToDOM&&n.flushToDOM(t)}},getAttribute:{value:function(t){var n,r,i,o;return"position"===t?this.object3D.position:"rotation"===t?(r=u.Math.radToDeg,i=this.object3D.rotation,(o=this.rotationObj).x=r(i.x),o.y=r(i.y),o.z=r(i.z),o):"scale"===t?this.object3D.scale:"visible"===t?this.object3D.visible:(n=this.components[t])?n.data:window.HTMLElement.prototype.getAttribute.call(this,t)},writable:window.debug},getDOMAttribute:{value:function(t){var n=this.components[t];return n?n.attrValue:window.HTMLElement.prototype.getAttribute.call(this,t)},writable:window.debug},addState:{value:function(t){this.is(t)||(this.states.push(t),this.emit("stateadded",t))}},removeState:{value:function(t){var n=this.states.indexOf(t);-1!==n&&(this.states.splice(n,1),this.emit("stateremoved",t))}},is:{value:function(t){return -1!==this.states.indexOf(t)}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var t;if(this.parentNode){p("Entity can only be destroyed if detached from scenegraph.");return}for(t in this.components)this.components[t].destroy()}}})}),n.exports=a},{"../lib/three":179,"../utils/":205,"./a-node":129,"./a-register-element":130,"./component":131}],128:[function(t,n,r){var i=t("./a-node"),o=t("./a-register-element").registerElement,a=t("./component").components,s=t("../utils");n.exports=o("a-mixin",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(t,n,r){this.cacheAttribute(t,r),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(t,n){window.HTMLElement.prototype.setAttribute.call(this,t,n),this.cacheAttribute(t,n)}},cacheAttribute:{value:function(t,n){var r;(r=a[s.split(t,"__")[0]])&&(void 0===n&&(n=window.HTMLElement.prototype.getAttribute.call(this,t)),this.componentCache[t]=r.parseAttrValueForCache(n))}},getAttribute:{value:function(t){return this.componentCache[t]||window.HTMLElement.prototype.getAttribute.call(this,t)}},cacheAttributes:{value:function(){var t,n,r=this.attributes;for(n=0;n<r.length;n++)t=r[n].name,this.cacheAttribute(t)}},updateEntities:{value:function(){var t,n,r;if(this.sceneEl)for(r=0,n=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]");r<n.length;r++)(t=n[r]).hasLoaded&&!t.isMixin&&t.mixinUpdate(this.id)}}})})},{"../utils":205,"./a-node":129,"./a-register-element":130,"./component":131}],129:[function(t,n,r){var i,o,a,s,l=t("./a-register-element").registerElement,c=t("./a-register-element").isNode,u=t("../utils/"),h=u.debug("core:a-node:warn"),d=u.debug("core:a-node:error");n.exports=l("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var t;this.sceneEl=this.closestScene(),this.sceneEl||h("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),!this.isMixin&&(t=this.getAttribute("mixin"))&&this.updateMixins(t)},writable:window.debug},attributeChangedCallback:{value:function(t,n,r){r!==this.computedMixinStr&&("mixin"!==t||this.isMixin||this.updateMixins(r,n))}},closestScene:{value:function(){for(var t=this;t&&!t.isScene;)t=t.parentElement;return t}},closest:{value:function(t){for(var n=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,r=this;r&&!n.call(r,t);)r=r.parentElement;return r}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(t,n){var r=this;this.hasLoaded||(n=n||c,Promise.all(this.getChildren().filter(n).map(function(t){return new Promise(function(n){if(t.hasLoaded)return n();t.addEventListener("loaded",n)})})).then(function(){r.hasLoaded=!0,t&&t(),r.emit("loaded",void 0,!1)}).catch(function(t){d("Failure loading node: ",t)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:(i=[],o=[],a={},function(t,n){var r,s,l;for(r=0,i.length=0,o.length=0,s=t?u.split(t.trim(),/\s+/):i,l=n?u.split(n.trim(),/\s+/):o,a.newMixinIds=s,a.oldMixinIds=l;r<l.length;r++)-1===s.indexOf(l[r])&&this.unregisterMixin(l[r]);for(r=0,this.computedMixinStr="",this.mixinEls.length=0;r<s.length;r++)this.registerMixin(document.getElementById(s[r]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),a})},registerMixin:{value:function(t){var n,r,i;if(t){if(i=t.getAttribute("mixin"))for(r=0,n=u.split(i.trim(),/\s+/);r<n.length;r++)this.registerMixin(document.getElementById(n[r]));this.computedMixinStr=this.computedMixinStr+" "+t.id,this.mixinEls.push(t)}}},setAttribute:{value:function(t,n){"mixin"===t&&this.updateMixins(n),window.HTMLElement.prototype.setAttribute.call(this,t,n)}},unregisterMixin:{value:function(t){var n,r=this.mixinEls;for(n=0;n<r.length;++n)if(t===r[n].id){r.splice(n,1);break}}},emit:{value:(s={},function(t,n,r,i){void 0===r&&(r=!0),s.bubbles=!!r,s.detail=n,i&&(s=u.extend({},i,s)),this.dispatchEvent(new CustomEvent(t,s))}),writable:window.debug}})})},{"../utils/":205,"./a-register-element":130}],130:[function(t,n,r){t("document-register-element");var i,o,a=n.exports.knownTags={};function s(t,n,r,i){n.forEach(function(n){var o,a;o=r[n],a=i[n],o&&a&&o!==a&&(t[n]={value:function(){return a.apply(this,arguments),o.apply(this,arguments)},writable:window.debug})})}function l(t,n){Object.getOwnPropertyNames(t).forEach(function(r){var i;n[r]||(i=Object.getOwnPropertyDescriptor(t,r),n[r]={value:t[r],writable:i.writable})})}n.exports.isNode=function(t){return t.tagName.toLowerCase() in a||t.isNode},n.exports.registerElement=function(t,n){var r,c,u,h,d=Object.getPrototypeOf(n.prototype),p=n,f=i&&d===i.prototype,m=o&&d===o.prototype;return(f||m)&&(a[t.toLowerCase()]=!0),f&&(p={prototype:Object.create(d,(s(c={},["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],r=n.prototype,i.prototype),l(r,c),p=c))}),m&&(p={prototype:Object.create(d,(s(h={},["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],u=n.prototype,i.prototype),s(h,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],u,o.prototype),l(u,h),p=h))}),Object.getOwnPropertyNames(p.prototype).forEach(function(t){var n=p.prototype[t];"function"==typeof n&&(n.displayName=t)}),document.registerElement(t,p)},n.exports.wrapMethods=s,i=t("./a-node"),o=t("./a-entity")},{"./a-entity":127,"./a-node":129,"document-register-element":12}],131:[function(t,n,r){var i=t("./schema"),o=t("./scene/scenes"),a=t("./system"),s=t("../utils/"),l=n.exports.components={},c=i.parseProperties,u=i.parseProperty,h=i.process,d=i.isSingleProperty,p=i.stringifyProperties,f=i.stringifyProperty,m=s.styleParser,v=s.debug("core:component:warn"),g=document.currentScript,y=/[A-Z]+/,b={},A=n.exports.Component=function(t,n,r){var i=this;this.el=t,this.id=r,this.attrName=this.name+(r?"__"+r:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=d(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&_(u(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=b[this.name];let o=this.events;this.events={},function(t,n){var r;for(r in n)t.events[r]=n[r].bind(t)}(this,o),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),s.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),s.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),s.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),s.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=s.throttle(function(){t.emit("componentchanged",i.evtDetail,!1)},200),this.updateProperties(n)};if(A.prototype={schema:{},init:function(){},events:{},update:function(t){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(t,n){var r=this.schema;return this.isSingleProperty?u(t,r):c(m.parse(t),r,!0,this.name,n)},stringify:function(t){var n=this.schema;return"string"==typeof t?t:this.isSingleProperty?f(t,n):(t=p(t,n),m.stringify(t))},updateCachedAttrValue:function(t,n){var r,i,o;if(void 0!==t){if(null===t){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(t instanceof Object&&!(t instanceof window.HTMLElement)?(i=this.objectPool.use(),r=s.extend(i,t)):r=this.parseAttrValueForCache(t),this.isObjectBased&&!n&&this.attrValue)for(o in this.attrValue)void 0===r[o]&&(r[o]=this.attrValue[o]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),s.objectPool.clearObject(this.attrValue),this.attrValue=E(this.attrValue,r,this.isObjectBased),s.objectPool.clearObject(i)}},parseAttrValueForCache:function(t){var n;return"string"!=typeof t?t:(this.isSingleProperty?"string"==typeof(n=this.schema.parse(t))&&(n=t):(s.objectPool.clearObject(this.parsingAttrValue),n=m.parse(t,this.parsingAttrValue)),n)},flushToDOM:function(t){var n=t?this.data:this.attrValue;null!=n&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(n))},updateProperties:function(t,n){if(!this.el.hasLoaded){this.updateCachedAttrValue(t);return}null!==t&&(t=this.parseAttrValueForCache(t)),this.updateCachedAttrValue(t,n),this.initialized?(this.updateComponent(t,n),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var t,n=this.el;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),n.initializingComponents[this.name]||(n.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete n.initializingComponents[this.name],this.oldData=E(this.oldData,this.data,this.isObjectBased),t=this.isObjectBased?this.objectPool.use():void 0,this.update(t),this.isObjectBased&&this.objectPool.recycle(t),n.isPlaying&&this.play(),n.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(t,n){var r,i;if(n){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&u(t,this.schema),this.data=t;return}if(c(t,this.schema,!0,this.name),this.schemaChangeKeys.length){for(r in t)if(this.schema[r].schemaChange){i=!0;break}}if(i){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(r in t)void 0!==t[r]&&(this.data[r]=t[r])},callUpdateHandler:function(){var t;this.previousOldData instanceof Object&&s.objectPool.clearObject(this.previousOldData),this.isObjectBased?w(this.previousOldData,this.oldData):this.previousOldData=this.oldData,t=!s.deepEqual(this.oldData,this.data),(this.isPositionRotationScale||t)&&(this.oldData instanceof Object&&s.objectPool.clearObject(this.oldData),this.oldData=E(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(t){if(this.isObjectBased){if(!(t in this.attrValue))return;delete this.attrValue[t],this.data[t]=this.schema[t].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(t){var n;n=s.extend({},l[this.name].schema),s.extend(n,t),this.schema=h(n),this.el.emit("schemachanged",this.evtDetail)},buildData:function(t,n,r){var i,o,a,l,h,d,p,f=this.nextData,m=this.schema,v=this.el.mixinEls;if(i=t&&t.constructor===Array?t.length:null!=t,this.isObjectBased&&s.objectPool.clearObject(f),this.isSingleProperty)o=this.isObjectBased?w(f,m.default):T(m.default)?s.clone(m.default):m.default;else for(l in o=(p=!n&&this.attrValue)instanceof Object?w(f,p):f,m)a=m[l].default,void 0===o[l]&&(o[l]=T(a)?s.clone(a):a);for(d=0;d<v.length;d++)(h=v[d].getAttribute(this.attrName))&&(o=E(o,h,this.isObjectBased));if(i){if(this.isSingleProperty)return _(t)?(w(this.parsingAttrValue,t),u(this.parsingAttrValue,m)):u(t,m);o=E(o,t,this.isObjectBased)}else if(this.isSingleProperty)return u(o,m);return c(o,m,void 0,this.name,r)},eventsAttach:function(){var t;for(t in this.eventsDetach(),this.events)this.el.addEventListener(t,this.events[t])},eventsDetach:function(){var t;for(t in this.events)this.el.removeEventListener(t,this.events[t])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}},window.debug)var x=n.exports.registrationOrderWarnings={};function w(t,n){var r,i;for(i in n)void 0!==n[i]&&(r=n[i],t[i]=T(r)?s.clone(r):r);return t}function E(t,n,r){var i;if(r&&n.constructor===Object){for(i in n)void 0!==n[i]&&(n[i]&&n[i].constructor===Object?t[i]=s.clone(n[i]):t[i]=n[i]);return t}return n}function M(t){return t.tick||t.tock}function _(t){return t&&t.constructor===Object&&!(t instanceof window.HTMLElement)}function T(t){return t&&(t.constructor===Object||t.constructor===Array)&&!(t instanceof window.HTMLElement)}n.exports.registerComponent=function(t,n){var r,i,c,u,p,f,m={};if(document.currentScript&&document.currentScript!==g&&o.forEach(function(n){!n.hasLoaded&&document.currentScript.compareDocumentPosition(n)!==Node.DOCUMENT_POSITION_FOLLOWING&&(v("The component `"+t+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(x[t]=!0))}),!0===y.test(t)&&v("The component name `"+t+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+t.toLowerCase()+"`"),-1!==t.indexOf("__"))throw Error("The component name `"+t+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(n).forEach(function(t){m[t]={value:n[t],writable:!0}}),l[t])throw Error("The component `"+t+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if((c=function(t,n,r){A.call(this,t,n,r)}).prototype=Object.create(A.prototype,m),c.prototype.name=t,c.prototype.isPositionRotationScale="position"===t||"rotation"===t||"scale"===t,c.prototype.constructor=c,c.prototype.system=a&&a.systems[t],c.prototype.play=(r=c.prototype.play,function(){var t=this.el.sceneEl,n=this.el.isPlaying&&!this.isPlaying;this.initialized&&n&&(r.call(this),this.isPlaying=!0,this.eventsAttach(),M(this)&&t.addBehavior(this))}),c.prototype.pause=(i=c.prototype.pause,function(){var t=this.el.sceneEl;this.isPlaying&&(i.call(this),this.isPlaying=!1,this.eventsDetach(),M(this)&&t.removeBehavior(this))}),p=s.extend(h(c.prototype.schema,c.prototype.name)),!(f=d(c.prototype.schema)))for(u in c.prototype.schemaChangeKeys=[],p)p[u].schemaChange&&c.prototype.schemaChangeKeys.push(u);return b[t]=s.objectPool.createPool(),l[t]={Component:c,dependencies:c.prototype.dependencies,isSingleProp:f,multiple:c.prototype.multiple,name:t,parse:c.prototype.parse,parseAttrValueForCache:c.prototype.parseAttrValueForCache,schema:p,stringify:c.prototype.stringify,type:c.prototype.type},c}},{"../utils/":205,"./scene/scenes":138,"./schema":140,"./system":142}],132:[function(t,n,r){var i=t("./schema").process,o=n.exports.geometries={},a=n.exports.geometryNames=[],s=t("../lib/three"),l=n.exports.Geometry=function(){};l.prototype={schema:{},init:function(t){return this.geometry=new s.BufferGeometry,this.geometry},update:function(t){}},n.exports.registerGeometry=function(t,n){var r,s={};if(Object.keys(n).forEach(function(t){s[t]={value:n[t],writable:!0}}),o[t])throw Error("The geometry `"+t+"` has been already registered");return(r=function(){l.call(this)}).prototype=Object.create(l.prototype,s),r.prototype.name=t,r.prototype.constructor=r,o[t]={Geometry:r,schema:i(r.prototype.schema)},a.push(t),r}},{"../lib/three":179,"./schema":140}],133:[function(t,n,r){var i=t("../utils/coordinates"),o=t("debug"),a=o("core:propertyTypes:warn"),s=o("core:propertyTypes:warn"),l=n.exports.propertyTypes={},c=/[,> .[\]:]/,u=/\url\((.+)\)/;function h(t,n,r,i){if("type"in l){a("Property type "+t+" is already registered.");return}l[t]={default:n,parse:r||p,stringify:i||f}}function d(t){var n,r;return"string"!=typeof t?t:(r=t.match(u))?r[1]:"#"===t.charAt(0)?(n=document.getElementById(t.substring(1)))?"CANVAS"===n.tagName||"VIDEO"===n.tagName||"IMG"===n.tagName?n:n.getAttribute("src"):void s('"'+t+'" asset not found.'):t}function p(t){return t}function f(t){return null===t?"null":t.toString()}function m(t){return parseInt(t,10)}function v(t){return i.parse(t,this.default)}function g(t,n){if(null===t)return!0;if("object"!=typeof t||Object.keys(t).length!==n)return!1;var r=t.x,i=t.y,o=t.z,a=t.w;return"number"==typeof r&&"number"==typeof i&&(!(n>2)||"number"==typeof o)&&(!(n>3)||"number"==typeof a)}h("audio","",d),h("array",[],function(t){return Array.isArray(t)?t:t&&"string"==typeof t?t.split(",").map(function(t){return t.trim()}):[]},function(t){return t.join(", ")}),h("asset","",d),h("boolean",!1,function(t){return"false"!==t&&!1!==t}),h("color","#FFF",p,f),h("int",0,m),h("number",0,function(t){return parseFloat(t,10)}),h("map","",d),h("model","",d),h("selector",null,function(t){return t?"string"!=typeof t?t:"#"!==t[0]||c.test(t)?document.querySelector(t):document.getElementById(t.substring(1)):null},function(t){return t.getAttribute?"#"+t.getAttribute("id"):f(t)}),h("selectorAll",null,function(t){return t?"string"!=typeof t?t:Array.prototype.slice.call(document.querySelectorAll(t),0):null},function(t){return t instanceof Array?t.map(function(t){return"#"+t.getAttribute("id")}).join(", "):f(t)}),h("src","",function(t){return s("`src` property type is deprecated. Use `asset` instead."),d(t)}),h("string","",p,f),h("time",0,m),h("vec2",{x:0,y:0},v,i.stringify),h("vec3",{x:0,y:0,z:0},v,i.stringify),h("vec4",{x:0,y:0,z:0,w:1},v,i.stringify),n.exports.registerPropertyType=h,n.exports.isValidDefaultValue=function(t,n){return!!(("audio"!==t||"string"==typeof n)&&("array"!==t||Array.isArray(n)))&&("asset"!==t||"string"==typeof n)&&("boolean"!==t||"boolean"==typeof n)&&("color"!==t||"string"==typeof n)&&("int"!==t||"number"==typeof n)&&("number"!==t||"number"==typeof n)&&("map"!==t||"string"==typeof n)&&("model"!==t||"string"==typeof n)&&("selector"!==t||"string"==typeof n||null===n)&&("selectorAll"!==t||"string"==typeof n||null===n)&&("src"!==t||"string"==typeof n)&&("string"!==t||"string"==typeof n)&&("time"!==t||"number"==typeof n)&&("vec2"===t?g(n,2):"vec3"===t?g(n,3):"vec4"!==t||g(n,4))},n.exports.isValidDefaultCoordinate=g},{"../utils/coordinates":200,debug:8}],134:[function(t,n,r){var i=t("./metaTags").inject,o=t("./wakelock"),a=t("./loadingScreen"),s=t("../a-register-element"),l=t("./scenes"),c=t("../system").systems,u=t("../../lib/three"),h=t("../../utils/"),d=t("../a-entity"),p=t("../a-node"),f=t("./postMessage"),m=h.bind,v=h.device.isIOS(),g=h.device.isMobile(),y=h.device.isWebXRAvailable,b=s.registerElement,A=h.debug("core:a-scene:warn");function x(t,n,r,i){var o,a,s;return t.parentElement?n?{height:t.parentElement.offsetHeight,width:t.parentElement.offsetWidth}:(s=window.devicePixelRatio,a={height:document.body.offsetHeight,width:document.body.offsetWidth},!r||i||-1===r.width&&-1===r.height||a.width*s<r.width&&a.height*s<r.height||(o=a.width/a.height,a.width*s>r.width&&-1!==r.width&&(a.width=Math.round(r.width/s),a.height=Math.round(r.width/o/s)),a.height*s>r.height&&-1!==r.height&&(a.height=Math.round(r.height/s),a.width=Math.round(r.height*o/s))),a):{height:0,width:0}}function w(t){var n;function r(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||t.exitVR(),document.activeElement.blur(),document.body.focus()}(n=document.createElement("canvas")).classList.add("a-canvas"),n.dataset.aframeCanvas=!0,t.appendChild(n),document.addEventListener("fullscreenchange",r),document.addEventListener("mozfullscreenchange",r),document.addEventListener("webkitfullscreenchange",r),document.addEventListener("MSFullscreenChange",r),n.addEventListener("touchmove",function(t){t.preventDefault()}),t.canvas=n,t.emit("render-target-loaded",{target:n}),setTimeout(m(t.resize,t),0)}v&&t("../../utils/ios-orientationchange-blank-bug"),n.exports.AScene=b("a-scene",{prototype:Object.create(d.prototype,{createdCallback:{value:function(){this.clock=new u.Clock,this.isIOS=v,this.isMobile=g,this.hasWebXR=y,this.isAR=!1,this.isScene=!0,this.object3D=new u.Scene;var t=this;this.object3D.onAfterRender=function(n,r,i){t.isPlaying&&t.tock(t.time,t.delta,i)},this.resize=m(this.resize,this),this.render=m(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var t=this,n=this.hasAttribute("embedded");w(this),this.setupRenderer(),a.setup(this,x),this.resize(),n||this.addFullScreenStyles(),f(this),i(this),o(this),this.onVRPresentChangeBound=m(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){t.enterVR()},this.exitVRBound=function(){t.exitVR()},this.exitVRTrueBound=function(){t.exitVR(!0)},this.pointerRestrictedBound=function(){t.pointerRestricted()},this.pointerUnrestrictedBound=function(){t.pointerUnrestricted()},y||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){t.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){t.enterVR()})}},attachedCallbackPostCamera:{value:function(){var t,n=this;window.addEventListener("load",t),window.addEventListener("resize",function(){n.isIOS?setTimeout(n.resize,100):n.resize()}),this.play(),l.push(this)},writable:window.debug},initSystems:{value:function(){var t;for(t in this.initSystem("camera"),c)"camera"!==t&&this.initSystem(t)}},initSystem:{value:function(t){this.systems[t]||(this.systems[t]=new c[t](this),this.systemNames.push(t))}},detachedCallback:{value:function(){var t=l.indexOf(this);l.splice(t,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function(t){var n,r,i=this.behaviors;for(r in i)t[r]&&-1===(n=this.behaviors[r]).indexOf(t)&&n.push(t)}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:h.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){if(!this.hasWebXR)throw Error("Failed to enter AR mode, WebXR not supported.");if(!h.device.checkARSupport())throw Error("Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.");return this.enterVR(!0)}},enterVR:{value:function(t){var n,r,i=this,o=i.renderer.xr;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){if(o.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var a=this.sceneEl.systems.webxr.sessionReferenceSpaceType;o.setReferenceSpaceType(a);var s=t?"immersive-ar":"immersive-vr";return r=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(t,n){navigator.xr.requestSession(s,r).then(function(n){i.xrSession=n,o.layersEnabled=-1!==r.requiredFeatures.indexOf("layers"),o.setSession(n),n.addEventListener("end",i.exitVRBound),u(t)},function(t){throw Error("Failed to enter "+("immersive-ar"===s?"AR":"VR")+" mode (`requestSession`) "+t)})})}if(n=h.device.getVRDisplay(),o.setDevice(n),n.isPresenting&&!window.hasNativeWebVRImplementation)return u(),Promise.resolve();var l=this.getAttribute("renderer"),c={highRefreshRate:l.highRefreshRate,foveationLevel:l.foveationLevel};return n.requestPresent([{source:this.canvas,attributes:c}]).then(u,function(t){if(i.removeState("vr-mode"),t&&t.message)throw Error("Failed to enter VR mode (`requestPresent`): "+t.message);throw Error("Failed to enter VR mode (`requestPresent`).")})}return u(),Promise.resolve();function u(n){var r;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(r=new CustomEvent("vrdisplaypresentchange",{detail:{display:h.device.getVRDisplay()}}),window.dispatchEvent(r)),t?i.addState("ar-mode"):i.addState("vr-mode"),i.emit("enter-vr",{target:i}),!y&&i.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),i.addFullScreenStyles(),i.isMobile||i.checkHeadsetConnected()||function(t){(t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen).apply(t,[{navigationUI:"hide"}])}(i.canvas),i.renderer.setAnimationLoop(i.render),i.resize(),n&&n()}},writable:!0},exitVR:{value:function(){var t,n=this,r=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(r.enabled=!1,t=h.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,r.setSession(null);else if(t.isPresenting)return t.exitPresent().then(i,function(t){if(t&&t.message)throw Error("Failed to exit VR mode (`exitPresent`): "+t.message);throw Error("Failed to exit VR mode (`exitPresent`).")})}else(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen());return i(),Promise.resolve();function i(){n.removeState("vr-mode"),n.removeState("ar-mode"),n.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),n.hasAttribute("embedded")&&n.removeFullScreenStyles(),n.resize(),n.isIOS&&h.forceCanvasResizeSafariMobile(n.canvas),n.renderer.setPixelRatio(window.devicePixelRatio),n.emit("exit-vr",{target:n})}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var t=this.getPointerLockElement();t&&t!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var t=this.getPointerLockElement();t&&t===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(t){var n=t.display||t.detail.display;if(n&&n.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function(t){var n=this.systems[t];return n?n.data:d.prototype.getAttribute.call(this,t)}},getComputedAttribute:{value:function(t){A("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(t)}},getDOMAttribute:{value:function(t){var n=this.systems[t];return n?n.data:d.prototype.getDOMAttribute.call(this,t)}},setAttribute:{value:function(t,n,r){var i=this.systems[t];if(i){p.prototype.setAttribute.call(this,t,n),i.updateProperties(n);return}d.prototype.setAttribute.call(this,t,n,r)}},removeBehavior:{value:function(t){var n,r,i,o=this.behaviors;for(r in o)t[r]&&-1!==(i=(n=this.behaviors[r]).indexOf(t))&&n.splice(i,1)}},resize:{value:function(){var t,n,r=this.camera,i=this.canvas,o=this.renderer.xr.isPresenting;t=this.renderer.xr.enabled&&o,!r||!i||this.is("vr-mode")&&(this.isMobile||t)||(n=x(i,this.getAttribute("embedded")&&!this.is("vr-mode"),this.maxCanvasSize,this.is("vr-mode")),r.aspect=n.width/n.height,r.updateProjectionMatrix(),this.renderer.setSize(n.width,n.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var t,n,r,i,o=this;i={alpha:!0,antialias:!g,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(r=this.getAttribute("renderer"),(n=h.styleParser.parse(r)).precision&&(i.precision=n.precision+"p"),n.antialias&&"auto"!==n.antialias&&(i.antialias="true"===n.antialias),n.logarithmicDepthBuffer&&"auto"!==n.logarithmicDepthBuffer&&(i.logarithmicDepthBuffer="true"===n.logarithmicDepthBuffer),n.alpha&&(i.alpha="true"===n.alpha),this.maxCanvasSize={width:n.maxCanvasWidth?parseInt(n.maxCanvasWidth):this.maxCanvasSize.width,height:n.maxCanvasHeight?parseInt(n.maxCanvasHeight):this.maxCanvasSize.height}),(t=this.renderer=new u.WebGLRenderer(i)).setPixelRatio(window.devicePixelRatio),t.sortObjects=!1,this.camera&&t.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){t.xr.setPoseTarget(o.camera.el.object3D)})},writable:window.debug},play:{value:function(){var t=this,n=this;if(this.renderStarted){d.prototype.play.call(this);return}this.addEventListener("loaded",function(){var t,r=this.renderer,i=this.renderer.xr;d.prototype.play.call(this),!n.renderStarted&&(n.resize(),n.renderer&&(window.performance&&window.performance.mark("render-started"),a.remove(),(t=h.device.getVRDisplay())&&t.isPresenting&&(i.setDevice(t),i.enabled=!0,n.enterVR()),r.setAnimationLoop(this.render),n.renderStarted=!0,n.emit("renderstart")))}),setTimeout(function(){d.prototype.load.call(t)})}},updateComponent:{value:function(t){t in c||d.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(t,n){var r,i=this.systems;for(r=0;r<this.behaviors.tick.length;r++)this.behaviors.tick[r].el.isPlaying&&this.behaviors.tick[r].tick(t,n);for(r=0;r<this.systemNames.length;r++)i[this.systemNames[r]].tick&&i[this.systemNames[r]].tick(t,n)}},tock:{value:function(t,n,r){var i,o=this.systems;for(i=0;i<this.behaviors.tock.length;i++)this.behaviors.tock[i].el.isPlaying&&this.behaviors.tock[i].tock(t,n,r);for(i=0;i<this.systemNames.length;i++)o[this.systemNames[i]].tock&&o[this.systemNames[i]].tock(t,n,r)}},render:{value:function(t,n){var r=this.renderer;this.frame=n,this.delta=1e3*this.clock.getDelta(),this.time=1e3*this.clock.elapsedTime,this.isPlaying&&this.tick(this.time,this.delta);var i=null;this.is("ar-mode")&&(i=this.object3D.background,this.object3D.background=null),r.render(this.object3D,this.camera),i&&(this.object3D.background=i)},writable:!0}})}),n.exports.setupCanvas=w},{"../../lib/three":179,"../../utils/":205,"../../utils/ios-orientationchange-blank-bug":206,"../a-entity":127,"../a-node":129,"../a-register-element":130,"../system":142,"./loadingScreen":135,"./metaTags":136,"./postMessage":137,"./scenes":138,"./wakelock":139}],135:[function(t,n,r){var i,o,a,s=t("../../utils/").styleParser,l="loading-screen";function c(t){var n=i.hasAttribute("embedded"),r=a(i.canvas,n,i.maxCanvasSize,i.is("vr-mode"));t.aspect=r.width/r.height,t.updateProjectionMatrix(),i.renderer.setSize(r.width,r.height,!1)}n.exports.setup=function(t,n){i=t,a=n;var r,u,h,d,p,f,m,v,g,y,b=i.hasAttribute(l)?s.parse(i.getAttribute(l)):void 0,A=b&&b.dotsColor||"white",x=b&&b.backgroundColor||"#24CAFF";(void 0===b||"true"===b.enabled||void 0===b.enabled)&&(r=new THREE.Scene,u=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),h=new THREE.MeshBasicMaterial({color:A}),p=(d=new THREE.Mesh(u,h)).clone(),f=d.clone(),m=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),v=new THREE.Clock,g=0,y=function(){i.renderer.render(r,m),g=v.getElapsedTime()%4,d.visible=g>=1,p.visible=g>=2,f.visible=g>=3},r.background=new THREE.Color(x),r.add(m),d.position.set(-1,0,-15),p.position.set(0,0,-15),f.position.set(1,0,-15),m.add(d),m.add(p),m.add(f),(o=document.createElement("div")).className="a-loader-title",o.innerHTML=document.title,o.style.display="none",i.appendChild(o),setTimeout(function(){i.hasLoaded||(c(m),o.style.display="block",window.addEventListener("resize",function(){c(m)}),i.renderer.setAnimationLoop(y))},200))},n.exports.remove=function(){window.removeEventListener("resize",c),o&&(o.style.display="none")}},{"../../utils/":205}],136:[function(t,n,r){var i,o=t("../../constants/"),a=t("../../utils").extend,s=n.exports.MOBILE_HEAD_TAGS=[c({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),c({name:"mobile-web-app-capable",content:"yes"}),c({name:"theme-color",content:"black"})],l=[c({name:"apple-mobile-web-app-capable",content:"yes"}),c({name:"apple-mobile-web-app-status-bar-style",content:"black"}),{tagName:"link",attributes:i={rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"},exists:function(){return document.querySelector('link[rel="'+i.rel+'"]')}}];function c(t){return{tagName:"meta",attributes:t,exists:function(){return document.querySelector('meta[name="'+t.name+'"]')}}}n.exports.inject=function(t){var n,r=document.head,i=r.querySelector("script"),c=[];return s.forEach(u),t.isIOS&&l.forEach(u),c;function u(t){!(!t||t.exists())&&(n=function(t){if(t&&t.tagName){var n=document.createElement(t.tagName);return n.setAttribute(o.AFRAME_INJECTED,""),a(n,t.attributes)}}(t))&&(i?i.parentNode.insertBefore(n,i):r.appendChild(n),c.push(n))}}},{"../../constants/":123,"../../utils":205}],137:[function(t,n,r){var i=t("../../utils/bind"),o=t("../../utils/").isIframed;function a(t){if(t.data&&"vr"===t.data.type)switch(t.data.data){case"enter":this.enterVR();break;case"exit":this.exitVR()}}n.exports=function(t){o()&&window.addEventListener("message",i(a,t))}},{"../../utils/":205,"../../utils/bind":199}],138:[function(t,n,r){n.exports=[]},{}],139:[function(t,n,r){var i=t("../../../vendor/wakelock/wakelock");n.exports=function(t){if(t.isMobile){var n=t.wakelock=new i;t.addEventListener("enter-vr",function(){n.request()}),t.addEventListener("exit-vr",function(){n.release()})}}},{"../../../vendor/wakelock/wakelock":220}],140:[function(t,n,r){var i,o=t("../utils/"),a=t("./propertyTypes"),s=o.debug,l=a.isValidDefaultValue,c=a.propertyTypes,u=s("core:schema:warn");function h(t){return"type"in t?"string"==typeof t.type:"default"in t}function d(t,n){var r,i,o=t.default,a=t.type;return t.type?"bool"===t.type?a="boolean":"float"===t.type&&(a="number"):a=void 0!==o&&("boolean"==typeof o||"number"==typeof o)?typeof o:Array.isArray(o)?"array":"string",(i=c[a])||u("Unknown property type for component `"+n+"`: "+a),r=!!t.parse,t.parse=t.parse||i.parse,t.stringify=t.stringify||i.stringify,t.type=a,"default"in t?r||l(a,o)||u("Default value `"+o+"` does not match type `"+a+"` in component `"+n+"`"):t.default=i.default,t}function p(t,n){return(null==t||""===t)&&Array.isArray(t=n.default)&&(t=t.slice()),n.parse(t,n.default)}function f(t,n){return"object"!=typeof t?t:n&&null!==t?n.stringify(t):JSON.stringify(t)}n.exports.isSingleProperty=h,n.exports.process=function(t,n){var r;if(h(t))return d(t,n);for(r in t)t[r]=d(t[r],n);return t},n.exports.processPropertyDefinition=d,n.exports.parseProperties=(i=[],function(t,n,r,o,a){var s,l,c,h;for(l in i.length=0,r?t:n)r&&void 0===t[l]||i.push(l);if(null===t||"object"!=typeof t)return t;for(l in t)void 0===t[l]||n[l]||a||u("Unknown property `"+l+"` for component/system `"+o+"`.");for(s=0;s<i.length;s++){if(c=n[l=i[s]],h=t[l],!n[l])return;t[l]=p(h,c)}return t}),n.exports.parseProperty=p,n.exports.stringifyProperties=function(t,n){var r,i,o,a,s={};for(r in t)i=n[r],"object"!=typeof(a=o=t[r])||(a=f(o,i),i||u("Unknown component property: "+r)),s[r]=a;return s},n.exports.stringifyProperty=f},{"../utils/":205,"./propertyTypes":133}],141:[function(t,n,r){var i=t("./schema").process,o=n.exports.shaders={},a=n.exports.shaderNames=[],s=t("../lib/three"),l=t("../utils"),c={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},u=n.exports.Shader=function(){};u.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(t){return this.attributes=this.initVariables(t,"attribute"),this.uniforms=this.initVariables(t,"uniform"),this.material=new(this.raw?s.RawShaderMaterial:s.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(t,n){var r,i,o=this.schema,a={};for(r in o)o[r].is===n&&(i=c[o[r].type],a[r]={type:i,value:void 0});return a},update:function(t){this.updateVariables(t,"attribute"),this.updateVariables(t,"uniform")},updateVariables:function(t,n){var r,i,o,a=this.schema;for(r in o="uniform"===n?this.uniforms:this.attributes,t)if(a[r]&&a[r].is===n){if("map"===a[r].type){if(!o[r]||o[r].value===t[r])continue;i="_texture_"+r,this.setMapOnTextureLoad(o,r,i),l.material.updateMapMaterialFromData(i,r,this,t);continue}o[r].value=this.parseValue(a[r].type,t[r]),o[r].needsUpdate=!0}},parseValue:function(t,n){var r;switch(t){case"vec2":return new s.Vector2(n.x,n.y);case"vec3":return new s.Vector3(n.x,n.y,n.z);case"vec4":return new s.Vector4(n.x,n.y,n.z,n.w);case"color":return r=new s.Color(n),new s.Vector3(r.r,r.g,r.b);case"map":return s.ImageUtils.loadTexture(n);default:return n}},setMapOnTextureLoad:function(t,n,r){var i=this;this.el.addEventListener("materialtextureloaded",function(){t[n].value=i.material[r],t[n].needsUpdate=!0})}},n.exports.registerShader=function(t,n){var r,s={};if(Object.keys(n).forEach(function(t){s[t]={value:n[t],writable:!0}}),o[t])throw Error("The shader "+t+" has been already registered");return(r=function(){u.call(this)}).prototype=Object.create(u.prototype,s),r.prototype.name=t,r.prototype.constructor=r,o[t]={Shader:r,schema:i(r.prototype.schema)},a.push(t),r}},{"../lib/three":179,"../utils":205,"./schema":140}],142:[function(t,n,r){var i=t("./component"),o=t("./schema"),a=t("../utils/"),s=o.parseProperties,l=o.parseProperty,c=o.process,u=o.isSingleProperty,h=a.styleParser,d=n.exports.systems={},p=n.exports.System=function(t){var n=i&&i.components[this.name];this.el=t,this.sceneEl=t,n&&(n.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};p.prototype={schema:{},init:function(){},update:function(t){},updateProperties:function(t){var n=this.data;Object.keys(o).length&&(this.buildData(t),this.update(n))},buildData:function(t){var n=this.schema;Object.keys(n).length&&(t=t||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),u(n)?this.data=l(t,n):this.data=s(h.parse(t)||{},n))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},n.exports.registerSystem=function(t,n){var r,i,o={},s=a.findAllScenes(document);if(Object.keys(n).forEach(function(t){o[t]={value:n[t],writable:!0}}),d[t])throw Error("The system `"+t+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(r=0,(i=function(t){p.call(this,t)}).prototype=Object.create(p.prototype,o),i.prototype.name=t,i.prototype.constructor=i,i.prototype.schema=a.extend(c(i.prototype.schema)),d[t]=i;r<s.length;r++)s[r].initSystem(t)}},{"../utils/":205,"./component":131,"./schema":140}],143:[function(t,n,r){t("./pivot")},{"./pivot":144}],144:[function(t,n,r){var i=t("../../core/component").registerComponent,o=t("../../lib/three"),a=new o.Vector3,s=new o.Vector3;i("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var t=this.data,n=this.el,r=n.object3D.parent,i=n.object3D,l=new o.Group;a.copy(i.position),s.copy(i.rotation),r.remove(i),l.add(i),r.add(l),n.object3D=l,i.position.set(-1*t.x,-1*t.y,-1*t.z),l.position.set(t.x+a.x,t.y+a.y,t.z+a.z),l.rotation.copy(i.rotation),i.rotation.set(0,0,0)}})},{"../../core/component":131,"../../lib/three":179}],145:[function(t,n,r){var i=t("../../core/component").components,o=t("../../core/shader").shaders,a=t("../../utils/"),s={};function l(t){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===t&&(n="material-fog"),"visible"===t&&(n="material-visible"),s[n]="material."+t}Object.keys(i.material.schema).forEach(l),Object.keys(o.standard.schema).forEach(l),n.exports=function(){return{defaultComponents:{material:{}},mappings:a.extend({},s)}}},{"../../core/component":131,"../../core/shader":141,"../../utils/":205}],146:[function(t,n,r){t("./primitives/a-camera"),t("./primitives/a-cursor"),t("./primitives/a-curvedimage"),t("./primitives/a-gltf-model"),t("./primitives/a-image"),t("./primitives/a-light"),t("./primitives/a-link"),t("./primitives/a-obj-model"),t("./primitives/a-sky"),t("./primitives/a-sound"),t("./primitives/a-text"),t("./primitives/a-video"),t("./primitives/a-videosphere"),t("./primitives/meshPrimitives")},{"./primitives/a-camera":148,"./primitives/a-cursor":149,"./primitives/a-curvedimage":150,"./primitives/a-gltf-model":151,"./primitives/a-image":152,"./primitives/a-light":153,"./primitives/a-link":154,"./primitives/a-obj-model":155,"./primitives/a-sky":156,"./primitives/a-sound":157,"./primitives/a-text":158,"./primitives/a-video":159,"./primitives/a-videosphere":160,"./primitives/meshPrimitives":161}],147:[function(t,n,r){var i=t("../../core/a-entity"),o=t("../../core/component").components,a=t("../../core/a-register-element").registerElement,s=t("../../utils/"),l=s.debug,c=s.entity.setComponentProperty,u=l("extras:primitives:debug"),h=l("extras:primitives:warn"),d=n.exports.primitives={};n.exports.registerPrimitive=function(t,n){u("Registering <%s>",t=t.toLowerCase()),n.defaultAttributes&&h("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var r=a(t,{prototype:Object.create(i.prototype,{defaultComponentsFromPrimitive:{value:n.defaultComponents||n.defaultAttributes||{}},deprecated:{value:n.deprecated||null},deprecatedMappings:{value:n.deprecatedMappings||{}},mappings:{value:n.mappings||{}},createdCallback:{value:function(){n.deprecated&&console.warn(n.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var t=this.mappings,n=this;Object.keys(t).forEach(function(r){var i;r!==r.toLowerCase()&&h("Mapping keys should be specified in lower case. The mapping key "+r+" may not be recognized"),o[r]&&(i=t[r].replace(".","-"),t[i]=t[r],delete t[r],console.warn("The primitive "+n.tagName.toLowerCase()+" has a mapping collision. The attribute "+r+" has the same name as a registered component and has been renamed to "+i))})}},getExtraComponents:{value:function(){var t,n,r,i,o,a,l=this;for(n=s.clone(this.defaultComponentsFromPrimitive),(o=this.getAttribute("mixin"))&&(o=o.trim().split(" ")).forEach(function(t){var r=l.sceneEl.querySelector("#"+t).componentCache;Object.keys(r).forEach(function(t){var i,o;n[t]=(i=n[t],o=r[t],void 0===i?c(o):void 0===o?c(i):u(i)&&u(o)?s.extendDeep(i,o):c(o))})}),r=0;r<this.attributes.length;r++)if(t=this.attributes[r],i=this.mappings[t.name]){(a=s.entity.getComponentPropertyPath(i)).constructor===Array?(n[a[0]]=n[a[0]]||{},n[a[0]][a[1]]=t.value.trim()):n[a]=t.value.trim();continue}return n;function c(t){return u(t)?s.extendDeep({},t):t}function u(t){return null!==t&&t.constructor===Object}}},attributeChangedCallback:{value:function(t,n,r){var i=this.mappings[t];t in this.deprecatedMappings&&console.warn(this.deprecatedMappings[t]),t&&i&&c(this,i,r)}}})});return d[t]=r,r},n.exports.definePrimitive=function(t,r,i){i=i||{},Object.keys(r).map(function(t){!function(t,n){Object.keys(o[t].schema).map(function(r){var i=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==n[i]&&(i=t+"-"+r),n[i]=t+"."+r})}(t,i)}),n.exports.registerPrimitive(t,s.extendDeep({},null,{defaultComponents:r,mappings:i}))}},{"../../core/a-entity":127,"../../core/a-register-element":130,"../../core/component":131,"../../utils/":205}],148:[function(t,n,r){(0,t("../primitives").registerPrimitive)("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":147}],149:[function(t,n,r){var i=t("../getMeshMixin");(0,t("../primitives").registerPrimitive)("a-cursor",t("../../../utils/").extendDeep({},i(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],150:[function(t,n,r){var i=t("../getMeshMixin");(0,t("../primitives").registerPrimitive)("a-curvedimage",t("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],151:[function(t,n,r){(0,t("../primitives").registerPrimitive)("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":147}],152:[function(t,n,r){var i=t("../getMeshMixin");(0,t("../primitives").registerPrimitive)("a-image",t("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],153:[function(t,n,r){(0,t("../primitives").registerPrimitive)("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":147}],154:[function(t,n,r){(0,t("../primitives").registerPrimitive)("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":147}],155:[function(t,n,r){var i=t("../getMeshMixin")();(0,t("../primitives").registerPrimitive)("a-obj-model",t("../../../utils/").extendDeep({},i,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],156:[function(t,n,r){var i=t("../getMeshMixin"),o=t("../primitives").registerPrimitive,a=t("../../../utils/"),s=t("./meshPrimitives");o("a-sky",a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:a.extendDeep({},s["a-sphere"].prototype.mappings)}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147,"./meshPrimitives":161}],157:[function(t,n,r){(0,t("../primitives").registerPrimitive)("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":147}],158:[function(t,n,r){(0,t("../primitives").definePrimitive)("a-text",{text:{anchor:"align",width:5}})},{"../primitives":147}],159:[function(t,n,r){var i=t("../getMeshMixin");(0,t("../primitives").registerPrimitive)("a-video",t("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],160:[function(t,n,r){var i=t("../getMeshMixin");(0,t("../primitives").registerPrimitive)("a-videosphere",t("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],161:[function(t,n,r){var i=t("../getMeshMixin"),o=t("../../../core/geometry").geometries,a=t("../../../core/geometry").geometryNames,s=t("../primitives").registerPrimitive,l=t("../../../utils/"),c=n.exports={};function u(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}a.forEach(function(t){var n=o[t],r=u(t),a={};Object.keys(n.schema).forEach(function(t){a[u(t)]="geometry."+t});var h="a-"+r,d=s(h,l.extendDeep({},i(),{defaultComponents:{geometry:{primitive:t}},mappings:a}));c[h]=d})},{"../../../core/geometry":132,"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],162:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(t){this.geometry=new o.BoxGeometry(t.width,t.height,t.depth,t.segmentsWidth,t.segmentsHeight,t.segmentsDepth)}})},{"../core/geometry":132,"../lib/three":179}],163:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(t){this.geometry=new o.CircleGeometry(t.radius,t.segments,a(t.thetaStart),a(t.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],164:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(t){this.geometry=new o.CylinderGeometry(t.radiusTop,t.radiusBottom,t.height,t.segmentsRadial,t.segmentsHeight,t.openEnded,a(t.thetaStart),a(t.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],165:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(t){this.geometry=new o.CylinderGeometry(t.radius,t.radius,t.height,t.segmentsRadial,t.segmentsHeight,t.openEnded,a(t.thetaStart),a(t.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],166:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(t){this.geometry=new o.DodecahedronGeometry(t.radius,t.detail)}})},{"../core/geometry":132,"../lib/three":179}],167:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(t){this.geometry=new o.IcosahedronGeometry(t.radius,t.detail)}})},{"../core/geometry":132,"../lib/three":179}],168:[function(t,n,r){t("./box.js"),t("./circle.js"),t("./cone.js"),t("./cylinder.js"),t("./dodecahedron.js"),t("./icosahedron.js"),t("./octahedron.js"),t("./plane.js"),t("./ring.js"),t("./sphere.js"),t("./tetrahedron.js"),t("./torus.js"),t("./torusKnot.js"),t("./triangle.js")},{"./box.js":162,"./circle.js":163,"./cone.js":164,"./cylinder.js":165,"./dodecahedron.js":166,"./icosahedron.js":167,"./octahedron.js":169,"./plane.js":170,"./ring.js":171,"./sphere.js":172,"./tetrahedron.js":173,"./torus.js":174,"./torusKnot.js":175,"./triangle.js":176}],169:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(t){this.geometry=new o.OctahedronGeometry(t.radius,t.detail)}})},{"../core/geometry":132,"../lib/three":179}],170:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(t){this.geometry=new o.PlaneGeometry(t.width,t.height,t.segmentsWidth,t.segmentsHeight)}})},{"../core/geometry":132,"../lib/three":179}],171:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(t){this.geometry=new o.RingGeometry(t.radiusInner,t.radiusOuter,t.segmentsTheta,t.segmentsPhi,a(t.thetaStart),a(t.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],172:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(t){this.geometry=new o.SphereGeometry(t.radius,t.segmentsWidth,t.segmentsHeight,a(t.phiStart),a(t.phiLength),a(t.thetaStart),a(t.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],173:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(t){this.geometry=new o.TetrahedronGeometry(t.radius,t.detail)}})},{"../core/geometry":132,"../lib/three":179}],174:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=o.Math.degToRad;i("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(t){this.geometry=new o.TorusGeometry(t.radius,2*t.radiusTubular,t.segmentsRadial,t.segmentsTubular,a(t.arc))}})},{"../core/geometry":132,"../lib/three":179}],175:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three");i("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(t){this.geometry=new o.TorusKnotGeometry(t.radius,2*t.radiusTubular,t.segmentsTubular,t.segmentsRadial,t.p,t.q)}})},{"../core/geometry":132,"../lib/three":179}],176:[function(t,n,r){var i=t("../core/geometry").registerGeometry,o=t("../lib/three"),a=new o.Quaternion,s=new o.Vector3(0,0,1),l=new o.Vector2,c=new o.Vector2,u=new o.Vector2;i("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(t){var n,r,i,h,d,p,f,m,v;(i=new o.Triangle).a.set(t.vertexA.x,t.vertexA.y,t.vertexA.z),i.b.set(t.vertexB.x,t.vertexB.y,t.vertexB.z),i.c.set(t.vertexC.x,t.vertexC.y,t.vertexC.z),r=i.getNormal(new o.Vector3),a.setFromUnitVectors(r,s),h=i.a.clone().applyQuaternion(a),d=i.b.clone().applyQuaternion(a),p=i.c.clone().applyQuaternion(a),l.set(Math.min(h.x,d.x,p.x),Math.min(h.y,d.y,p.y)),c.set(Math.max(h.x,d.x,p.x),Math.max(h.y,d.y,p.y)),u.set(0,0).subVectors(c,l),h=new o.Vector2().subVectors(h,l).divide(u),d=new o.Vector2().subVectors(d,l).divide(u),p=new o.Vector2().subVectors(p,l).divide(u),n=this.geometry=new o.BufferGeometry,f=[i.a.x,i.a.y,i.a.z,i.b.x,i.b.y,i.b.z,i.c.x,i.c.y,i.c.z],m=[r.x,r.y,r.z,r.x,r.y,r.z,r.x,r.y,r.z],v=[h.x,h.y,d.x,d.y,p.x,p.y],n.setAttribute("position",new o.Float32BufferAttribute(f,3)),n.setAttribute("normal",new o.Float32BufferAttribute(m,3)),n.setAttribute("uv",new o.Float32BufferAttribute(v,2))}})},{"../core/geometry":132,"../lib/three":179}],177:[function(t,n,r){if(window.Promise=window.Promise||t("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=void 0!==navigator.xr,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var i=t("./utils/isIOSOlderThan10")(window.navigator.userAgent)?1/window.devicePixelRatio:1,o=t("webvr-polyfill"),a={BUFFER_SCALE:i,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new o(a)}var s=t("./utils/"),l=s.debug;s.isIE11&&(t("custom-event-polyfill"),t("../vendor/starts-with-polyfill"));var c=l("A-Frame:error"),u=l("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&u("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),window.cordova||"file:"!==window.location.protocol||c("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),t("present"),s.device.isBrowserEnvironment&&(t("./style/aframe.css"),t("./style/rStats.css"));var h=t("./core/scene/a-scene").AScene,d=t("./core/component").components,p=t("./core/component").registerComponent,f=t("./core/geometry").registerGeometry,m=t("./extras/primitives/primitives").registerPrimitive,v=t("./core/shader").registerShader,g=t("./core/system").registerSystem,y=t("./core/shader").shaders,b=t("./core/system").systems,A=window.THREE=t("./lib/three"),x=t("../package");t("./components/index"),t("./geometries/index"),t("./shaders/index"),t("./systems/index");var w=t("./core/a-node"),E=t("./core/a-entity");t("./core/a-assets"),t("./core/a-cubemap"),t("./core/a-mixin"),t("./extras/components/"),t("./extras/primitives/"),console.log("A-Frame Version: 1.2.0 (Date 2021-02-05, Commit #b220fa00)"),console.log("THREE Version (https://github.com/supermedium/three.js):",x.dependencies["super-three"]),console.log("WebVR Polyfill Version:",x.dependencies["webvr-polyfill"]),n.exports=window.AFRAME={AComponent:t("./core/component").Component,AEntity:E,ANode:w,ANIME:t("super-animejs"),AScene:h,components:d,coreComponents:Object.keys(d),geometries:t("./core/geometry").geometries,registerComponent:p,registerElement:t("./core/a-register-element").registerElement,registerGeometry:f,registerPrimitive:m,registerShader:v,registerSystem:g,primitives:{getMeshMixin:t("./extras/primitives/getMeshMixin"),primitives:t("./extras/primitives/primitives").primitives},scenes:t("./core/scene/scenes"),schema:t("./core/schema"),shaders:y,systems:b,THREE:A,utils:s,version:x.version}},{"../package":73,"../vendor/starts-with-polyfill":218,"./components/index":84,"./core/a-assets":125,"./core/a-cubemap":126,"./core/a-entity":127,"./core/a-mixin":128,"./core/a-node":129,"./core/a-register-element":130,"./core/component":131,"./core/geometry":132,"./core/scene/a-scene":134,"./core/scene/scenes":138,"./core/schema":140,"./core/shader":141,"./core/system":142,"./extras/components/":143,"./extras/primitives/":146,"./extras/primitives/getMeshMixin":145,"./extras/primitives/primitives":147,"./geometries/index":168,"./lib/three":179,"./shaders/index":181,"./style/aframe.css":186,"./style/rStats.css":187,"./systems/index":191,"./utils/":205,"./utils/isIOSOlderThan10":208,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":68}],178:[function(t,n,r){window.aframeStats=function(t){var n=null;return{update:function(){var r;n("te").set((r=t.querySelectorAll("*"),Array.prototype.slice.call(r).filter(function(t){return t.isEntity}),r.length)),window.performance.getEntriesByName&&n("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))},start:function(){},end:function(){},attach:function(t){n=t},values:{te:{caption:"Entities"},lt:{caption:"Load Time"}},groups:[{caption:"A-Frame",values:["te","lt"]}],fractions:[]}},"object"==typeof n&&(n.exports={aframeStats:window.aframeStats})},{}],179:[function(t,n,i){(function(r){var i=r.THREE=t("super-three");i.TextureLoader&&(i.TextureLoader.prototype.crossOrigin="anonymous"),i.ImageLoader&&(i.ImageLoader.prototype.crossOrigin="anonymous"),i.Cache&&(i.Cache.enabled=!0),t("../../vendor/DeviceOrientationControls"),t("super-three/examples/js/loaders/DRACOLoader"),t("super-three/examples/js/loaders/GLTFLoader"),t("super-three/examples/js/loaders/OBJLoader"),t("super-three/examples/js/loaders/MTLLoader"),t("super-three/examples/js/utils/BufferGeometryUtils"),i.DRACOLoader.prototype.crossOrigin="anonymous",i.GLTFLoader.prototype.crossOrigin="anonymous",i.MTLLoader.prototype.crossOrigin="anonymous",i.OBJLoader.prototype.crossOrigin="anonymous",n.exports=i}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../vendor/DeviceOrientationControls":215,"super-three":57,"super-three/examples/js/loaders/DRACOLoader":58,"super-three/examples/js/loaders/GLTFLoader":59,"super-three/examples/js/loaders/MTLLoader":60,"super-three/examples/js/loaders/OBJLoader":61,"super-three/examples/js/utils/BufferGeometryUtils":62}],180:[function(t,n,r){var i=t("../core/shader").registerShader,o=t("../lib/three"),a=t("../utils/");function s(t,n){return n.color.set(t.color),n.fog=t.fog,n.wireframe=t.wireframe,n.wireframeLinewidth=t.wireframeLinewidth,n}n.exports.Shader=i("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(t){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new o.Color},this.textureSrc=null,s(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new o.MeshBasicMaterial(this.materialData),a.material.updateMap(this,t)},update:function(t){this.updateMaterial(t),a.material.updateMap(this,t)},updateMaterial:function(t){var n;for(n in s(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.materialData)this.material[n]=this.materialData[n]}})},{"../core/shader":141,"../lib/three":179,"../utils/":205}],181:[function(t,n,r){t("./flat"),t("./standard"),t("./sdf"),t("./msdf"),t("./ios10hls")},{"./flat":180,"./ios10hls":182,"./msdf":183,"./sdf":184,"./standard":185}],182:[function(t,n,r){var i=t("../core/shader").registerShader;n.exports.Shader=i("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:"varying vec2 vUV;\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV = uv;\n}",fragmentShader:"uniform sampler2D src;\nuniform float opacity;\nvarying vec2 vUV;\nvoid main() {\n  vec2 offset = vec2(0, 0);\n  vec2 repeat = vec2(1, 1);\n  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;\n  gl_FragColor = vec4(color.rgb, opacity);\n}"})},{"../core/shader":141}],183:[function(t,n,r){var i=t("../core/shader").registerShader,o=!!document.createElement("canvas").getContext("webgl2");n.exports.Shader=i("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:o?"#version 300 es\nin vec2 uv;\nin vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nout vec2 vUV;\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV = uv;\n}":"attribute vec2 uv;\nattribute vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nvarying vec2 vUV;\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV = uv;\n}",fragmentShader:o?"#version 300 es\nprecision highp float;\nuniform bool negate;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nin vec2 vUV;\nout vec4 fragColor;\nfloat median(float r, float g, float b) {\n  return max(min(r, g), min(max(r, g), b));\n}\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\nvoid main() {\n  vec3 sampleColor = texture(map, vUV).rgb;\n  if (negate) { sampleColor = 1.0 - sampleColor; }\n  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n  float dscale = 0.353505;\n  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));\n  float isBigEnough = max(abs(duv.x), abs(duv.y));\n  // Do modified alpha test.\n  if (isBigEnough > BIG_ENOUGH) {\n    float ratio = BIG_ENOUGH / isBigEnough;\n    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n  }\n  // Do modified alpha test.\n  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  fragColor = vec4(color.xyz, alpha * opacity);\n}":"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives: enable\n#endif\nprecision highp float;\nuniform bool negate;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nvarying vec2 vUV;\nfloat median(float r, float g, float b) {\n  return max(min(r, g), min(max(r, g), b));\n}\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\nvoid main() {\n  vec3 sampleColor = texture2D(map, vUV).rgb;\n  if (negate) { sampleColor = 1.0 - sampleColor; }\n  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;\n  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n  float dscale = 0.353505;\n  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));\n  float isBigEnough = max(abs(duv.x), abs(duv.y));\n  // Do modified alpha test.\n  if (isBigEnough > BIG_ENOUGH) {\n    float ratio = BIG_ENOUGH / isBigEnough;\n    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);\n  }\n  // Do modified alpha test.\n  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  gl_FragColor = vec4(color.xyz, alpha * opacity);\n}"})},{"../core/shader":141}],184:[function(t,n,r){var i=t("../core/shader").registerShader;n.exports.Shader=i("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:"#version 300 es\nin vec2 uv;\nin vec3 position;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nout vec2 vUV;\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUV = uv;\n}",fragmentShader:"#version 300 es\nprecision highp float;\nuniform float alphaTest;\nuniform float opacity;\nuniform sampler2D map;\nuniform vec3 color;\nin vec2 vUV;\nout vec4 fragColor;\n#ifdef GL_OES_standard_derivatives\n  float contour(float width, float value) {\n    return smoothstep(0.5 - value, 0.5 + value, width);\n  }\n#else\n  float aastep(float value, float afwidth) {\n    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);\n  }\n#endif\n#define BIG_ENOUGH 0.001\n#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)\n#define ALL_SMOOTH 0.4\n#define ALL_ROUGH 0.02\n#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))\nvoid main() {\n  #ifdef GL_OES_standard_derivatives\n    vec2 uv = vUV;\n    vec4 texColor = texture(map, uv);\n    float dist = texColor.a;\n    float width = fwidth(dist);\n    float alpha = contour(dist, width);\n    float dscale = 0.353505;\n    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));\n    float isBigEnough = max(abs(duv.x), abs(duv.y));\n    if (isBigEnough > BIG_ENOUGH) {\n      float ratio = BIG_ENOUGH / isBigEnough;\n      alpha = ratio * alpha + (1.0 - ratio) * dist;\n    }\n    if (isBigEnough <= BIG_ENOUGH) {\n      vec4 box = vec4 (uv - duv, uv + duv);\n      alpha = (alpha + 0.5 * (\n        contour(texture(map, box.xy).a, width)\n        + contour(texture(map, box.zw).a, width)\n        + contour(texture(map, box.xw).a, width)\n        + contour(texture(map, box.zy).a, width)\n      )) / 3.0;\n    }\n    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }\n  #else\n    vec4 texColor = texture(map, vUV);\n    float value = texColor.a;\n    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));\n    float alpha = aastep(value, afwidth);\n    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);\n    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }\n    alpha = alpha * ratio + (1.0 - ratio) * value;\n    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }\n  #endif\n  fragColor = vec4(color, opacity * alpha);\n}"})},{"../core/shader":141}],185:[function(t,n,r){var i=t("../core/shader").registerShader,o=t("../lib/three"),a=t("../utils/"),s=new o.CubeTextureLoader,l={};function c(t,n){return n.color.set(t.color),n.emissive.set(t.emissive),n.emissiveIntensity=t.emissiveIntensity,n.fog=t.fog,n.metalness=t.metalness,n.roughness=t.roughness,n.wireframe=t.wireframe,n.wireframeLinewidth=t.wireframeLinewidth,t.normalMap&&(n.normalScale=t.normalScale),t.ambientOcclusionMap&&(n.aoMapIntensity=t.ambientOcclusionMapIntensity),t.displacementMap&&(n.displacementScale=t.displacementScale,n.displacementBias=t.displacementBias),n}n.exports.Shader=i("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(t){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new o.Color,emissive:new o.Color},c(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new o.MeshStandardMaterial(this.materialData),a.material.updateMap(this,t),t.normalMap&&a.material.updateDistortionMap("normal",this,t),t.displacementMap&&a.material.updateDistortionMap("displacement",this,t),t.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,t),t.metalnessMap&&a.material.updateDistortionMap("metalness",this,t),t.roughnessMap&&a.material.updateDistortionMap("roughness",this,t),this.updateEnvMap(t)},update:function(t){this.updateMaterial(t),a.material.updateMap(this,t),t.normalMap&&a.material.updateDistortionMap("normal",this,t),t.displacementMap&&a.material.updateDistortionMap("displacement",this,t),t.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,t),t.metalnessMap&&a.material.updateDistortionMap("metalness",this,t),t.roughnessMap&&a.material.updateDistortionMap("roughness",this,t),this.updateEnvMap(t)},updateMaterial:function(t){var n,r=this.material;for(n in c(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.materialData)r[n]=this.materialData[n]},updateEnvMap:function(t){var n=this,r=this.material,i=t.envMap,c=t.sphericalEnvMap;if(!i&&!c||this.isLoadingEnvMap){r.envMap=null,r.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,c){this.el.sceneEl.systems.material.loadTexture(c,{src:c},function(t){n.isLoadingEnvMap=!1,t.mapping=o.SphericalReflectionMapping,r.envMap=t,a.material.handleTextureEvents(n.el,t),r.needsUpdate=!0});return}if(l[i]){l[i].then(function(t){n.isLoadingEnvMap=!1,r.envMap=t,a.material.handleTextureEvents(n.el,t),r.needsUpdate=!0});return}l[i]=new Promise(function(t){a.srcLoader.validateCubemapSrc(i,function(i){s.load(i,function(i){n.isLoadingEnvMap=!1,r.envMap=i,a.material.handleTextureEvents(n.el,i),t(i)})})})}})},{"../core/shader":141,"../lib/three":179,"../utils/":205}],186:[function(t,n,r){var i="html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}";t("browserify-css").createStyle(i,{href:"src/style/aframe.css"}),n.exports=i},{"browserify-css":4}],187:[function(t,n,r){var i=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";t("browserify-css").createStyle(i,{href:"src/style/rStats.css"}),n.exports=i},{"browserify-css":4}],188:[function(t,n,r){var i=t("../constants/"),o=t("../core/system").registerSystem,a="data-aframe-default-camera";n.exports.System=o("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var t,n,r=this.sceneEl,i=this;if(r.camera&&!r.camera.el.getAttribute("camera").spectator){r.emit("cameraready",{cameraEl:r.camera.el});return}if(!(t=r.querySelectorAll("a-camera, [camera]")).length){this.createDefaultCamera();return}for(n=0,this.numUserCameras=t.length;n<t.length;n++)t[n].addEventListener("object3dset",function(t){"camera"===t.detail.type&&i.checkUserCamera(this)}),t[n].isNode?t[n].load():t[n].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(t){var n,r=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(!(n=t.getAttribute("camera")).active||n.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,r.camera=t.getObject3D("camera"),r.emit("cameraready",{cameraEl:t})}},createDefaultCamera:function(){var t,n=this.sceneEl;(t=document.createElement("a-entity")).setAttribute("camera",{active:!0}),t.setAttribute("position",{x:0,y:i.DEFAULT_CAMERA_HEIGHT,z:0}),t.setAttribute("wasd-controls",""),t.setAttribute("look-controls",""),t.setAttribute(i.AFRAME_INJECTED,""),t.addEventListener("object3dset",function(r){"camera"===r.detail.type&&(n.camera=r.detail.object,n.emit("cameraready",{cameraEl:t}))}),n.appendChild(t)},disableActiveCamera:function(){var t;(t=this.sceneEl.querySelectorAll("[camera]"))[t.length-1].setAttribute("camera","active",!0)},setActiveCamera:function(t){var n,r,i,o,s=this.activeCameraEl,l=this.sceneEl;if((o=t.getObject3D("camera"))&&t!==this.activeCameraEl){var c,u=l.querySelector("["+a+"]");for(t===(u&&u.querySelector("[camera]"))||l.camera&&(c=l.querySelector("["+a+"]"))&&l.removeChild(c),this.activeCameraEl=t,this.activeCameraEl.play(),l.camera=o,s&&s.setAttribute("camera","active",!1),r=l.querySelectorAll("[camera]"),i=0;i<r.length;i++)(n=r[i]).isEntity&&t!==n&&(n.setAttribute("camera","active",!1),n.pause());l.emit("camera-set-active",{cameraEl:t})}},setSpectatorCamera:function(t){var n,r=this.spectatorCameraEl,i=this.sceneEl;t.getObject3D("camera")&&t!==this.spectatorCameraEl&&(r&&r.setAttribute("camera","spectator",!1),n=this.spectatorCameraEl=t,i.addEventListener("enter-vr",this.wrapRender),i.addEventListener("exit-vr",this.unwrapRender),n.setAttribute("camera","active",!1),n.play(),i.emit("camera-set-spectator",{cameraEl:t}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){this.spectatorCameraEl&&!this.originalRender&&(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(t,n){var r,i,o=this.sceneEl;r=o.renderer.xr.enabled,this.originalRender.call(o.renderer,t,n),this.spectatorCameraEl&&!o.isMobile&&r&&(i=this.spectatorCameraEl.components.camera.camera,o.renderer.xr.enabled=!1,this.originalRender.call(o.renderer,t,i),o.renderer.xr.enabled=r)}})},{"../constants/":123,"../core/system":142}],189:[function(t,n,r){var i=t("../core/geometry").geometries,o=t("../core/system").registerSystem;function a(t){var n=t.primitive,r=i[n]&&i[n].Geometry,o=new r;if(!r)throw Error("Unknown geometry `"+n+"`");return o.init(t),o.geometry}n.exports.System=o("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(t){var n,r,i,o=this.cache;return t.skipCache?a(t):(r=o[i=this.hash(t)],(n=this.cacheCount)[i]=void 0===n[i]?1:n[i]+1,r||(r=a(t),o[i]=r),r)},unuseGeometry:function(t){var n,r,i=this.cache,o=this.cacheCount;!t.skipCache&&i[r=this.hash(t)]&&(n=r,o[n]--,!(o[r]>0)&&(i[r].dispose(),delete i[r],delete o[r]))},hash:function(t){return JSON.stringify(t)}})},{"../core/geometry":132,"../core/system":142}],190:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../lib/three");n.exports.System=i("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var t=this.data.dracoDecoderPath;this.dracoLoader=new o.DRACOLoader,this.dracoLoader.setDecoderPath(t)},update:function(){var t;this.dracoLoader||(t=this.data.dracoDecoderPath,this.dracoLoader=new o.DRACOLoader,this.dracoLoader.setDecoderPath(t))},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":142,"../lib/three":179}],191:[function(t,n,r){t("./camera"),t("./geometry"),t("./gltf-model"),t("./light"),t("./material"),t("./renderer"),t("./shadow"),t("./tracked-controls-webvr"),t("./tracked-controls-webxr"),t("./webxr")},{"./camera":188,"./geometry":189,"./gltf-model":190,"./light":192,"./material":193,"./renderer":194,"./shadow":195,"./tracked-controls-webvr":196,"./tracked-controls-webxr":197,"./webxr":198}],192:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../utils/bind"),a=t("../constants/"),s="data-aframe-default-light";n.exports.System=i("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",o(this.setupDefaultLights,this))},registerLight:function(t){t.hasAttribute(s)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var t,n=this.sceneEl;if(this.defaultLights){t=document.querySelectorAll("["+s+"]");for(var r=0;r<t.length;r++)n.removeChild(t[r]);this.defaultLights=!1}},setupDefaultLights:function(){var t,n,r=this.sceneEl;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||((t=document.createElement("a-entity")).setAttribute("light",{color:"#BBB",type:"ambient"}),t.setAttribute(s,""),t.setAttribute(a.AFRAME_INJECTED,""),r.appendChild(t),(n=document.createElement("a-entity")).setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),n.setAttribute("position",{x:-.5,y:1,z:1}),n.setAttribute(s,""),n.setAttribute(a.AFRAME_INJECTED,""),r.appendChild(n),this.defaultLights=!0)}})},{"../constants/":123,"../core/system":142,"../utils/bind":199}],193:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../lib/three"),a=t("../utils/"),s=t("../utils/material").isHLS,l=a.bind,c=a.debug,u=c("components:texture:error"),h=new o.TextureLoader,d=c("components:texture:warn");function p(t,n){var r=n.offset||{x:0,y:0},i=n.repeat||{x:1,y:1};n.npot&&(t.wrapS=o.ClampToEdgeWrapping,t.wrapT=o.ClampToEdgeWrapping,t.magFilter=o.LinearFilter,t.minFilter=o.LinearFilter),(1!==i.x||1!==i.y)&&(t.wrapS=o.RepeatWrapping,t.wrapT=o.RepeatWrapping,t.repeat.set(i.x,i.y)),(0!==r.x||0!==r.y)&&t.offset.set(r.x,r.y)}h.setCrossOrigin("anonymous"),n.exports.System=i("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",l(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(t,n,r){var i=this;if("CANVAS"===t.tagName){this.loadCanvas(t,n,r);return}if("VIDEO"===t.tagName){t.src||t.srcObject||t.childElementCount||d("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(t,n,r);return}a.srcLoader.validateSrc(t,function(t){i.loadImage(t,n,r)},function(t){i.loadVideo(t,n,r)})},loadImage:function(t,n,r){var i=this.hash(n),a=this.textureCache;if(a[i]){a[i].then(r);return}a[i]=new Promise(function(r,i){function a(t){p(t,n),t.needsUpdate=!0,r(t)}if("string"!=typeof t){a(new o.Texture(t));return}h.load(t,a,function(){},function(t){u("`$s` could not be fetched (Error code: %s; Response: %s)",t.status,t.statusText)})}),a[i].then(r)},loadCanvas:function(t,n,r){var i;p(i=new o.CanvasTexture(t),n),r(i)},loadVideo:function(t,n,r){var i,a,l,c,u,h,f,m,v=this.textureCache;function g(t){t.texture.needsUpdate=!0,r(t.texture,t.videoEl)}if("string"!=typeof t){if(f=t,v[u=this.hashVideo(n,f)]){v[u].then(g);return}(i=f).autoplay=i.hasAttribute("autoplay")&&"false"!==i.getAttribute("autoplay"),i.controls=i.hasAttribute("controls")&&"false"!==i.getAttribute("controls"),"false"===i.getAttribute("loop")&&i.removeAttribute("loop"),"false"===i.getAttribute("preload")&&(i.preload="none"),i.crossOrigin=i.crossOrigin||"anonymous",i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline","")}if(f=f||(a=n.width,l=n.height,(c=document.createElement("video")).width=a,c.height=l,c.setAttribute("playsinline",""),c.setAttribute("webkit-playsinline",""),c.autoplay=!0,c.loop=!0,c.crossOrigin="anonymous",c.addEventListener("error",function(){d("`$s` is not a valid video",t)},!0),c.src=t,c),v[u=this.hashVideo(n,f)]){v[u].then(g);return}(h=new o.VideoTexture(f)).minFilter=o.LinearFilter,p(h,n),this.sceneEl.isIOS&&s(f.src||f.getAttribute("src"),f.type||f.getAttribute("type"))&&(h.format=o.RGBAFormat,h.needsCorrectionBGRA=!0,h.flipY=!1,h.needsCorrectionFlipY=!0),m={texture:h,videoEl:f},v[u]=Promise.resolve(m),g(m)},hash:function(t){return t.src.tagName&&((t=a.extendDeep({},t)).src=t.src.src),JSON.stringify(t)},hashVideo:function(t,n){return function(t,n){var r,i,o,a=n.getAttribute("id");if(a)return a;for(r=0,i="",o=t||{};r<n.attributes.length;r++)o[n.attributes[r].name]=n.attributes[r].value;return Object.keys(o).sort().forEach(function(t){i+=t+":"+o[t]+";"}),i}(t,n)},registerMaterial:function(t){this.materials[t.uuid]=t},unregisterMaterial:function(t){delete this.materials[t.uuid];var n=this.textureCounts;Object.keys(t).filter(function(n){return t[n]&&t[n].isTexture}).forEach(function(r){n[t[r].uuid]--,n[t[r].uuid]<=0&&t[r].dispose()})},updateMaterials:function(t){var n=this.materials;Object.keys(n).forEach(function(t){n[t].needsUpdate=!0})},onMaterialTextureLoaded:function(t){this.textureCounts[t.detail.texture.uuid]||(this.textureCounts[t.detail.texture.uuid]=0),this.textureCounts[t.detail.texture.uuid]++}})},{"../core/system":142,"../lib/three":179,"../utils/":205,"../utils/material":209}],194:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../utils/"),a=t("../lib/three"),s=(0,o.debug)("components:renderer:warn");n.exports.System=i("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:o.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var t=this.data,n=this.el,r=n.renderer;r.sortObjects=t.sortObjects,r.physicallyCorrectLights=t.physicallyCorrectLights,(t.colorManagement||t.gammaOutput)&&(r.outputEncoding=a.sRGBEncoding,t.gammaOutput&&s('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),n.hasAttribute("antialias")&&s('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),n.hasAttribute("logarithmicDepthBuffer")&&s('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(t){this.data.colorManagement&&t&&(t.isColor?t.convertSRGBToLinear():t.isTexture&&(t.encoding=a.sRGBEncoding))}})},{"../core/system":142,"../lib/three":179,"../utils/":205}],195:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../lib/three"),a={basic:o.BasicShadowMap,pcf:o.PCFShadowMap,pcfsoft:o.PCFSoftShadowMap};n.exports.System=i("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var t=this.sceneEl,n=this.data;this.shadowMapEnabled=!1,t.renderer&&(t.renderer.shadowMap.type=a[n.type],t.renderer.shadowMap.autoUpdate=n.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(t){t.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(t){var n=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&t,n&&(n.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":142,"../lib/three":179}],196:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../utils"),a=o.device.isWebXRAvailable;n.exports.System=i("tracked-controls-webvr",{init:function(){var t=this;this.controllers=[],this.isChrome=-1!==navigator.userAgent.indexOf("Chrome"),this.updateControllerList(),this.throttledUpdateControllerList=o.throttle(this.updateControllerList,500,this),!a&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(n){n.length&&(t.vrDisplay=n[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var t,n,r,i,o=this.controllers;if(n=navigator.getGamepads&&navigator.getGamepads()){for(r=0,i=o.length,o.length=0;r<n.length;++r)(t=n[r])&&t.pose&&o.push(t);o.length!==i&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],197:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../utils");n.exports.System=i("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=o.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var t=this,n=this.el.xrSession;if(!n){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var r=t.el.sceneEl.systems.webxr.sessionReferenceSpaceType;n.requestReferenceSpace(r).then(function(n){t.referenceSpace=n}).catch(function(n){throw t.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(r,'tracked-controls-webxr uses reference space "'+r+'".'),n})},updateControllerList:function(){var t,n=this.el.xrSession,r=this.oldControllers;if(!n){if(0===this.oldControllersLength)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(n.inputSources){if(this.controllers=n.inputSources,this.oldControllersLength===this.controllers.length){var i=!0;for(t=0;t<this.controllers.length;++t)if(this.controllers[t]!==r[t]||this.controllers[t].gamepad!==r[t].gamepad){i=!1;break}if(i)return}for(t=0,r.length=0;t<this.controllers.length;t++)r.push(this.controllers[t]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],198:[function(t,n,r){var i=t("../core/system").registerSystem,o=t("../utils/").debug("systems:webxr:warn");n.exports.System=i("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var t=this.data;this.sessionConfiguration={requiredFeatures:t.requiredFeatures,optionalFeatures:t.optionalFeatures},this.sessionReferenceSpaceType=t.referenceSpaceType,t.overlayElement&&(this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:t.overlayElement})},wasFeatureRequested:function(t){return!!("viewer"===t||"local"===t||this.sessionConfiguration.requiredFeatures.includes(t)||this.sessionConfiguration.optionalFeatures.includes(t))},warnIfFeatureNotRequested:function(t,n){this.wasFeatureRequested(t)||o((n?n+" ":"")+'Please add the feature "'+t+"\" to a-scene's webxr system options in requiredFeatures/optionalFeatures.")}})},{"../core/system":142,"../utils/":205}],199:[function(t,n,r){n.exports=function(t,n){var r;return r=Array.prototype.slice.call(arguments,2),function(){var i=r.concat(Array.prototype.slice.call(arguments,0));return t.apply(n,i)}}},{}],200:[function(t,n,r){var i=t("./debug"),o=t("object-assign"),a=i("utils:coordinates:warn"),s=["x","y","z","w"],l=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;n.exports.regex=l;var c="object",u=/\s+/g;function h(t){return l.test(t)}function d(t){return null!=t&&t.constructor===String?parseFloat(t,10):t}n.exports.parse=function(t,n){var r,i,a,l,h,p,f,m,v;if(t&&t instanceof Object)return p=void 0===t.x?n&&n.x:t.x,f=void 0===t.y?n&&n.y:t.y,m=void 0===t.z?n&&n.z:t.z,v=void 0===t.w?n&&n.w:t.w,null!=p&&(t.x=d(p)),null!=f&&(t.y=d(f)),null!=m&&(t.z=d(m)),null!=v&&(t.w=d(v)),t;if(null==t)return typeof n===c?o({},n):n;for(l=0,r=t.trim().split(u),h={};l<s.length;l++)if(a=s[l],r[l])h[a]=parseFloat(r[l],10);else{if(void 0===(i=n&&n[a]))continue;h[a]=d(i)}return h},n.exports.stringify=function(t){var n;return typeof t!==c?t:(n=t.x+" "+t.y,null!=t.z&&(n+=" "+t.z),null!=t.w&&(n+=" "+t.w),n)},n.exports.isCoordinates=h,n.exports.isCoordinate=function(t){return a("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),h(t)},n.exports.toVector3=function(t){return new THREE.Vector3(t.x,t.y,t.z)}},{"./debug":201,"object-assign":39}],201:[function(t,n,r){(function(r){var i=t("debug"),o=t("object-assign"),a={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},s=function(t){var n,r,o=i(t);return o.color=(r=(n=t.split(":"))[n.length-1],a.colors&&a.colors[r]||null),o};o(s,i);var l=function(){try{return window.localStorage}catch(t){}}();l&&(parseInt(l.logs,10)||"true"===l.logs)?s.enable("*"):s.enable("*:error,*:info,*:warn"),r.browser&&(window.logs=s),n.exports=s}).call(this,t("_process"))},{_process:49,debug:8,"object-assign":39}],202:[function(t,n,r){(function(r){var i,o,a,s=t("debug")("device:error"),l=!1,c=!1,u=n.exports.isWebXRAvailable=!window.debug&&void 0!==navigator.xr;if(window.addEventListener("vrdisplayactivate",function(t){var n;u||(n=document.createElement("canvas"),a=t.display,n.getContext("webgl",{}),a.requestPresent([{source:n}]).then(function(){},function(){}))}),u){var h=function(){var t=document.querySelector("a-scene");if(!t){window.addEventListener("DOMContentLoaded",h);return}t.hasLoaded?t.components["vr-mode-ui"].updateEnterInterfaces():t.addEventListener("loaded",h)},d=function(t){s("WebXR session support error: "+t.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(t){l=t,h()}).catch(d),navigator.xr.isSessionSupported("immersive-ar").then(function(t){c=t,h()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){l=!0,h()}).catch(d),navigator.xr.supportsSession("immersive-ar").then(function(){c=!0,h()}).catch(function(){})):s("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(t){var n=document.querySelector("a-scene");a=t.length&&t[0],n&&n.emit("displayconnected",{vrDisplay:a})});n.exports.getVRDisplay=function(){return a},n.exports.checkHeadsetConnected=function(){return l||c||!!a},n.exports.checkARSupport=function(){return c};var p=(i=!1,o=window.navigator.userAgent||window.navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(o)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(i=!0),(m()||f()||b())&&(i=!0),y()&&(i=!1),function(){return i});function f(t){var n=t||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(n)}function m(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function v(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}function g(){return/(Mobile VR)/i.test(window.navigator.userAgent)}function y(){return v()||g()}function b(){return/R7 Build/.test(window.navigator.userAgent)}n.exports.isMobile=p,n.exports.isTablet=f,n.exports.isIOS=m,n.exports.isMobileDeviceRequestingDesktopSite=function(){return!p()&&!y()&&void 0!==window.orientation},n.exports.isOculusBrowser=v,n.exports.isFirefoxReality=g,n.exports.isMobileVR=y,n.exports.isR7=b,n.exports.isLandscape=function(){var t=window.orientation;return b()&&(t+=90),90===t||-90===t},n.exports.isBrowserEnvironment=!!(!r||r.browser),n.exports.isNodeEnvironment=!n.exports.isBrowserEnvironment}).call(this,t("_process"))},{_process:49,debug:8}],203:[function(t,n,r){var i={};function o(t,n){return i[n=n||"."]||(i[n]={}),-1!==t.indexOf(n)?i[n][t]=t.split(n):i[n][t]=t,i[n][t]}n.exports.getComponentPropertyPath=o,n.exports.propertyPathCache=i,n.exports.getComponentProperty=function(t,n,r){var i;return(r=r||".",-1!==n.indexOf(r))?(i=o(n,r)).constructor===String?t.getAttribute(i):t.getAttribute(i[0])[i[1]]:t.getAttribute(n)},n.exports.setComponentProperty=function(t,n,r,i){var a;if(i=i||".",-1!==n.indexOf(i)){(a=o(n,i)).constructor===String?t.setAttribute(a,r):t.setAttribute(a[0],a[1],r);return}t.setAttribute(n,r)}},{}],204:[function(t,n,r){n.exports=function(t){var n=t.style.width,r=t.style.height;t.style.width=parseInt(n,10)+1+"px",t.style.height=parseInt(r,10)+1+"px",setTimeout(function(){t.style.width=n,t.style.height=r},200)}},{}],205:[function(t,n,r){var i,o,a=t("./debug"),s=t("deep-assign"),l=t("./device"),c=t("object-assign"),u=t("./object-pool"),h=a("utils:warn");n.exports.bind=t("./bind"),n.exports.coordinates=t("./coordinates"),n.exports.debug=a,n.exports.device=l,n.exports.entity=t("./entity"),n.exports.forceCanvasResizeSafariMobile=t("./forceCanvasResizeSafariMobile"),n.exports.isIE11=t("./is-ie11"),n.exports.material=t("./material"),n.exports.objectPool=u,n.exports.split=t("./split").split,n.exports.styleParser=t("./styleParser"),n.exports.trackedControls=t("./tracked-controls"),n.exports.checkHeadsetConnected=function(){return h("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),l.checkHeadsetConnected(arguments)},n.exports.isGearVR=n.exports.device.isGearVR=function(){h("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},n.exports.isIOS=function(){return h("`utils.isIOS` has moved to `utils.device.isIOS`"),l.isIOS(arguments)},n.exports.isOculusGo=n.exports.device.isOculusGo=function(){h("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},n.exports.isMobile=function(){return h("`utils.isMobile has moved to `utils.device.isMobile`"),l.isMobile(arguments)},n.exports.throttle=function(t,r,i){var o;return i&&(t=n.exports.bind(t,i)),function(){var n=Date.now(),i=void 0===o?r:n-o;(void 0===o||i>=r)&&(o=n,t.apply(null,arguments))}},n.exports.throttleTick=function(t,r,i){var o;return i&&(t=n.exports.bind(t,i)),function(n,i){var a=void 0===o?i:n-o;(void 0===o||a>=r)&&(o=n,t(n,a))}},n.exports.debounce=function(t,n,r){var i;return function(){var o=this,a=arguments,s=r&&!i;clearTimeout(i),i=setTimeout(function(){i=null,r||t.apply(o,a)},n),s&&t.apply(o,a)}},n.exports.extend=c,n.exports.extendDeep=s,n.exports.clone=function(t){return JSON.parse(JSON.stringify(t))};var d=(i=u.createPool(function(){return[]}),function(t,n){var r,o,a,s,l,c;if(void 0===t||void 0===n||null===t||null===n||!(t&&n&&t.constructor===Object&&n.constructor===Object||t.constructor===Array&&n.constructor===Array))return t===n;for(r in o=i.use(),a=i.use(),o.length=0,a.length=0,t)o.push(r);for(r in n)a.push(r);if(o.length!==a.length)return i.recycle(o),i.recycle(a),!1;for(s=0;s<o.length;++s)if(l=t[o[s]],c=n[o[s]],"object"==typeof l||"object"==typeof c||Array.isArray(l)&&Array.isArray(c)){if(l===c)continue;if(!d(l,c))return i.recycle(o),i.recycle(a),!1}else if(l!==c)return i.recycle(o),i.recycle(a),!1;return i.recycle(o),i.recycle(a),!0});n.exports.deepEqual=d,n.exports.diff=(o=[],function(t,n,r){var i,a,s,l,c,u,h;for(c in l=r||{},o.length=0,t)o.push(c);if(!n)return l;for(s in n)-1===o.indexOf(s)&&o.push(s);for(u=0;u<o.length;u++)i=t[c=o[u]],a=n[c],((h=i&&a&&i.constructor===Object&&a.constructor===Object)&&!d(i,a)||!h&&i!==a)&&(l[c]=a);return l}),n.exports.shouldCaptureKeyEvent=function(t){return!t.metaKey&&document.activeElement===document.body},n.exports.splitString=function(t,n){void 0===n&&(n=" ");var r=RegExp(n,"g");return(t=(t||"").replace(r,n)).split(n)},n.exports.getElData=function(t,n){var r={};return Object.keys(n=n||{}).forEach(function(n){t.hasAttribute(n)&&(r[n]=t.getAttribute(n))}),r},n.exports.getUrlParameter=function(t){var n=RegExp("[\\?&]"+(t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)").exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},n.exports.isIframed=function(){return window.top!==window.self},n.exports.findAllScenes=function(t){for(var n=[],r=t.getElementsByTagName("*"),i=0,o=r.length;i<o;i++)r[i].isScene&&n.push(r[i]);return n},n.exports.srcLoader=t("./src-loader")},{"./bind":199,"./coordinates":200,"./debug":201,"./device":202,"./entity":203,"./forceCanvasResizeSafariMobile":204,"./is-ie11":207,"./material":209,"./object-pool":210,"./split":211,"./src-loader":212,"./styleParser":213,"./tracked-controls":214,"deep-assign":10,"object-assign":39}],206:[function(t,n,r){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],207:[function(t,n,r){var i,o;n.exports=11===(i=-1,o=navigator.userAgent,"Microsoft Internet Explorer"===navigator.appName?null!=RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(o)&&(i=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!=RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})").exec(o)&&(i=parseFloat(RegExp.$1)),i)},{}],208:[function(t,n,r){n.exports=function(t){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(t)}},{}],209:[function(t,n,r){var i=t("../lib/three"),o=["application/x-mpegurl","application/vnd.apple.mpegurl"],a=new Set(["emissiveMap","envMap","map","specularMap"]);function s(t,n){n&&(t.emit("materialtextureloaded",{src:n.image,texture:n}),n.image&&"VIDEO"===n.image.tagName&&(n.image.addEventListener("loadeddata",function(){t.components&&t.components.material&&(n.needsCorrectionBGRA&&n.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(t.components.material.data.shader)&&t.setAttribute("material","shader","ios10hls"),t.emit("materialvideoloadeddata",{src:n.image,texture:n}))}),n.image.addEventListener("ended",function(){t.emit("materialvideoended",{src:n.image,texture:n})})))}n.exports.updateMapMaterialFromData=function(t,n,r,o){var l=r.el,c=r.material,u=l.sceneEl.systems.renderer,h=o[n];if(r.materialSrcs||(r.materialSrcs={}),!h){delete r.materialSrcs[t],d(null);return}function d(n){c[t]=n,n&&a.has(t)&&u.applyColorCorrection(n),c.needsUpdate=!0,s(l,n)}h!==r.materialSrcs[t]&&(r.materialSrcs[t]=h,h instanceof i.Texture?d(h):l.sceneEl.systems.material.loadTexture(h,{src:h,repeat:o.repeat,offset:o.offset,npot:o.npot},function(n){r.materialSrcs[t]===h&&d(n)}))},n.exports.updateMap=function(t,r){return n.exports.updateMapMaterialFromData("map","src",t,r)},n.exports.updateDistortionMap=function(t,n,r){var i=t;"ambientOcclusion"===t&&(i="ao");var o=n.el,l=n.material,c=o.sceneEl.systems.renderer,u=r[t+"Map"],h={};if(h.src=u,h.offset=r[t+"TextureOffset"],h.repeat=r[t+"TextureRepeat"],h.wrap=r[t+"TextureWrap"],u){if(u===n[t+"TextureSrc"])return;n[t+"TextureSrc"]=u,o.sceneEl.systems.material.loadTexture(u,h,d);return}function d(t){var n=i+"Map";l[n]=t,t&&a.has(n)&&c.applyColorCorrection(t),l.needsUpdate=!0,s(o,t)}l.map&&d(null)},n.exports.handleTextureEvents=s,n.exports.isHLS=function(t,n){return!!(n&&o.includes(n.toLowerCase())||t&&t.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":179}],210:[function(t,n,r){var i=Object.freeze(Object.create(null));function o(){return{}}function a(t){var n;if(t&&t.constructor===Object)for(n in t)t[n]=void 0}n.exports.createPool=function(t){var n=[],r=null;function s(i){var o,a;if((i=void 0===i?n.length:i)>0&&null==r&&(r=0),i>0)for(o=n.length,n.length+=Number(i),a=o;a<n.length;a++)n[a]=t();return n.length}return t=t||o,{grow:s,pool:n,recycle:function(t){if(t instanceof Object){if(null===r||-1===r){n[n.length]=t;return}n[--r]=t}},size:function(){return n.length},use:function(){var t;return(null===r||r===n.length)&&s(n.length||5),t=n[r],n[r++]=i,a(t),t}}},n.exports.clearObject=a,n.exports.removeUnusedKeys=function(t,n){var r;if(t&&t.constructor===Object)for(r in t)r in n||delete t[r]}},{}],211:[function(t,n,r){var i;n.exports.split=(i={},function(t,n){return n in i||(i[n]={}),t in i[n]||(i[n][t]=t.split(n)),i[n][t]})},{}],212:[function(t,n,r){var i=t("./debug")("utils:src-loader:warn");function o(t,n,r){(function(t,n){var r;if(t.tagName){n("IMG"===t.tagName);return}(r=new XMLHttpRequest).open("HEAD",t),r.addEventListener("load",function(i){var o;r.status>=200&&r.status<300?null==(o=r.getResponseHeader("Content-Type"))?s(t,n):o.startsWith("image")?n(!0):n(!1):s(t,n),r.abort()}),r.send()})(t,function(i){if(i){n(t);return}r(t)})}function a(t){var n=t.match(/\url\((.+)\)/);if(n)return n[1]}function s(t,n){var r=new Image;r.addEventListener("load",function(){n(!0)}),r.addEventListener("error",function(){n(!1)}),r.src=t}n.exports={parseUrl:a,validateSrc:o,validateCubemapSrc:function(t,n){var r,s,l,c="",u=[];for(s=0;s<5;s++)c+="(url\\((?:[^\\)]+)\\),\\s*)";function h(t){u.push(t),6===u.length&&n(u)}if(c+="(url\\((?:[^\\)]+)\\)\\s*)",l=t.match(new RegExp(c))){for(s=1;s<7;s++)o(a(l[s]),h);return}if(r=function(t){try{var n=document.querySelector(t);return n||i('No element was found matching the selector: "%s"',t),n}catch(n){i('"%s" is not a valid selector',t);return}}(t)){if("A-CUBEMAP"===r.tagName&&r.srcs)return n(r.srcs);i('Selector "%s" does not point to <a-cubemap>',t)}}}},{"./debug":201}],213:[function(t,n,r){var i,o,a=/-([a-z])/g;function s(t){return t.replace(a,u)}function l(t){var n,r;for(r in t)n=s(r),r!==n&&(t[n]=t[r],delete t[r]);return t}n.exports.parse=function(t,n){var r;return"string"!=typeof t||(r=function(t,n){var r,i,o,a,s,l;for(i=0,n=n||{},r=c(t);i<r.length;i++)(o=r[i])&&(a=o.indexOf(":"),s=o.substr(0,a).trim(),l=o.substr(a+1).trim(),n[s]=l);return n}(t,n))[""]?t:l(r)},n.exports.stringify=function(t){return"string"==typeof t?t:function(t){var n,r=0,i=0,o="";for(n in t)r++;for(n in t)o+=n+": "+t[n],i<r-1&&(o+="; "),i++;return o}(t)},n.exports.toCamelCase=s,n.exports.transformKeysToCamelCase=l;var c=(i=[],o=/url\([^)]+$/,function(t){var n,r="",a=0;for(i.length=0;a<t.length;){if(-1===(n=t.indexOf(";",a))&&(n=t.length),r+=t.substring(a,n),o.test(r)){r+=";",a=n+1;continue}i.push(r.trim()),r="",a=n+1}return i});function u(t){return t[1].toUpperCase()}},{}],214:[function(t,n,r){var i=t("../constants").DEFAULT_HANDEDNESS,o=["x","y","z","w"];function a(t,n,r){var i,o,a=t.el.sceneEl,s=r.index||0;return!!n&&!!(o=a&&a.systems["tracked-controls-webvr"])&&!!(i=o.controllers).length&&!!l(i,null,n,r.hand,s)}function s(t,n,r){var i,o=t.el.sceneEl,a=o&&o.systems["tracked-controls-webxr"];return!!a&&!!(i=a.controllers)&&!!i.length&&c(i,n,r.hand,r.index,r.iterateControllerProfiles,r.handTracking)}function l(t,n,r,o,a){var s,l,c=0,u=a>=0?a:0;for(l=0;l<t.length;l++)if(s=t[l],(!r||s.id.startsWith(r))&&(r||s.id===n)&&(!o||!s.hand||o===s.hand)){if(!o||s.hand||c===2*a+(o===i?0:1))return s;++c}}function c(t,n,r,i,o,a){var s,l,c,u,h=!1;for(s=0;s<t.length;s++){if(u=(c=t[s]).profiles,a)h=c.hand;else if(o)for(l=0;l<u.length&&!(h=u[l].startsWith(n));l++);else h=u.length>0&&u[0].startsWith(n);if(h){if("right"===c.handedness||"left"===c.handedness){if(c.handedness===r)return t[s]}else if(s===i)return t[s]}}}n.exports.checkControllerPresentAndSetup=function(t,n,r){var i,o,l=t.el,c=l.sceneEl.hasWebXR;if(o=!!(i=(c?s:a)(t,n,r)),!t.controllerPresent||t.controllerEventsActive||c||t.addEventListeners(),o===t.controllerPresent)return o;t.controllerPresent=o,o?(t.addEventListeners(),t.injectTrackedControls(i),l.emit("controllerconnected",{name:t.name,component:t})):(t.removeEventListeners(),l.emit("controllerdisconnected",{name:t.name,component:t}))},n.exports.isControllerPresentWebVR=a,n.exports.isControllerPresentWebXR=s,n.exports.findMatchingControllerWebVR=l,n.exports.findMatchingControllerWebXR=c,n.exports.emitIfAxesChanged=function(t,n,r){var i,a,s,l,c;for(a in n){for(c=0,i=n[a],s=!1;c<i.length;c++)r.detail.changed[i[c]]&&(s=!0);if(s){for(c=0,l={};c<i.length;c++)l[o[c]]=r.detail.axis[i[c]];t.el.emit(a+"moved",l)}}},n.exports.onButtonEvent=function(t,n,r,i){var o=(i?r.mapping[i]:r.mapping).buttons[t];r.el.emit(o+n),r.updateModel&&r.updateModel(o,n)}},{"../constants":123}],215:[function(t,n,r){THREE.DeviceOrientationControls=function(t){var n,r,i,o,a=this;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var s=function(t){a.deviceOrientation=t},l=function(){a.screenOrientation=window.orientation||0},c=(n=new THREE.Vector3(0,0,1),r=new THREE.Euler,i=new THREE.Quaternion,o=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(t,a,s,l,c){r.set(s,a,-l,"YXZ"),t.setFromEuler(r),t.multiply(o),t.multiply(i.setFromAxisAngle(n,-c))});this.connect=function(){l(),window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",s,!1),a.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",l,!1),window.removeEventListener("deviceorientation",s,!1),a.enabled=!1},this.update=function(){if(!1!==a.enabled){var t=a.deviceOrientation;if(t){var n=t.alpha?THREE.Math.degToRad(t.alpha)+a.alphaOffset:0,r=t.beta?THREE.Math.degToRad(t.beta):0,i=t.gamma?THREE.Math.degToRad(t.gamma):0,o=a.screenOrientation?THREE.Math.degToRad(a.screenOrientation):0;c(a.object.quaternion,n,r,i,o)}}},this.dispose=function(){a.disconnect()},this.connect()}},{}],216:[function(t,n,r){window.glStats=function(){var t=null,n=0,r=0,i=0,o=0,a=0,s=0,l=0;function c(t,n){return function(){n.apply(this,arguments),t.apply(this,arguments)}}return WebGLRenderingContext.prototype.drawArrays=c(WebGLRenderingContext.prototype.drawArrays,function(){n++,arguments[0]==this.POINTS?s+=arguments[2]:a+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=c(WebGLRenderingContext.prototype.drawElements,function(){r++,o+=arguments[1]/3,a+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=c(WebGLRenderingContext.prototype.useProgram,function(){i++}),WebGLRenderingContext.prototype.bindTexture=c(WebGLRenderingContext.prototype.bindTexture,function(){l++}),{update:function(){t("allcalls").set(n+r),t("drawElements").set(r),t("drawArrays").set(n),t("bindTexture").set(l),t("useProgram").set(i),t("glfaces").set(o),t("glvertices").set(a),t("glpoints").set(s)},start:function(){n=0,r=0,i=0,o=0,a=0,s=0,l=0},end:function(){},attach:function(n){t=n},values:{allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}},window.threeStats=function(t){var n=null;return{update:function(){n("renderer.info.memory.geometries").set(t.info.memory.geometries),n("renderer.info.programs").set(t.info.programs.length),n("renderer.info.memory.textures").set(t.info.memory.textures),n("renderer.info.render.calls").set(t.info.render.calls),n("renderer.info.render.triangles").set(t.info.render.triangles),n("renderer.info.render.points").set(t.info.render.points)},start:function(){},end:function(){},attach:function(t){n=t},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],fractions:[]}},window.BrowserStats=function(){var t=null,n=0,r=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var i=Math.log(1024);function o(t){var n=Math.floor(Math.log(t)/i);return Math.round(100*t/Math.pow(1024,n))/100}return{update:function(){n=o(performance.memory.usedJSHeapSize),r=o(performance.memory.totalJSHeapSize),t("memory").set(n),t("total").set(r)},start:function(){n=0},end:function(){},attach:function(n){t=n},values:{memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}},"object"==typeof n&&(n.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],217:[function(t,n,r){"use strict";(function(){"performance"in window==!1&&(window.performance={});var t=window.performance;if("now"in t==!1){var n=Date.now();t.timing&&t.timing.navigationStart&&(n=t.timing.navigationStart),t.now=function(){return Date.now()-n}}t.mark||(t.mark=function(){}),t.measure||(t.measure=function(){})})(),window.rStats=function(t){function n(t,n){for(var r=Object.keys(t),i=0,o=r.length;i<o;i++)n(r[i])}var r,i,o=t||{},a=o.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],s=(o.CSSPath?o.CSSPath:"")+"rStats.css";(o.css||["https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",s]).forEach(function(t){var n;(n=document.createElement("link")).href=t,n.rel="stylesheet",n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n)}),o.values||(o.values={});var l={};function c(t,n,r){var i=r||{},o=document.createElement("canvas"),a=o.getContext("2d"),s=0,l=0,c=i.color?i.color:"#666666",u=document.createElement("canvas"),h=u.getContext("2d");u.width=1,u.height=20,h.fillStyle="#444444",h.fillRect(0,0,1,20),h.fillStyle=c,h.fillRect(0,10,1,10),h.fillStyle="#ffffff",h.globalAlpha=.5,h.fillRect(0,10,1,1),h.globalAlpha=1;var d=document.createElement("canvas"),p=d.getContext("2d");return d.width=1,d.height=20,p.fillStyle="#444444",p.fillRect(0,0,1,20),p.fillStyle="#b70000",p.fillRect(0,10,1,10),p.globalAlpha=.5,p.fillStyle="#ffffff",p.fillRect(0,10,1,1),p.globalAlpha=1,o.width=200,o.height=10,o.style.width=o.width+"px",o.style.height=o.height+"px",o.className="rs-canvas",t.appendChild(o),a.fillStyle="#444444",a.fillRect(0,0,o.width,o.height),{draw:function(t,n){l+=(t-l)*.1,s*=.99,l>s&&(s=l),a.drawImage(o,1,0,o.width-1,o.height,0,0,o.width-1,o.height),n?a.drawImage(d,o.width-1,o.height-l*o.height/s-10):a.drawImage(u,o.width-1,o.height-l*o.height/s-10)}}}function u(t,r){var i=document.createElement("canvas"),o=i.getContext("2d");return i.width=200,i.height=10*r,i.style.width=i.width+"px",i.style.height=i.height+"px",i.className="rs-canvas",t.appendChild(i),o.fillStyle="#444444",o.fillRect(0,0,i.width,i.height),{draw:function(t){o.drawImage(i,1,0,i.width-1,i.height,0,0,i.width-1,i.height);var r=0;n(t,function(n){var s=t[n]*i.height;o.fillStyle=a[n],o.fillRect(i.width-1,r,1,s),r+=s})}}}function h(t,n){var r,a=0,s=0,l=0,u=0,h=performance.now(),d=0,p=document.createElement("div"),f=document.createElement("span"),m=document.createElement("div"),v=document.createTextNode(""),g=o?o.values[t.toLowerCase()]:null,y=new c(p,t,g),b=!1;function A(t){if(g&&g.average){u+=t,d++;var n=performance.now();n-h>=(g.avgMs||1e3)&&(l=u/d,u=0,h=n,d=0)}}function x(){r=performance.now(),o.userTimingAPI&&performance.mark(t+"-start"),b=!0}function w(){a=performance.now()-r,o.userTimingAPI&&(performance.mark(t+"-end"),b&&performance.measure(t,t+"-start",t+"-end")),A(a)}return f.className="rs-counter-id",f.textContent=g&&g.caption?g.caption:t,m.className="rs-counter-value",m.appendChild(v),p.appendChild(f),p.appendChild(m),n?n.div.appendChild(p):i.appendChild(p),r=performance.now(),{set:function(t){A(a=t)},start:x,tick:function(){w(),x()},end:w,frame:function(){var t=performance.now(),n=t-r;s++,n>1e3&&(a=g&&!1===g.interpolate?s:1e3*s/n,s=0,r=t,A(a))},value:function(){return a},draw:function(){var t=g&&g.average?l:a;v.nodeValue=Math.round(100*t)/100;var n=g&&(g.below&&a<g.below||g.over&&a>g.over);y.draw(a,n),p.className=n?"rs-counter-base alarm":"rs-counter-base"}}}function d(t){var r=t.toLowerCase();if(void 0===r&&(r="default"),l[r])return l[r];var i=null;o&&o.groups&&n(o.groups,function(t){var n=o.groups[parseInt(t,10)];i||-1===n.values.indexOf(r.toLowerCase())||(i=n)});var a=new h(r,i);return l[r]=a,a}function p(){n(o.plugins,function(t){o.plugins[t].update()}),n(l,function(t){l[t].draw()}),o&&o.fractions&&n(o.fractions,function(t){var r=o.fractions[parseInt(t,10)],i=[],a=l[r.base.toLowerCase()];a&&(a=a.value(),n(o.fractions[t].steps,function(n){var r=l[o.fractions[t].steps[parseInt(n,10)].toLowerCase()];r&&i.push(r.value()/a)})),r.graph.draw(i)})}return function(){if(o.plugins){o.values||(o.values={}),o.groups||(o.groups=[]),o.fractions||(o.fractions=[]);for(var t=0;t<o.plugins.length;t++)o.plugins[t].attach(d),n(o.plugins[t].values,function(n){o.values[n]=o.plugins[t].values[n]}),o.groups=o.groups.concat(o.plugins[t].groups),o.fractions=o.fractions.concat(o.plugins[t].fractions)}else o.plugins={};(r=document.createElement("div")).className="rs-base",(i=document.createElement("div")).className="rs-container",i.style.height="auto",r.appendChild(i),document.body.appendChild(r),o&&(o.groups&&n(o.groups,function(t){var n=o.groups[parseInt(t,10)],r=document.createElement("div");r.className="rs-group",n.div=r;var a=document.createElement("h1");a.textContent=n.caption,a.addEventListener("click",(function(t){this.classList.toggle("hidden"),t.preventDefault()}).bind(r)),i.appendChild(a),i.appendChild(r)}),o.fractions&&n(o.fractions,function(t){var r=o.fractions[parseInt(t,10)],s=document.createElement("div");s.className="rs-fraction";var l=document.createElement("div");l.className="rs-legend";var c=0;n(o.fractions[t].steps,function(n){var r=document.createElement("p");r.textContent=o.fractions[t].steps[n],r.style.color=a[c],l.appendChild(r),c++}),s.appendChild(l),s.style.height=10*c+"px",r.div=s;var h=new u(s,c);r.graph=h,i.appendChild(s)}))}(),function(t){return t?d(t):{element:r,update:p}}},"object"==typeof n&&(n.exports=window.rStats)},{}],218:[function(t,n,r){String.prototype.startsWith||(String.prototype.startsWith=function(t,n){return n=n||0,this.substr(n,t.length)===t})},{}],219:[function(t,n,r){var i={};i.base64=function(t,n){return"data:"+t+";base64,"+n},i.isMobile=function(){var t,n=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0),n},i.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},i.isIFrame=function(){try{return window.self!==window.top}catch(t){return!0}},i.appendQueryParameter=function(t,n,r){var i=0>t.indexOf("?")?"?":"&";return t+(i+n+"=")+r},i.getQueryParameter=function(t){var n=RegExp("[\\?&]"+(t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)").exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},i.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation},n.exports=i},{}],220:[function(t,n,r){var i,o=t("./util.js");n.exports=(i=navigator.userAgent||navigator.vendor||window.opera).match(/iPhone/i)||i.match(/iPod/i)?function(){var t=null;this.request=function(){t||(t=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){t&&(clearInterval(t),t=null)}}:function(){var t=document.createElement("video");t.addEventListener("ended",function(){t.play()}),this.request=function(){t.paused&&(t.src=o.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),t.play())},this.release=function(){t.pause(),t.src=""}}},{"./util.js":219}]},{},[177])(177)},t.exports=i()}}]);